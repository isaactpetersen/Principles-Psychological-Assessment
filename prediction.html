<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Isaac T. Petersen">
<meta name="dcterms.date" content="today">
<title>9&nbsp; Prediction – Principles of Psychological Assessment: With Applied Examples in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./clinical-actuarial-judgment.html" rel="next">
<link href="./item-response-theory.html" rel="prev">
<link href="./images/logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d640c705e8c17715bca3574aa719063f.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-d6a2ae2cb249da1580f0a11f71b8f854.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d640c705e8c17715bca3574aa719063f.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9be0be348ad53823ff161d1a1ef978d8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d4727fef54d5ba1f892cea2c0407faf0.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-9be0be348ad53823ff161d1a1ef978d8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-WZJ45RB1K4"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-WZJ45RB1K4', { 'anonymize_ip': true});
</script><script type="application/json" class="js-hypothesis-config">
{
  "theme": "classic",
  "openSidebar": false,
  "showHighlights": "whenSidebarOpen"
}
</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="9&nbsp; Prediction – Principles of Psychological Assessment: With Applied Examples in R">
<meta property="og:description" content="">
<meta property="og:image" content="https://isaactpetersen.github.io/Principles-Psychological-Assessment/images/bayesTheorem2x2.png">
<meta property="og:site_name" content="Principles of Psychological Assessment: With Applied Examples in R">
<meta property="og:image:alt" content="[Confusion Matrix](#sec-confusionMatrix): 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio.">
<meta property="og:image:height" content="385">
<meta property="og:image:width" content="1816">
<meta name="twitter:title" content="9&nbsp; Prediction – Principles of Psychological Assessment: With Applied Examples in R">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://isaactpetersen.github.io/Principles-Psychological-Assessment/images/bayesTheorem2x2.png">
<meta name="twitter:image:alt" content="[Confusion Matrix](#sec-confusionMatrix): 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio.">
<meta name="twitter:image-height" content="385">
<meta name="twitter:image-width" content="1816">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./prediction.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Prediction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Principles of Psychological Assessment: With Applied Examples in R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Part I</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scores-scales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Scores and Scales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./constructs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Constructs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reliability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reliability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./validity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Validity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalizability-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalizability Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structural-equation-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Structural Equation Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./item-response-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Item Response Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Prediction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clinical-actuarial-judgment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Clinical Judgment Versus Algorithmic Prediction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clinical-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">General Issues in Clinical Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evidence-based-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Evidence-Based Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ethical Issues in Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factor-analysis-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Factor Analysis and Principal Component Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Part II</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intellectual-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Intellectual Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test-bias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Test Bias</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interview-dsm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">The Interview and the DSM</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./objective-personality-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Objective Personality Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./projective-personality-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Projective Personality Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./psychophysiological-measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Psychophysiological and Ambulatory Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./computerized-adaptive-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Computers and Adaptive Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./behavioral-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Behavioral Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repeated-assessments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Repeated Assessments Across Time</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cognitive-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Assessment of Cognition</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Cultural and Individual Diversity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#sec-overview-prediction" id="toc-sec-overview-prediction" class="nav-link active" data-scroll-target="#sec-overview-prediction"><span class="header-section-number">9.1</span> Overview of Prediction</a>
  <ul>
<li>
<a href="#sec-probability" id="toc-sec-probability" class="nav-link" data-scroll-target="#sec-probability"><span class="header-section-number">9.1.1</span> Issues Around Probability</a>
  <ul>
<li>
<a href="#sec-probabilityTypes" id="toc-sec-probabilityTypes" class="nav-link" data-scroll-target="#sec-probabilityTypes"><span class="header-section-number">9.1.1.1</span> Types of Probabilities</a>
  <ul class="collapse">
<li><a href="#sec-baseRate" id="toc-sec-baseRate" class="nav-link" data-scroll-target="#sec-baseRate"><span class="header-section-number">9.1.1.1.1</span> Base Rate (Marginal Probability)</a></li>
  <li><a href="#sec-jointProbability" id="toc-sec-jointProbability" class="nav-link" data-scroll-target="#sec-jointProbability"><span class="header-section-number">9.1.1.1.2</span> Joint Probability</a></li>
  <li><a href="#sec-conditionalProbability" id="toc-sec-conditionalProbability" class="nav-link" data-scroll-target="#sec-conditionalProbability"><span class="header-section-number">9.1.1.1.3</span> Conditional Probability</a></li>
  </ul>
</li>
  <li><a href="#sec-inverseFallacy" id="toc-sec-inverseFallacy" class="nav-link" data-scroll-target="#sec-inverseFallacy"><span class="header-section-number">9.1.1.2</span> Confusion of the Inverse</a></li>
  <li><a href="#sec-bayesTheorem" id="toc-sec-bayesTheorem" class="nav-link" data-scroll-target="#sec-bayesTheorem"><span class="header-section-number">9.1.1.3</span> Bayes’ Theorem</a></li>
  </ul>
</li>
  <li>
<a href="#sec-predictionAccuracy-overview" id="toc-sec-predictionAccuracy-overview" class="nav-link" data-scroll-target="#sec-predictionAccuracy-overview"><span class="header-section-number">9.1.2</span> Prediction Accuracy</a>
  <ul>
<li><a href="#sec-decisionOutcomes-overview" id="toc-sec-decisionOutcomes-overview" class="nav-link" data-scroll-target="#sec-decisionOutcomes-overview"><span class="header-section-number">9.1.2.1</span> Decision Outcomes</a></li>
  <li><a href="#sec-percentAccuracy-overview" id="toc-sec-percentAccuracy-overview" class="nav-link" data-scroll-target="#sec-percentAccuracy-overview"><span class="header-section-number">9.1.2.2</span> Percent Accuracy</a></li>
  <li><a href="#sec-accuracyByChance" id="toc-sec-accuracyByChance" class="nav-link" data-scroll-target="#sec-accuracyByChance"><span class="header-section-number">9.1.2.3</span> Percent Accuracy by Chance</a></li>
  <li><a href="#sec-predictingFromBaseRate" id="toc-sec-predictingFromBaseRate" class="nav-link" data-scroll-target="#sec-predictingFromBaseRate"><span class="header-section-number">9.1.2.4</span> Predicting from the Base Rate</a></li>
  <li><a href="#sec-differentErrorsDifferentCosts" id="toc-sec-differentErrorsDifferentCosts" class="nav-link" data-scroll-target="#sec-differentErrorsDifferentCosts"><span class="header-section-number">9.1.2.5</span> Different Kinds of Errors Have Different Costs</a></li>
  <li>
<a href="#sec-sensitivitySpecificityPPVnpv" id="toc-sec-sensitivitySpecificityPPVnpv" class="nav-link" data-scroll-target="#sec-sensitivitySpecificityPPVnpv"><span class="header-section-number">9.1.2.6</span> Sensitivity, Specificity, PPV, and NPV</a>
  <ul class="collapse">
<li><a href="#sec-accuracyCutoff" id="toc-sec-accuracyCutoff" class="nav-link" data-scroll-target="#sec-accuracyCutoff"><span class="header-section-number">9.1.2.6.1</span> Some Accuracy Estimates Depend on the Cutoff</a></li>
  </ul>
</li>
  <li>
<a href="#sec-sdt" id="toc-sec-sdt" class="nav-link" data-scroll-target="#sec-sdt"><span class="header-section-number">9.1.2.7</span> Signal Detection Theory</a>
  <ul class="collapse">
<li><a href="#sec-roc" id="toc-sec-roc" class="nav-link" data-scroll-target="#sec-roc"><span class="header-section-number">9.1.2.7.1</span> Receiver Operating Characteristic (ROC) Curve</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#sec-gettingStarted-prediction" id="toc-sec-gettingStarted-prediction" class="nav-link" data-scroll-target="#sec-gettingStarted-prediction"><span class="header-section-number">9.2</span> Getting Started</a>
  <ul>
<li><a href="#sec-loadLibraries-prediction" id="toc-sec-loadLibraries-prediction" class="nav-link" data-scroll-target="#sec-loadLibraries-prediction"><span class="header-section-number">9.2.1</span> Load Libraries</a></li>
  <li>
<a href="#sec-prepareData-prediction" id="toc-sec-prepareData-prediction" class="nav-link" data-scroll-target="#sec-prepareData-prediction"><span class="header-section-number">9.2.2</span> Prepare Data</a>
  <ul>
<li><a href="#sec-loadData-prediction" id="toc-sec-loadData-prediction" class="nav-link" data-scroll-target="#sec-loadData-prediction"><span class="header-section-number">9.2.2.1</span> Load Data</a></li>
  <li><a href="#sec-simulateData-prediction" id="toc-sec-simulateData-prediction" class="nav-link" data-scroll-target="#sec-simulateData-prediction"><span class="header-section-number">9.2.2.2</span> Simulate Data</a></li>
  <li><a href="#sec-addMissingData-prediction" id="toc-sec-addMissingData-prediction" class="nav-link" data-scroll-target="#sec-addMissingData-prediction"><span class="header-section-number">9.2.2.3</span> Add Missing Data</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#sec-rocCurve" id="toc-sec-rocCurve" class="nav-link" data-scroll-target="#sec-rocCurve"><span class="header-section-number">9.3</span> Receiver Operating Characteristic (ROC) Curve</a>
  <ul>
<li><a href="#sec-empiricalROC" id="toc-sec-empiricalROC" class="nav-link" data-scroll-target="#sec-empiricalROC"><span class="header-section-number">9.3.1</span> Empirical ROC Curve</a></li>
  <li><a href="#sec-smoothROC" id="toc-sec-smoothROC" class="nav-link" data-scroll-target="#sec-smoothROC"><span class="header-section-number">9.3.2</span> Smooth ROC Curve</a></li>
  <li><a href="#sec-youdenJ" id="toc-sec-youdenJ" class="nav-link" data-scroll-target="#sec-youdenJ"><span class="header-section-number">9.3.3</span> Youden’s J Statistic</a></li>
  <li><a href="#sec-topLeftROC" id="toc-sec-topLeftROC" class="nav-link" data-scroll-target="#sec-topLeftROC"><span class="header-section-number">9.3.4</span> The point closest to the top-left part of the ROC curve with perfect sensitivity and specificity</a></li>
  </ul>
</li>
  <li>
<a href="#sec-predictionAccuracy" id="toc-sec-predictionAccuracy" class="nav-link" data-scroll-target="#sec-predictionAccuracy"><span class="header-section-number">9.4</span> Prediction Accuracy Across Cutoffs</a>
  <ul>
<li>
<a href="#sec-generalPredictionAccuracy" id="toc-sec-generalPredictionAccuracy" class="nav-link" data-scroll-target="#sec-generalPredictionAccuracy"><span class="header-section-number">9.4.1</span> General Prediction Accuracy</a>
  <ul>
<li>
<a href="#sec-scaleDependentAccuracy" id="toc-sec-scaleDependentAccuracy" class="nav-link" data-scroll-target="#sec-scaleDependentAccuracy"><span class="header-section-number">9.4.1.1</span> Scale-Dependent Accuracy Estimates</a>
  <ul class="collapse">
<li><a href="#sec-meanError" id="toc-sec-meanError" class="nav-link" data-scroll-target="#sec-meanError"><span class="header-section-number">9.4.1.1.1</span> Mean Error</a></li>
  <li><a href="#sec-meanAbsoluteError" id="toc-sec-meanAbsoluteError" class="nav-link" data-scroll-target="#sec-meanAbsoluteError"><span class="header-section-number">9.4.1.1.2</span> Mean Absolute Error (MAE)</a></li>
  <li><a href="#sec-meanSquaredError" id="toc-sec-meanSquaredError" class="nav-link" data-scroll-target="#sec-meanSquaredError"><span class="header-section-number">9.4.1.1.3</span> Mean Squared Error (MSE)</a></li>
  <li><a href="#sec-rootMeanSquaredError" id="toc-sec-rootMeanSquaredError" class="nav-link" data-scroll-target="#sec-rootMeanSquaredError"><span class="header-section-number">9.4.1.1.4</span> Root Mean Squared Error (RMSE)</a></li>
  </ul>
</li>
  <li>
<a href="#sec-scaleIndependentAccuracy" id="toc-sec-scaleIndependentAccuracy" class="nav-link" data-scroll-target="#sec-scaleIndependentAccuracy"><span class="header-section-number">9.4.1.2</span> Scale-Independent Accuracy Estimates</a>
  <ul class="collapse">
<li><a href="#sec-meanPercentageError" id="toc-sec-meanPercentageError" class="nav-link" data-scroll-target="#sec-meanPercentageError"><span class="header-section-number">9.4.1.2.1</span> Mean Percentage Error (MPE)</a></li>
  <li><a href="#sec-meanAbsolutePercentageError" id="toc-sec-meanAbsolutePercentageError" class="nav-link" data-scroll-target="#sec-meanAbsolutePercentageError"><span class="header-section-number">9.4.1.2.2</span> Mean Absolute Percentage Error (MAPE)</a></li>
  <li><a href="#sec-symmetricMeanAbsolutePercentageError" id="toc-sec-symmetricMeanAbsolutePercentageError" class="nav-link" data-scroll-target="#sec-symmetricMeanAbsolutePercentageError"><span class="header-section-number">9.4.1.2.3</span> Symmetric Mean Absolute Percentage Error (sMAPE)</a></li>
  <li><a href="#sec-meanAbsoluteScaledErrro" id="toc-sec-meanAbsoluteScaledErrro" class="nav-link" data-scroll-target="#sec-meanAbsoluteScaledErrro"><span class="header-section-number">9.4.1.2.4</span> Mean Absolute Scaled Error (MASE)</a></li>
  <li><a href="#sec-accuracyRatio" id="toc-sec-accuracyRatio" class="nav-link" data-scroll-target="#sec-accuracyRatio"><span class="header-section-number">9.4.1.2.5</span> Root Mean Squared Log Error (RMSLE)</a></li>
  <li><a href="#sec-coefficientOfDetermination" id="toc-sec-coefficientOfDetermination" class="nav-link" data-scroll-target="#sec-coefficientOfDetermination"><span class="header-section-number">9.4.1.2.6</span> Coefficient of Determination (<span class="math inline">\(R^2\)</span>)</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#sec-discrimination" id="toc-sec-discrimination" class="nav-link" data-scroll-target="#sec-discrimination"><span class="header-section-number">9.4.2</span> Discrimination</a>
  <ul>
<li><a href="#sec-aucROC" id="toc-sec-aucROC" class="nav-link" data-scroll-target="#sec-aucROC"><span class="header-section-number">9.4.2.1</span> Area under the ROC curve (AUC)</a></li>
  <li><a href="#sec-CPA" id="toc-sec-CPA" class="nav-link" data-scroll-target="#sec-CPA"><span class="header-section-number">9.4.2.2</span> Coefficient of Predictive Ability (CPA)</a></li>
  <li><a href="#sec-spearmanRho" id="toc-sec-spearmanRho" class="nav-link" data-scroll-target="#sec-spearmanRho"><span class="header-section-number">9.4.2.3</span> Spearman’s Rho (<span class="math inline">\(\rho\)</span>) Rank Correlation</a></li>
  <li><a href="#sec-somersD" id="toc-sec-somersD" class="nav-link" data-scroll-target="#sec-somersD"><span class="header-section-number">9.4.2.4</span> Somers’ <span class="math inline">\(D_{xy}\)</span> Rank Correlation</a></li>
  <li><a href="#sec-kendallTau" id="toc-sec-kendallTau" class="nav-link" data-scroll-target="#sec-kendallTau"><span class="header-section-number">9.4.2.5</span> Kendall’s Tau-a (<span class="math inline">\(\tau_A\)</span>) Rank Correlation</a></li>
  <li><a href="#sec-concordanceProbability" id="toc-sec-concordanceProbability" class="nav-link" data-scroll-target="#sec-concordanceProbability"><span class="header-section-number">9.4.2.6</span> <span class="math inline">\(c\)</span> Index</a></li>
  <li><a href="#sec-standardizedRegressionCoefficient" id="toc-sec-standardizedRegressionCoefficient" class="nav-link" data-scroll-target="#sec-standardizedRegressionCoefficient"><span class="header-section-number">9.4.2.7</span> Effect Size (<span class="math inline">\(\beta\)</span>) of Regression</a></li>
  </ul>
</li>
  <li>
<a href="#sec-calibration" id="toc-sec-calibration" class="nav-link" data-scroll-target="#sec-calibration"><span class="header-section-number">9.4.3</span> Calibration</a>
  <ul>
<li><a href="#sec-calibrationPlot" id="toc-sec-calibrationPlot" class="nav-link" data-scroll-target="#sec-calibrationPlot"><span class="header-section-number">9.4.3.1</span> Calibration Plot</a></li>
  <li><a href="#sec-brierScores" id="toc-sec-brierScores" class="nav-link" data-scroll-target="#sec-brierScores"><span class="header-section-number">9.4.3.2</span> Brier Scores</a></li>
  <li><a href="#sec-hoslerLemeshow" id="toc-sec-hoslerLemeshow" class="nav-link" data-scroll-target="#sec-hoslerLemeshow"><span class="header-section-number">9.4.3.3</span> Hosler-Lemeshow Test</a></li>
  <li><a href="#sec-spiegelhalterZ" id="toc-sec-spiegelhalterZ" class="nav-link" data-scroll-target="#sec-spiegelhalterZ"><span class="header-section-number">9.4.3.4</span> Spiegelhalter’s z</a></li>
  <li><a href="#sec-calibrationContinuous" id="toc-sec-calibrationContinuous" class="nav-link" data-scroll-target="#sec-calibrationContinuous"><span class="header-section-number">9.4.3.5</span> Calibration for predicting a continuous outcome</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#sec-cutoffAccuracy" id="toc-sec-cutoffAccuracy" class="nav-link" data-scroll-target="#sec-cutoffAccuracy"><span class="header-section-number">9.5</span> Prediction Accuracy at a Given Cutoff</a>
  <ul>
<li><a href="#sec-setCutoff" id="toc-sec-setCutoff" class="nav-link" data-scroll-target="#sec-setCutoff"><span class="header-section-number">9.5.1</span> Set a Cutoff</a></li>
  <li><a href="#sec-accuracyAtCutoff" id="toc-sec-accuracyAtCutoff" class="nav-link" data-scroll-target="#sec-accuracyAtCutoff"><span class="header-section-number">9.5.2</span> Accuracy at a Given Cutoff</a></li>
  <li>
<a href="#sec-confusionMatrix" id="toc-sec-confusionMatrix" class="nav-link" data-scroll-target="#sec-confusionMatrix"><span class="header-section-number">9.5.3</span> Confusion Matrix aka 2x2 Accuracy Table aka Cross-Tabulation aka Contingency Table</a>
  <ul>
<li><a href="#sec-confusionMatrix-number" id="toc-sec-confusionMatrix-number" class="nav-link" data-scroll-target="#sec-confusionMatrix-number"><span class="header-section-number">9.5.3.1</span> Number</a></li>
  <li><a href="#sec-confusionMatrix-numberMargins" id="toc-sec-confusionMatrix-numberMargins" class="nav-link" data-scroll-target="#sec-confusionMatrix-numberMargins"><span class="header-section-number">9.5.3.2</span> Number with margins added</a></li>
  <li><a href="#sec-confusionMatrix-numberMarginsProportions" id="toc-sec-confusionMatrix-numberMarginsProportions" class="nav-link" data-scroll-target="#sec-confusionMatrix-numberMarginsProportions"><span class="header-section-number">9.5.3.3</span> Proportions</a></li>
  <li><a href="#sec-confusionMatrix-numberMarginsProportionsMargins" id="toc-sec-confusionMatrix-numberMarginsProportionsMargins" class="nav-link" data-scroll-target="#sec-confusionMatrix-numberMarginsProportionsMargins"><span class="header-section-number">9.5.3.4</span> Proportions with margins added</a></li>
  </ul>
</li>
  <li><a href="#sec-truePositive" id="toc-sec-truePositive" class="nav-link" data-scroll-target="#sec-truePositive"><span class="header-section-number">9.5.4</span> True Positives (TP)</a></li>
  <li><a href="#sec-trueNegative" id="toc-sec-trueNegative" class="nav-link" data-scroll-target="#sec-trueNegative"><span class="header-section-number">9.5.5</span> True Negatives (TN)</a></li>
  <li><a href="#sec-falsePositive" id="toc-sec-falsePositive" class="nav-link" data-scroll-target="#sec-falsePositive"><span class="header-section-number">9.5.6</span> False Positives (FP)</a></li>
  <li><a href="#sec-falseNegative" id="toc-sec-falseNegative" class="nav-link" data-scroll-target="#sec-falseNegative"><span class="header-section-number">9.5.7</span> False Negatives (FN)</a></li>
  <li><a href="#sec-sampleSize-prediction" id="toc-sec-sampleSize-prediction" class="nav-link" data-scroll-target="#sec-sampleSize-prediction"><span class="header-section-number">9.5.8</span> Sample Size (<em>N</em>)</a></li>
  <li><a href="#sec-selectionRatio" id="toc-sec-selectionRatio" class="nav-link" data-scroll-target="#sec-selectionRatio"><span class="header-section-number">9.5.9</span> Selection Ratio (SR)</a></li>
  <li><a href="#sec-pretestProbability" id="toc-sec-pretestProbability" class="nav-link" data-scroll-target="#sec-pretestProbability"><span class="header-section-number">9.5.10</span> Base Rate (BR)</a></li>
  <li><a href="#sec-pretestOdds" id="toc-sec-pretestOdds" class="nav-link" data-scroll-target="#sec-pretestOdds"><span class="header-section-number">9.5.11</span> Pretest Odds</a></li>
  <li><a href="#sec-percentAccuracy" id="toc-sec-percentAccuracy" class="nav-link" data-scroll-target="#sec-percentAccuracy"><span class="header-section-number">9.5.12</span> Percent Accuracy</a></li>
  <li><a href="#sec-percentAccuracyByChance" id="toc-sec-percentAccuracyByChance" class="nav-link" data-scroll-target="#sec-percentAccuracyByChance"><span class="header-section-number">9.5.13</span> Percent Accuracy by Chance</a></li>
  <li><a href="#sec-percentAccuracyPredictingFromBaseRate" id="toc-sec-percentAccuracyPredictingFromBaseRate" class="nav-link" data-scroll-target="#sec-percentAccuracyPredictingFromBaseRate"><span class="header-section-number">9.5.14</span> Percent Accuracy Predicting from the Base Rate</a></li>
  <li><a href="#sec-relativeImprovementOverChance" id="toc-sec-relativeImprovementOverChance" class="nav-link" data-scroll-target="#sec-relativeImprovementOverChance"><span class="header-section-number">9.5.15</span> Relative Improvement Over Chance (RIOC)</a></li>
  <li><a href="#sec-relativeImprovementOverPredictingFromBaseRate" id="toc-sec-relativeImprovementOverPredictingFromBaseRate" class="nav-link" data-scroll-target="#sec-relativeImprovementOverPredictingFromBaseRate"><span class="header-section-number">9.5.16</span> Relative Improvement Over Predicting from the Base Rate</a></li>
  <li><a href="#sec-sensitivity" id="toc-sec-sensitivity" class="nav-link" data-scroll-target="#sec-sensitivity"><span class="header-section-number">9.5.17</span> Sensitivity (SN)</a></li>
  <li><a href="#sec-specificity" id="toc-sec-specificity" class="nav-link" data-scroll-target="#sec-specificity"><span class="header-section-number">9.5.18</span> Specificity (SP)</a></li>
  <li><a href="#sec-falseNegativeRate" id="toc-sec-falseNegativeRate" class="nav-link" data-scroll-target="#sec-falseNegativeRate"><span class="header-section-number">9.5.19</span> False Negative Rate (FNR)</a></li>
  <li><a href="#sec-falsePositiveRate" id="toc-sec-falsePositiveRate" class="nav-link" data-scroll-target="#sec-falsePositiveRate"><span class="header-section-number">9.5.20</span> False Positive Rate (FPR)</a></li>
  <li><a href="#sec-ppv" id="toc-sec-ppv" class="nav-link" data-scroll-target="#sec-ppv"><span class="header-section-number">9.5.21</span> Positive Predictive Value (PPV)</a></li>
  <li><a href="#sec-npv" id="toc-sec-npv" class="nav-link" data-scroll-target="#sec-npv"><span class="header-section-number">9.5.22</span> Negative Predictive Value (NPV)</a></li>
  <li><a href="#sec-falseDiscoveryRate" id="toc-sec-falseDiscoveryRate" class="nav-link" data-scroll-target="#sec-falseDiscoveryRate"><span class="header-section-number">9.5.23</span> False Discovery Rate (FDR)</a></li>
  <li><a href="#sec-falseOmissionRate" id="toc-sec-falseOmissionRate" class="nav-link" data-scroll-target="#sec-falseOmissionRate"><span class="header-section-number">9.5.24</span> False Omission Rate (FOR)</a></li>
  <li><a href="#sec-youdenJ-example" id="toc-sec-youdenJ-example" class="nav-link" data-scroll-target="#sec-youdenJ-example"><span class="header-section-number">9.5.25</span> Youden’s J Statistic</a></li>
  <li><a href="#sec-balancedAccuracy" id="toc-sec-balancedAccuracy" class="nav-link" data-scroll-target="#sec-balancedAccuracy"><span class="header-section-number">9.5.26</span> Balanced Accuracy</a></li>
  <li><a href="#sec-fScore" id="toc-sec-fScore" class="nav-link" data-scroll-target="#sec-fScore"><span class="header-section-number">9.5.27</span> F-Score</a></li>
  <li><a href="#sec-matthewsCorrelationCoefficient" id="toc-sec-matthewsCorrelationCoefficient" class="nav-link" data-scroll-target="#sec-matthewsCorrelationCoefficient"><span class="header-section-number">9.5.28</span> Matthews Correlation Coefficient (MCC)</a></li>
  <li><a href="#sec-diagnosticOddsRatio" id="toc-sec-diagnosticOddsRatio" class="nav-link" data-scroll-target="#sec-diagnosticOddsRatio"><span class="header-section-number">9.5.29</span> Diagnostic Odds Ratio</a></li>
  <li>
<a href="#sec-diagnosticLikelihoodRatio" id="toc-sec-diagnosticLikelihoodRatio" class="nav-link" data-scroll-target="#sec-diagnosticLikelihoodRatio"><span class="header-section-number">9.5.30</span> Diagnostic Likelihood Ratio</a>
  <ul>
<li><a href="#sec-positiveLikelihoodRatio" id="toc-sec-positiveLikelihoodRatio" class="nav-link" data-scroll-target="#sec-positiveLikelihoodRatio"><span class="header-section-number">9.5.30.1</span> Positive Likelihood Ratio (LR+)</a></li>
  <li><a href="#sec-negativeLikelihoodRatio" id="toc-sec-negativeLikelihoodRatio" class="nav-link" data-scroll-target="#sec-negativeLikelihoodRatio"><span class="header-section-number">9.5.30.2</span> Negative Likelihood Ratio (LR−)</a></li>
  </ul>
</li>
  <li><a href="#sec-posttestOdds" id="toc-sec-posttestOdds" class="nav-link" data-scroll-target="#sec-posttestOdds"><span class="header-section-number">9.5.31</span> Posttest Odds</a></li>
  <li><a href="#sec-posttestProbability" id="toc-sec-posttestProbability" class="nav-link" data-scroll-target="#sec-posttestProbability"><span class="header-section-number">9.5.32</span> Posttest Probability</a></li>
  <li><a href="#sec-nomogram" id="toc-sec-nomogram" class="nav-link" data-scroll-target="#sec-nomogram"><span class="header-section-number">9.5.33</span> Probability Nomogram</a></li>
  <li><a href="#sec-dPrimeSDT" id="toc-sec-dPrimeSDT" class="nav-link" data-scroll-target="#sec-dPrimeSDT"><span class="header-section-number">9.5.34</span> <span class="math inline">\(d'\)</span> Sensitivity from Signal Detection Theory</a></li>
  <li><a href="#sec-aSDT" id="toc-sec-aSDT" class="nav-link" data-scroll-target="#sec-aSDT"><span class="header-section-number">9.5.35</span> <span class="math inline">\(A\)</span> (Non-Parametric) Sensitivity from Signal Detection Theory</a></li>
  <li><a href="#sec-betaSDT" id="toc-sec-betaSDT" class="nav-link" data-scroll-target="#sec-betaSDT"><span class="header-section-number">9.5.36</span> <span class="math inline">\(\beta\)</span> Bias from Signal Detection Theory</a></li>
  <li><a href="#sec-cSDT" id="toc-sec-cSDT" class="nav-link" data-scroll-target="#sec-cSDT"><span class="header-section-number">9.5.37</span> <span class="math inline">\(c\)</span> Bias from Signal Detection Theory</a></li>
  <li><a href="#sec-bSDT" id="toc-sec-bSDT" class="nav-link" data-scroll-target="#sec-bSDT"><span class="header-section-number">9.5.38</span> <span class="math inline">\(b\)</span> (Non-Parametric) Bias from Signal Detection Theory</a></li>
  <li><a href="#sec-miscalibration" id="toc-sec-miscalibration" class="nav-link" data-scroll-target="#sec-miscalibration"><span class="header-section-number">9.5.39</span> Mean Difference between Predicted Versus Observed Values (Miscalibration)</a></li>
  </ul>
</li>
  <li>
<a href="#sec-optimalCutoff" id="toc-sec-optimalCutoff" class="nav-link" data-scroll-target="#sec-optimalCutoff"><span class="header-section-number">9.6</span> Optimal Cutoff Specification</a>
  <ul>
<li>
<a href="#sec-decisionTheory" id="toc-sec-decisionTheory" class="nav-link" data-scroll-target="#sec-decisionTheory"><span class="header-section-number">9.6.1</span> Decision Theory</a>
  <ul>
<li><a href="#sec-overallUtilityCutoff" id="toc-sec-overallUtilityCutoff" class="nav-link" data-scroll-target="#sec-overallUtilityCutoff"><span class="header-section-number">9.6.1.1</span> Overall utility of a specific cutoff value</a></li>
  <li><a href="#sec-utilityRatio" id="toc-sec-utilityRatio" class="nav-link" data-scroll-target="#sec-utilityRatio"><span class="header-section-number">9.6.1.2</span> Utility ratio</a></li>
  </ul>
</li>
  <li>
<a href="#sec-informationTheory" id="toc-sec-informationTheory" class="nav-link" data-scroll-target="#sec-informationTheory"><span class="header-section-number">9.6.2</span> Information Theory</a>
  <ul>
<li>
<a href="#sec-informationGain" id="toc-sec-informationGain" class="nav-link" data-scroll-target="#sec-informationGain"><span class="header-section-number">9.6.2.1</span> Information Gain</a>
  <ul class="collapse">
<li><a href="#sec-IgainTreat2023" id="toc-sec-IgainTreat2023" class="nav-link" data-scroll-target="#sec-IgainTreat2023"><span class="header-section-number">9.6.2.1.1</span> Formula from <span class="citation" data-cites="Treat2023">Treat &amp; Viken (2023)</span></a></li>
  <li><a href="#sec-IgainMetz1973" id="toc-sec-IgainMetz1973" class="nav-link" data-scroll-target="#sec-IgainMetz1973"><span class="header-section-number">9.6.2.1.2</span> Alternative formula from <span class="citation" data-cites="Metz1973">Metz et al. (1973)</span></a></li>
  <li><a href="#sec-IgainSomoza1989" id="toc-sec-IgainSomoza1989" class="nav-link" data-scroll-target="#sec-IgainSomoza1989"><span class="header-section-number">9.6.2.1.3</span> Alternative formula from <span class="citation" data-cites="Somoza1989">Somoza et al. (1989)</span></a></li>
  <li><a href="#sec-IgainExamples" id="toc-sec-IgainExamples" class="nav-link" data-scroll-target="#sec-IgainExamples"><span class="header-section-number">9.6.2.1.4</span> Examples</a></li>
  <li><a href="#sec-baseRateEffectsIgain" id="toc-sec-baseRateEffectsIgain" class="nav-link" data-scroll-target="#sec-baseRateEffectsIgain"><span class="header-section-number">9.6.2.1.5</span> Effect of Base Rate</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#sec-accuracyAtEveryPossibleCutoff" id="toc-sec-accuracyAtEveryPossibleCutoff" class="nav-link" data-scroll-target="#sec-accuracyAtEveryPossibleCutoff"><span class="header-section-number">9.7</span> Accuracy at Every Possible Cutoff</a>
  <ul>
<li><a href="#sec-specifyUtility" id="toc-sec-specifyUtility" class="nav-link" data-scroll-target="#sec-specifyUtility"><span class="header-section-number">9.7.1</span> Specify utility of each outcome</a></li>
  <li><a href="#sec-calculateAccuracyAtEveryPossibleCutoff" id="toc-sec-calculateAccuracyAtEveryPossibleCutoff" class="nav-link" data-scroll-target="#sec-calculateAccuracyAtEveryPossibleCutoff"><span class="header-section-number">9.7.2</span> Calculate Accuracy</a></li>
  <li><a href="#sec-allAccuracyStatistics" id="toc-sec-allAccuracyStatistics" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics"><span class="header-section-number">9.7.3</span> All Accuracy Statistics</a></li>
  <li>
<a href="#sec-allAccuracyStatistics-youdenJ" id="toc-sec-allAccuracyStatistics-youdenJ" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-youdenJ"><span class="header-section-number">9.7.4</span> Youden’s J Statistic</a>
  <ul>
<li><a href="#sec-allAccuracyStatistics-youdenJthreshold" id="toc-sec-allAccuracyStatistics-youdenJthreshold" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-youdenJthreshold"><span class="header-section-number">9.7.4.1</span> Threshold</a></li>
  <li><a href="#sec-allAccuracyStatistics-youdenJaccuracy" id="toc-sec-allAccuracyStatistics-youdenJaccuracy" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-youdenJaccuracy"><span class="header-section-number">9.7.4.2</span> Accuracy statistics at cutoff of Youden’s J Statistic</a></li>
  </ul>
</li>
  <li>
<a href="#sec-allAccuracyStatistics-topLeftROC" id="toc-sec-allAccuracyStatistics-topLeftROC" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-topLeftROC"><span class="header-section-number">9.7.5</span> Closest to the Top Left of the ROC Curve</a>
  <ul>
<li><a href="#sec-allAccuracyStatistics-topLeftROCthreshold" id="toc-sec-allAccuracyStatistics-topLeftROCthreshold" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-topLeftROCthreshold"><span class="header-section-number">9.7.5.1</span> Threshold</a></li>
  <li><a href="#sec-allAccuracyStatistics-topLeftROCaccuracy" id="toc-sec-allAccuracyStatistics-topLeftROCaccuracy" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-topLeftROCaccuracy"><span class="header-section-number">9.7.5.2</span> Accuracy stats at cutoff where the ROC plot is closest to the Top Left</a></li>
  </ul>
</li>
  <li>
<a href="#sec-allAccuracyStatistics-cutoff" id="toc-sec-allAccuracyStatistics-cutoff" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoff"><span class="header-section-number">9.7.6</span> Cutoff that optimizes each of the following criteria:</a>
  <ul>
<li><a href="#sec-allAccuracyStatistics-cutoffPercentAccuracy" id="toc-sec-allAccuracyStatistics-cutoffPercentAccuracy" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffPercentAccuracy"><span class="header-section-number">9.7.6.1</span> Percent Accuracy</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffPercentAccuracyByChance" id="toc-sec-allAccuracyStatistics-cutoffPercentAccuracyByChance" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffPercentAccuracyByChance"><span class="header-section-number">9.7.6.2</span> Percent Accuracy by Chance</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffROIC" id="toc-sec-allAccuracyStatistics-cutoffROIC" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffROIC"><span class="header-section-number">9.7.6.3</span> Relative Improvement Over Chance (ROIC)</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffRelativeImprovementOverPredictingFromBaseRate" id="toc-sec-allAccuracyStatistics-cutoffRelativeImprovementOverPredictingFromBaseRate" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffRelativeImprovementOverPredictingFromBaseRate"><span class="header-section-number">9.7.6.4</span> Relative Improvement Over Predicting from the Base Rate</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffSensitivity" id="toc-sec-allAccuracyStatistics-cutoffSensitivity" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffSensitivity"><span class="header-section-number">9.7.6.5</span> Sensitivity</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffSpecificity" id="toc-sec-allAccuracyStatistics-cutoffSpecificity" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffSpecificity"><span class="header-section-number">9.7.6.6</span> Specificity</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffPPV" id="toc-sec-allAccuracyStatistics-cutoffPPV" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffPPV"><span class="header-section-number">9.7.6.7</span> Positive Predictive Value</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffNPV" id="toc-sec-allAccuracyStatistics-cutoffNPV" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffNPV"><span class="header-section-number">9.7.6.8</span> Negative Predictive Value</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffYoudenJ" id="toc-sec-allAccuracyStatistics-cutoffYoudenJ" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffYoudenJ"><span class="header-section-number">9.7.6.9</span> Youden’s J Statistic</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffBalancedAccuracy" id="toc-sec-allAccuracyStatistics-cutoffBalancedAccuracy" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffBalancedAccuracy"><span class="header-section-number">9.7.6.10</span> Balanced Accuracy</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffF1" id="toc-sec-allAccuracyStatistics-cutoffF1" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffF1"><span class="header-section-number">9.7.6.11</span> F1 Score</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffMCC" id="toc-sec-allAccuracyStatistics-cutoffMCC" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffMCC"><span class="header-section-number">9.7.6.12</span> Matthews Correlation Coefficient</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffDOR" id="toc-sec-allAccuracyStatistics-cutoffDOR" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffDOR"><span class="header-section-number">9.7.6.13</span> Diagnostic Odds Ratio</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffPLR" id="toc-sec-allAccuracyStatistics-cutoffPLR" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffPLR"><span class="header-section-number">9.7.6.14</span> Positive Likelihood Ratio</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffNLR" id="toc-sec-allAccuracyStatistics-cutoffNLR" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffNLR"><span class="header-section-number">9.7.6.15</span> Negative Likelihood Ratio</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffDprime" id="toc-sec-allAccuracyStatistics-cutoffDprime" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffDprime"><span class="header-section-number">9.7.6.16</span> <span class="math inline">\(d'\)</span> Sensitivity</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffAsensitivity" id="toc-sec-allAccuracyStatistics-cutoffAsensitivity" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffAsensitivity"><span class="header-section-number">9.7.6.17</span> <span class="math inline">\(A\)</span> (Non-Parametric) Sensitivity</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffBetaBias" id="toc-sec-allAccuracyStatistics-cutoffBetaBias" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffBetaBias"><span class="header-section-number">9.7.6.18</span> <span class="math inline">\(\beta\)</span> Bias</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffCbias" id="toc-sec-allAccuracyStatistics-cutoffCbias" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffCbias"><span class="header-section-number">9.7.6.19</span> <span class="math inline">\(c\)</span> Bias</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffBbias" id="toc-sec-allAccuracyStatistics-cutoffBbias" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffBbias"><span class="header-section-number">9.7.6.20</span> <span class="math inline">\(b\)</span> (Non-Parametric) Bias</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffMiscalibration" id="toc-sec-allAccuracyStatistics-cutoffMiscalibration" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffMiscalibration"><span class="header-section-number">9.7.6.21</span> Mean difference between predicted and observed values (Miscalibration)</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffOverallUtility" id="toc-sec-allAccuracyStatistics-cutoffOverallUtility" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffOverallUtility"><span class="header-section-number">9.7.6.22</span> Overall Utility</a></li>
  <li><a href="#sec-allAccuracyStatistics-cutoffIgain" id="toc-sec-allAccuracyStatistics-cutoffIgain" class="nav-link" data-scroll-target="#sec-allAccuracyStatistics-cutoffIgain"><span class="header-section-number">9.7.6.23</span> Information Gain</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#sec-regression-prediction" id="toc-sec-regression-prediction" class="nav-link" data-scroll-target="#sec-regression-prediction"><span class="header-section-number">9.8</span> Regression for Prediction of Continuous Outcomes</a></li>
  <li>
<a href="#sec-pseudoPrediction" id="toc-sec-pseudoPrediction" class="nav-link" data-scroll-target="#sec-pseudoPrediction"><span class="header-section-number">9.9</span> Pseudo-Prediction</a>
  <ul>
<li><a href="#sec-multiCollinearity" id="toc-sec-multiCollinearity" class="nav-link" data-scroll-target="#sec-multiCollinearity"><span class="header-section-number">9.9.1</span> Multicollinearity</a></li>
  </ul>
</li>
  <li><a href="#sec-waysToImprovePredictionAccuracy" id="toc-sec-waysToImprovePredictionAccuracy" class="nav-link" data-scroll-target="#sec-waysToImprovePredictionAccuracy"><span class="header-section-number">9.10</span> Ways to Improve Prediction Accuracy</a></li>
  <li><a href="#sec-conclusion-prediction" id="toc-sec-conclusion-prediction" class="nav-link" data-scroll-target="#sec-conclusion-prediction"><span class="header-section-number">9.11</span> Conclusion</a></li>
  <li><a href="#sec-readings-prediction" id="toc-sec-readings-prediction" class="nav-link" data-scroll-target="#sec-readings-prediction"><span class="header-section-number">9.12</span> Suggested Readings</a></li>
  <li>
<a href="#sec-exercises-prediction" id="toc-sec-exercises-prediction" class="nav-link" data-scroll-target="#sec-exercises-prediction"><span class="header-section-number">9.13</span> Exercises</a>
  <ul>
<li><a href="#sec-exercisesQuestions-prediction" id="toc-sec-exercisesQuestions-prediction" class="nav-link" data-scroll-target="#sec-exercisesQuestions-prediction"><span class="header-section-number">9.13.1</span> Questions</a></li>
  <li><a href="#sec-exercisesAnswers-prediction" id="toc-sec-exercisesAnswers-prediction" class="nav-link" data-scroll-target="#sec-exercisesAnswers-prediction"><span class="header-section-number">9.13.2</span> Answers</a></li>
  </ul>
</li>
  <li><a href="#sec-sessionInfo-prediction" id="toc-sec-sessionInfo-prediction" class="nav-link" data-scroll-target="#sec-sessionInfo-prediction"><span class="header-section-number">9.14</span> Session Info</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/edit/main/prediction.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/blob/main/prediction.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><div class="alert alert-info hints-alert">
  <div class="hints-icon">
    <i class="fa fa-comments-o"></i>
  </div>
  <div class="hints-container">
    <b>I need your help!</b>
    <p>
    I want your feedback to make the book better for you and other readers. If you find typos, errors, or places where the text may be improved, please let me know.
    The best ways to provide feedback are by <a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment">GitHub</a> or <a href="https://hypothes.is">hypothes.is</a> annotations.
    </p>

    <p>
      <i class="fa fa-github"></i>
      <a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/issues">Opening an issue</a> or <a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/pulls">submitting a pull request</a> on GitHub: <a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment">https://github.com/isaactpetersen/Principles-Psychological-Assessment</a>
    </p>
    <p>
      <img style="display: inline;" src="https://hypothes.is/organizations/__default__/logo" alt="Hypothesis">
      Adding an annotation using <a href="https://hypothes.is">hypothes.is</a>.
      To add an annotation, <span style="background-color: #3297FD; color: white">select some text</span> and then click the
      <span class="svg-icon--inline"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 16 16" class="annotator-adder-actions__icon"><path fill="currentColor" fill-rule="nonzero" d="M15 0c.27 0 .505.099.703.297A.961.961 0 0116 1v15l-4-3H1a.974.974 0 01-.703-.29A.953.953 0 010 12V1C0 .719.096.482.29.29A.966.966 0 011 0h14zM7 3l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C4.156 5.229 4 6 4 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188C4.729 8.854 5.082 9 5.5 9c.417 0 .77-.146 1.063-.438C6.854 8.271 7 7.918 7 7.5c0-.417-.146-.77-.438-1.063A1.447 1.447 0 005.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L7 4V3zm5 0l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C9.156 5.229 9 6 9 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188c.291.291.645.437 1.062.437.417 0 .77-.146 1.063-.438.291-.291.437-.645.437-1.062 0-.417-.146-.77-.438-1.063A1.447 1.447 0 0010.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L12 4V3z"></path></svg></span>
      symbol on the pop-up menu.
      To see the annotations of others, click the
      <span class="svg-icon--inline"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 16 16" class=""><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 12L6 8l4-4"></path></g></svg></span>
      symbol in the upper right-hand corner of the page.
    </p>
  </div>
</div>

<header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-prediction" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Prediction</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><blockquote class="blockquote">
<p>“It is very difficult to predict—especially the future.”</p>
<p>— Neils Bohr</p>
</blockquote>
<section id="sec-overview-prediction" class="level2" data-number="9.1"><h2 data-number="9.1" class="anchored" data-anchor-id="sec-overview-prediction">
<span class="header-section-number">9.1</span> Overview of Prediction</h2>
<p>In psychology, we are often interested in predicting behavior. Behavior is complex. Behavior is multiply determined—it is probabilistically influenced by many processes, including processes internal to the person in addition to external processes. In addition, the same behavior can occur for different reasons—that is, behavior can be considered overdetermined. Moreover, people’s behavior occurs in the context of a dynamic system with nonlinear, probabilistic, and cascading influences that change across time. The ever-changing system makes behavior challenging to predict. And, similar to chaos theory (or the butterfly effect), one small change in the system can lead to large differences later on. Another example of a chaotic system is the <a href="https://www.bbc.com/news/articles/cwy1epz58pyo">atmosphere and resulting weather</a> (archived at <a href="https://perma.cc/248N-9CW5" class="uri">https://perma.cc/248N-9CW5</a>).</p>
<p>When something is <em>overdetermined</em>, it has multiple causes, any of which could be sufficient to result in the outcome. In other words, the same behavior can occur for different reasons, consistent with the principle of developmental psychopathology known as <em>equifinality</em>—i.e., multiple causes can result in the same outcome. For instance, aggression could be caused by either excessively low anxiety for some children or excessively high anxiety for others; or for other children, it could be caused by deficient social information processing or another cognitive process. <em>Multifinality</em> refers to the idea that the same cause can result in different outcomes. For instance, substance use might lead to aggressive behavior for some people, whereas it might lead to depressive behavior for others. In contrast to overdetermination, <em>underdetermination</em> refers to the idea that the identified causes are insufficient for explaining the resulting outcome. All of these challenges make behavior difficult to predict.</p>
<p>Predictions can come in different types. Some predictions involve categorical data, whereas other predictions involve continuous data. When dealing with categorical data, we can evaluate predictions using a 2x2 table known as a <a href="#sec-confusionMatrix">confusion matrix</a> (see <a href="#fig-twoByTwoMatrix1" class="quarto-xref">Figure&nbsp;<span>9.4</span></a>), or with logistic regression models. When dealing with continuous data, we can evaluate predictions using multiple regression or similar variants such as <a href="structural-equation-modeling.html">structural equation modeling</a> and <a href="reliability.html#sec-mixedModels">mixed models</a>.</p>
<p>Let’s consider a prediction example, assuming the following probabilities:</p>
<ul>
<li>The probability of contracting HIV is .3%</li>
<li>The probability of a positive test for HIV is 1%</li>
<li>The probability of a positive test if you have HIV is 95%</li>
</ul>
<p>What is the probability of HIV if you have a positive test?</p>
<p>As we will see, the probability is: <span class="math inline">\(\frac{95\% \times .3\%}{1\%} = 28.5\%\)</span>. So based on the above probabilities, if you have a positive test, the probability that you have HIV is 28.5%. Most people tend to vastly over-estimate the likelihood that the person has HIV in this example. Why? Because they do not pay enough attention to the <a href="#sec-baseRate">base rate</a> (in this example, the <a href="#sec-baseRate">base rate</a> of HIV is .3%).</p>
<section id="sec-probability" class="level3" data-number="9.1.1"><h3 data-number="9.1.1" class="anchored" data-anchor-id="sec-probability">
<span class="header-section-number">9.1.1</span> Issues Around Probability</h3>
<section id="sec-probabilityTypes" class="level4" data-number="9.1.1.1"><h4 data-number="9.1.1.1" class="anchored" data-anchor-id="sec-probabilityTypes">
<span class="header-section-number">9.1.1.1</span> Types of Probabilities</h4>
<p>It is important to distinguish between different types of probabilities: marginal probabilities, joint probabilities, and conditional probabilities.</p>
<section id="sec-baseRate" class="level5" data-number="9.1.1.1.1"><h5 data-number="9.1.1.1.1" class="anchored" data-anchor-id="sec-baseRate">
<span class="header-section-number">9.1.1.1.1</span> Base Rate (Marginal Probability)</h5>
<p>A <em>base rate</em> is the probability of an event. Base rates are marginal probabilities. A <em>marginal probability</em> is the probability of an event irrespective of the outcome of another variable. For instance, we can consider the following marginal probabilities:</p>
<p><span class="math inline">\(P(C_i)\)</span> is the probability (i.e., base rate) of a classification, <span class="math inline">\(C\)</span>, independent of other things. A base rate is often used as the “<em>prior probability</em>” in a Bayesian model. In our example above, <span class="math inline">\(P(C_i)\)</span> is the base rate (i.e., prevalence) of HIV in the population: <span class="math inline">\(P(\text{HIV}) = .3\%\)</span>. <span class="math inline">\(P(R_i)\)</span> is the probability (base rate) of a response, <span class="math inline">\(R\)</span>, independent of other things. In the example above, <span class="math inline">\(P(R_i)\)</span> is the base rate of a positive test for HIV: <span class="math inline">\(P(\text{positive test}) = 1\%\)</span>. The base rate of a positive test is known as the <em>positivity rate</em> or <a href="#sec-selectionRatio"><em>selection ratio</em></a>.</p>
</section><section id="sec-jointProbability" class="level5" data-number="9.1.1.1.2"><h5 data-number="9.1.1.1.2" class="anchored" data-anchor-id="sec-jointProbability">
<span class="header-section-number">9.1.1.1.2</span> Joint Probability</h5>
<p>A <em>joint probability</em> is the probability of two (or more) events occurring simultaneously. For instance, the probability of events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> both occurring together is <span class="math inline">\(P(A, B)\)</span>. A joint probability can be calculated using the <a href="#sec-baseRate">marginal probability</a> of each event, as in <a href="#eq-jointProbability" class="quarto-xref">Equation&nbsp;<span>9.1</span></a>:</p>
<p><span id="eq-jointProbability"><span class="math display">\[
P(A, B) = P(A) \cdot P(B)
\tag{9.1}\]</span></span></p>
<p>Conversely (and rearranging the terms for the calculation of <a href="#sec-conditionalProbability">conditional probability</a>), a <a href="#sec-jointProbability">joint probability</a> can also be calculated using the <a href="#sec-conditionalProbability">conditional probability</a> and <a href="#sec-baseRate">marginal probability</a>, as in <a href="#eq-jointProbability2" class="quarto-xref">Equation&nbsp;<span>9.2</span></a>:</p>
<p><span id="eq-jointProbability2"><span class="math display">\[
P(A, B) = P(A | B) \cdot P(B)
\tag{9.2}\]</span></span></p>
</section><section id="sec-conditionalProbability" class="level5" data-number="9.1.1.1.3"><h5 data-number="9.1.1.1.3" class="anchored" data-anchor-id="sec-conditionalProbability">
<span class="header-section-number">9.1.1.1.3</span> Conditional Probability</h5>
<p>A <em>conditional probability</em> is the probability of one event occurring given the occurrence of another event. Conditional probabilities are written as: <span class="math inline">\(P(A | B)\)</span>. This is read as the probability that event <span class="math inline">\(A\)</span> occurs given that event <span class="math inline">\(B\)</span> occurred. For instance, we can consider the following conditional probabilities:</p>
<p><span class="math inline">\(P(C | R)\)</span> is the probability of a classification, <span class="math inline">\(C\)</span>, given a response, <span class="math inline">\(R\)</span>. In other words, <span class="math inline">\(P(C | R)\)</span> is the probability of having HIV given a positive test: <span class="math inline">\(P(\text{HIV} | \text{positive test})\)</span>. <span class="math inline">\(P(R | C)\)</span> is the probability of a response, <span class="math inline">\(R\)</span>, given a classification, <span class="math inline">\(C\)</span>. In the example above, <span class="math inline">\(P(R | C)\)</span> is the probability of having a positive test given that a person has HIV: <span class="math inline">\(P(\text{positive test} | \text{HIV}) = 95\%\)</span>.</p>
<p>A conditional probability can be calculated using the <a href="#sec-jointProbability">joint probability</a> and <a href="#sec-baseRate">marginal probability</a> (base rate), as in <a href="#eq-conditionalProbability" class="quarto-xref">Equation&nbsp;<span>9.3</span></a>:</p>
<p><span id="eq-conditionalProbability"><span class="math display">\[
P(A | B) = \frac{P(A, B)}{P(B)}
\tag{9.3}\]</span></span></p>
</section></section><section id="sec-inverseFallacy" class="level4" data-number="9.1.1.2"><h4 data-number="9.1.1.2" class="anchored" data-anchor-id="sec-inverseFallacy">
<span class="header-section-number">9.1.1.2</span> Confusion of the Inverse</h4>
<p>A <a href="#sec-conditionalProbability">conditional probability</a> is not the same thing as its reverse (or inverse) <a href="#sec-conditionalProbability">conditional probability</a>. Unless the <a href="#sec-baseRate">base rate</a> of the two events (<span class="math inline">\(C\)</span> and <span class="math inline">\(R\)</span>) are the same, <span class="math inline">\(P(C | R) \neq P(R | C)\)</span>. However, people frequently make the mistake of thinking that two inverse <a href="#sec-conditionalProbability">conditional probabilities</a> are the same. This mistake is known as the “confusion of the inverse”, or the “inverse fallacy”, or the “conditional probability fallacy”. The confusion of inverse probabilities is the logical error of representative thinking that leads people to assume that the probability of <span class="math inline">\(C\)</span> given <span class="math inline">\(R\)</span> is the same as the probability of <span class="math inline">\(R\)</span> given C, even though this is not true. As a few examples to demonstrate the logical fallacy, if 93% of breast cancers occur in high-risk women, this does not mean that 93% of high-risk women will eventually get breast cancer. As another example, if 77% of car accidents take place within 15 miles of a driver’s home, this does not mean that you will get in an accident 77% of times you drive within 15 miles of your home.</p>
<p>Which car is the most frequently stolen? It is often the Honda Accord or Honda Civic—probably because they are among the most popular/commonly available cars. The probability that the car is a Honda Accord given that a car was stolen (<span class="math inline">\(p(\text{Honda Accord } | \text{ Stolen})\)</span>) is what the media reports and what the police care about. However, that is not what buyers and car insurance companies should care about. Instead, they care about the probability that the car will be stolen given that it is a Honda Accord (<span class="math inline">\(p(\text{Stolen } | \text{ Honda Accord})\)</span>).</p>
</section><section id="sec-bayesTheorem" class="level4" data-number="9.1.1.3"><h4 data-number="9.1.1.3" class="anchored" data-anchor-id="sec-bayesTheorem">
<span class="header-section-number">9.1.1.3</span> Bayes’ Theorem</h4>
<p>An alternative way of calculating a <a href="#sec-conditionalProbability">conditional probability</a> is using the inverse <a href="#sec-conditionalProbability">conditional probability</a> (instead of the <a href="#sec-jointProbability">joint probability</a>). This is known as Bayes’ theorem. Bayes’ theorem can help us calculate a <a href="#sec-conditionalProbability">conditional probability</a> of some classification, <span class="math inline">\(C\)</span>, given some response, <span class="math inline">\(R\)</span>, if we know the inverse <a href="#sec-conditionalProbability">conditional probability</a> and the <a href="#sec-baseRate">base rate</a> (marginal probability) of each. Bayes’ theorem is in <a href="#eq-bayes1" class="quarto-xref">Equation&nbsp;<span>9.4</span></a>:</p>
<p><span id="eq-bayes1"><span class="math display">\[
\begin{aligned}
  P(C | R) &amp;= \frac{P(R | C) \cdot P(C_i)}{P(R_i)}
\end{aligned}
\tag{9.4}\]</span></span></p>
<p>Or, equivalently (rearranging the terms):</p>
<p><span id="eq-bayes2"><span class="math display">\[
\frac{P(C | R)}{P(R | C)} = \frac{P(C_i)}{P(R_i)}
\tag{9.5}\]</span></span></p>
<p>Or, equivalently (rearranging the terms):</p>
<p><span id="eq-bayes3"><span class="math display">\[
\frac{P(C | R)}{P(C_i)} = \frac{P(R | C)}{P(R_i)}
\tag{9.6}\]</span></span></p>
<p>More generally, Bayes’ theorem has been described as:</p>
<p><span id="eq-bayes6"><span class="math display">\[
\begin{aligned}
  P(H | E) &amp;= \frac{P(E | H) \cdot P(H)}{P(E)} \\
  \text{posterior probability} &amp;= \frac{\text{likelihood} \times \text{prior probability}}{\text{model evidence}} \\
\end{aligned}
\tag{9.7}\]</span></span></p>
<p>where <span class="math inline">\(H\)</span> is the hypothesis, and <span class="math inline">\(E\)</span> is the evidence—the new information that was not used in computing the prior probability.</p>
<p>In Bayesian terms, the <em>posterior probability</em> is the conditional probability of one event occurring given another event—it is the updated probability after the evidence is considered. In this case, the posterior probability is the probability of the classification occurring (<span class="math inline">\(C\)</span>) given the response (<span class="math inline">\(R\)</span>). The <em>likelihood</em> is the inverse conditional probability—the probability of the response (<span class="math inline">\(R\)</span>) occurring given the classification (<span class="math inline">\(C\)</span>). The <em>prior probability</em> is the marginal probability of the event (i.e., the classification) occurring, before we take into account any new information. The <em>model evidence</em> is the marginal probability of the other event occurring—i.e., the marginal probability of seeing the evidence.</p>
<p>In the HIV example above, we can calculate the <a href="#sec-conditionalProbability">conditional probability</a> of HIV given a positive test using three terms: the <a href="#sec-conditionalProbability">conditional probability</a> of a positive test given HIV (i.e., the sensitivity of the test), the <a href="#sec-baseRate">base rate</a> of HIV, and the <a href="#sec-baseRate">base rate</a> of a positive test for HIV. The <a href="#sec-conditionalProbability">conditional probability</a> of HIV given a positive test is in <a href="#eq-hivExample1" class="quarto-xref">Equation&nbsp;<span>9.8</span></a>:</p>
<p><span id="eq-hivExample1"><span class="math display">\[
\begin{aligned}
  P(C | R) &amp;= \frac{P(R | C) \cdot P(C_i)}{P(R_i)} \\
  P(\text{HIV} | \text{positive test}) &amp;= \frac{P(\text{positive test} | \text{HIV}) \cdot P(\text{HIV})}{P(\text{positive test})} \\
  &amp;= \frac{\text{sensitivity of test} \times \text{base rate of HIV}}{\text{base rate of positive test}} \\
  &amp;= \frac{95\% \times .3\%}{1\%} = \frac{.95 \times .003}{.01}\\
  &amp;= 28.5\%
\end{aligned}
\tag{9.8}\]</span></span></p>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>pAgivenB()</code> function that estimates the probability of one event, <span class="math inline">\(A\)</span>, given another event, <span class="math inline">\(B\)</span>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>pAgivenB <span class="ot">&lt;-</span> <span class="cf">function</span>(pBgivenA, pA, pB){</span>
<span id="cb1-2"><a href="#cb1-2"></a>  value <span class="ot">&lt;-</span> pBgivenA <span class="sc">*</span> pA <span class="sc">/</span> pB</span>
<span id="cb1-3"><a href="#cb1-3"></a>  </span>
<span id="cb1-4"><a href="#cb1-4"></a>  value</span>
<span id="cb1-5"><a href="#cb1-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">pAgivenB</span>(<span class="at">pBgivenA =</span> .<span class="dv">95</span>, <span class="at">pA =</span> .<span class="dv">003</span>, <span class="at">pB =</span> .<span class="dv">01</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.285</code></pre>
</div>
</div>
<p>Thus, assuming the probabilities in the example above, the <a href="#sec-conditionalProbability">conditional probability</a> of having HIV if a person has a positive test is 28.5%. Given a positive test, chances are higher than not that the person does not have HIV.</p>
<p>Bayes’ theorem can be depicted visually <span class="citation" data-cites="BallesterosPerez2018">(<a href="references.html#ref-BallesterosPerez2018" role="doc-biblioref">Ballesteros-Pérez et al., 2018</a>)</span>. If we have 100,000 people in our population, we would be able to fill out a 2-by-2 <a href="#sec-confusionMatrix">confusion matrix</a>, as depicted in <a href="#fig-bayesTheorem2x2" class="quarto-xref">Figure&nbsp;<span>9.1</span></a>.</p>
<div id="fig-bayesTheorem2x2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="[Confusion Matrix](#sec-confusionMatrix): 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bayesTheorem2x2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/bayesTheorem2x2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;9.1: Confusion Matrix: 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio."><img src="images/bayesTheorem2x2.png" class="img-fluid figure-img" style="width:100.0%" alt="[Confusion Matrix](#sec-confusionMatrix): 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bayesTheorem2x2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.1: <a href="#sec-confusionMatrix">Confusion Matrix</a>: 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio.
</figcaption></figure>
</div>
<p>We know that .3% of the population contracts HIV, so 300 people in the population of 100,000 would contract HIV. Therefore, we put 300 in the marginal sum of those with HIV (<span class="math inline">\(.003 \times 100,000 = 300\)</span>), i.e., the <a href="#sec-baseRate">base rate</a> of HIV. That means 99,700 people do not contract HIV (<span class="math inline">\(100,000 - 300 = 99,700\)</span>). We know that 1% of the population tests positive for HIV, so we put 1,000 in the marginal sum of those who test positive <span class="math inline">\(.01 \times 100,000 = 1,000\)</span>, i.e., the <a href="#sec-baseRate">marginal probability</a> of a positive test (the <a href="#sec-selectionRatio">selection ratio</a>). That means 99,000 people test negative for HIV (<span class="math inline">\(100,000 - 1,000 = 99,000\)</span>). We also know that 95% of those who have HIV test positive for HIV. Three hundred people have HIV, so 95% of them (i.e., 285 people; <span class="math inline">\(.95 \times 300 = 285\)</span>) tested positive for HIV (<a href="#sec-truePositive">true positives</a>). Because we know that 300 people have HIV and that 285 of those with HIV tested positive, that means that 15 people with HIV tested negative (<span class="math inline">\(300 - 15 = 285\)</span>; <a href="#sec-falseNegative">false negatives</a>). We know that 1,000 people tested positive for HIV, and 285 with HIV tested positive, so that means that 715 people without HIV tested positive (<span class="math inline">\(1,000 - 285 = 715\)</span>; <a href="#sec-falsePositive">false positives</a>). We know that 99,000 people tested negative for HIV, and 15 with HIV tested negative, so that means that 98,985 people without HIV tested negative (<span class="math inline">\(99,000 - 15 = 98,985\)</span>; <a href="#sec-trueNegative">true negatives</a>). So, to answer the question of what is the probability of having HIV if you have a positive test, we divide the number of people with HIV who had a positive test (285) by the total number of people who had a positive test (1000), which leads to a probability of 28.5%.</p>
<p>This can be depicted visually in Figures <a href="#fig-bayesTheorem1" class="quarto-xref"><span>9.2</span></a> and <a href="#fig-bayesTheorem2" class="quarto-xref"><span>9.3</span></a>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div id="fig-bayesTheorem1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Bayes' Theorem (and [Confusion Matrix](#sec-confusionMatrix)) Depicted Visually, Where the Marginal Probability is the [Base Rate](#sec-baseRate) (BR). The four boxes represent the number of [true positives](#sec-truePositive) (TP), [true negatives](#sec-trueNegative) (TN), [false positives](#sec-falsePositive) (FP), and [false negatives](#sec-falseNegative) (FN). Note: Boxes are not drawn to scale; otherwise, some regions would be too small to include text.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bayesTheorem1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/bayesTheorem2x2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;9.2: Bayes’ Theorem (and Confusion Matrix) Depicted Visually, Where the Marginal Probability is the Base Rate (BR). The four boxes represent the number of true positives (TP), true negatives (TN), false positives (FP), and false negatives (FN). Note: Boxes are not drawn to scale; otherwise, some regions would be too small to include text."><img src="images/bayesTheorem2x2.png" class="img-fluid figure-img" style="width:100.0%" alt="Bayes' Theorem (and [Confusion Matrix](#sec-confusionMatrix)) Depicted Visually, Where the Marginal Probability is the [Base Rate](#sec-baseRate) (BR). The four boxes represent the number of [true positives](#sec-truePositive) (TP), [true negatives](#sec-trueNegative) (TN), [false positives](#sec-falsePositive) (FP), and [false negatives](#sec-falseNegative) (FN). Note: Boxes are not drawn to scale; otherwise, some regions would be too small to include text."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bayesTheorem1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.2: Bayes’ Theorem (and <a href="#sec-confusionMatrix">Confusion Matrix</a>) Depicted Visually, Where the Marginal Probability is the <a href="#sec-baseRate">Base Rate</a> (BR). The four boxes represent the number of <a href="#sec-truePositive">true positives</a> (TP), <a href="#sec-trueNegative">true negatives</a> (TN), <a href="#sec-falsePositive">false positives</a> (FP), and <a href="#sec-falseNegative">false negatives</a> (FN). Note: Boxes are not drawn to scale; otherwise, some regions would be too small to include text.
</figcaption></figure>
</div>
<div id="fig-bayesTheorem2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Bayes' Theorem (and [Confusion Matrix](#sec-confusionMatrix)) Depicted Visually, where the Marginal Probability is the [Selection Ratio](#sec-selectionRatio) (SR). The four boxes represent the number of [true positives](#sec-truePositive) (TP), [true negatives](#sec-trueNegative) (TN), [false positives](#sec-falsePositive) (FP), and [false negatives](#sec-falseNegative) (FN). Note: Boxes are not drawn to scale; otherwise, some regions would be too small to include text.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bayesTheorem2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/bayesTheorem2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;9.3: Bayes’ Theorem (and Confusion Matrix) Depicted Visually, where the Marginal Probability is the Selection Ratio (SR). The four boxes represent the number of true positives (TP), true negatives (TN), false positives (FP), and false negatives (FN). Note: Boxes are not drawn to scale; otherwise, some regions would be too small to include text."><img src="images/bayesTheorem2.png" class="img-fluid figure-img" style="width:100.0%" alt="Bayes' Theorem (and [Confusion Matrix](#sec-confusionMatrix)) Depicted Visually, where the Marginal Probability is the [Selection Ratio](#sec-selectionRatio) (SR). The four boxes represent the number of [true positives](#sec-truePositive) (TP), [true negatives](#sec-trueNegative) (TN), [false positives](#sec-falsePositive) (FP), and [false negatives](#sec-falseNegative) (FN). Note: Boxes are not drawn to scale; otherwise, some regions would be too small to include text."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bayesTheorem2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.3: Bayes’ Theorem (and <a href="#sec-confusionMatrix">Confusion Matrix</a>) Depicted Visually, where the Marginal Probability is the <a href="#sec-selectionRatio">Selection Ratio</a> (SR). The four boxes represent the number of <a href="#sec-truePositive">true positives</a> (TP), <a href="#sec-trueNegative">true negatives</a> (TN), <a href="#sec-falsePositive">false positives</a> (FP), and <a href="#sec-falseNegative">false negatives</a> (FN). Note: Boxes are not drawn to scale; otherwise, some regions would be too small to include text.
</figcaption></figure>
</div>
<p>Now let’s see what happens if the person tests positive a second time. We would revise our “<a href="#sec-baseRate">prior probability</a>” for HIV from the general prevalence in the population (0.3%) to be the “posterior probability” of HIV given a first positive test (28.5%). This is known as <a href="evidence-based-assessment.html#sec-bayesianUpdating"><em>Bayesian updating</em></a>. We would also update the “evidence” to be the <a href="#sec-baseRate">marginal probability</a> of getting a second positive test.</p>
<p>If we do not know a <a href="#sec-baseRate">marginal probability</a> (i.e., base rate) of an event (e.g., getting a second positive test), we can calculate a <a href="#sec-baseRate">marginal probability</a> with the <em>law of total probability</em> using <a href="#sec-conditionalProbability">conditional probabilities</a> and the <a href="#sec-baseRate">marginal probability</a> of another event (e.g., having HIV). According to the law of total probability, the probability of getting a positive test is the probability that a person with HIV gets a positive test (i.e., <a href="#sec-sensitivity">sensitivity</a>) times the base rate of HIV plus the probability that a person without HIV gets a positive test (i.e., <a href="#sec-falsePositiveRate">false positive rate</a>) times the <a href="#sec-baseRate">base rate</a> of not having HIV, as in <a href="#eq-lawOfTotalProbability" class="quarto-xref">Equation&nbsp;<span>9.9</span></a>:</p>
<p><span id="eq-lawOfTotalProbability"><span class="math display">\[
\begin{aligned}
P(\text{not } C_i) &amp;= 1 - P(C_i) \\
  P(R_i) &amp;= P(R | C) \cdot P(C_i) + P(R | \text{not } C) \cdot P(\text{not } C_i) \\
  1\% &amp;= 95\% \times .3\% + P(R | \text{not } C) \times 99.7\% \\
\end{aligned}
\tag{9.9}\]</span></span></p>
<p>In this case, we know the <a href="#sec-baseRate">marginal probability</a> (<span class="math inline">\(P(R_i)\)</span>), and we can use that to solve for the unknown <a href="#sec-conditionalProbability">conditional probability</a> that reflects the <a href="#sec-falsePositiveRate">false positive rate</a> (<span class="math inline">\(P(R | \text{not } C)\)</span>), as in <a href="#eq-conditionalProbabilityRevised" class="quarto-xref">Equation&nbsp;<span>9.10</span></a>:</p>
<p><span id="eq-conditionalProbabilityRevised"><span class="math display">\[
\scriptsize
\begin{aligned}
  P(R_i) &amp;= P(R | C) \cdot P(C_i) + P(R | \text{not } C) \cdot P(\text{not } C_i) &amp;&amp; \\
  P(R_i) - [P(R | \text{not } C) \cdot P(\text{not } C_i)] &amp;= P(R | C) \cdot P(C_i) &amp;&amp; \text{Move } P(R | \text{not } C) \text{ to the left side} \\
  - [P(R | \text{not } C) \cdot P(\text{not } C_i)] &amp;= P(R | C) \cdot P(C_i) - P(R_i) &amp;&amp; \text{Move } P(R_i) \text{ to the right side} \\
  P(R | \text{not } C) \cdot P(\text{not } C_i) &amp;= P(R_i) - [P(R | C) \cdot P(C_i)] &amp;&amp; \text{Multiply by } -1 \\
  P(R | \text{not } C) &amp;= \frac{P(R_i) - [P(R | C) \cdot P(C_i)]}{P(\text{not } C_i)} &amp;&amp; \text{Divide by } P(R | \text{not } C) \\
  &amp;= \frac{1\% - [95\% \times .3\%]}{99.7\%} = \frac{.01 - [.95 \times .003]}{.997}\\
  &amp;= .7171515\% \\
\end{aligned}
\tag{9.10}\]</span></span></p>
<p>We can then estimate the marginal probability of the event, substititing in <span class="math inline">\(P(R | \text{not } C)\)</span>, using the law of total probability. The <a href="https://cran.r-project.org/web/packages/petersenlab/index.html"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>pA()</code> function that estimates the marginal probability of one event, <span class="math inline">\(A\)</span>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>pA <span class="ot">&lt;-</span> <span class="cf">function</span>(pAgivenB, pB, pAgivenNotB){</span>
<span id="cb4-2"><a href="#cb4-2"></a>  value <span class="ot">&lt;-</span> (pAgivenB <span class="sc">*</span> pB) <span class="sc">+</span> pAgivenNotB <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pB)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a>  value</span>
<span id="cb4-5"><a href="#cb4-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">pA</span>(</span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="at">pAgivenB =</span> .<span class="dv">95</span>,</span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="at">pB =</span> .<span class="dv">003</span>,</span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="at">pAgivenNotB =</span> .<span class="dv">007171515</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01</code></pre>
</div>
</div>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>pBgivenNotA()</code> function that estimates the probability of one event, <span class="math inline">\(B\)</span>, given that another event, <span class="math inline">\(A\)</span>, did not occur.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>pBgivenNotA <span class="ot">&lt;-</span> <span class="cf">function</span>(pBgivenA, pA, pB){</span>
<span id="cb7-2"><a href="#cb7-2"></a>  value <span class="ot">&lt;-</span> (pB <span class="sc">-</span> (pBgivenA <span class="sc">*</span> pA)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pA)</span>
<span id="cb7-3"><a href="#cb7-3"></a>  </span>
<span id="cb7-4"><a href="#cb7-4"></a>  value</span>
<span id="cb7-5"><a href="#cb7-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">pBgivenNotA</span>(<span class="at">pBgivenA =</span> .<span class="dv">95</span>, <span class="at">pA =</span> .<span class="dv">003</span>, <span class="at">pB =</span> .<span class="dv">01</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007171515</code></pre>
</div>
</div>
<p>With this <a href="#sec-conditionalProbability">conditional probability</a> (<span class="math inline">\(P(R | \text{not } C)\)</span>), the updated <a href="#sec-baseRate">marginal probability</a> of having HIV (<span class="math inline">\(P(C_i)\)</span>), and the updated marginal probability of not having HIV (<span class="math inline">\(P(\text{not } C_i)\)</span>), we can now calculate an updated estimate of the <a href="#sec-baseRate">marginal probability</a> of getting a second positive test. The probability of getting a second positive test is the probability that a person with HIV gets a second positive test (i.e., <a href="#sec-sensitivity">sensitivity</a>) times the updated probability of HIV plus the probability that a person without HIV gets a second positive test (i.e., <a href="#sec-falsePositiveRate">false positive rate</a>) times the updated probability of not having HIV, as in <a href="#eq-baseRateUpdated" class="quarto-xref">Equation&nbsp;<span>9.11</span></a>:</p>
<p><span id="eq-baseRateUpdated"><span class="math display">\[
\begin{aligned}
  P(R_{i}) &amp;= P(R | C) \cdot P(C_i) + P(R | \text{not } C) \cdot P(\text{not } C_i) \\
  &amp;= 95\% \times 28.5\% + .7171515\% \times 71.5\% = .95 \times .285 + .007171515 \times .715 \\
  &amp;= 27.58776\%
\end{aligned}
\tag{9.11}\]</span></span></p>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>pB()</code> function that estimates the marginal probability of one event, <span class="math inline">\(B\)</span>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>pB <span class="ot">&lt;-</span> <span class="cf">function</span>(pBgivenA, pA, pBgivenNotA){</span>
<span id="cb10-2"><a href="#cb10-2"></a>  value <span class="ot">&lt;-</span> (pBgivenA <span class="sc">*</span> pA) <span class="sc">+</span> pBgivenNotA <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pA)</span>
<span id="cb10-3"><a href="#cb10-3"></a>  </span>
<span id="cb10-4"><a href="#cb10-4"></a>  value</span>
<span id="cb10-5"><a href="#cb10-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">pB</span>(<span class="at">pBgivenA =</span> .<span class="dv">95</span>, <span class="at">pA =</span> .<span class="dv">285</span>, <span class="at">pBgivenNotA =</span> .<span class="dv">007171515</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2758776</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">pB</span>(</span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="at">pA =</span> <span class="fu">pAgivenB</span>(</span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb13-5"><a href="#cb13-5"></a>    <span class="at">pA =</span> .<span class="dv">003</span>,</span>
<span id="cb13-6"><a href="#cb13-6"></a>    <span class="at">pB =</span> .<span class="dv">01</span>),</span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="at">pBgivenNotA =</span> <span class="fu">pBgivenNotA</span>(</span>
<span id="cb13-8"><a href="#cb13-8"></a>    <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb13-9"><a href="#cb13-9"></a>    <span class="at">pA =</span> .<span class="dv">003</span>,</span>
<span id="cb13-10"><a href="#cb13-10"></a>    <span class="at">pB =</span> .<span class="dv">01</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2758776</code></pre>
</div>
</div>
<p>We then substitute the updated <a href="#sec-baseRate">marginal probability</a> of HIV (<span class="math inline">\(P(C_i)\)</span>) and the updated <a href="#sec-baseRate">marginal probability</a> of getting a second positive test (<span class="math inline">\(P(R_i)\)</span>) into Bayes’ theorem to get the probability that the person has HIV if they have a second positive test (assuming the <a href="reliability.html#sec-measurementError">errors</a> of each test are independent, i.e., uncorrelated), as in <a href="#eq-baseRateUpdated2" class="quarto-xref">Equation&nbsp;<span>9.12</span></a>:</p>
<p><span id="eq-baseRateUpdated2"><span class="math display">\[
\begin{aligned}
  P(C | R) &amp;= \frac{P(R | C) \cdot P(C_i)}{P(R_i)} \\
  P(\text{HIV} | \text{a second positive test}) &amp;= \frac{P(\text{a second positive test} | \text{HIV}) \cdot P(\text{HIV})}{P(\text{a second positive test})} \\
  &amp;= \frac{\text{sensitivity of test} \times \text{updated base rate of HIV}}{\text{updated base rate of positive test}} \\
  &amp;= \frac{95\% \times 28.5\%}{27.58776\%} \\
  &amp;= 98.14\%
\end{aligned}
\tag{9.12}\]</span></span></p>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>pAgivenB()</code> function that estimates the probability of one event, <span class="math inline">\(A\)</span>, given another event, <span class="math inline">\(B\)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">pAgivenB</span>(<span class="at">pBgivenA =</span> .<span class="dv">95</span>, <span class="at">pA =</span> .<span class="dv">285</span>, <span class="at">pB =</span> .<span class="dv">2758776</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9814135</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">pAgivenB</span>(</span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="at">pA =</span> <span class="fu">pAgivenB</span>(</span>
<span id="cb17-4"><a href="#cb17-4"></a>    <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb17-5"><a href="#cb17-5"></a>    <span class="at">pA =</span> .<span class="dv">003</span>,</span>
<span id="cb17-6"><a href="#cb17-6"></a>    <span class="at">pB =</span> .<span class="dv">01</span>),</span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="at">pB =</span> <span class="fu">pB</span>(</span>
<span id="cb17-8"><a href="#cb17-8"></a>    <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb17-9"><a href="#cb17-9"></a>    <span class="at">pA =</span> <span class="fu">pAgivenB</span>(</span>
<span id="cb17-10"><a href="#cb17-10"></a>      <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb17-11"><a href="#cb17-11"></a>      <span class="at">pA =</span> .<span class="dv">003</span>,</span>
<span id="cb17-12"><a href="#cb17-12"></a>      <span class="at">pB =</span> .<span class="dv">01</span>),</span>
<span id="cb17-13"><a href="#cb17-13"></a>    <span class="at">pBgivenNotA =</span> <span class="fu">pBgivenNotA</span>(</span>
<span id="cb17-14"><a href="#cb17-14"></a>      <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb17-15"><a href="#cb17-15"></a>      <span class="at">pA =</span> .<span class="dv">003</span>,</span>
<span id="cb17-16"><a href="#cb17-16"></a>      <span class="at">pB =</span> .<span class="dv">01</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9814134</code></pre>
</div>
</div>
<p>Thus, a second positive test greatly increases the posterior probability that the person has HIV from 28.5% to over 98%.</p>
<p>As seen in the rearranged formula in <a href="#eq-bayes2" class="quarto-xref">Equation&nbsp;<span>9.5</span></a>, the ratio of the <a href="#sec-conditionalProbability">conditional probabilities</a> is equal to the ratio of the <a href="#sec-baseRate">base rates</a>. Thus, it is important to consider <a href="#sec-baseRate">base rates</a>. People have a strong tendency to ignore (or give insufficient weight to) <a href="#sec-baseRate">base rates</a> when making predictions. The failure to consider the <a href="#sec-baseRate">base rate</a> when making predictions when given specific information about a case is a cognitive bias known as the <a href="#sec-baseRate">base-rate</a> fallacy or as <a href="#sec-baseRate">base rate</a> neglect. For example, people tend to say that the probability of a rare event is more likely than it actually is given specific information.</p>
<p>As seen in the rearranged formula in <a href="#eq-bayes3" class="quarto-xref">Equation&nbsp;<span>9.6</span></a>, the inverse <a href="#sec-conditionalProbability">conditional probabilities</a> (<span class="math inline">\(P(C | R)\)</span> and <span class="math inline">\(P(R | C)\)</span>) are not equal unless the <a href="#sec-baseRate">base rates</a> of <span class="math inline">\(C\)</span> and <span class="math inline">\(R\)</span> are the same. If the <a href="#sec-baseRate">base rates</a> are not equal, we are making at least some prediction errors. If <span class="math inline">\(P(C_i) &gt; P(R_i)\)</span>, our predictions must include some <a href="#sec-falseNegative">false negatives</a>. If <span class="math inline">\(P(R_i) &gt; P(C_i)\)</span>, our predictions must include some <a href="#sec-falsePositive">false positives</a>.</p>
<p>Using the law of total probability, we can substitute the calculation of the <a href="#sec-baseRate">marginal probability</a> (<span class="math inline">\(P(R_i)\)</span>) into Bayes’ theorem to get an alternative formulation of Bayes’ theorem, as in <a href="#eq-baseRateUpdated3" class="quarto-xref">Equation&nbsp;<span>9.13</span></a>:</p>
<p><span id="eq-baseRateUpdated3"><span class="math display">\[
\begin{aligned}
  P(C | R) &amp;= \frac{P(R | C) \cdot P(C_i)}{P(R_i)} \\
  &amp;= \frac{P(R | C) \cdot P(C_i)}{P(R | C) \cdot P(C_i) + P(R | \text{not } C) \cdot P(\text{not } C_i)} \\
  &amp;= \frac{P(R | C) \cdot P(C_i)}{P(R | C) \cdot P(C_i) + P(R | \text{not } C) \cdot [1 - P(C_i)]}
\end{aligned}
\tag{9.13}\]</span></span></p>
<p>Instead of using <a href="#sec-baseRate">marginal probability</a> (<a href="#sec-baseRate">base rate</a>) of <span class="math inline">\(R\)</span>, as in the original formulation of Bayes’ theorem, it uses the <a href="#sec-conditionalProbability">conditional probability</a>, <span class="math inline">\(P(R|\text{not } C)\)</span>. Thus, it uses three terms: two <a href="#sec-conditionalProbability">conditional probabilities</a>—<span class="math inline">\(P(R|C)\)</span> and <span class="math inline">\(P(R|\text{not } C)\)</span>—and one <a href="#sec-baseRate">marginal probability</a>, <span class="math inline">\(P(C_i)\)</span>. This alternative formulation of Bayes’ theorem can be used to calculate <a href="#sec-ppv">positive predictive value</a>, based on <a href="#sec-sensitivity">sensitivity</a>, <a href="#sec-specificity">specificity</a>, and the <a href="#sec-baseRate">base rate</a>, as presented in <a href="#eq-positivePredictiveValue" class="quarto-xref">Equation&nbsp;<span>9.51</span></a>.</p>
<p>Let us see how the alternative formulation of Bayes’ theorem applies to the HIV example above. We can calculate the probability of HIV given a positive test using three terms: the <a href="#sec-conditionalProbability">conditional probability</a> that a person with HIV gets a positive test (i.e., <a href="#sec-sensitivity">sensitivity</a>), the <a href="#sec-conditionalProbability">conditional probability</a> that a person without HIV gets a positive test (i.e., <a href="#sec-falsePositiveRate">false positive rate</a>), and the <a href="#sec-baseRate">base rate</a> of HIV. Using the <span class="math inline">\(P(R|\text{not } C)\)</span> calculated in <a href="#eq-conditionalProbabilityRevised" class="quarto-xref">Equation&nbsp;<span>9.10</span></a>, the <a href="#sec-conditionalProbability">conditional probability</a> of HIV given a single positive test is in <a href="#eq-bayes4" class="quarto-xref">Equation&nbsp;<span>9.14</span></a>:</p>
<p><span id="eq-bayes4"><span class="math display">\[
\small
\begin{aligned}
  P(C | R) &amp;= \frac{P(R | C) \cdot P(C_i)}{P(R | C) \cdot P(C_i) + P(R | \text{not } C) \cdot [1 - P(C_i)]} \\
  &amp;= \frac{\text{sensitivity of test} \times \text{base rate of HIV}}{\text{sensitivity of test} \times \text{base rate of HIV} + \text{false positive rate of test} \times (1 - \text{base rate of HIV})} \\
  &amp;= \frac{95\% \times .3\%}{95\% \times .3\% + .7171515\% \times (1 - .3\%)} = \frac{.95 \times .003}{.95 \times .003 + .007171515 \times (1 - .003)}\\
  &amp;= 28.5\%
\end{aligned}
\tag{9.14}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>pAgivenBalternative <span class="ot">&lt;-</span> <span class="cf">function</span>(pBgivenA, pA, pBgivenNotA){</span>
<span id="cb19-2"><a href="#cb19-2"></a>  value <span class="ot">&lt;-</span> (pBgivenA <span class="sc">*</span> pA) <span class="sc">/</span> ((pBgivenA <span class="sc">*</span> pA) <span class="sc">+</span> (pBgivenNotA <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pA)))</span>
<span id="cb19-3"><a href="#cb19-3"></a>  </span>
<span id="cb19-4"><a href="#cb19-4"></a>  value</span>
<span id="cb19-5"><a href="#cb19-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">pAgivenBalternative</span>(</span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="at">pA =</span> .<span class="dv">003</span>,</span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="at">pBgivenNotA =</span> .<span class="dv">007171515</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.285</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">pAgivenBalternative</span>(</span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="at">pA =</span> .<span class="dv">003</span>,</span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="at">pBgivenNotA =</span> <span class="fu">pBgivenNotA</span>(</span>
<span id="cb22-5"><a href="#cb22-5"></a>    <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb22-6"><a href="#cb22-6"></a>    <span class="at">pA =</span> .<span class="dv">003</span>,</span>
<span id="cb22-7"><a href="#cb22-7"></a>    <span class="at">pB =</span> .<span class="dv">01</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.285</code></pre>
</div>
</div>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>pAgivenB()</code> function that estimates the probability of one event, <span class="math inline">\(A\)</span>, given another event, <span class="math inline">\(B\)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">pAgivenB</span>(<span class="at">pBgivenA =</span> .<span class="dv">95</span>, <span class="at">pA =</span> .<span class="dv">003</span>, <span class="at">pBgivenNotA =</span> .<span class="dv">007171515</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.285</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">pAgivenB</span>(</span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="at">pA =</span> .<span class="dv">003</span>,</span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="at">pBgivenNotA =</span> <span class="fu">pBgivenNotA</span>(</span>
<span id="cb26-5"><a href="#cb26-5"></a>    <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb26-6"><a href="#cb26-6"></a>    <span class="at">pA =</span> .<span class="dv">003</span>,</span>
<span id="cb26-7"><a href="#cb26-7"></a>    <span class="at">pB =</span> .<span class="dv">01</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.285</code></pre>
</div>
</div>
<p>To calculate the <a href="#sec-conditionalProbability">conditional probability</a> of HIV given a second positive test, we update our priors because the person has now tested positive for HIV. We update the <a href="#sec-baseRate">prior probability</a> of HIV (<span class="math inline">\(P(C_i)\)</span>) based on the posterior probability of HIV after a positive test (<span class="math inline">\(P(C | R)\)</span>) that we calculated above. We can calculate the <a href="#sec-conditionalProbability">conditional probability</a> of HIV given a second positive test using three terms: the <a href="#sec-conditionalProbability">conditional probability</a> that a person with HIV gets a positive test (i.e., <a href="#sec-sensitivity">sensitivity</a>; which stays the same), the <a href="#sec-conditionalProbability">conditional probability</a> that a person without HIV gets a positive test (i.e., <a href="#sec-falsePositiveRate">false positive rate</a>; which stays the same), and the updated <a href="#sec-baseRate">marginal probability</a> of HIV. The <a href="#sec-conditionalProbability">conditional probability</a> of HIV given a second positive test is in <a href="#eq-baseRateUpdated4" class="quarto-xref">Equation&nbsp;<span>9.15</span></a>:</p>
<p><span id="eq-baseRateUpdated4"><span class="math display">\[
\scriptsize
\begin{aligned}
  P(C | R) &amp;= \frac{P(R | C) \cdot P(C_i)}{P(R | C) \cdot P(C_i) + P(R | \text{not } C) \cdot [1 - P(C_i)]} \\
  &amp;= \frac{\text{sensitivity of test} \times \text{updated base rate of HIV}}{\text{sensitivity of test} \times \text{updated base rate of HIV} + \text{false positive rate of test} \times (1 - \text{updated base rate of HIV})} \\
  &amp;= \frac{95\% \times 28.5\%}{95\% \times 28.5\% + .7171515\% \times (1 - 28.5\%)} = \frac{.95 \times .285}{.95 \times .285 + .007171515 \times (1 - .285)}\\
  &amp;= 98.14\%
\end{aligned}
\tag{9.15}\]</span></span></p>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>pAgivenB()</code> function that estimates the probability of one event, <span class="math inline">\(A\)</span>, given another event, <span class="math inline">\(B\)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">pAgivenBalternative</span>(</span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="at">pA =</span> .<span class="dv">285</span>,</span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="at">pBgivenNotA =</span> .<span class="dv">007171515</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9814134</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">pAgivenBalternative</span>(</span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="at">pA =</span> .<span class="dv">285</span>,</span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="at">pBgivenNotA =</span> <span class="fu">pBgivenNotA</span>(</span>
<span id="cb30-5"><a href="#cb30-5"></a>    <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb30-6"><a href="#cb30-6"></a>    <span class="at">pA =</span> .<span class="dv">003</span>,</span>
<span id="cb30-7"><a href="#cb30-7"></a>    <span class="at">pB =</span> .<span class="dv">01</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9814134</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">pAgivenB</span>(</span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="at">pA =</span> .<span class="dv">285</span>,</span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="at">pBgivenNotA =</span> .<span class="dv">007171515</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9814134</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">pAgivenB</span>(</span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="at">pA =</span> .<span class="dv">285</span>,</span>
<span id="cb34-4"><a href="#cb34-4"></a>  <span class="at">pBgivenNotA =</span> <span class="fu">pBgivenNotA</span>(</span>
<span id="cb34-5"><a href="#cb34-5"></a>    <span class="at">pBgivenA =</span> .<span class="dv">95</span>,</span>
<span id="cb34-6"><a href="#cb34-6"></a>    <span class="at">pA =</span> .<span class="dv">003</span>,</span>
<span id="cb34-7"><a href="#cb34-7"></a>    <span class="at">pB =</span> .<span class="dv">01</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9814134</code></pre>
</div>
</div>
<p>If we want to compare the relative probability of two outcomes, we can use the odds form of Bayes’ theorem, as in <a href="#eq-bayes5" class="quarto-xref">Equation&nbsp;<span>9.16</span></a>:</p>
<p><span id="eq-bayes5"><span class="math display">\[
\begin{aligned}
  P(C | R) &amp;= \frac{P(R | C) \cdot P(C_i)}{P(R_i)} \\
  P(\text{not } C | R) &amp;= \frac{P(R | \text{not } C) \cdot P(\text{not } C_i)}{P(R_i)} \\
  \frac{P(C | R)}{P(\text{not } C | R)} &amp;= \frac{\frac{P(R | C) \cdot P(C_i)}{P(R_i)}}{\frac{P(R | \text{not } C) \cdot P(\text{not } C_i)}{P(R_i)}} \\
  &amp;= \frac{P(R | C) \cdot P(C_i)}{P(R | \text{not } C) \cdot P(\text{not } C_i)} \\
  &amp;= \frac{P(C_i)}{P(\text{not } C_i)} \times \frac{P(R | C)}{P(R | \text{not } C)} \\
  \text{posterior odds} &amp;= \text{prior odds} \times \text{likelihood ratio}
\end{aligned}
\tag{9.16}\]</span></span></p>
<p>In sum, the <a href="#sec-baseRate">marginal probability</a>, including the <a href="#sec-baseRate">prior probability</a> or <a href="#sec-baseRate">base rate</a>, should be weighed heavily in predictions unless there are sufficient data to indicate otherwise, i.e., to update the posterior probability based on new evidence. Bayes’ theorem provides a powerful tool to anchor predictions to the <a href="#sec-baseRate">base rate</a> unless sufficient evidence changes the posterior probability (by updating the evidence and <a href="#sec-baseRate">prior probability</a>).</p>
</section></section><section id="sec-predictionAccuracy-overview" class="level3" data-number="9.1.2"><h3 data-number="9.1.2" class="anchored" data-anchor-id="sec-predictionAccuracy-overview">
<span class="header-section-number">9.1.2</span> Prediction Accuracy</h3>
<section id="sec-decisionOutcomes-overview" class="level4" data-number="9.1.2.1"><h4 data-number="9.1.2.1" class="anchored" data-anchor-id="sec-decisionOutcomes-overview">
<span class="header-section-number">9.1.2.1</span> Decision Outcomes</h4>
<p>To consider how we can evaluate the accuracy of predictions, consider an example adapted from <span class="citation" data-cites="Meehl1955">Meehl &amp; Rosen (<a href="references.html#ref-Meehl1955" role="doc-biblioref">1955</a>)</span>. The military conducts a test of its prospective members to screen out applicants who would likely fail basic training. To evaluate the accuracy of our predictions using the test, we can examine a <a href="#sec-confusionMatrix">confusion matrix</a>. A <a href="#sec-confusionMatrix">confusion matrix</a> is a matrix that presents the predicted outcome on one dimension and the actual outcome (truth) on the other dimension. If the predictions and outcomes are dichotomous, the <a href="#sec-confusionMatrix">confusion matrix</a> is a 2x2 matrix with two rows and two columns that represent four possible predicted-actual combinations (decision outcomes): <a href="#sec-truePositive">true positives</a> (TP), <a href="#sec-trueNegative">true negatives</a> (TN), <a href="#sec-falsePositive">false positives</a> (FP), and <a href="#sec-falseNegative">false negatives</a> (FN).</p>
<p>When discussing the four decision outcomes, “true” means an accurate judgment, whereas “false” means an inaccurate judgment. “Positive” means that the judgment was that the person has the characteristic of interest, whereas “negative” means that the judgment was that the person does not have the characteristic of interest. A <em>true positive</em> is a correct judgment (or prediction) where the judgment was that the person has (or will have) the characteristic of interest, and, in truth, they actually have (or will have) the characteristic. A <em>true negative</em> is a correct judgment (or prediction) where the judgment was that the person does not have (or will not have) the characteristic of interest, and, in truth, they actually do not have (or will not have) the characteristic. A <em>false positive</em> is an incorrect judgment (or prediction) where the judgment was that the person has (or will have) the characteristic of interest, and, in truth, they actually do not have (or will not have) the characteristic. A <em>false negative</em> is an incorrect judgment (or prediction) where the judgment was that the person does not have (or will not have) the characteristic of interest, and, in truth, they actually do have (or will have) the characteristic.</p>
<p>An example of a <a href="#sec-confusionMatrix">confusion matrix</a> is in <a href="#fig-twoByTwoMatrix1" class="quarto-xref">Figure&nbsp;<span>9.4</span></a>.</p>
<div id="fig-twoByTwoMatrix1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="[Confusion Matrix](#sec-confusionMatrix): 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-twoByTwoMatrix1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/2x2-Matrix_2a.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;9.4: Confusion Matrix: 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio."><img src="images/2x2-Matrix_2a.png" class="img-fluid figure-img" style="width:100.0%" alt="[Confusion Matrix](#sec-confusionMatrix): 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoByTwoMatrix1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.4: <a href="#sec-confusionMatrix">Confusion Matrix</a>: 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio.
</figcaption></figure>
</div>
<p>With the information in the <a href="#sec-confusionMatrix">confusion matrix</a>, we can calculate the marginal sums and the proportion of people in each cell (in parentheses), as depicted in <a href="#fig-twoByTwoMatrix2" class="quarto-xref">Figure&nbsp;<span>9.5</span></a>.</p>
<div id="fig-twoByTwoMatrix2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="[Confusion Matrix](#sec-confusionMatrix): 2x2 Prediction Matrix With Marginal Sums. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-twoByTwoMatrix2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/2x2-Matrix_2b.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;9.5: Confusion Matrix: 2x2 Prediction Matrix With Marginal Sums. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives."><img src="images/2x2-Matrix_2b.png" class="img-fluid figure-img" style="width:100.0%" alt="[Confusion Matrix](#sec-confusionMatrix): 2x2 Prediction Matrix With Marginal Sums. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoByTwoMatrix2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.5: <a href="#sec-confusionMatrix">Confusion Matrix</a>: 2x2 Prediction Matrix With Marginal Sums. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives.
</figcaption></figure>
</div>
<p>That is, we can sum across the rows and columns to identify how many people actually showed poor adjustment (<span class="math inline">\(n = 100\)</span>) versus good adjustment (<span class="math inline">\(n = 1,900\)</span>), and how many people were selected to reject (<span class="math inline">\(n = 508\)</span>) versus retain (<span class="math inline">\(n = 1,492\)</span>). If we sum the column of predicted marginal sums (<span class="math inline">\(508 + 1,492\)</span>) or the row of actual marginal sums (<span class="math inline">\(100 + 1,900\)</span>), we get the total number of people (<span class="math inline">\(N = 2,000\)</span>).</p>
<p>Based on the marginal sums, we can compute the <a href="#sec-baseRate">marginal probabilities</a>, as depicted in <a href="#fig-twoByTwoMatrix3" class="quarto-xref">Figure&nbsp;<span>9.6</span></a>.</p>
<div id="fig-twoByTwoMatrix3" class="quarto-float quarto-figure quarto-figure-center anchored" alt="[Confusion Matrix](#sec-confusionMatrix): 2x2 Prediction Matrix With Marginal Sums And Marginal Probabilities. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-twoByTwoMatrix3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/2x2-Matrix_2c.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;9.6: Confusion Matrix: 2x2 Prediction Matrix With Marginal Sums And Marginal Probabilities. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio."><img src="images/2x2-Matrix_2c.png" class="img-fluid figure-img" style="width:100.0%" alt="[Confusion Matrix](#sec-confusionMatrix): 2x2 Prediction Matrix With Marginal Sums And Marginal Probabilities. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoByTwoMatrix3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.6: <a href="#sec-confusionMatrix">Confusion Matrix</a>: 2x2 Prediction Matrix With Marginal Sums And Marginal Probabilities. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio.
</figcaption></figure>
</div>
<p>The <a href="#sec-baseRate">marginal probability</a> of the person having the characteristic of interest (i.e., showing poor adjustment) is called the <a href="#sec-baseRate"><em>base rate</em></a> (BR). That is, the <a href="#sec-baseRate">base rate</a> is the proportion of people who have the characteristic. It is calculated by dividing the number of people with poor adjustment (<span class="math inline">\(n = 100\)</span>) by the total number of people (<span class="math inline">\(N = 2,000\)</span>): <span class="math inline">\(BR = \frac{FN + TP}{N}\)</span>. Here, the <a href="#sec-baseRate">base rate</a> reflects the prevalence of poor adjustment. In this case, the <a href="#sec-baseRate">base rate</a> is .05, so there is a 5% chance that an applicant will be poorly adjusted. The <a href="#sec-baseRate">marginal probability</a> of good adjustment is equal to 1 minus the <a href="#sec-baseRate">base rate</a> of poor adjustment.</p>
<p>The <a href="#sec-baseRate">marginal probability</a> of predicting that a person has the characteristic (i.e., rejecting a person) is called the <a href="#sec-selectionRatio"><em>selection ratio</em></a> (SR). The <a href="#sec-selectionRatio">selection ratio</a> is the proportion of people who will be selected (in this case, rejected rather than retained); i.e., the proportion of people who are identified as having the characteristic. The <a href="#sec-selectionRatio">selection ratio</a> is calculated by dividing the number of people selected to reject (<span class="math inline">\(n = 508\)</span>) by the total number of people (<span class="math inline">\(N = 2,000\)</span>): <span class="math inline">\(SR = \frac{TP + FP}{N}\)</span>. In this case, the <a href="#sec-selectionRatio">selection ratio</a> is .25, so 25% of people are rejected. The <a href="#sec-baseRate">marginal probability</a> of not selecting someone to reject (i.e., the <a href="#sec-baseRate">marginal probability</a> of retaining) is equal to 1 minus the <a href="#sec-selectionRatio">selection ratio</a>.</p>
<p>The <a href="#sec-selectionRatio">selection ratio</a> might be something that the test dictates according to its cutoff score. Or, the <a href="#sec-selectionRatio">selection ratio</a> might be imposed by external factors that place limits on how many people you can assign a positive test value. For instance, when deciding whether to treat a client, the <a href="#sec-selectionRatio">selection ratio</a> may depend on how many therapists are available and how many cases can be treated.</p>
</section><section id="sec-percentAccuracy-overview" class="level4" data-number="9.1.2.2"><h4 data-number="9.1.2.2" class="anchored" data-anchor-id="sec-percentAccuracy-overview">
<span class="header-section-number">9.1.2.2</span> Percent Accuracy</h4>
<p>Based on the <a href="#sec-confusionMatrix">confusion matrix</a>, we can calculate the prediction accuracy based on the <a href="#sec-percentAccuracy">percent accuracy</a> of the predictions. The <a href="#sec-percentAccuracy">percent accuracy</a> is the number of correct predictions divided by the total number of predictions, and multiplied by 100. In the context of a <a href="#sec-confusionMatrix">confusion matrix</a>, this is calculated as: <span class="math inline">\(100\% \times \frac{\text{TP} + \text{TN}}{N}\)</span>. In this case, our <a href="#sec-percentAccuracy">percent accuracy</a> was 78%—that is, 78% of our predictions were accurate, and 22% of our predictions were inaccurate.</p>
</section><section id="sec-accuracyByChance" class="level4" data-number="9.1.2.3"><h4 data-number="9.1.2.3" class="anchored" data-anchor-id="sec-accuracyByChance">
<span class="header-section-number">9.1.2.3</span> Percent Accuracy by Chance</h4>
<p>78% sounds pretty accurate. And it is much higher than 50%, so we are doing a pretty good job, right? Well, it is important to compare our accuracy to what accuracy we would expect to get by chance alone, if predictions were made by a random process rather than using a test’s scores. Our <a href="#sec-selectionRatio">selection ratio</a> was 25.4%. How accurate would we be if we randomly selected 25.4% of people to reject? To determine what accuracy we could get by chance alone given the <a href="#sec-selectionRatio">selection ratio</a> and the base rate, we can calculate the chance probability of <a href="#sec-truePositive">true positives</a> and the chance probability of <a href="#sec-trueNegative">true negatives</a>. The probability of a given cell in the <a href="#sec-confusionMatrix">confusion matrix</a> is a <a href="#sec-jointProbability">joint probability</a>—the probability of two events occurring simultaneously. To calculate a <a href="#sec-jointProbability">joint probability</a>, we multiply the probability of each event.</p>
<p>So, to get the chance expectancies of <a href="#sec-truePositive">true positives</a>, we would multiply the respective <a href="#sec-baseRate">marginal probabilities</a>, as in <a href="#eq-truePositivesByChanceExample" class="quarto-xref">Equation&nbsp;<span>9.17</span></a>:</p>
<p><span id="eq-truePositivesByChanceExample"><span class="math display">\[
\begin{aligned}
  P(TP) &amp;= P(\text{Poor adjustment}) \times P(\text{Reject})\\
   &amp;= BR \times SR \\
  &amp;= .05 \times .254 \\
  &amp;= .0127
\end{aligned}
\tag{9.17}\]</span></span></p>
<p>To get the chance expectancies of <a href="#sec-trueNegative">true negatives</a>, we would multiply the respective <a href="#sec-baseRate">marginal probabilities</a>, as in <a href="#eq-trueNegativesByChanceExample" class="quarto-xref">Equation&nbsp;<span>9.18</span></a>:</p>
<p><span id="eq-trueNegativesByChanceExample"><span class="math display">\[
\begin{aligned}
  P(TN) &amp;= P(\text{Good adjustment}) \times P(\text{Retain})\\
   &amp;= (1 - BR) \times (1 - SR) \\
  &amp;= .95 \times .746 \\
  &amp;= .7087
\end{aligned}
\tag{9.18}\]</span></span></p>
<p>To get the <a href="#sec-percentAccuracyByChance">percent accuracy by chance</a>, we sum the chance expectancies for the correct predictions (<a href="#sec-truePositive">TP</a> and <a href="#sec-trueNegative">TN</a>): <span class="math inline">\(.0127 + .7087 = .7214\)</span>. Thus, the <a href="#sec-percentAccuracyByChance">percent accuracy you can get by chance alone</a> is 72%. This is because most of our predictions are to retain people, and the <a href="#sec-baseRate">base rate</a> of poor adjustment is quite low (.05). Our measure with 78% <a href="#sec-percentAccuracy">accuracy</a> provides only a 6% increment in correct predictions. Thus, you cannot judge how good your judgment or prediction is until you know how you would do by random chance.</p>
<p>The chance expectancies for each cell of the <a href="#sec-confusionMatrix">confusion matrix</a> are in <a href="#fig-twoByTwoMatrix4" class="quarto-xref">Figure&nbsp;<span>9.7</span></a>.</p>
<div id="fig-twoByTwoMatrix4" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Chance Expectancies in 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-twoByTwoMatrix4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/2x2-Matrix_2d.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;9.7: Chance Expectancies in 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio."><img src="images/2x2-Matrix_2d.png" class="img-fluid figure-img" style="width:100.0%" alt="Chance Expectancies in 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoByTwoMatrix4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.7: Chance Expectancies in 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio.
</figcaption></figure>
</div>
</section><section id="sec-predictingFromBaseRate" class="level4" data-number="9.1.2.4"><h4 data-number="9.1.2.4" class="anchored" data-anchor-id="sec-predictingFromBaseRate">
<span class="header-section-number">9.1.2.4</span> Predicting from the Base Rate</h4>
<p>Now, let us consider how well you would do if you were to predict from the <a href="#sec-baseRate">base rate</a>. Predicting from the <a href="#sec-baseRate">base rate</a> is also called “betting from the <a href="#sec-baseRate">base rate</a>”, and it involves setting the <a href="#sec-selectionRatio">selection ratio</a> by taking advantage of the <a href="#sec-baseRate">base rate</a> so that you go with the most likely outcome in every prediction. Because the <a href="#sec-baseRate">base rate</a> is quite low (.05), we could predict from the <a href="#sec-baseRate">base rate</a> by selecting no one to reject (i.e., setting the <a href="#sec-selectionRatio">selection ratio</a> at zero). Our <a href="#sec-percentAccuracyByChance">percent accuracy by chance</a> if we predict from the <a href="#sec-baseRate">base rate</a> would be calculated by multiplying the <a href="#sec-baseRate">marginal probabilities</a>, as we did above, but with a new <a href="#sec-selectionRatio">selection ratio</a>, as in <a href="#eq-predictingFromBaseRateExample" class="quarto-xref">Equation&nbsp;<span>9.19</span></a>:</p>
<p><span id="eq-predictingFromBaseRateExample"><span class="math display">\[
\begin{aligned}
  P(TP) &amp;= P(\text{Poor adjustment}) \times P(\text{Reject})\\
   &amp;= BR \times SR \\
  &amp;= .05 \times 0 \\
  &amp;= 0 \\ \\
  P(TN) &amp;= P(\text{Good adjustment}) \times P(\text{Retain})\\
   &amp;= (1 - BR) \times (1 - SR) \\
  &amp;= .95 \times 1 \\
  &amp;= .95
\end{aligned}
\tag{9.19}\]</span></span></p>
<p>We sum the chance expectancies for the correct predictions (<a href="#sec-truePositive">TP</a> and <a href="#sec-trueNegative">TN</a>): <span class="math inline">\(0 + .95 = .95\)</span>. Thus, our <a href="#sec-percentAccuracy">percent accuracy</a> by predicting from the <a href="#sec-baseRate">base rate</a> is 95%. This is damning to our measure because it is a much higher accuracy than the accuracy of our measure. That is, we can be much more accurate than our measure simply by predicting from the <a href="#sec-baseRate">base rate</a> and selecting no one to reject.</p>
<p>Going with the most likely outcome in every prediction (predicting from the <a href="#sec-baseRate">base rate</a>) can be highly accurate (in terms of percent accuracy) as noted by <span class="citation" data-cites="Meehl1955">Meehl &amp; Rosen (<a href="references.html#ref-Meehl1955" role="doc-biblioref">1955</a>)</span>, especially when the <a href="#sec-baseRate">base rate</a> is very low or very high. This should serve as an important reminder that we need to compare the accuracy of our measures to the accuracy by (1) random chance and (2) predicting from the <a href="#sec-baseRate">base rate</a>. There are several important implications of the impact of <a href="#sec-baseRate">base rates</a> on prediction accuracy. One implication is that using the same test in different settings with different <a href="#sec-baseRate">base rates</a> will markedly change the accuracy of the test. Oftentimes, using a test will actually <em>decrease</em> the predictive accuracy when the <a href="#sec-baseRate">base rate</a> deviates greatly from .50. But <a href="#sec-percentAccuracy">percent accuracy</a> is not everything. <a href="#sec-percentAccuracy">Percent accuracy</a> treats different kinds of errors as if they are equally important. However, the value we place on different kinds of errors may be different, as described next.</p>
</section><section id="sec-differentErrorsDifferentCosts" class="level4" data-number="9.1.2.5"><h4 data-number="9.1.2.5" class="anchored" data-anchor-id="sec-differentErrorsDifferentCosts">
<span class="header-section-number">9.1.2.5</span> Different Kinds of Errors Have Different Costs</h4>
<p>Some errors have a high cost, and some errors have a low cost. Among the four decision outcomes, there are two types of errors: <a href="#sec-falsePositive">false positives</a> and <a href="#sec-falseNegative">false negatives</a>. The extent to which <a href="#sec-falsePositive">false positives</a> and <a href="#sec-falseNegative">false negatives</a> are costly depends on the prediction problem. So, even though you can often be most accurate by going with the <a href="#sec-baseRate">base rate</a>, it may be advantageous to use a screening instrument despite lower <a href="#sec-percentAccuracy">overall accuracy</a> because of the huge difference in costs of <a href="#sec-falsePositive">false positives</a> versus <a href="#sec-falseNegative">false negatives</a> in some cases.</p>
<p>Consider the example of a screening instrument for HIV. <a href="#sec-falsePositive">False positives</a> would be cases where we said that someone is at high risk of HIV when they are not, whereas <a href="#sec-falseNegative">false negatives</a> are cases where we said that someone is not at high risk when they actually are. The costs of <a href="#sec-falsePositive">false positives</a> include a shortage of blood, some follow-up testing, and potentially some anxiety, but that is about it. The costs of <a href="#sec-falseNegative">false negatives</a> may be people getting HIV. In this case, the costs of <a href="#sec-falseNegative">false negatives</a> greatly outweigh the costs of <a href="#sec-falsePositive">false positives</a>, so we use a screening instrument to try to identify the cases at high risk for HIV because of the important consequences of failing to do so, even though using the screening instrument will lower our overall accuracy level.</p>
<p>Another example is when the Central Intelligence Agency (CIA) used a screen for protective typists during wartime to try to detect spies. <a href="#sec-falsePositive">False positives</a> would be cases where the CIA believes that a person is a spy when they are not, and the CIA does not hire them. <a href="#sec-falseNegative">False negatives</a> would be cases where the CIA believes that a person is not a spy when they actually are, and the CIA hires them. In this case, a <a href="#sec-falsePositive">false positive</a> would be fine, but a <a href="#sec-falseNegative">false negative</a> would be really bad.</p>
<p>How you weigh the costs of different errors depends considerably on the domain and context. Possible costs of <a href="#sec-falsePositive">false positives</a> to society include: unnecessary and costly treatment with side effects and sending an innocent person to jail (despite our presumption of innocence in the United States criminal justice system that a person is innocent until proven guilty). Possible costs of <a href="#sec-falseNegative">false negatives</a> to society include: setting a guilty person free, failing to detect a bomb or tumor, and preventing someone from getting treatment who needs it.</p>
<p>The differential costs of different errors also depend on how much flexibility you have in the <a href="#sec-selectionRatio">selection ratio</a> in being able to set a stringent versus loose <a href="#sec-selectionRatio">selection ratio</a>. Consider if there is a high cost of getting rid of people during the selection process. For example, if you must hire 100 people and only 100 people apply for the position, you cannot lose people, so you need to hire even high-risk people. However, if you do not need to hire many people, then you can hire more conservatively.</p>
<p>Any time the <a href="#sec-selectionRatio">selection ratio</a> differs from the <a href="#sec-baseRate">base rate</a>, you will make errors. For example, if you reject 25% of applicants, and the <a href="#sec-baseRate">base rate</a> of poor adjustment is 5%, then you are making errors of over-rejecting (<a href="#sec-falsePositive">false positives</a>). By contrast, if you reject 1% of applicants and the <a href="#sec-baseRate">base rate</a> of poor adjustment is 5%, then you are making errors of under-rejecting or over-accepting (<a href="#sec-falseNegative">false negatives</a>).</p>
<p>A low <a href="#sec-baseRate">base rate</a> makes it harder to make predictions, and tends to lead to less accurate predictions. For instance, it is very challenging to predict low <a href="#sec-baseRate">base rate</a> behaviors, including suicide <span class="citation" data-cites="Kessler2020">(<a href="references.html#ref-Kessler2020" role="doc-biblioref">Kessler et al., 2020</a>)</span>. The difficulty in predicting events with a low <a href="#sec-baseRate">base rate</a> is apparent with the true score formula from classical test theory: <span class="math inline">\(X = T + e\)</span>. As described in <a href="reliability.html#eq-reliabilityRatio" class="quarto-xref">Equation&nbsp;<span>4.10</span></a>, <a href="reliability.html">reliability</a> is the ratio of true score variance to observed score variance. As true score variance increases, <a href="reliability.html">reliability</a> increases. If the <a href="#sec-baseRate">base rate</a> is .05, the maximum variance of the true scores is .05. The lower true score variance makes the measure less <a href="reliability.html">reliable</a> and hard to make accurate predictions.</p>
</section><section id="sec-sensitivitySpecificityPPVnpv" class="level4" data-number="9.1.2.6"><h4 data-number="9.1.2.6" class="anchored" data-anchor-id="sec-sensitivitySpecificityPPVnpv">
<span class="header-section-number">9.1.2.6</span> Sensitivity, Specificity, PPV, and NPV</h4>
<p>As described earlier, <a href="#sec-percentAccuracy">percent accuracy</a> is not the only important aspect of accuracy. <a href="#sec-percentAccuracy">Percent accuracy</a> can be misleading because it is highly influenced by <a href="#sec-baseRate">base rates</a>. You can have a high <a href="#sec-percentAccuracy">percent accuracy</a> by <a href="#sec-predictingFromBaseRate">predicting from the base rate</a> and saying that no one has the condition (if the <a href="#sec-baseRate">base rate</a> is low) or that everyone has the condition (if the <a href="#sec-baseRate">base rate</a> is high). Thus, it is also important to consider other aspects of accuracy, including <a href="#sec-sensitivity">sensitivity</a> (SN), <a href="#sec-specificity">specificity</a> (SP), <a href="#sec-ppv">positive predictive value</a> (PPV), and <a href="#sec-npv">negative predictive value</a> (NPV). We want our predictions to be <a href="#sec-sensitivity">sensitive</a> to be able to detect the characteristic but also to be <a href="#sec-specificity">specific</a> so that we classify only people actually with the characteristic as having the characteristic.</p>
<p>Let us return to the <a href="#sec-confusionMatrix">confusion matrix</a> in <a href="#fig-twoByTwoMatrix5" class="quarto-xref">Figure&nbsp;<span>9.8</span></a>. If we know the frequency of each of the four predicted-actual combinations of the <a href="#sec-confusionMatrix">confusion matrix</a> (<a href="#sec-truePositive">TP</a>, <a href="#sec-trueNegative">TN</a>, <a href="#sec-falsePositive">FP</a>, <a href="#sec-falseNegative">FN</a>), we can calculate <a href="#sec-sensitivity">sensitivity</a>, <a href="#sec-specificity">specificity</a>, <a href="#sec-ppv">PPV</a>, and <a href="#sec-npv">NPV</a>.</p>
<div id="fig-twoByTwoMatrix5" class="quarto-float quarto-figure quarto-figure-center anchored" alt="[Confusion Matrix](#sec-confusionMatrix): 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-twoByTwoMatrix5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/2x2-Matrix_2e.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;9.8: Confusion Matrix: 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives."><img src="images/2x2-Matrix_2e.png" class="img-fluid figure-img" style="width:100.0%" alt="[Confusion Matrix](#sec-confusionMatrix): 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoByTwoMatrix5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.8: <a href="#sec-confusionMatrix">Confusion Matrix</a>: 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives.
</figcaption></figure>
</div>
<p><a href="#sec-sensitivity">Sensitivity</a> is the proportion of those with the characteristic (<span class="math inline">\(\text{TP} + \text{FN}\)</span>) that we identified with our measure (<span class="math inline">\(\text{TP}\)</span>): <span class="math inline">\(\frac{\text{TP}}{\text{TP} + \text{FN}} = \frac{86}{86 + 14} = .86\)</span>. <a href="#sec-specificity">Specificity</a> is the proportion of those who do not have the characteristic (<span class="math inline">\(\text{TN} + \text{FP}\)</span>) that we correctly classify as not having the characteristic (<span class="math inline">\(\text{TN}\)</span>): <span class="math inline">\(\frac{\text{TN}}{\text{TN} + \text{FP}} = \frac{1,478}{1,478 + 422} = .78\)</span>. <a href="#sec-ppv">PPV</a> is the proportion of those who we classify as having the characteristic (<span class="math inline">\(\text{TP} + \text{FP}\)</span>) who actually have the characteristic (<span class="math inline">\(\text{TP}\)</span>): <span class="math inline">\(\frac{\text{TP}}{\text{TP} + \text{FP}} = \frac{86}{86 + 422} = .17\)</span>. <a href="#sec-npv">NPV</a> is the proportion of those we classify as not having the characteristic (<span class="math inline">\(\text{TN} + \text{FN}\)</span>) who actually do not have the characteristic (<span class="math inline">\(\text{TN}\)</span>): <span class="math inline">\(\frac{\text{TN}}{\text{TN} + \text{FN}} = \frac{1,478}{1,478 + 14} = .99\)</span>.</p>
<p><a href="#sec-sensitivity">Sensitivity</a>, <a href="#sec-specificity">specificity</a>, <a href="#sec-ppv">PPV</a>, and <a href="#sec-npv">NPV</a> are proportions, and their values therefore range from 0 to 1, where higher values reflect greater accuracy. With <a href="#sec-sensitivity">sensitivity</a>, <a href="#sec-specificity">specificity</a>, <a href="#sec-ppv">PPV</a>, and <a href="#sec-npv">NPV</a>, we have a good snapshot of how accurate the measure is at a given cutoff. In our case, our measure is good at finding whom to reject (high <a href="#sec-sensitivity">sensitivity</a>), but it is rejecting too many people who do not need to be rejected (lower <a href="#sec-ppv">PPV</a> due to many <a href="#sec-falsePositive">FPs</a>). Most people whom we classify as having the characteristic do not actually have the characteristic. However, the fact that we are over-rejecting could be okay depending on our goals, for instance, if we do not care about over-dropping (i.e., the <a href="#sec-ppv">PPV</a> being low).</p>
<section id="sec-accuracyCutoff" class="level5" data-number="9.1.2.6.1"><h5 data-number="9.1.2.6.1" class="anchored" data-anchor-id="sec-accuracyCutoff">
<span class="header-section-number">9.1.2.6.1</span> Some Accuracy Estimates Depend on the Cutoff</h5>
<p><a href="#sec-sensitivity">Sensitivity</a>, <a href="#sec-specificity">specificity</a>, <a href="#sec-ppv">PPV</a>, and <a href="#sec-npv">NPV</a> differ based on the cutoff (i.e., threshold) for classification. Consider the following example. Aliens visit Earth, and they develop a test to determine whether a berry is edible or inedible.</p>
<p><a href="#fig-classificationDistributions" class="quarto-xref">Figure&nbsp;<span>9.9</span></a> depicts the distributions of scores by berry type. Note how there are clearly two distinct distributions. However, the distributions overlap to some degree. Thus, any cutoff will have at least some inaccurate classifications. The extent of overlap of the distributions reflects the amount of <a href="reliability.html#sec-measurementError">measurement error</a> of the measure with respect to the characteristic of interest.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-classificationDistributions" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Distribution of Test Scores by Berry Type.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-classificationDistributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-classificationDistributions-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;9.9: Distribution of Test Scores by Berry Type."><img src="prediction_files/figure-html/fig-classificationDistributions-1.png" class="img-fluid figure-img" alt="Distribution of Test Scores by Berry Type." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-classificationDistributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.9: Distribution of Test Scores by Berry Type.
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-classificationStandardCutoff" class="quarto-xref">Figure&nbsp;<span>9.10</span></a> depicts the distributions of scores by berry type with a cutoff. The red line indicates the cutoff—the level above which berries are classified by the test as inedible. There are errors on each side of the cutoff. Below the cutoff, there are some <a href="#sec-falseNegative">false negatives</a> (blue): inedible berries that are inaccurately classified as edible. Above the cutoff, there are some <a href="#sec-falsePositive">false positives</a> (green): edible berries that are inaccurately classified as inedible. Costs of <a href="#sec-falseNegative">false negatives</a> could include sickness or death from eating the inedible berries. Costs of <a href="#sec-falsePositive">false positives</a> could include taking longer to find food, finding insufficient food, and starvation.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-classificationStandardCutoff" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Classifications Based on a Cutoff. Note that some true negatives and true positives are hidden behind the false positives and false negatives." data-fig-scap="Classifications Based on a Cutoff.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-classificationStandardCutoff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-classificationStandardCutoff-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;9.10: Classifications Based on a Cutoff. Note that some true negatives and true positives are hidden behind the false positives and false negatives."><img src="prediction_files/figure-html/fig-classificationStandardCutoff-1.png" class="img-fluid figure-img" data-fig-scap="Classifications Based on a Cutoff." alt="Classifications Based on a Cutoff. Note that some true negatives and true positives are hidden behind the false positives and false negatives." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-classificationStandardCutoff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.10: Classifications Based on a Cutoff. Note that some true negatives and true positives are hidden behind the false positives and false negatives.
</figcaption></figure>
</div>
</div>
</div>
<p>Based on our assessment goals, we might use a different <a href="#sec-selectionRatio">selection ratio</a> by changing the cutoff. <a href="#fig-classificationRaiseCutoff" class="quarto-xref">Figure&nbsp;<span>9.11</span></a> depicts the distributions of scores by berry type when we raise the cutoff. There are now more <a href="#sec-falseNegative">false negatives</a> (blue) and fewer <a href="#sec-falsePositive">false positives</a> (green). If we raise the cutoff (to be more conservative), the number of <a href="#sec-falseNegative">false negatives</a> increases and the number of <a href="#sec-falsePositive">false positives</a> decreases. Consequently, as the cutoff increases, <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-npv">NPV</a> decrease (because we have more <a href="#sec-falseNegative">false negatives</a>), whereas <a href="#sec-specificity">specificity</a> and <a href="#sec-ppv">PPV</a> increase (because we have fewer <a href="#sec-falsePositive">false positives</a>). A higher cutoff could be optimal if the costs of <a href="#sec-falsePositive">false positives</a> are considered greater than the costs of <a href="#sec-falseNegative">false negatives</a>. For instance, if the aliens cannot risk eating the inedible berries because the berries are fatal, and there are sufficient edible berries that can be found to feed the alien colony.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-classificationRaiseCutoff" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Classifications Based on Raising the Cutoff. Note that some true negatives and true positives are hidden behind the false positives and false negatives." data-fig-scap="Classifications Based on Raising the Cutoff.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-classificationRaiseCutoff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-classificationRaiseCutoff-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;9.11: Classifications Based on Raising the Cutoff. Note that some true negatives and true positives are hidden behind the false positives and false negatives."><img src="prediction_files/figure-html/fig-classificationRaiseCutoff-1.png" class="img-fluid figure-img" data-fig-scap="Classifications Based on Raising the Cutoff." alt="Classifications Based on Raising the Cutoff. Note that some true negatives and true positives are hidden behind the false positives and false negatives." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-classificationRaiseCutoff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.11: Classifications Based on Raising the Cutoff. Note that some true negatives and true positives are hidden behind the false positives and false negatives.
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-classificationLowerCutoff" class="quarto-xref">Figure&nbsp;<span>9.12</span></a> depicts the distributions of scores by berry type when we lower the cutoff. There are now fewer <a href="#sec-falseNegative">false negatives</a> (blue) and more <a href="#sec-falsePositive">false positives</a> (green). If we lower the cutoff (to be more liberal), the number of <a href="#sec-falseNegative">false negatives</a> decreases and the number of <a href="#sec-falsePositive">false positives</a> increases. Consequently, as the cutoff decreases, <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-npv">NPV</a> increase (because we have fewer <a href="#sec-falseNegative">false negatives</a>), whereas <a href="#sec-specificity">specificity</a> and <a href="#sec-ppv">PPV</a> decrease (because we have more <a href="#sec-falsePositive">false positives</a>). A lower cutoff could be optimal if the costs of <a href="#sec-falseNegative">false negatives</a> are considered greater than the costs of <a href="#sec-falsePositive">false positives</a>. For instance, if the aliens cannot risk missing edible berries because they are in short supply relative to the size of the alien colony, and eating the inedible berries would, at worst, lead to minor, temporary discomfort.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-classificationLowerCutoff" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Classifications Based on Lowering the Cutoff. Note that some true negatives and true positives are hidden behind the false positives and false negatives." data-fig-scap="Classifications Based on Lowering the Cutoff.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-classificationLowerCutoff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-classificationLowerCutoff-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;9.12: Classifications Based on Lowering the Cutoff. Note that some true negatives and true positives are hidden behind the false positives and false negatives."><img src="prediction_files/figure-html/fig-classificationLowerCutoff-1.png" class="img-fluid figure-img" data-fig-scap="Classifications Based on Lowering the Cutoff." alt="Classifications Based on Lowering the Cutoff. Note that some true negatives and true positives are hidden behind the false positives and false negatives." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-classificationLowerCutoff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.12: Classifications Based on Lowering the Cutoff. Note that some true negatives and true positives are hidden behind the false positives and false negatives.
</figcaption></figure>
</div>
</div>
</div>
<p>In sum, <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a> differ based on the cutoff for classification. if we raise the cutoff, <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-ppv">PPV</a> increase (due to fewer <a href="#sec-falsePositive">false positives</a>), whereas and <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-npv">NPV</a> decrease (due to more <a href="#sec-falseNegative">false negatives</a>). If we lower the cutoff, <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-npv">NPV</a> increase (due to fewer <a href="#sec-falseNegative">false negatives</a>), whereas <a href="#sec-specificity">specificity</a> and <a href="#sec-ppv">PPV</a> decrease (due to more <a href="#sec-falsePositive">false positives</a>). Thus, the optimal cutoff depends on how costly each type of error is: <a href="#sec-falseNegative">false negatives</a> and <a href="#sec-falsePositive">false positives</a>. If false negatives are more costly than <a href="#sec-falsePositive">false positives</a>, we would set a low cutoff. If <a href="#sec-falsePositive">false positives</a> are more costly than <a href="#sec-falseNegative">false negatives</a>, we would set a high cutoff.</p>
</section></section><section id="sec-sdt" class="level4" data-number="9.1.2.7"><h4 data-number="9.1.2.7" class="anchored" data-anchor-id="sec-sdt">
<span class="header-section-number">9.1.2.7</span> Signal Detection Theory</h4>
<p>Signal detection theory (SDT) is a probability-based theory for the detection of a given stimulus (signal) from a stimulus set that includes non-target stimuli (noise). SDT arose through the development of radar (<strong>RA</strong>dio <strong>D</strong>etection <strong>A</strong>nd <strong>R</strong>anging) and sonar (<strong>SO</strong>und <strong>N</strong>avigation <strong>A</strong>nd <strong>R</strong>anging) in World War II based on research on sensory-perception research. The military wanted to determine which objects on radar/sonar were enemy aircraft/submarines, and which were noise (e.g., different object in the environment or even just the weather itself). SDT allowed determining how many errors operators made (how accurate they were) and decomposing errors into different kinds of errors. SDT distinguishes between sensitivity and bias. In SDT, <em>sensitivity</em> (or <a href="#sec-discrimination">discriminability</a>) is how well an assessment distinguishes between a target stimulus and non-target stimuli (i.e., how well the assessment detects the target stimulus amid non-target stimuli). <em>Bias</em> is the extent to which the probability of a selection decision from the assessment is higher or lower than the true rate of the target stimulus.</p>
<p>Some radar/sonar operators were not as sensitive to the differences between signal and noise, due to factors such as age, ability to distinguish gradations of a signal, etc. People who showed low sensitivity (i.e., who were not as successful at distinguishing between signal and noise) were screened out because the military perceived sensitivity as a skill that was not easily taught. By contrast, other operators could distinguish signal from noise, but their threshold was too low or high—they could take in information, but their decisions tended to be wrong due to systematic bias or poor <a href="#sec-calibration">calibration</a>. That is, they systematically over-rejected or under-rejected stimuli. Over-rejecting leads to many <a href="#sec-falseNegative">false negatives</a> (i.e., saying that a stimulus is safe when it is not). Under-rejecting leads to many <a href="#sec-falsePositive">false positives</a> (i.e., saying that a stimulus is harmful when it is not). A person who showed good sensitivity but systematic bias was considered more teach-able than a person who showed low sensitivity. Thus, radar and sonar operators were selected based on their sensitivity to distinguish signal from noise, and then were trained to improve the <a href="#sec-calibration">calibration</a> so they reduce their systematic bias and do not systematically over- or under-reject.</p>
<p>Although SDT was originally developed for use in World War II, it now plays an important role in many areas of science and medicine. A medical application of SDT is tumor detection in radiology. SDT also plays an important role in psychology, especially cognitive psychology. For instance, research on social perception of sexual interest has shown that men tend to show lack of sensitivity to differences in women’s affect—i.e., they have relative difficulties discriminating between friendliness and sexual interest <span class="citation" data-cites="Farris2008">(<a href="references.html#ref-Farris2008" role="doc-biblioref">Farris et al., 2008</a>)</span>. Men also tend to show systematic bias (poor <a href="#sec-calibration">calibration</a>) such that they tend to over-estimate women’s sexual interest in them—i.e., men tend to have too low of a threshold for determining that a women is showing sexual interest in them <span class="citation" data-cites="Farris2006">(<a href="references.html#ref-Farris2006" role="doc-biblioref">Farris et al., 2006</a>)</span>.</p>
<p>SDT metrics of sensitivity include <a href="#sec-dPrimeSDT"><span class="math inline">\(d'\)</span></a> (“<span class="math inline">\(d\)</span>-prime”), <a href="#sec-aSDT"><span class="math inline">\(A\)</span></a> (or <span class="math inline">\(A'\)</span>), and the <a href="#sec-auc">area under the receiver operating characteristic (ROC) curve</a>. SDT metrics of bias include <a href="#sec-betaSDT"><span class="math inline">\(\beta\)</span></a> (beta), <a href="#sec-cSDT"><span class="math inline">\(c\)</span></a>, and <a href="#sec-bSDT"><span class="math inline">\(b\)</span></a>.</p>
<section id="sec-roc" class="level5" data-number="9.1.2.7.1"><h5 data-number="9.1.2.7.1" class="anchored" data-anchor-id="sec-roc">
<span class="header-section-number">9.1.2.7.1</span> Receiver Operating Characteristic (ROC) Curve</h5>
<p>The x-axis of the ROC curve is the <a href="#sec-falsePositiveRate">false alarm rate</a> or <a href="#sec-falsePositiveRate">false positive rate</a> (<span class="math inline">\(1 -\)</span> <a href="#sec-specificity">specificity</a>). The y-axis is the <a href="#sec-sensitivity">hit rate</a> or <a href="#sec-sensitivity">true positive rate</a> (<a href="#sec-sensitivity">sensitivity</a>). We can trace the ROC curve as the combination between <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a> at every possible cutoff. At a cutoff of zero (top right of ROC curve), we calculate <a href="#sec-sensitivity">sensitivity</a> (1.0) and <a href="#sec-specificity">specificity</a> (0) and plot it. At a cutoff of zero, the assessment tells us to make an action for every stimulus (i.e., it is the most liberal). We then gradually increase the cutoff, and plot <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a> at each cutoff. As the cutoff increases, <a href="#sec-sensitivity">sensitivity</a> decreases and <a href="#sec-specificity">specificity</a> increases. We end at the highest possible cutoff, where the <a href="#sec-sensitivity">sensitivity</a> is 0 and the specificity is 1.0 (i.e., we never make an action; i.e., it is the most conservative). Each point on the ROC curve corresponds to a pair of <a href="#sec-sensitivity">hit</a> and <a href="#sec-falsePositiveRate">false alarm</a> rates (<a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a>) resulting from a specific cutoff value. Then, we can draw lines or a curve to connect the points.</p>
<p><a href="#fig-empiricalROC" class="quarto-xref">Figure&nbsp;<span>9.13</span></a> depicts an empirical ROC plot where lines are drawn to connect the <a href="#sec-sensitivity">hit</a> and <a href="#sec-falsePositiveRate">false alarm</a> rates.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-empiricalROC" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Empirical Receiver Operating Characteristic Curve. AUC = Area under the receiver operating characteristic curve." data-fig-scap="Empirical Receiver Operating Characteristic Curve.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-empiricalROC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-empiricalROC-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;9.13: Empirical Receiver Operating Characteristic Curve. AUC = Area under the receiver operating characteristic curve."><img src="prediction_files/figure-html/fig-empiricalROC-1.png" class="img-fluid figure-img" data-fig-scap="Empirical Receiver Operating Characteristic Curve." alt="Empirical Receiver Operating Characteristic Curve. AUC = Area under the receiver operating characteristic curve." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-empiricalROC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.13: Empirical Receiver Operating Characteristic Curve. AUC = Area under the receiver operating characteristic curve.
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-smoothROC" class="quarto-xref">Figure&nbsp;<span>9.14</span></a> depicts an ROC curve where a smoothed and fitted curve is drawn to connect the <a href="#sec-sensitivity">hit</a> and <a href="#sec-falsePositiveRate">false alarm</a> rates.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-smoothROC" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Smooth Receiver Operating Characteristic Curve. AUC = Area under the receiver operating characteristic curve." data-fig-scap="Smooth Receiver Operating Characteristic Curve.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-smoothROC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-smoothROC-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;9.14: Smooth Receiver Operating Characteristic Curve. AUC = Area under the receiver operating characteristic curve."><img src="prediction_files/figure-html/fig-smoothROC-1.png" class="img-fluid figure-img" data-fig-scap="Smooth Receiver Operating Characteristic Curve." alt="Smooth Receiver Operating Characteristic Curve. AUC = Area under the receiver operating characteristic curve." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-smoothROC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.14: Smooth Receiver Operating Characteristic Curve. AUC = Area under the receiver operating characteristic curve.
</figcaption></figure>
</div>
</div>
</div>
<section id="sec-auc" class="level6" data-number="9.1.2.7.1.1"><h6 data-number="9.1.2.7.1.1" class="anchored" data-anchor-id="sec-auc">
<span class="header-section-number">9.1.2.7.1.1</span> Area Under the ROC Curve</h6>
<p><a href="#sec-roc">ROC</a> methods can be used to compare and compute the <a href="#sec-discrimination">discriminative</a> power of measurement devices free from the influence of <a href="#sec-selectionRatio">selection ratios</a>, <a href="#sec-baseRate">base rates</a>, and costs and benefits. An <a href="#sec-roc">ROC</a> analysis yields a quantitative index of how well an index predicts a signal of interest or can discriminate between different signals. <a href="#sec-roc">ROC</a> analysis can help tell us how often our assessment would be correct. If we randomly pick two observations, and we were right once and wrong once, we were 50% accurate. But this would be a useless measure because it reflects chance responding.</p>
<p>The geometrical area under the <a href="#sec-roc">ROC curve</a> reflects the <a href="#sec-discrimination">discriminative accuracy</a> of the measure. The index is called the <strong>a</strong>rea <strong>u</strong>nder the <strong>c</strong>urve (AUC) of an <a href="#sec-roc">ROC curve</a>. AUC quantifies the <a href="#sec-discrimination">discriminative power</a> of an assessment. AUC is the probability that a randomly selected target and a randomly selected non-target is ranked correctly by the assessment method. AUC values range from 0.0 to 1.0, where chance accuracy is 0.5 as indicated by diagonal line in the ROC curve. That is, a measure can be useful to the extent that its ROC curve is above the diagonal line (i.e., its <a href="#sec-discrimination">discriminative accuracy</a> is above chance).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-auc" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Area Under The Receiver Operating Characteristic Curve (AUC).">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-auc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-auc-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure&nbsp;9.15: Area Under The Receiver Operating Characteristic Curve (AUC)."><img src="prediction_files/figure-html/fig-auc-1.png" class="img-fluid figure-img" alt="Area Under The Receiver Operating Characteristic Curve (AUC)." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-auc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.15: Area Under The Receiver Operating Characteristic Curve (AUC).
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-aucRange" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Receiver Operating Characteristic (ROC) Curves for Various Levels of Area Under The ROC Curve (AUC) for Various Measures.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-aucRange-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-aucRange-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure&nbsp;9.16: Receiver Operating Characteristic (ROC) Curves for Various Levels of Area Under The ROC Curve (AUC) for Various Measures."><img src="prediction_files/figure-html/fig-aucRange-1.png" class="img-fluid figure-img" alt="Receiver Operating Characteristic (ROC) Curves for Various Levels of Area Under The ROC Curve (AUC) for Various Measures." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aucRange-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.16: Receiver Operating Characteristic (ROC) Curves for Various Levels of Area Under The ROC Curve (AUC) for Various Measures.
</figcaption></figure>
</div>
</div>
</div>
<p>As an example, given an AUC of .75, this says that the overall score of an individual who has the characteristic in question will be higher 75% of the time than the overall score of an individual who does not have the characteristic. In lay terms, AUC provides the probability that we will classify correctly based on our instrument if we were to randomly pick one good and one bad outcome. AUC is a stronger index of accuracy than <a href="#sec-percentAccuracy">percent accuracy</a>, because you can have high <a href="#sec-percentAccuracy">percent accuracy</a> just by going with the <a href="#sec-baseRate">base rate</a>. AUC tells us how much better than chance a measure is at discriminating outcomes. AUC is useful as a measure of general <a href="#sec-discrimination">discriminative accuracy</a>, and it tells us how accurate a measure is at all possible cutoffs. Knowing the accuracy of a measure at all possible cutoffs can be helpful for selecting the optimal cutoff, given the goals of the assessment. In reality, however, we may not be interested in all cutoffs because not all errors are equal in their costs.</p>
<p>If we lower the <a href="#sec-baseRate">base rate</a>, we would need a larger sample to get enough people to classify into each group. <a href="#sec-sdt">SDT</a>/<a href="#sec-roc">ROC</a> methods are traditionally about dichotomous decisions (yes/no), not graded judgments. <a href="#sec-sdt">SDT</a>/<a href="#sec-roc">ROC</a> methods can get messy with ordinal data that are more graded because you would have an AUC curve for each ordinal grouping.</p>
</section></section></section></section></section><section id="sec-gettingStarted-prediction" class="level2" data-number="9.2"><h2 data-number="9.2" class="anchored" data-anchor-id="sec-gettingStarted-prediction">
<span class="header-section-number">9.2</span> Getting Started</h2>
<section id="sec-loadLibraries-prediction" class="level3" data-number="9.2.1"><h3 data-number="9.2.1" class="anchored" data-anchor-id="sec-loadLibraries-prediction">
<span class="header-section-number">9.2.1</span> Load Libraries</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">library</span>(<span class="st">"petersenlab"</span>) <span class="co">#to install: install.packages("remotes"); remotes::install_github("DevPsyLab/petersenlab")</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">library</span>(<span class="st">"pROC"</span>)</span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="fu">library</span>(<span class="st">"ROCR"</span>)</span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="fu">library</span>(<span class="st">"rms"</span>)</span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="fu">library</span>(<span class="st">"ResourceSelection"</span>)</span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="fu">library</span>(<span class="st">"PredictABEL"</span>)</span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="fu">library</span>(<span class="st">"uroc"</span>) <span class="co">#to install: install.packages("remotes"); remotes::install_github("evwalz/uroc")</span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="fu">library</span>(<span class="st">"rms"</span>)</span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="fu">library</span>(<span class="st">"gridExtra"</span>)</span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="fu">library</span>(<span class="st">"grid"</span>)</span>
<span id="cb36-11"><a href="#cb36-11"></a><span class="fu">library</span>(<span class="st">"ggpubr"</span>)</span>
<span id="cb36-12"><a href="#cb36-12"></a><span class="fu">library</span>(<span class="st">"msir"</span>)</span>
<span id="cb36-13"><a href="#cb36-13"></a><span class="fu">library</span>(<span class="st">"car"</span>)</span>
<span id="cb36-14"><a href="#cb36-14"></a><span class="fu">library</span>(<span class="st">"viridis"</span>)</span>
<span id="cb36-15"><a href="#cb36-15"></a><span class="fu">library</span>(<span class="st">"ggrepel"</span>)</span>
<span id="cb36-16"><a href="#cb36-16"></a><span class="fu">library</span>(<span class="st">"caret"</span>)</span>
<span id="cb36-17"><a href="#cb36-17"></a><span class="fu">library</span>(<span class="st">"MOTE"</span>)</span>
<span id="cb36-18"><a href="#cb36-18"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb36-19"><a href="#cb36-19"></a><span class="fu">library</span>(<span class="st">"here"</span>)</span>
<span id="cb36-20"><a href="#cb36-20"></a><span class="fu">library</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb36-21"><a href="#cb36-21"></a><span class="fu">library</span>(<span class="st">"rmarkdown"</span>)</span>
<span id="cb36-22"><a href="#cb36-22"></a><span class="fu">library</span>(<span class="st">"knitr"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-prepareData-prediction" class="level3" data-number="9.2.2"><h3 data-number="9.2.2" class="anchored" data-anchor-id="sec-prepareData-prediction">
<span class="header-section-number">9.2.2</span> Prepare Data</h3>
<section id="sec-loadData-prediction" class="level4" data-number="9.2.2.1"><h4 data-number="9.2.2.1" class="anchored" data-anchor-id="sec-loadData-prediction">
<span class="header-section-number">9.2.2.1</span> Load Data</h4>
<p><code>aSAH</code> is a data set from the <code>pROC</code> package <span class="citation" data-cites="R-pROC">(<a href="references.html#ref-R-pROC" role="doc-biblioref">Robin et al., 2021</a>)</span> that contains test scores (<code>s100b</code>) and clinical outcomes (<code>outcome</code>) for patients.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">data</span>(aSAH)</span>
<span id="cb37-2"><a href="#cb37-2"></a>mydataSDT <span class="ot">&lt;-</span> aSAH</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-simulateData-prediction" class="level4" data-number="9.2.2.2"><h4 data-number="9.2.2.2" class="anchored" data-anchor-id="sec-simulateData-prediction">
<span class="header-section-number">9.2.2.2</span> Simulate Data</h4>
<p>For reproducibility, I set the seed below. Using the same seed will yield the same answer every time. There is nothing special about this particular seed.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a></span>
<span id="cb38-3"><a href="#cb38-3"></a>mydataSDT<span class="sc">$</span>testScore <span class="ot">&lt;-</span> mydataSDT<span class="sc">$</span>s100b</span>
<span id="cb38-4"><a href="#cb38-4"></a>mydataSDT <span class="ot">&lt;-</span> mydataSDT <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5"></a>  <span class="fu">mutate</span>(<span class="at">testScoreSimple =</span> <span class="fu">ntile</span>(testScore, <span class="dv">10</span>))</span>
<span id="cb38-6"><a href="#cb38-6"></a></span>
<span id="cb38-7"><a href="#cb38-7"></a>mydataSDT<span class="sc">$</span>predictedProbability <span class="ot">&lt;-</span> </span>
<span id="cb38-8"><a href="#cb38-8"></a>  (mydataSDT<span class="sc">$</span>s100b <span class="sc">-</span> <span class="fu">min</span>(mydataSDT<span class="sc">$</span>s100b, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> </span>
<span id="cb38-9"><a href="#cb38-9"></a>  (<span class="fu">max</span>(mydataSDT<span class="sc">$</span>s100b, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(mydataSDT<span class="sc">$</span>s100b, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb38-10"><a href="#cb38-10"></a>mydataSDT<span class="sc">$</span>continuousOutcome <span class="ot">&lt;-</span> mydataSDT<span class="sc">$</span>testScore <span class="sc">+</span> </span>
<span id="cb38-11"><a href="#cb38-11"></a>  <span class="fu">rnorm</span>(<span class="fu">nrow</span>(mydataSDT), <span class="at">mean =</span> <span class="fl">0.20</span>, <span class="at">sd =</span> <span class="fl">0.20</span>)</span>
<span id="cb38-12"><a href="#cb38-12"></a>mydataSDT<span class="sc">$</span>disorder <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb38-13"><a href="#cb38-13"></a>mydataSDT<span class="sc">$</span>disorder[mydataSDT<span class="sc">$</span>outcome <span class="sc">==</span> <span class="st">"Good"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb38-14"><a href="#cb38-14"></a>mydataSDT<span class="sc">$</span>disorder[mydataSDT<span class="sc">$</span>outcome <span class="sc">==</span> <span class="st">"Poor"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-addMissingData-prediction" class="level4" data-number="9.2.2.3"><h4 data-number="9.2.2.3" class="anchored" data-anchor-id="sec-addMissingData-prediction">
<span class="header-section-number">9.2.2.3</span> Add Missing Data</h4>
<p>Adding missing data to dataframes helps make examples more realistic to real-life data and helps you get in the habit of programming to account for missing data.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>mydataSDT<span class="sc">$</span>testScore[<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>mydataSDT<span class="sc">$</span>disorder[<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">15</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section></section><section id="sec-rocCurve" class="level2" data-number="9.3"><h2 data-number="9.3" class="anchored" data-anchor-id="sec-rocCurve">
<span class="header-section-number">9.3</span> Receiver Operating Characteristic (ROC) Curve</h2>
<p>The <a href="#sec-roc">receiver operating characteristic (ROC) curve</a> shows the combination of <a href="#sec-sensitivity">hit rate</a> (<a href="#sec-sensitivity">sensitivity</a>) and <a href="#sec-falsePositiveRate">false alarm rate</a> (<span class="math inline">\(1 - \text{specificity}\)</span>) at every possible cutoff. It depicts that, as the cutoff increases (i.e., becomes more conservative), <a href="#sec-sensitivity">sensitivity</a> decreases and <a href="#sec-specificity">specificity</a> increases. It also depicts that, as the cutoff decreases (i.e., becomes more liberal), <a href="#sec-sensitivity">sensitivity</a> increases and <a href="#sec-specificity">specificity</a> decreases.</p>
<p><a href="#sec-roc">Receiver operating characteristic (ROC) curves</a> were generated using the <code>pROC</code> package <span class="citation" data-cites="R-pROC">(<a href="references.html#ref-R-pROC" role="doc-biblioref">Robin et al., 2021</a>)</span>. The examples depict ROC curves that demonstrate that the measure is moderately accurate—the measure is more accurate than chance but there remains considerable room for improvement in predictive accuracy.</p>
<section id="sec-empiricalROC" class="level3" data-number="9.3.1"><h3 data-number="9.3.1" class="anchored" data-anchor-id="sec-empiricalROC">
<span class="header-section-number">9.3.1</span> Empirical ROC Curve</h3>
<p>The syntax used to generate an empirical ROC plot is below, and the plot is in <a href="#fig-empiricalROC" class="quarto-xref">Figure&nbsp;<span>9.13</span></a>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>rocCurve <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">data =</span> mydataSDT, <span class="at">response =</span> disorder, <span class="at">predictor =</span> testScore, <span class="at">smooth =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-empiricalROC2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Empirical Receiver Operating Characteristic Curve.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-empiricalROC2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-empiricalROC2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure&nbsp;9.17: Empirical Receiver Operating Characteristic Curve."><img src="prediction_files/figure-html/fig-empiricalROC2-1.png" class="img-fluid figure-img" alt="Empirical Receiver Operating Characteristic Curve." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-empiricalROC2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.17: Empirical Receiver Operating Characteristic Curve.
</figcaption></figure>
</div>
</div>
</div>
<p>An empirical ROC plot with cutoffs overlaid is in <a href="#fig-empiricalROCcutoffs" class="quarto-xref">Figure&nbsp;<span>9.18</span></a>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(<span class="fu">na.omit</span>(mydataSDT[,<span class="fu">c</span>(</span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="st">"testScoreSimple"</span>,<span class="st">"disorder"</span>)])<span class="sc">$</span>testScoreSimple,</span>
<span id="cb41-3"><a href="#cb41-3"></a>  <span class="fu">na.omit</span>(mydataSDT[,<span class="fu">c</span>(<span class="st">"testScoreSimple"</span>,<span class="st">"disorder"</span>)])<span class="sc">$</span>disorder)</span>
<span id="cb41-4"><a href="#cb41-4"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="fu">plot</span>(</span>
<span id="cb41-6"><a href="#cb41-6"></a>  perf,</span>
<span id="cb41-7"><a href="#cb41-7"></a>  <span class="at">print.cutoffs.at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>,</span>
<span id="cb41-8"><a href="#cb41-8"></a>  <span class="at">text.adj =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb41-9"><a href="#cb41-9"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.05</span>))</span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-empiricalROCcutoffs" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Empirical Receiver Operating Characteristic Curve With Cutoffs Overlaid.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-empiricalROCcutoffs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-empiricalROCcutoffs-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figure&nbsp;9.18: Empirical Receiver Operating Characteristic Curve With Cutoffs Overlaid."><img src="prediction_files/figure-html/fig-empiricalROCcutoffs-1.png" class="img-fluid figure-img" alt="Empirical Receiver Operating Characteristic Curve With Cutoffs Overlaid." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-empiricalROCcutoffs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.18: Empirical Receiver Operating Characteristic Curve With Cutoffs Overlaid.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-smoothROC" class="level3" data-number="9.3.2"><h3 data-number="9.3.2" class="anchored" data-anchor-id="sec-smoothROC">
<span class="header-section-number">9.3.2</span> Smooth ROC Curve</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>rocCurveSmooth <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">data =</span> mydataSDT, <span class="at">response =</span> disorder, <span class="at">predictor =</span> testScore, <span class="at">smooth =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">plot</span>(rocCurveSmooth, <span class="at">legacy.axes =</span> <span class="cn">TRUE</span>, <span class="at">print.auc =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-smoothROC2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Smooth Receiver Operating Characteristic Curve. AUC = Area under the receiver operating characteristic curve." data-fig-scap="Smooth Receiver Operating Characteristic Curve.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-smoothROC2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-smoothROC2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Figure&nbsp;9.19: Smooth Receiver Operating Characteristic Curve. AUC = Area under the receiver operating characteristic curve."><img src="prediction_files/figure-html/fig-smoothROC2-1.png" class="img-fluid figure-img" data-fig-scap="Smooth Receiver Operating Characteristic Curve." alt="Smooth Receiver Operating Characteristic Curve. AUC = Area under the receiver operating characteristic curve." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-smoothROC2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.19: Smooth Receiver Operating Characteristic Curve. AUC = Area under the receiver operating characteristic curve.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-youdenJ" class="level3" data-number="9.3.3"><h3 data-number="9.3.3" class="anchored" data-anchor-id="sec-youdenJ">
<span class="header-section-number">9.3.3</span> Youden’s J Statistic</h3>
<p>The threshold at the Youden’s J statistic is the threshold where the test has the maximum combination (i.e., sum) of <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a>: <span class="math inline">\(\text{max}(\text{sensitivity} + \text{specificity} - 1)\)</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>youdenJ <span class="ot">&lt;-</span> <span class="fu">coords</span>(</span>
<span id="cb44-2"><a href="#cb44-2"></a>  rocCurve,</span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="at">x =</span> <span class="st">"best"</span>,</span>
<span id="cb44-4"><a href="#cb44-4"></a>  <span class="at">best.method =</span> <span class="st">"youden"</span>)</span>
<span id="cb44-5"><a href="#cb44-5"></a>youdenJthreshold <span class="ot">&lt;-</span> youdenJ<span class="sc">$</span>threshold</span>
<span id="cb44-6"><a href="#cb44-6"></a>youdenJspecificity <span class="ot">&lt;-</span> youdenJ<span class="sc">$</span>specificity</span>
<span id="cb44-7"><a href="#cb44-7"></a>youdenJsensitivity <span class="ot">&lt;-</span> youdenJ<span class="sc">$</span>sensitivity</span>
<span id="cb44-8"><a href="#cb44-8"></a></span>
<span id="cb44-9"><a href="#cb44-9"></a>youdenJ</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["threshold"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["specificity"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sensitivity"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.205","2":"0.8","3":"0.65"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>For this test, the Youden’s J Statistic is at a threshold of <span class="math inline">\(0.205\)</span>, where sensitivity is <span class="math inline">\(0.65\)</span> and specificity is <span class="math inline">\(0.8\)</span>.</p>
</section><section id="sec-topLeftROC" class="level3" data-number="9.3.4"><h3 data-number="9.3.4" class="anchored" data-anchor-id="sec-topLeftROC">
<span class="header-section-number">9.3.4</span> The point closest to the top-left part of the ROC curve with perfect sensitivity and specificity</h3>
<p>The point closest to the top-left part of the ROC plot with perfect <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a>: <span class="math inline">\(\text{min}[(1 - \text{sensitivity})^2 + (1 - \text{specificity})^2]\)</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>closestTopLeft <span class="ot">&lt;-</span> <span class="fu">coords</span>(</span>
<span id="cb45-2"><a href="#cb45-2"></a>  rocCurve,</span>
<span id="cb45-3"><a href="#cb45-3"></a>  <span class="at">x =</span> <span class="st">"best"</span>,</span>
<span id="cb45-4"><a href="#cb45-4"></a>  <span class="at">best.method =</span> <span class="st">"closest.topleft"</span>)</span>
<span id="cb45-5"><a href="#cb45-5"></a>closestTopLeftthreshold <span class="ot">&lt;-</span> closestTopLeft<span class="sc">$</span>threshold</span>
<span id="cb45-6"><a href="#cb45-6"></a>closestTopLeftspecificity <span class="ot">&lt;-</span> closestTopLeft<span class="sc">$</span>specificity</span>
<span id="cb45-7"><a href="#cb45-7"></a>closestTopLeftsensitivity <span class="ot">&lt;-</span> closestTopLeft<span class="sc">$</span>sensitivity</span>
<span id="cb45-8"><a href="#cb45-8"></a></span>
<span id="cb45-9"><a href="#cb45-9"></a>closestTopLeft</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["threshold"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["specificity"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sensitivity"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.205","2":"0.8","3":"0.65"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>For this test, the combination of <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a> is closest to the top left of the <a href="#sec-roc">ROC plot</a> at a threshold of <span class="math inline">\(0.205\)</span>, where <a href="#sec-sensitivity">sensitivity</a> is <span class="math inline">\(0.65\)</span> and <a href="#sec-specificity">specificity</a> is <span class="math inline">\(0.8\)</span>.</p>
</section></section><section id="sec-predictionAccuracy" class="level2" data-number="9.4"><h2 data-number="9.4" class="anchored" data-anchor-id="sec-predictionAccuracy">
<span class="header-section-number">9.4</span> Prediction Accuracy Across Cutoffs</h2>
<p>There are two primary dimensions of accuracy: (1) <a href="#sec-discrimination">discrimination</a> (e.g., <a href="#sec-sensitivity">sensitivity</a>, <a href="#sec-specificity">specificity</a>, <a href="#sec-auc">area under the ROC curve</a>) and (2) <a href="#sec-calibration">calibration</a>. Some general indexes of accuracy combine <a href="#sec-discrimination">discrimination</a> and <a href="#sec-calibration">calibration</a>, as described in <a href="#sec-generalPredictionAccuracy" class="quarto-xref"><span>Section 9.4.1</span></a>. This section (<a href="#sec-predictionAccuracy" class="quarto-xref"><span>Section 9.4</span></a>) describes indexes of accuracy that span all possible cutoffs. That is, each index of accuracy described in this section provides a single numerical index of accuracy that aggregates the accuracy across all possible cutoffs. Aspects of accuracy at a particular cutoff are described in <a href="#sec-cutoffAccuracy" class="quarto-xref"><span>Section 9.5</span></a>.</p>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>accuracyOverall()</code> function that estimates the prediction accuracy across cutoffs.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">accuracyOverall</span>(</span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="at">predicted =</span> mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="at">actual =</span> mydataSDT<span class="sc">$</span>disorder) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>  t <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>  <span class="fu">round</span>(., <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                               [,1]
ME                            -0.11
MAE                            0.34
MdAE                           0.17
MSE                            0.21
RMSE                           0.46
MPE                            -Inf
MAPE                            Inf
sMAPE                         82.46
MASE                           0.74
RMSLE                          0.30
rsquared                       0.10
rsquaredAsPredictor            0.18
rsquaredAdjAsPredictor         0.17
rsquaredPredictiveAsPredictor  0.12</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">accuracyOverall</span>(</span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="at">predicted =</span> mydataSDT<span class="sc">$</span>testScore, </span>
<span id="cb48-3"><a href="#cb48-3"></a>  <span class="at">actual =</span> mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="at">dropUndefined =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5"></a>  t <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6"></a>  <span class="fu">round</span>(., <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                               [,1]
ME                            -0.11
MAE                            0.34
MdAE                           0.17
MSE                            0.21
RMSE                           0.46
MPE                           59.62
MAPE                          64.97
sMAPE                         82.46
MASE                           0.74
RMSLE                          0.30
rsquared                       0.10
rsquaredAsPredictor            0.18
rsquaredAdjAsPredictor         0.17
rsquaredPredictiveAsPredictor  0.12</code></pre>
</div>
</div>
<section id="sec-generalPredictionAccuracy" class="level3" data-number="9.4.1"><h3 data-number="9.4.1" class="anchored" data-anchor-id="sec-generalPredictionAccuracy">
<span class="header-section-number">9.4.1</span> General Prediction Accuracy</h3>
<p>There are many metrics of general prediction accuracy. When thinking about which metric(s) may be best for a given problem, it is important to consider the purpose of the assessment. The estimates of general prediction accuracy are separated below into <a href="#sec-scaleDependentAccuracy">scale-dependent</a> and <a href="#sec-scaleIndependentAccuracy">scale-independent</a> accuracy estimates.</p>
<section id="sec-scaleDependentAccuracy" class="level4" data-number="9.4.1.1"><h4 data-number="9.4.1.1" class="anchored" data-anchor-id="sec-scaleDependentAccuracy">
<span class="header-section-number">9.4.1.1</span> Scale-Dependent Accuracy Estimates</h4>
<p>The estimates of prediction accuracy described in this section are scale-dependent. These accuracy estimates depend on the unit of measurement and therefore cannot be compared across measures with different scales or across data sets.</p>
<section id="sec-meanError" class="level5" data-number="9.4.1.1.1"><h5 data-number="9.4.1.1.1" class="anchored" data-anchor-id="sec-meanError">
<span class="header-section-number">9.4.1.1.1</span> Mean Error</h5>
<p>Here, “error” (<span class="math inline">\(e\)</span>) is the difference between the predicted and observed value for a given individual (<span class="math inline">\(i\)</span>). Mean error (ME; also known as bias, see <a href="reliability.html#sec-blandAltmanBias" class="quarto-xref"><span>Section 4.5.1.3.2</span></a>) is the mean difference between the predicted and observed values across individuals (<span class="math inline">\(i\)</span>), that is, the mean of the errors across individuals (<span class="math inline">\(e_i\)</span>). Values closer to zero reflect greater accuracy. If mean error is above zero, it indicates that predicted values are, on average, greater than observed values (i.e., over-estimating errors). If mean error is below zero, it indicates that predicted values are, on average, less than observed values (i.e., under-estimating errors). If both over-estimating and under-estimating errors are present, however, they can cancel each other out. As a result, even with a mean error of zero, there can still be considerable error present. Thus, although mean error can be helpful for examining whether predictions systematically under- or over-estimate the actual scores, other forms of accuracy are necessary to examine the <em>extent</em> of error. The formula for mean error is in <a href="#eq-meanError" class="quarto-xref">Equation&nbsp;<span>9.20</span></a>:</p>
<p><span id="eq-meanError"><span class="math display">\[
\begin{aligned}
  \text{mean error} &amp;= \frac{\sum\limits_{i = 1}^n(\text{predicted}_i - \text{observed}_i)}{n} \\
  &amp;= \text{mean}(e_i)
\end{aligned}
\tag{9.20}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>meanError <span class="ot">&lt;-</span> <span class="cf">function</span>(predicted, actual){</span>
<span id="cb50-2"><a href="#cb50-2"></a>  value <span class="ot">&lt;-</span> <span class="fu">mean</span>(predicted <span class="sc">-</span> actual, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="fu">return</span>(value)</span>
<span id="cb50-4"><a href="#cb50-4"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">meanError</span>(mydataSDT<span class="sc">$</span>testScore, mydataSDT<span class="sc">$</span>disorder)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1123636</code></pre>
</div>
</div>
<p>In this case, the mean error is negative, so the predictions systematically under-estimate the actual scores.</p>
</section><section id="sec-meanAbsoluteError" class="level5" data-number="9.4.1.1.2"><h5 data-number="9.4.1.1.2" class="anchored" data-anchor-id="sec-meanAbsoluteError">
<span class="header-section-number">9.4.1.1.2</span> Mean Absolute Error (MAE)</h5>
<p>Mean absolute error (MAE) is the mean of the absolute value of differences between the predicted and observed values across individuals, that is, the mean of the absolute value of errors. Smaller MAE values (closer to zero) reflect greater accuracy. MAE is preferred over <a href="#sec-rootMeanSquaredError">root mean squared error</a> (RMSE) when you want to give equal weight to all errors and when the outliers have considerable impact. The formula for MAE is in <a href="#eq-meanAbsoluteError" class="quarto-xref">Equation&nbsp;<span>9.21</span></a>:</p>
<p><span id="eq-meanAbsoluteError"><span class="math display">\[
\begin{aligned}
  \text{mean absolute error (MAE)} &amp;= \frac{\sum\limits_{i = 1}^n|\text{predicted}_i - \text{observed}_i|}{n} \\
  &amp;= \text{mean}(|e_i|)
\end{aligned}
\tag{9.21}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>meanAbsoluteError <span class="ot">&lt;-</span> <span class="cf">function</span>(predicted, actual){</span>
<span id="cb53-2"><a href="#cb53-2"></a>  value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predicted <span class="sc">-</span> actual), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-3"><a href="#cb53-3"></a>  <span class="fu">return</span>(value)</span>
<span id="cb53-4"><a href="#cb53-4"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">meanAbsoluteError</span>(mydataSDT<span class="sc">$</span>testScore, mydataSDT<span class="sc">$</span>disorder)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3407273</code></pre>
</div>
</div>
</section><section id="sec-meanSquaredError" class="level5" data-number="9.4.1.1.3"><h5 data-number="9.4.1.1.3" class="anchored" data-anchor-id="sec-meanSquaredError">
<span class="header-section-number">9.4.1.1.3</span> Mean Squared Error (MSE)</h5>
<p>Mean squared error (MSE) is the mean of the square of the differences between the predicted and observed values across individuals, that is, the mean of the squared value of errors. Smaller MSE values (closer to zero) reflect greater accuracy. MSE penalizes larger errors more heavily than smaller errors (unlike <a href="#sec-meanAbsoluteError">MAE</a>). However, MSE is sensitive to outliers and can be impacted if the errors are skewed. The formula for MSE is in <a href="#eq-meanSquaredError" class="quarto-xref">Equation&nbsp;<span>9.22</span></a>:</p>
<p><span id="eq-meanSquaredError"><span class="math display">\[
\begin{aligned}
  \text{mean squared error (MSE)} &amp;= \frac{\sum\limits_{i = 1}^n(\text{predicted}_i - \text{observed}_i)^2}{n} \\
  &amp;= \text{mean}(e_i^2)
\end{aligned}
\tag{9.22}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>meanSquaredError <span class="ot">=</span> <span class="cf">function</span>(predicted, actual){</span>
<span id="cb56-2"><a href="#cb56-2"></a>  value <span class="ot">&lt;-</span> <span class="fu">mean</span>((predicted <span class="sc">-</span> actual)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a>  <span class="fu">return</span>(value)</span>
<span id="cb56-4"><a href="#cb56-4"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">meanSquaredError</span>(mydataSDT<span class="sc">$</span>testScore, mydataSDT<span class="sc">$</span>disorder)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2078273</code></pre>
</div>
</div>
</section><section id="sec-rootMeanSquaredError" class="level5" data-number="9.4.1.1.4"><h5 data-number="9.4.1.1.4" class="anchored" data-anchor-id="sec-rootMeanSquaredError">
<span class="header-section-number">9.4.1.1.4</span> Root Mean Squared Error (RMSE)</h5>
<p>Root mean squared error (RMSE) is the square root of the mean of the square of the differences between the predicted and observed values across individuals, that is, the root mean squared value of errors. Smaller RMSE values (closer to zero) reflect greater accuracy. RMSE penalizes larger errors more heavily than smaller errors (unlike <a href="#sec-meanAbsoluteError">MAE</a>). However, RMSE is sensitive to outliers and can be impacted if the errors are skewed. The formula for RMSE is in <a href="#eq-rootMeanSquaredError" class="quarto-xref">Equation&nbsp;<span>9.23</span></a>:</p>
<p><span id="eq-rootMeanSquaredError"><span class="math display">\[
\begin{aligned}
  \text{root mean squared error (RMSE)} &amp;= \sqrt{\frac{\sum\limits_{i = 1}^n(\text{predicted}_i - \text{observed}_i)^2}{n}} \\
  &amp;= \sqrt{\text{mean}(e_i^2)}
\end{aligned}
\tag{9.23}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>rootMeanSquaredError <span class="ot">=</span> <span class="cf">function</span>(predicted, actual){</span>
<span id="cb59-2"><a href="#cb59-2"></a>  value <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predicted <span class="sc">-</span> actual)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb59-3"><a href="#cb59-3"></a>  <span class="fu">return</span>(value)</span>
<span id="cb59-4"><a href="#cb59-4"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">rootMeanSquaredError</span>(mydataSDT<span class="sc">$</span>testScore, mydataSDT<span class="sc">$</span>disorder)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4558808</code></pre>
</div>
</div>
</section></section><section id="sec-scaleIndependentAccuracy" class="level4" data-number="9.4.1.2"><h4 data-number="9.4.1.2" class="anchored" data-anchor-id="sec-scaleIndependentAccuracy">
<span class="header-section-number">9.4.1.2</span> Scale-Independent Accuracy Estimates</h4>
<p>The estimates of prediction accuracy described in this section are intended to be scale-<em>independent</em> (unit-free) so the accuracy estimates can be compared across measures with different scales or across data sets <span class="citation" data-cites="Hyndman2018">(<a href="references.html#ref-Hyndman2018" role="doc-biblioref">Hyndman &amp; Athanasopoulos, 2018</a>)</span>.</p>
<section id="sec-meanPercentageError" class="level5" data-number="9.4.1.2.1"><h5 data-number="9.4.1.2.1" class="anchored" data-anchor-id="sec-meanPercentageError">
<span class="header-section-number">9.4.1.2.1</span> Mean Percentage Error (MPE)</h5>
<p>Mean percentage error (MPE) values closer to zero reflect greater accuracy. The formula for percentage error is in <a href="#eq-percentageError" class="quarto-xref">Equation&nbsp;<span>9.24</span></a>:</p>
<p><span id="eq-percentageError"><span class="math display">\[
\begin{aligned}
  \text{percentage error }(p_i) = \frac{100\% \times (\text{observed}_i - \text{predicted}_i)}{\text{observed}_i}
\end{aligned}
\tag{9.24}\]</span></span></p>
<p>We then take the mean of the percentage errors to get MPE. The formula for MPE is in <a href="#eq-meanPercentageError" class="quarto-xref">Equation&nbsp;<span>9.25</span></a>:</p>
<p><span id="eq-meanPercentageError"><span class="math display">\[
\begin{aligned}
  \text{mean percentage error (MPE)} &amp;= \frac{100\%}{n} \sum\limits_{i = 1}^n \frac{\text{observed}_i - \text{predicted}_i}{\text{observed}_i} \\
  &amp;= \text{mean(percentage error)} \\
  &amp;= \text{mean}(p_i)
\end{aligned}
\tag{9.25}\]</span></span></p>
<p>Note: MPE is undefined when one or more of the observed values equals zero, due to division by zero. I provide the option in the function to drop undefined values so you can still generate an estimate of accuracy despite undefined values, but use this option at your own risk.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>meanPercentageError <span class="ot">=</span> <span class="cf">function</span>(predicted, actual, <span class="at">dropUndefined =</span> <span class="cn">FALSE</span>){</span>
<span id="cb62-2"><a href="#cb62-2"></a>  percentageError <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (actual <span class="sc">-</span> predicted) <span class="sc">/</span> actual</span>
<span id="cb62-3"><a href="#cb62-3"></a>  </span>
<span id="cb62-4"><a href="#cb62-4"></a>  <span class="cf">if</span>(dropUndefined <span class="sc">==</span> <span class="cn">TRUE</span>){</span>
<span id="cb62-5"><a href="#cb62-5"></a>    percentageError[<span class="sc">!</span><span class="fu">is.finite</span>(percentageError)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb62-6"><a href="#cb62-6"></a>  }</span>
<span id="cb62-7"><a href="#cb62-7"></a>  </span>
<span id="cb62-8"><a href="#cb62-8"></a>  value <span class="ot">&lt;-</span> <span class="fu">mean</span>(percentageError, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-9"><a href="#cb62-9"></a>  <span class="fu">return</span>(value)</span>
<span id="cb62-10"><a href="#cb62-10"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="fu">meanPercentageError</span>(</span>
<span id="cb63-2"><a href="#cb63-2"></a>  mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb63-3"><a href="#cb63-3"></a>  mydataSDT<span class="sc">$</span>disorder)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] -Inf</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">meanPercentageError</span>(</span>
<span id="cb65-2"><a href="#cb65-2"></a>  mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb65-3"><a href="#cb65-3"></a>  mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb65-4"><a href="#cb65-4"></a>  <span class="at">dropUndefined =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 59.625</code></pre>
</div>
</div>
</section><section id="sec-meanAbsolutePercentageError" class="level5" data-number="9.4.1.2.2"><h5 data-number="9.4.1.2.2" class="anchored" data-anchor-id="sec-meanAbsolutePercentageError">
<span class="header-section-number">9.4.1.2.2</span> Mean Absolute Percentage Error (MAPE)</h5>
<p>Smaller mean absolute percentage error (MAPE) values (closer to zero) reflect greater accuracy. The formula for MAPE is in <a href="#eq-meanAbsolutePercentageError" class="quarto-xref">Equation&nbsp;<span>9.26</span></a>: MAPE is asymmetric because it overweights underestimates and underweights overestimates. MAPE can be preferable to <a href="#sec-symmetricMeanAbsolutePercentageError">symmetric mean absolute percentage error</a> (sMAPE) if there are no observed values of zero and if you want to emphasize the importance of underestimates (relative to overestimates).</p>
<p><span id="eq-meanAbsolutePercentageError"><span class="math display">\[
\begin{aligned}
  \text{mean absolute percentage error (MAPE)} &amp;= \frac{100\%}{n} \sum\limits_{i = 1}^n \Bigg|\frac{\text{observed}_i - \text{predicted}_i}{\text{observed}_i}\Bigg| \\
  &amp;= \text{mean(|percentage error|)} \\
  &amp;= \text{mean}(|p_i|)
\end{aligned}
\tag{9.26}\]</span></span></p>
<p>Note: MAPE is undefined when one or more of the observed values equals zero, due to division by zero. I provide the option in the function to drop undefined values so you can still generate an estimate of accuracy despite undefined values, but use this option at your own risk.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>meanAbsolutePercentageError <span class="ot">=</span> <span class="cf">function</span>(predicted, actual, <span class="at">dropUndefined =</span> <span class="cn">FALSE</span>){</span>
<span id="cb67-2"><a href="#cb67-2"></a>  percentageError <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (actual <span class="sc">-</span> predicted) <span class="sc">/</span> actual</span>
<span id="cb67-3"><a href="#cb67-3"></a>  </span>
<span id="cb67-4"><a href="#cb67-4"></a>  <span class="cf">if</span>(dropUndefined <span class="sc">==</span> <span class="cn">TRUE</span>){</span>
<span id="cb67-5"><a href="#cb67-5"></a>    percentageError[<span class="sc">!</span><span class="fu">is.finite</span>(percentageError)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb67-6"><a href="#cb67-6"></a>  }</span>
<span id="cb67-7"><a href="#cb67-7"></a>  </span>
<span id="cb67-8"><a href="#cb67-8"></a>  value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(percentageError), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-9"><a href="#cb67-9"></a>  <span class="fu">return</span>(value)</span>
<span id="cb67-10"><a href="#cb67-10"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="fu">meanAbsolutePercentageError</span>(</span>
<span id="cb68-2"><a href="#cb68-2"></a>  mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb68-3"><a href="#cb68-3"></a>  mydataSDT<span class="sc">$</span>disorder)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] Inf</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="fu">meanAbsolutePercentageError</span>(</span>
<span id="cb70-2"><a href="#cb70-2"></a>  mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb70-3"><a href="#cb70-3"></a>  mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb70-4"><a href="#cb70-4"></a>  <span class="at">dropUndefined =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 64.975</code></pre>
</div>
</div>
</section><section id="sec-symmetricMeanAbsolutePercentageError" class="level5" data-number="9.4.1.2.3"><h5 data-number="9.4.1.2.3" class="anchored" data-anchor-id="sec-symmetricMeanAbsolutePercentageError">
<span class="header-section-number">9.4.1.2.3</span> Symmetric Mean Absolute Percentage Error (sMAPE)</h5>
<p>Unlike MAPE, symmetric mean absolute percentage error (sMAPE) is symmetric because it equally weights underestimates and overestimates. Smaller sMAPE values (closer to zero) reflect greater accuracy. The formula for sMAPE is in <a href="#eq-symmetricMeanAbsolutePercentageError" class="quarto-xref">Equation&nbsp;<span>9.27</span></a>:</p>
<p><span id="eq-symmetricMeanAbsolutePercentageError"><span class="math display">\[
\small
\begin{aligned}
  \text{symmetric mean absolute percentage error (sMAPE)} = \frac{100\%}{n} \sum\limits_{i = 1}^n \frac{|\text{predicted}_i - \text{observed}_i|}{|\text{predicted}_i| + |\text{observed}_i|}
\end{aligned}
\tag{9.27}\]</span></span></p>
<p>Note: sMAPE is undefined when one or more of the individuals has a prediction–observed combination such that the sum of the absolute value of the predicted value and the absolute value of the observed value equals zero (<span class="math inline">\(|\text{predicted}_i| + |\text{observed}_i|\)</span>), due to division by zero. I provide the option in the function to drop undefined values so you can still generate an estimate of accuracy despite undefined values, but use this option at your own risk.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>symmetricMeanAbsolutePercentageError <span class="ot">=</span> <span class="cf">function</span>(predicted, actual, <span class="at">dropUndefined =</span> <span class="cn">FALSE</span>){</span>
<span id="cb72-2"><a href="#cb72-2"></a>  relativeError <span class="ot">&lt;-</span> <span class="fu">abs</span>(predicted <span class="sc">-</span> actual)<span class="sc">/</span>(<span class="fu">abs</span>(predicted) <span class="sc">+</span> <span class="fu">abs</span>(actual))</span>
<span id="cb72-3"><a href="#cb72-3"></a>  </span>
<span id="cb72-4"><a href="#cb72-4"></a>  <span class="cf">if</span>(dropUndefined <span class="sc">==</span> <span class="cn">TRUE</span>){</span>
<span id="cb72-5"><a href="#cb72-5"></a>    relativeError[<span class="sc">!</span><span class="fu">is.finite</span>(relativeError)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb72-6"><a href="#cb72-6"></a>  }</span>
<span id="cb72-7"><a href="#cb72-7"></a>  </span>
<span id="cb72-8"><a href="#cb72-8"></a>  value <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">mean</span>(<span class="fu">abs</span>(relativeError), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-9"><a href="#cb72-9"></a>  <span class="fu">return</span>(value)</span>
<span id="cb72-10"><a href="#cb72-10"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="fu">symmetricMeanAbsolutePercentageError</span>(</span>
<span id="cb73-2"><a href="#cb73-2"></a>  mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb73-3"><a href="#cb73-3"></a>  mydataSDT<span class="sc">$</span>disorder)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 82.45553</code></pre>
</div>
</div>
</section><section id="sec-meanAbsoluteScaledErrro" class="level5" data-number="9.4.1.2.4"><h5 data-number="9.4.1.2.4" class="anchored" data-anchor-id="sec-meanAbsoluteScaledErrro">
<span class="header-section-number">9.4.1.2.4</span> Mean Absolute Scaled Error (MASE)</h5>
<p>Mean absolute scaled error (MASE) is described by <span class="citation" data-cites="Hyndman2018">(<a href="references.html#ref-Hyndman2018" role="doc-biblioref">Hyndman &amp; Athanasopoulos, 2018</a>)</span>. Values closer to zero reflect greater accuracy.</p>
<p>The adapted formula for MASE with non-time series data is described <a href="https://stats.stackexchange.com/a/108963/20338">here (https://stats.stackexchange.com/a/108963/20338)</a> (archived at <a href="https://perma.cc/G469-8NAJ" class="uri">https://perma.cc/G469-8NAJ</a>). Scaled errors are calculated using <a href="#eq-scaledError" class="quarto-xref">Equation&nbsp;<span>9.28</span></a>:</p>
<p><span id="eq-scaledError"><span class="math display">\[
\begin{aligned}
  \text{scaled error}(q_i) &amp;= \frac{\text{observed}_i - \text{predicted}_i}{\text{scaling factor}} \\
  &amp;= \frac{\text{observed}_i - \text{predicted}_i}{\frac{1}{n} \sum\limits_{i = 1}^n |\text{observed}_i - \overline{\text{observed}}|}
\end{aligned}
\tag{9.28}\]</span></span></p>
<p>Then, we calculate the mean of the absolute value of the scaled errors to get MASE, as in <a href="#eq-meanAbsoluteScaledError" class="quarto-xref">Equation&nbsp;<span>9.29</span></a>:</p>
<p><span id="eq-meanAbsoluteScaledError"><span class="math display">\[
\begin{aligned}
  \text{mean absolute scaled error (MASE)} &amp;= \frac{1}{n} \sum\limits_{i = 1}^n |q_i| \\
  &amp;= \text{mean(|scaled error|)} \\
  &amp;= \text{mean}(|q_i|)
\end{aligned}
\tag{9.29}\]</span></span></p>
<p>Note: MASE is undefined when the scaling factor is zero, due to division by zero. With non-time series data, the scaling factor is the average of the absolute value of individuals’ observed scores minus the average observed score (<span class="math inline">\(\frac{1}{n} \sum\limits_{i = 1}^n |\text{observed}_i - \overline{\text{observed}}|\)</span>).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>meanAbsoluteScaledError <span class="ot">&lt;-</span> <span class="cf">function</span>(predicted, actual){</span>
<span id="cb75-2"><a href="#cb75-2"></a>  mydata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">na.omit</span>(<span class="fu">cbind</span>(predicted, actual)))</span>
<span id="cb75-3"><a href="#cb75-3"></a>  </span>
<span id="cb75-4"><a href="#cb75-4"></a>  errors <span class="ot">&lt;-</span> mydata<span class="sc">$</span>actual <span class="sc">-</span> mydata<span class="sc">$</span>predicted</span>
<span id="cb75-5"><a href="#cb75-5"></a>  scalingFactor <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(mydata<span class="sc">$</span>actual <span class="sc">-</span> <span class="fu">mean</span>(mydata<span class="sc">$</span>actual)))</span>
<span id="cb75-6"><a href="#cb75-6"></a>  scaledErrors <span class="ot">&lt;-</span> errors<span class="sc">/</span>scalingFactor</span>
<span id="cb75-7"><a href="#cb75-7"></a>  </span>
<span id="cb75-8"><a href="#cb75-8"></a>  value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(scaledErrors))</span>
<span id="cb75-9"><a href="#cb75-9"></a>  <span class="fu">return</span>(value)</span>
<span id="cb75-10"><a href="#cb75-10"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">meanAbsoluteScaledError</span>(mydataSDT<span class="sc">$</span>testScore, mydataSDT<span class="sc">$</span>disorder)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7362143</code></pre>
</div>
</div>
</section><section id="sec-accuracyRatio" class="level5" data-number="9.4.1.2.5"><h5 data-number="9.4.1.2.5" class="anchored" data-anchor-id="sec-accuracyRatio">
<span class="header-section-number">9.4.1.2.5</span> Root Mean Squared Log Error (RMSLE)</h5>
<p>The squared log of the accuracy ratio is described by <span class="citation" data-cites="Tofallis2015">Tofallis (<a href="references.html#ref-Tofallis2015" role="doc-biblioref">2015</a>)</span>. The accuracy ratio is in <a href="#eq-accuracyRatio1" class="quarto-xref">Equation&nbsp;<span>9.30</span></a>:</p>
<p><span id="eq-accuracyRatio1"><span class="math display">\[
\begin{aligned}
  \text{accuracy ratio} &amp;= \frac{\text{predicted}_i}{\text{observed}_i}
\end{aligned}
\tag{9.30}\]</span></span></p>
<p>However, the accuracy ratio is undefined with observed or predicted values of zero, so it is common to modify it by adding 1 to the predictor and denominator, as in <a href="#eq-accuracyRatio2" class="quarto-xref">Equation&nbsp;<span>9.31</span></a>:</p>
<p><span id="eq-accuracyRatio2"><span class="math display">\[
\begin{aligned}
  \text{accuracy ratio} &amp;= \frac{\text{predicted}_i + 1}{\text{observed}_i + 1}
\end{aligned}
\tag{9.31}\]</span></span></p>
<p>Squaring the log values keeps the values positive, such that smaller values (values closer to zero) reflect greater accuracy. Then we take the mean of the squared log values, which keeps the values positive, and calculate the square root of the mean squared log values to put them back on the (pre-squared) log metric. This is known as the root mean squared log error (RMSLE). Division inside the log is equal to subtraction outside the log. So, the formula can be reformulated with the subtraction of two logs, as in <a href="#eq-rootMeanSquaredLogError" class="quarto-xref">Equation&nbsp;<span>9.32</span></a>:</p>
<p><span id="eq-rootMeanSquaredLogError"><span class="math display">\[
\begin{aligned}
  \text{root mean squared log error (RMSLE)} &amp;= \sqrt{\sum\limits_{i = 1}^n log\bigg(\frac{\text{predicted}_i + 1}{\text{observed}_i + 1}\bigg)^2} \\
  &amp;= \sqrt{\text{mean}\Bigg[log\bigg(\frac{\text{predicted}_i + 1}{\text{observed}_i + 1}\bigg)^2\Bigg]} \\
  &amp;= \sqrt{\text{mean}\big[log(\text{accuracy ratio})^2\big]} = \sqrt{\text{mean}\Big\{\big[log(\text{predicted}_i + 1) - log(\text{actual}_i + 1)\big]^2\Big\}}
\end{aligned}
\tag{9.32}\]</span></span></p>
<p>RMSLE can be preferable when the scores have a wide range of values and are skewed. RMSLE can help to reduce the impact of outliers. RMSLE gives more weight to smaller errors in the prediction of small observed values, while also penalizing larger errors in the prediction of larger observed values. It overweights underestimates and underweights overestimates.</p>
<p>There are other variations of prediction accuracy metrics that use the log of the accuracy ratio. One variation makes it similar to median symmetric percentage error <span class="citation" data-cites="Morley2018">(<a href="references.html#ref-Morley2018" role="doc-biblioref">Morley et al., 2018</a>)</span>.</p>
<p>Note: Root mean squared log error is undefined when one or more predicted values or actual values equals -1. When predicted or actual values are -1, this leads to <span class="math inline">\(log(0)\)</span>, which is undefined. I provide the option in the function to drop undefined values so you can still generate an estimate of accuracy despite undefined values, but use this option at your own risk.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>rootMeanSquaredLogError <span class="ot">&lt;-</span> <span class="cf">function</span>(predicted, actual, <span class="at">dropUndefined =</span> <span class="cn">FALSE</span>){</span>
<span id="cb78-2"><a href="#cb78-2"></a>  logError <span class="ot">&lt;-</span> <span class="fu">log</span>(predicted <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">log</span>(actual <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb78-3"><a href="#cb78-3"></a>  </span>
<span id="cb78-4"><a href="#cb78-4"></a>  <span class="cf">if</span>(dropUndefined <span class="sc">==</span> <span class="cn">TRUE</span>){</span>
<span id="cb78-5"><a href="#cb78-5"></a>    logError[<span class="sc">!</span><span class="fu">is.finite</span>(logError)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb78-6"><a href="#cb78-6"></a>  }</span>
<span id="cb78-7"><a href="#cb78-7"></a>  </span>
<span id="cb78-8"><a href="#cb78-8"></a>  value <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(logError<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb78-9"><a href="#cb78-9"></a>  </span>
<span id="cb78-10"><a href="#cb78-10"></a>  <span class="fu">return</span>(value)</span>
<span id="cb78-11"><a href="#cb78-11"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="fu">rootMeanSquaredLogError</span>(</span>
<span id="cb79-2"><a href="#cb79-2"></a>  mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb79-3"><a href="#cb79-3"></a>  mydataSDT<span class="sc">$</span>disorder)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.303727</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">rootMeanSquaredLogError</span>(</span>
<span id="cb81-2"><a href="#cb81-2"></a>  mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb81-3"><a href="#cb81-3"></a>  mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb81-4"><a href="#cb81-4"></a>  <span class="at">dropUndefined =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.303727</code></pre>
</div>
</div>
</section><section id="sec-coefficientOfDetermination" class="level5" data-number="9.4.1.2.6"><h5 data-number="9.4.1.2.6" class="anchored" data-anchor-id="sec-coefficientOfDetermination">
<span class="header-section-number">9.4.1.2.6</span> Coefficient of Determination (<span class="math inline">\(R^2\)</span>)</h5>
<p>The coefficient of determination (<span class="math inline">\(R^2\)</span>) is a general index of accuracy that combines both <a href="#sec-discrimination">discrimination</a> and <a href="#sec-calibration">calibration</a>. It reflects the proportion of variance in the outcome (dependent) variable that is explained by the model predictions: <span class="math inline">\(R^2 = \frac{\text{variance explained in }Y}{\text{total variance in }Y}\)</span>. Larger values indicate greater accuracy. The formula for the coefficient of determination is in <a href="#eq-rSquared" class="quarto-xref">Equation&nbsp;<span>9.33</span></a>:</p>
<p><span id="eq-rSquared"><span class="math display">\[
\begin{aligned}
  R^2 &amp;= 1 - \frac{\sum (y_i - \hat{y}_i)^2}{\sum (y_i - \bar{y})^2} \\
      &amp;= 1 - \frac{SS_{\text{residual}}}{SS_{\text{total}}} \\
      &amp;= 1 - \frac{\text{sum of squared residuals}}{\text{total sum of squares}} \\
      &amp;= \frac{\text{variance explained in }y}{\text{total variance in }y}
\end{aligned}
\tag{9.33}\]</span></span></p>
<p>where <span class="math inline">\(y\)</span> is the outcome variable, <span class="math inline">\(y_i\)</span> is the observed value of the outcome variable for the <span class="math inline">\(i\)</span>th observation, <span class="math inline">\(\hat{y}_i\)</span> is the model predicted value for the <span class="math inline">\(i\)</span>th observation, and <span class="math inline">\(\bar{y}\)</span> is the mean of the observed values of the outcome variable. The total sum of squares is an index of the total variation in the outcome variable.</p>
<p><span class="math inline">\(R^2\)</span> is commonly estimated in multiple regression, in which multiple predictors are allowed to predict one outcome. Multiple regression can be conceptualized with overlapping circles in what is called a <a href="https://www.andrewheiss.com/blog/2021/08/21/r2-euler">Ballantine graph</a> (archived at <a href="https://perma.cc/C7CU-KFVG" class="uri">https://perma.cc/C7CU-KFVG</a>). <span class="math inline">\(R^2\)</span> in multiple regression is depicted conceptually with a Ballantine graph in <a href="#fig-multipleRegressionRSquared" class="quarto-xref">Figure&nbsp;<span>9.20</span></a>.</p>
<div id="fig-multipleRegressionRSquared" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Conceptual Depiction of Proportion of Variance Explained ($R^2$) in an Outcome Variable ($Y$) by Multiple Predictors ($X1$ and $X2$) in Multiple Regression. The size of each circle represents the variable's variance. The proportion of variance in $Y$ that is explained by the predictors is depicted by the areas in orange. The dark orange space ($G$) is where multiple predictors explain overlapping variance in the outcome. Overlapping variance that is explained in the outcome ($G$) will not be recovered in the regression coefficients when both predictors are included in the regression model.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-multipleRegressionRSquared-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/multipleRegressionRSquared.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Figure&nbsp;9.20: Conceptual Depiction of Proportion of Variance Explained (R^2) in an Outcome Variable (Y) by Multiple Predictors (X1 and X2) in Multiple Regression. The size of each circle represents the variable’s variance. The proportion of variance in Y that is explained by the predictors is depicted by the areas in orange. The dark orange space (G) is where multiple predictors explain overlapping variance in the outcome. Overlapping variance that is explained in the outcome (G) will not be recovered in the regression coefficients when both predictors are included in the regression model."><img src="images/multipleRegressionRSquared.png" class="img-fluid figure-img" style="width:50.0%" alt="Conceptual Depiction of Proportion of Variance Explained ($R^2$) in an Outcome Variable ($Y$) by Multiple Predictors ($X1$ and $X2$) in Multiple Regression. The size of each circle represents the variable's variance. The proportion of variance in $Y$ that is explained by the predictors is depicted by the areas in orange. The dark orange space ($G$) is where multiple predictors explain overlapping variance in the outcome. Overlapping variance that is explained in the outcome ($G$) will not be recovered in the regression coefficients when both predictors are included in the regression model."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-multipleRegressionRSquared-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.20: Conceptual Depiction of Proportion of Variance Explained (<span class="math inline">\(R^2\)</span>) in an Outcome Variable (<span class="math inline">\(Y\)</span>) by Multiple Predictors (<span class="math inline">\(X1\)</span> and <span class="math inline">\(X2\)</span>) in Multiple Regression. The size of each circle represents the variable’s variance. The proportion of variance in <span class="math inline">\(Y\)</span> that is explained by the predictors is depicted by the areas in orange. The dark orange space (<span class="math inline">\(G\)</span>) is where multiple predictors explain overlapping variance in the outcome. Overlapping variance that is explained in the outcome (<span class="math inline">\(G\)</span>) will not be recovered in the regression coefficients when both predictors are included in the regression model.
</figcaption></figure>
</div>
<p><span class="math inline">\(R^2\)</span>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(</span>
<span id="cb83-2"><a href="#cb83-2"></a>  disorder <span class="sc">~</span> testScore,</span>
<span id="cb83-3"><a href="#cb83-3"></a>  <span class="at">data =</span> mydataSDT))<span class="sc">$</span>r.squared</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1778746</code></pre>
</div>
</div>
<p>The predictor (<code>testScore</code>) explains <span class="math inline">\(17.79\)</span>% of the variance <span class="math inline">\((R^2 = .1779)\)</span> in the outcome (<code>disorder</code> status).</p>
<p>The coefficient of determination typically ranges from 0 to 1, but it can be negative. A negative coefficient of determination indicates that the predicted values are less accurate than using the mean of the actual values as the predicted values (i.e., predicting the mean of the observed values for every case).</p>
<p>An issue with <span class="math inline">\(R^2\)</span> is that it can be artificially inflated by adding more predictors to the model, even if those predictors do not improve the model fit. <span class="math inline">\(R^2\)</span> never decreases when adding predictors to a model, even if the predictors do not provide any predictive power. Thus, to account for the number of predictors in the model, we can use <a href="#sec-adjustedRsquared">adjusted <span class="math inline">\(R^2\)</span></a>.</p>
<section id="sec-adjustedRsquared" class="level6" data-number="9.4.1.2.6.1"><h6 data-number="9.4.1.2.6.1" class="anchored" data-anchor-id="sec-adjustedRsquared">
<span class="header-section-number">9.4.1.2.6.1</span> Adjusted <span class="math inline">\(R^2\)</span> (<span class="math inline">\(R^2_{adj}\)</span>)</h6>
<p>Adjusted <span class="math inline">\(R^2\)</span> is similar to the <a href="#sec-coefficientOfDetermination">coefficient of determination</a>, but it accounts for the number of predictors included in the regression model to penalize <a href="validity.html#sec-overfitting">overfitting</a>. Specifically, adjusted <span class="math inline">\(R^2\)</span> penalizes the number of predictors in the model. Adjusted <span class="math inline">\(R^2\)</span> reflects the proportion of variance in the outcome (dependent) variable that is explained by the model predictions over and above what would be expected to be accounted for by chance, given the number of predictors in the model. Thus, adjusted <span class="math inline">\(R^2\)</span> will increase only if the new predictor improves the model (i.e., explains additional variance in the outcome variable) more than would be expected by chance. Larger values indicate greater accuracy. The formula for adjusted <span class="math inline">\(R^2\)</span> is in <a href="#eq-adjustedRSquared" class="quarto-xref">Equation&nbsp;<span>9.34</span></a>:</p>
<p><span id="eq-adjustedRSquared"><span class="math display">\[
R^2_{adj} = 1 - (1 - R^2) \frac{n - 1}{n - p - 1}
\tag{9.34}\]</span></span></p>
<p>where <span class="math inline">\(p\)</span> is the number of predictors in the model, and <span class="math inline">\(n\)</span> is the sample size.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(</span>
<span id="cb85-2"><a href="#cb85-2"></a>  disorder <span class="sc">~</span> testScore,</span>
<span id="cb85-3"><a href="#cb85-3"></a>  <span class="at">data =</span> mydataSDT))<span class="sc">$</span>adj.r.squared</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1702623</code></pre>
</div>
</div>
<p>Adjusted <span class="math inline">\(R^2\)</span> is described further in <a href="#sec-pseudoPrediction" class="quarto-xref"><span>Section 9.9</span></a>.</p>
</section><section id="sec-predictiveRsquared" class="level6" data-number="9.4.1.2.6.2"><h6 data-number="9.4.1.2.6.2" class="anchored" data-anchor-id="sec-predictiveRsquared">
<span class="header-section-number">9.4.1.2.6.2</span> Predictive <span class="math inline">\(R^2\)</span>
</h6>
<p>Predictive <span class="math inline">\(R^2\)</span> is described here: <a href="https://tomhopper.me/2014/05/16/can-we-do-better-than-r-squared/" class="uri">https://tomhopper.me/2014/05/16/can-we-do-better-than-r-squared/</a> (archived at <a href="https://perma.cc/BK8J-HFUK" class="uri">https://perma.cc/BK8J-HFUK</a>) and <a href="https://mfatihtuzen.netlify.app/posts/2025-04-30_rsquared/" class="uri">https://mfatihtuzen.netlify.app/posts/2025-04-30_rsquared/</a> (archived at <a href="https://perma.cc/EPP8-VG23" class="uri">https://perma.cc/EPP8-VG23</a>). Predictive <span class="math inline">\(R^2\)</span> penalizes <a href="validity.html#sec-overfitting">overfitting</a>, unlike traditional <span class="math inline">\(R^2\)</span>. Larger values indicate greater accuracy. The formula for predictive <span class="math inline">\(R^2\)</span> is in <a href="#eq-predictiveRSquared" class="quarto-xref">Equation&nbsp;<span>9.35</span></a>:</p>
<p><span id="eq-predictiveRSquared"><span class="math display">\[
R^2_{pred} = 1 - \frac{\text{PRESS}}{\text{SS}_\text{total}}
\tag{9.35}\]</span></span></p>
<p>where PRESS is the predictive residual sum of squares, and <span class="math inline">\(\text{SS}_\text{total}\)</span> is the total sum of squares.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="co">#predictive residual sum of squares (PRESS)</span></span>
<span id="cb87-2"><a href="#cb87-2"></a>PRESS <span class="ot">&lt;-</span> <span class="cf">function</span>(linear.model) {</span>
<span id="cb87-3"><a href="#cb87-3"></a>  <span class="co">#calculate the predictive residuals</span></span>
<span id="cb87-4"><a href="#cb87-4"></a>  pr <span class="ot">&lt;-</span> <span class="fu">residuals</span>(linear.model)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">lm.influence</span>(linear.model)<span class="sc">$</span>hat)</span>
<span id="cb87-5"><a href="#cb87-5"></a>  <span class="co">#calculate the PRESS</span></span>
<span id="cb87-6"><a href="#cb87-6"></a>  PRESS <span class="ot">&lt;-</span> <span class="fu">sum</span>(pr<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb87-7"><a href="#cb87-7"></a>  </span>
<span id="cb87-8"><a href="#cb87-8"></a>  <span class="fu">return</span>(PRESS)</span>
<span id="cb87-9"><a href="#cb87-9"></a>}</span>
<span id="cb87-10"><a href="#cb87-10"></a></span>
<span id="cb87-11"><a href="#cb87-11"></a>predictiveRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(predicted, actual){</span>
<span id="cb87-12"><a href="#cb87-12"></a>  <span class="co">#fit linear model</span></span>
<span id="cb87-13"><a href="#cb87-13"></a>  linear.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(actual <span class="sc">~</span> predicted)</span>
<span id="cb87-14"><a href="#cb87-14"></a>  </span>
<span id="cb87-15"><a href="#cb87-15"></a>  <span class="co">#use anova() to get the sum of squares for the linear model</span></span>
<span id="cb87-16"><a href="#cb87-16"></a>  lm.anova <span class="ot">&lt;-</span> <span class="fu">anova</span>(linear.model)</span>
<span id="cb87-17"><a href="#cb87-17"></a>  </span>
<span id="cb87-18"><a href="#cb87-18"></a>  <span class="co">#calculate the total sum of squares</span></span>
<span id="cb87-19"><a href="#cb87-19"></a>  tss <span class="ot">&lt;-</span> <span class="fu">sum</span>(lm.anova<span class="sc">$</span><span class="st">'Sum Sq'</span>)</span>
<span id="cb87-20"><a href="#cb87-20"></a>  </span>
<span id="cb87-21"><a href="#cb87-21"></a>  <span class="co">#calculate the predictive R^2</span></span>
<span id="cb87-22"><a href="#cb87-22"></a>  value <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">PRESS</span>(linear.model)<span class="sc">/</span>(tss)</span>
<span id="cb87-23"><a href="#cb87-23"></a>  </span>
<span id="cb87-24"><a href="#cb87-24"></a>  <span class="fu">return</span>(value)</span>
<span id="cb87-25"><a href="#cb87-25"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="fu">predictiveRSquared</span>(mydataSDT<span class="sc">$</span>testScore, mydataSDT<span class="sc">$</span>disorder)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1190976</code></pre>
</div>
</div>
<p>It is preferable to examine predictive <span class="math inline">\(R^2\)</span> using new data that the model was not trained on—i.e., cross-validation, either in an independent sample (i.e., external cross-validation) or in a hold-out sample (i.e., internal cross-validation on test data).</p>
<p>For example, here is an example of estimating predictive <span class="math inline">\(R^2\)</span> with 10-fold cross-validation using the <code>caret</code> package <span class="citation" data-cites="R-caret">(<a href="references.html#ref-R-caret" role="doc-biblioref">Kuhn, 2022</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb90-2"><a href="#cb90-2"></a></span>
<span id="cb90-3"><a href="#cb90-3"></a><span class="co"># Set up 10-fold cross-validation</span></span>
<span id="cb90-4"><a href="#cb90-4"></a>train_control <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">trainControl</span>(</span>
<span id="cb90-5"><a href="#cb90-5"></a>  <span class="at">method =</span> <span class="st">"cv"</span>,</span>
<span id="cb90-6"><a href="#cb90-6"></a>  <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb90-7"><a href="#cb90-7"></a></span>
<span id="cb90-8"><a href="#cb90-8"></a><span class="co"># Fit the model with cross-validation</span></span>
<span id="cb90-9"><a href="#cb90-9"></a>model_cv <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(</span>
<span id="cb90-10"><a href="#cb90-10"></a>  testScore <span class="sc">~</span> disorder,</span>
<span id="cb90-11"><a href="#cb90-11"></a>  <span class="at">data =</span> mydataSDT,</span>
<span id="cb90-12"><a href="#cb90-12"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb90-13"><a href="#cb90-13"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb90-14"><a href="#cb90-14"></a>  <span class="at">trControl =</span> train_control,</span>
<span id="cb90-15"><a href="#cb90-15"></a>  <span class="at">metric =</span> <span class="st">"Rsquared"</span>)</span>
<span id="cb90-16"><a href="#cb90-16"></a></span>
<span id="cb90-17"><a href="#cb90-17"></a><span class="co"># View R-squared across the folds</span></span>
<span id="cb90-18"><a href="#cb90-18"></a>model_cv<span class="sc">$</span>results<span class="sc">$</span>Rsquared</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2727232</code></pre>
</div>
</div>
<p>Here is an example of estimating predictive <span class="math inline">\(R^2\)</span> with a training and testing data set using the <code>caret</code> package <span class="citation" data-cites="R-caret">(<a href="references.html#ref-R-caret" role="doc-biblioref">Kuhn, 2022</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb92-2"><a href="#cb92-2"></a></span>
<span id="cb92-3"><a href="#cb92-3"></a>inTrain <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createDataPartition</span>(</span>
<span id="cb92-4"><a href="#cb92-4"></a>  <span class="at">y =</span> <span class="fu">as.factor</span>(mydataSDT<span class="sc">$</span>disorder),</span>
<span id="cb92-5"><a href="#cb92-5"></a>  <span class="at">p =</span> .<span class="dv">75</span>, <span class="co"># the proportion of data for the training data set</span></span>
<span id="cb92-6"><a href="#cb92-6"></a>  <span class="at">list =</span> <span class="cn">FALSE</span></span>
<span id="cb92-7"><a href="#cb92-7"></a>)</span>
<span id="cb92-8"><a href="#cb92-8"></a></span>
<span id="cb92-9"><a href="#cb92-9"></a>training <span class="ot">&lt;-</span> mydataSDT[ inTrain,]</span>
<span id="cb92-10"><a href="#cb92-10"></a>testing  <span class="ot">&lt;-</span> mydataSDT[<span class="sc">-</span>inTrain,]</span>
<span id="cb92-11"><a href="#cb92-11"></a></span>
<span id="cb92-12"><a href="#cb92-12"></a>training_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb92-13"><a href="#cb92-13"></a>  testScore <span class="sc">~</span> disorder,</span>
<span id="cb92-14"><a href="#cb92-14"></a>  <span class="at">data =</span> training)</span>
<span id="cb92-15"><a href="#cb92-15"></a></span>
<span id="cb92-16"><a href="#cb92-16"></a>testing_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb92-17"><a href="#cb92-17"></a>  training_model,</span>
<span id="cb92-18"><a href="#cb92-18"></a>  <span class="at">newdata =</span> testing)</span>
<span id="cb92-19"><a href="#cb92-19"></a></span>
<span id="cb92-20"><a href="#cb92-20"></a><span class="fu">accuracyOverall</span>(</span>
<span id="cb92-21"><a href="#cb92-21"></a>  <span class="at">predicted =</span> testing_predictions,</span>
<span id="cb92-22"><a href="#cb92-22"></a>  <span class="at">actual =</span> testing<span class="sc">$</span>disorder)<span class="sc">$</span>rsquared</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4415453</code></pre>
</div>
</div>
</section></section></section></section><section id="sec-discrimination" class="level3" data-number="9.4.2"><h3 data-number="9.4.2" class="anchored" data-anchor-id="sec-discrimination">
<span class="header-section-number">9.4.2</span> Discrimination</h3>
<p>When dealing with a categorical outcome, discrimination is the ability to separate events from non-events. When dealing with a continuous outcome, discrimination is the strength of the association between the predictor and the outcome. Aspects of <a href="#sec-discrimination">discrimination</a> at a particular cutoff (e.g., <a href="#sec-sensitivity">sensitivity</a>, <a href="#sec-specificity">specificity</a>) are described in <a href="#sec-cutoffAccuracy" class="quarto-xref"><span>Section 9.5</span></a>.</p>
<section id="sec-aucROC" class="level4" data-number="9.4.2.1"><h4 data-number="9.4.2.1" class="anchored" data-anchor-id="sec-aucROC">
<span class="header-section-number">9.4.2.1</span> Area under the ROC curve (AUC)</h4>
<p>The <a href="#sec-auc">area under the ROC curve (AUC)</a> is a general index of discrimination accuracy for a categorical outcome. It is also called the concordance (<span class="math inline">\(c\)</span>) statistic. Larger values reflect greater <a href="#sec-discrimination">discrimination accuracy</a>. <a href="#sec-auc">AUC</a> was estimated using the <code>pROC</code> package <span class="citation" data-cites="R-pROC">(<a href="references.html#ref-R-pROC" role="doc-biblioref">Robin et al., 2021</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>rocCurve<span class="sc">$</span>auc</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.7312</code></pre>
</div>
</div>
</section><section id="sec-CPA" class="level4" data-number="9.4.2.2"><h4 data-number="9.4.2.2" class="anchored" data-anchor-id="sec-CPA">
<span class="header-section-number">9.4.2.2</span> Coefficient of Predictive Ability (CPA)</h4>
<p>The coefficient of predictive ability (CPA) is a generalization of <a href="#sec-auc">AUC</a> to handle non-binary outcomes including ordinal and continuous outcomes <span class="citation" data-cites="Gneiting2021">(<a href="references.html#ref-Gneiting2021" role="doc-biblioref">Gneiting &amp; Walz, 2021</a>)</span>. Larger values reflect greater accuracy. It was calculated using the <code>uroc</code> package <span class="citation" data-cites="Gneiting2021">(<a href="references.html#ref-Gneiting2021" role="doc-biblioref">Gneiting &amp; Walz, 2021</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>cpaNoMissing <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(</span>
<span id="cb96-2"><a href="#cb96-2"></a>  mydataSDT[,<span class="fu">c</span>(<span class="st">"testScore"</span>,<span class="st">"continuousOutcome"</span>)])</span>
<span id="cb96-3"><a href="#cb96-3"></a></span>
<span id="cb96-4"><a href="#cb96-4"></a><span class="fu">cpa</span>(</span>
<span id="cb96-5"><a href="#cb96-5"></a>  <span class="at">response =</span> cpaNoMissing<span class="sc">$</span>continuousOutcome,</span>
<span id="cb96-6"><a href="#cb96-6"></a>  <span class="at">predictor =</span> cpaNoMissing<span class="sc">$</span>testScore)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8380923</code></pre>
</div>
</div>
</section><section id="sec-spearmanRho" class="level4" data-number="9.4.2.3"><h4 data-number="9.4.2.3" class="anchored" data-anchor-id="sec-spearmanRho">
<span class="header-section-number">9.4.2.3</span> Spearman’s Rho (<span class="math inline">\(\rho\)</span>) Rank Correlation</h4>
<p>When the coefficient of predictive ability is applied to an ordinal or continuous outcome, it is linearly related to Spearman’s rho (<span class="math inline">\(\rho\)</span>) rank correlation <span class="citation" data-cites="Gneiting2021">(<a href="references.html#ref-Gneiting2021" role="doc-biblioref">Gneiting &amp; Walz, 2021</a>)</span>. Larger values reflect greater accuracy. Spearman’s rho was estimated in the <code>rms</code> package <span class="citation" data-cites="R-rms">(<a href="references.html#ref-R-rms" role="doc-biblioref">Harrell, Jr., 2021</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="fu">cor</span>(</span>
<span id="cb98-2"><a href="#cb98-2"></a>  <span class="at">x =</span> mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb98-3"><a href="#cb98-3"></a>  <span class="at">y =</span> mydataSDT<span class="sc">$</span>continuousOutcome,</span>
<span id="cb98-4"><a href="#cb98-4"></a>  <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>,</span>
<span id="cb98-5"><a href="#cb98-5"></a>  <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6768502</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="fu">orm</span>(</span>
<span id="cb100-2"><a href="#cb100-2"></a>  continuousOutcome <span class="sc">~</span> testScore,</span>
<span id="cb100-3"><a href="#cb100-3"></a>  <span class="at">data =</span> mydataSDT)<span class="sc">$</span>stats[<span class="st">"rho"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      rho 
0.6768502 </code></pre>
</div>
</div>
</section><section id="sec-somersD" class="level4" data-number="9.4.2.4"><h4 data-number="9.4.2.4" class="anchored" data-anchor-id="sec-somersD">
<span class="header-section-number">9.4.2.4</span> Somers’ <span class="math inline">\(D_{xy}\)</span> Rank Correlation</h4>
<p>Somers <span class="math inline">\(D_{xy}\)</span> is an index of <a href="#sec-discrimination">discrimination</a> for an ordinal outcome <span class="citation" data-cites="Harrell2015">(<a href="references.html#ref-Harrell2015" role="doc-biblioref">Harrell, 2015</a>)</span>. Larger values reflect greater accuracy. Somers’ <span class="math inline">\(D_{xy}\)</span> was estimated in the <code>rms</code> package <span class="citation" data-cites="R-rms">(<a href="references.html#ref-R-rms" role="doc-biblioref">Harrell, Jr., 2021</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="fu">lrm</span>(</span>
<span id="cb102-2"><a href="#cb102-2"></a>  continuousOutcome <span class="sc">~</span> testScore,</span>
<span id="cb102-3"><a href="#cb102-3"></a>  <span class="at">data =</span> mydataSDT)<span class="sc">$</span>stats[<span class="st">"Dxy"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      Dxy 
0.4977887 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a>rms<span class="sc">::</span><span class="fu">validate</span>(<span class="fu">lrm</span>(</span>
<span id="cb104-2"><a href="#cb104-2"></a>  continuousOutcome <span class="sc">~</span> testScore,</span>
<span id="cb104-3"><a href="#cb104-3"></a>  <span class="at">data =</span> mydataSDT,</span>
<span id="cb104-4"><a href="#cb104-4"></a>  <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb104-5"><a href="#cb104-5"></a>  <span class="at">y =</span> <span class="cn">TRUE</span>),</span>
<span id="cb104-6"><a href="#cb104-6"></a>  <span class="at">group =</span> mydataSDT<span class="sc">$</span>continuousOutcome)[<span class="st">"Dxy"</span>,<span class="st">"index.corrected"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4977887</code></pre>
</div>
</div>
</section><section id="sec-kendallTau" class="level4" data-number="9.4.2.5"><h4 data-number="9.4.2.5" class="anchored" data-anchor-id="sec-kendallTau">
<span class="header-section-number">9.4.2.5</span> Kendall’s Tau-a (<span class="math inline">\(\tau_A\)</span>) Rank Correlation</h4>
<p>Kendall’s tau-a (<span class="math inline">\(\tau_A\)</span>) is an index of the <a href="#sec-discrimination">discrimination</a> for an ordinal outcome <span class="citation" data-cites="Harrell2015">(<a href="references.html#ref-Harrell2015" role="doc-biblioref">Harrell, 2015</a>)</span>. Larger values reflect greater accuracy. Kendall’s tau-a was estimated in the <code>rms</code> package <span class="citation" data-cites="R-rms">(<a href="references.html#ref-R-rms" role="doc-biblioref">Harrell, Jr., 2021</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="fu">cor</span>(</span>
<span id="cb106-2"><a href="#cb106-2"></a>  <span class="at">x =</span> mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb106-3"><a href="#cb106-3"></a>  <span class="at">y =</span> mydataSDT<span class="sc">$</span>continuousOutcome,</span>
<span id="cb106-4"><a href="#cb106-4"></a>  <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>,</span>
<span id="cb106-5"><a href="#cb106-5"></a>  <span class="at">method =</span> <span class="st">"kendall"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5050378</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="fu">lrm</span>(continuousOutcome <span class="sc">~</span> testScore,</span>
<span id="cb108-2"><a href="#cb108-2"></a>    <span class="at">data =</span> mydataSDT)<span class="sc">$</span>stats[<span class="st">"Tau-a"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>    Tau-a 
0.4977887 </code></pre>
</div>
</div>
</section><section id="sec-concordanceProbability" class="level4" data-number="9.4.2.6"><h4 data-number="9.4.2.6" class="anchored" data-anchor-id="sec-concordanceProbability">
<span class="header-section-number">9.4.2.6</span> <span class="math inline">\(c\)</span> Index</h4>
<p>The <span class="math inline">\(c\)</span> index, also called the concordance probability, is a generalization of the area under the <a href="#sec-roc">ROC curve</a> that applies to a continuous outcome <span class="citation" data-cites="Harrell2015">(<a href="references.html#ref-Harrell2015" role="doc-biblioref">Harrell, 2015</a>)</span>. The <span class="math inline">\(c\)</span> index is the proportion of all pairs of predicted-actual values whose actual value can be ordered such that the pair with the higher predicted value is the one who had the higher actual value. Larger values reflect greater accuracy. The Brown–Hollander–Korwar non-parametric test of association was estimated in the <code>rms</code> package <span class="citation" data-cites="R-rms">(<a href="references.html#ref-R-rms" role="doc-biblioref">Harrell, Jr., 2021</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="fu">lrm</span>(</span>
<span id="cb110-2"><a href="#cb110-2"></a>  continuousOutcome <span class="sc">~</span> testScore,</span>
<span id="cb110-3"><a href="#cb110-3"></a>  <span class="at">data =</span> mydataSDT)<span class="sc">$</span>stats[<span class="st">"C"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>        C 
0.7488943 </code></pre>
</div>
</div>
</section><section id="sec-standardizedRegressionCoefficient" class="level4" data-number="9.4.2.7"><h4 data-number="9.4.2.7" class="anchored" data-anchor-id="sec-standardizedRegressionCoefficient">
<span class="header-section-number">9.4.2.7</span> Effect Size (<span class="math inline">\(\beta\)</span>) of Regression</h4>
<p>The effect size of a predictor, i.e., the standardized regression coefficient is called a beta (<span class="math inline">\(\beta\)</span>) coefficient, is a general index of <a href="#sec-discrimination">discrimination accuracy</a> for a continuous outcome. Larger values reflect greater accuracy. We can obtain standardized regression coefficients by standardizing the predictors and outcome using the <code><a href="https://rdrr.io/r/base/scale.html">scale()</a></code> function in R.</p>
<p><span class="math inline">\(\beta\)</span>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="fu">lm</span>(</span>
<span id="cb112-2"><a href="#cb112-2"></a>  <span class="fu">scale</span>(continuousOutcome) <span class="sc">~</span> <span class="fu">scale</span>(testScore),</span>
<span id="cb112-3"><a href="#cb112-3"></a>  <span class="at">data =</span> mydataSDT)<span class="sc">$</span>coef[<span class="st">"scale(testScore)"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>scale(testScore) 
       0.8284925 </code></pre>
</div>
</div>
</section></section><section id="sec-calibration" class="level3" data-number="9.4.3"><h3 data-number="9.4.3" class="anchored" data-anchor-id="sec-calibration">
<span class="header-section-number">9.4.3</span> Calibration</h3>
<p>When dealing with a categorical outcome, calibration is the degree to which a probabilistic estimate of an event reflects the true underlying probability of the event. When dealing with a continuous outcome, calibration is the degree to which the predicted values are close in value to the outcome values. The importance of examining calibration (in addition to <a href="#sec-discrimination">discrimination</a>) is described by <span class="citation" data-cites="Lindhiem2020">Lindhiem et al. (<a href="references.html#ref-Lindhiem2020" role="doc-biblioref">2020</a>)</span>.</p>
<p>Calibration came to be considered a central aspect of weather forecast accuracy. For instance, on the days that the meteorologist says there is a 60% chance of rain, it should rain about 60% of the time. Through improvements in scientific understanding of weather systems, rain forecasts have become more accurate. Meteorologists produce “<a href="https://www.bbc.com/news/articles/cwy1epz58pyo">ensemble forecasts</a>”, where they run many different models (archived at <a href="https://perma.cc/248N-9CW5" class="uri">https://perma.cc/248N-9CW5</a>). If all of the models predict a similar outcome (e.g., no rain), the metereologists have greater confidence in the forecast. However, if the models predict different outcomes (e.g., some models predict rain and others predict no rain), the meteorologists have less confidence in the forecast, which is why the meteorologists might predict a “10% chance of rain”.</p>
<p>With these advancements, rain forecasts from the National Weather Service are well calibrated <a href="#fig-calibrationNWS" class="quarto-xref">see&nbsp;<span>9.22</span></a>. However, forecasts of rain may be exaggerated by local TV meteorologists to boost ratings <span class="citation" data-cites="Silver2012">(<a href="references.html#ref-Silver2012" role="doc-biblioref">Silver, 2012</a>)</span>. Interestingly, rain forecasts from The Weather Channel are somewhat miscalibrated under certain conditions. For instance, on days when they forecast a 20% chance of rain, the actual chance of rain is around 5% <a href="#fig-calibrationWeatherChannel" class="quarto-xref">see&nbsp;<span>9.21</span></a>. However, this miscalibration is deliberate. People tend to be more angry when the meteorologist says it will not rain when it actually does (<a href="#sec-falseNegative">false negative</a>) compared to when the meteorologist says it will rain when it actually does not (<a href="#sec-falsePositive">false positive</a>). As <span class="citation" data-cites="Silver2012">Silver (<a href="references.html#ref-Silver2012" role="doc-biblioref">2012</a>)</span> notes, “If it rains when it isn’t supposed to, [people] curse the weatherman for ruining their picnic, whereas an unexpectedly sunny day is taken as a serendipitous bonus. It isn’t good science, but as Dr.&nbsp;Rose at The Weather Channel acknowledged to [Mr.&nbsp;Silver]: ‘If the forecast was objective, if it has zero <a href="#sec-sdt">bias</a> in precipitation, we’d probably be in trouble.’” (p.&nbsp;135).</p>
<div id="fig-calibrationWeatherChannel" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Calibration Plot Of Same-Day Probability Of Precipitation (PoP) Forecasts From The Weather Channel. The plot depicts that the rain forecasts are generally well calibrated, but shows some miscalibration. For instance, the forecasted probability of rain is lower than the actual probability of rain when the forecasted probability of rain is 20%. (Figure reprinted from @Bickel2008, Figure 2, p. 4872. Bickel, J. E., &amp; Kim, S. D. (2008). Verification of The Weather Channel probability of precipitation forecasts. *Monthly Weather Review*, *136*(12), 4867–4881. doi: <https://doi.org/10.1175/2008MWR2547.1> Copyright (c) American Meteorological Society. Used with permission.)">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-calibrationWeatherChannel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/calibrationTWC.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Figure&nbsp;9.21: Calibration Plot Of Same-Day Probability Of Precipitation (PoP) Forecasts From The Weather Channel. The plot depicts that the rain forecasts are generally well calibrated, but shows some miscalibration. For instance, the forecasted probability of rain is lower than the actual probability of rain when the forecasted probability of rain is 20%. (Figure reprinted from @Bickel2008, Figure 2, p.&nbsp;4872. Bickel, J. E., &amp; Kim, S. D. (2008). Verification of The Weather Channel probability of precipitation forecasts. Monthly Weather Review, 136(12), 4867–4881. doi: https://doi.org/10.1175/2008MWR2547.1 Copyright (c) American Meteorological Society. Used with permission.)"><img src="images/calibrationTWC.png" class="img-fluid figure-img" style="width:100.0%" alt="Calibration Plot Of Same-Day Probability Of Precipitation (PoP) Forecasts From The Weather Channel. The plot depicts that the rain forecasts are generally well calibrated, but shows some miscalibration. For instance, the forecasted probability of rain is lower than the actual probability of rain when the forecasted probability of rain is 20%. (Figure reprinted from @Bickel2008, Figure 2, p. 4872. Bickel, J. E., &amp; Kim, S. D. (2008). Verification of The Weather Channel probability of precipitation forecasts. *Monthly Weather Review*, *136*(12), 4867–4881. doi: <https://doi.org/10.1175/2008MWR2547.1> Copyright (c) American Meteorological Society. Used with permission.)"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-calibrationWeatherChannel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.21: Calibration Plot Of Same-Day Probability Of Precipitation (PoP) Forecasts From The Weather Channel. The plot depicts that the rain forecasts are generally well calibrated, but shows some miscalibration. For instance, the forecasted probability of rain is lower than the actual probability of rain when the forecasted probability of rain is 20%. (Figure reprinted from <span class="citation" data-cites="Bickel2008">Bickel &amp; Kim (<a href="references.html#ref-Bickel2008" role="doc-biblioref">2008</a>)</span>, Figure 2, p.&nbsp;4872. Bickel, J. E., &amp; Kim, S. D. (2008). Verification of The Weather Channel probability of precipitation forecasts. <em>Monthly Weather Review</em>, <em>136</em>(12), 4867–4881. doi: <a href="https://doi.org/10.1175/2008MWR2547.1" class="uri">https://doi.org/10.1175/2008MWR2547.1</a> Copyright (c) American Meteorological Society. Used with permission.)
</figcaption></figure>
</div>
<div id="fig-calibrationNWS" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Calibration Plot Of Local Probability Of Precipitation (PoP) Forecasts for 87 Stations From the United States National Weather Service. Numbers next to the plotted points are the sample sizes. (Figure reprinted from @Charba1980, Figure 6, p. 1550. Charba, J. P., &amp; Klein, W. H. (1980). Skill in precipitation forecasting in the National Weather Service. *Bulletin of the American Meteorological Society*, *61*(12), 1546–1555. <https://doi.org/10.1175/1520-0477(1980)061<1546:SIPFIT>2.0.CO;2>. Copyright (c) American Meteorological Society. Used with permission.)">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-calibrationNWS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/calibrationNWS.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Figure&nbsp;9.22: Calibration Plot Of Local Probability Of Precipitation (PoP) Forecasts for 87 Stations From the United States National Weather Service. Numbers next to the plotted points are the sample sizes. (Figure reprinted from @Charba1980, Figure 6, p.&nbsp;1550. Charba, J. P., &amp; Klein, W. H. (1980). Skill in precipitation forecasting in the National Weather Service. Bulletin of the American Meteorological Society, 61(12), 1546–1555. https://doi.org/10.1175/1520-0477(1980)061<1546:SIPFIT2.0.CO;2>. Copyright (c) American Meteorological Society. Used with permission.)"><img src="images/calibrationNWS.png" class="img-fluid figure-img" style="width:100.0%" alt="Calibration Plot Of Local Probability Of Precipitation (PoP) Forecasts for 87 Stations From the United States National Weather Service. Numbers next to the plotted points are the sample sizes. (Figure reprinted from @Charba1980, Figure 6, p. 1550. Charba, J. P., &amp; Klein, W. H. (1980). Skill in precipitation forecasting in the National Weather Service. *Bulletin of the American Meteorological Society*, *61*(12), 1546–1555. <https://doi.org/10.1175/1520-0477(1980)061<1546:SIPFIT>2.0.CO;2>. Copyright (c) American Meteorological Society. Used with permission.)"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-calibrationNWS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.22: Calibration Plot Of Local Probability Of Precipitation (PoP) Forecasts for 87 Stations From the United States National Weather Service. Numbers next to the plotted points are the sample sizes. (Figure reprinted from <span class="citation" data-cites="Charba1980">Charba &amp; Klein (<a href="references.html#ref-Charba1980" role="doc-biblioref">1980</a>)</span>, Figure 6, p.&nbsp;1550. Charba, J. P., &amp; Klein, W. H. (1980). Skill in precipitation forecasting in the National Weather Service. <em>Bulletin of the American Meteorological Society</em>, <em>61</em>(12), 1546–1555. <a href="https://doi.org/10.1175/1520-0477(1980)061%3C1546:SIPFIT" class="uri">https://doi.org/10.1175/1520-0477(1980)061&lt;1546:SIPFIT</a>2.0.CO;2&gt;. Copyright (c) American Meteorological Society. Used with permission.)
</figcaption></figure>
</div>
<p>Calibration is not just important for weather forecasts. It is also important for psychological assessment. Calibration can be examined in several ways, including <a href="#sec-brierScores">Brier Scores</a> (see <a href="#sec-brierScores" class="quarto-xref"><span>Section 9.4.3.2</span></a>), the <a href="#sec-hoslerLemeshow">Hosler-Lemeshow test</a> (see <a href="#sec-hoslerLemeshow" class="quarto-xref"><span>Section 9.4.3.3</span></a>), <a href="#sec-spiegelhalterZ">Spiegelhalter’s <span class="math inline">\(z\)</span></a> (see <a href="#sec-spiegelhalterZ" class="quarto-xref"><span>Section 9.4.3.4</span></a>), and the <a href="#sec-miscalibration">mean difference between predicted and observed values</a> at different binned thresholds as depicted graphically with a <a href="#sec-calibrationPlot">calibration plot</a> (see <a href="#fig-calibrationPlot1" class="quarto-xref">Figure&nbsp;<span>9.24</span></a>).</p>
<section id="sec-calibrationPlot" class="level4" data-number="9.4.3.1"><h4 data-number="9.4.3.1" class="anchored" data-anchor-id="sec-calibrationPlot">
<span class="header-section-number">9.4.3.1</span> Calibration Plot</h4>
<p>Calibration plots can be helpful for identifying miscalibration. A calibration plot depicts the predicted probability of an event on the x-axis, and the actual (observed) probability of the event on the y-axis. The predictions are binned into a certain number of groups (commonly 10). The diagonal line reflects predictions that are perfectly calibrated. To the extent that predictions deviate from the diagonal line, the predictions are miscalibrated. There are four general patterns of miscalibration: overextremity, underextremity, overprediction, and underprediction (see <a href="#fig-miscalibrationPlots" class="quarto-xref">Figure&nbsp;<span>9.23</span></a>). <em>Overextremity</em> exists when the predicted probabilites are too close to the extremes (zero or one). <em>Underextremity</em> exists when the predicted probabilities are too far away from the extremes. <em>Overprediction</em> exists when the predicted probabilities are consistently greater than the observed probabilities. <em>Underprediction</em> exists when the predicted probabilities are consistently less than the observed probabilities. For a more thorough description of these types of miscalibration, see <span class="citation" data-cites="Lindhiem2020">Lindhiem et al. (<a href="references.html#ref-Lindhiem2020" role="doc-biblioref">2020</a>)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-miscalibrationPlots" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Types Of Miscalibration.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-miscalibrationPlots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-miscalibrationPlots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Figure&nbsp;9.23: Types Of Miscalibration."><img src="prediction_files/figure-html/fig-miscalibrationPlots-1.png" class="img-fluid figure-img" alt="Types Of Miscalibration." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-miscalibrationPlots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.23: Types Of Miscalibration.
</figcaption></figure>
</div>
</div>
</div>
<p>This calibration plot was generated using the <code>PredictABEL</code> package <span class="citation" data-cites="R-PredictABEL">(<a href="references.html#ref-R-PredictABEL" role="doc-biblioref">Kundu et al., 2020</a>)</span>, and is depicted in <a href="#fig-calibrationPlot1" class="quarto-xref">Figure&nbsp;<span>9.24</span></a>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>colNumberOutcome <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">names</span>(mydataSDT) <span class="sc">==</span> <span class="st">"disorder"</span>)</span>
<span id="cb114-2"><a href="#cb114-2"></a>myDataNoMissing <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(mydataSDT)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="fu">plotCalibration</span>(</span>
<span id="cb115-2"><a href="#cb115-2"></a>  <span class="at">data =</span> <span class="fu">na.omit</span>(myDataNoMissing),</span>
<span id="cb115-3"><a href="#cb115-3"></a>  <span class="at">cOutcome =</span> colNumberOutcome,</span>
<span id="cb115-4"><a href="#cb115-4"></a>  <span class="at">predRisk =</span> myDataNoMissing<span class="sc">$</span>predictedProbability,</span>
<span id="cb115-5"><a href="#cb115-5"></a>  <span class="at">groups =</span> <span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$Table_HLtest
                total meanpred meanobs predicted observed
[0.0000,0.0245)    19    0.013   0.211      0.25        4
0.0245              7    0.025   0.143      0.17        1
0.0294              8    0.029   0.250      0.24        2
[0.0343,0.0441)    13    0.036   0.231      0.47        3
[0.0441,0.0588)    10    0.051   0.300      0.51        3
[0.0588,0.0735)    10    0.063   0.100      0.63        1
[0.0735,0.1324)    10    0.099   0.500      0.99        5
[0.1324,0.2059)    12    0.165   0.583      1.98        7
[0.2059,0.2598)    10    0.222   0.300      2.22        3
[0.2598,1.0000]    11    0.408   1.000      4.49       11

$Chi_square
[1] 152.274

$df
[1] 8

$p_value
[1] 0</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-calibrationPlot1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Calibration Plot 1.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-calibrationPlot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-calibrationPlot1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Figure&nbsp;9.24: Calibration Plot 1."><img src="prediction_files/figure-html/fig-calibrationPlot1-1.png" class="img-fluid figure-img" alt="Calibration Plot 1." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-calibrationPlot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.24: Calibration Plot 1.
</figcaption></figure>
</div>
</div>
</div>
<p>This calibration plot (and ROC curve) was generated using the <code>rms</code> package <span class="citation" data-cites="R-rms">(<a href="references.html#ref-R-rms" role="doc-biblioref">Harrell, Jr., 2021</a>)</span>, and is depicted in <a href="#fig-calibrationPlot2" class="quarto-xref">Figure&nbsp;<span>9.25</span></a>. The calibration plot is consistent with underprediction. That is, the predicted probabilities were consistently lower than the actual probabilities. To re-calibrate the predicted probabilities, it would be necessary to increase them so they are consistent with observed probabilties.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="fu">val.prob</span>(mydataSDT<span class="sc">$</span>predictedProbability, mydataSDT<span class="sc">$</span>disorder)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>          Dxy       C (ROC)            R2             D      D:Chi-sq 
 4.769231e-01  7.384615e-01 -6.156954e-01 -3.797827e-01 -4.039632e+01 
          D:p             U      U:Chi-sq           U:p             Q 
 1.000000e+00           Inf           Inf  0.000000e+00          -Inf 
        Brier     Intercept         Slope          Emax           E90 
 2.659086e-01  1.682881e+00  8.857501e-01  7.146778e-01  3.719585e-01 
         Eavg           S:z           S:p 
 2.618115e-01  1.052663e+01  6.512514e-26 </code></pre>
</div>
<div class="cell-output-display">
<div id="fig-calibrationPlot2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Calibration Plot 2.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-calibrationPlot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-calibrationPlot2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Figure&nbsp;9.25: Calibration Plot 2."><img src="prediction_files/figure-html/fig-calibrationPlot2-1.png" class="img-fluid figure-img" alt="Calibration Plot 2." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-calibrationPlot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.25: Calibration Plot 2.
</figcaption></figure>
</div>
</div>
</div>
<p>This calibration plot was adapted from Darren Dahly’s example, and is depicted in <a href="#fig-calibrationPlot3" class="quarto-xref">Figure&nbsp;<span>9.26</span></a>: <a href="https://darrendahly.github.io/post/homr/" class="uri">https://darrendahly.github.io/post/homr/</a> (archived at <a href="https://perma.cc/6J3J-69G7" class="uri">https://perma.cc/6J3J-69G7</a>)</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(mydataSDT, <span class="at">bin =</span> <span class="fu">cut_number</span>(predictedProbability, <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb119-2"><a href="#cb119-2"></a>  <span class="co"># Bin prediction into 10ths</span></span>
<span id="cb119-3"><a href="#cb119-3"></a>  <span class="fu">group_by</span>(bin) <span class="sc">%&gt;%</span></span>
<span id="cb119-4"><a href="#cb119-4"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">length</span>(<span class="fu">na.omit</span>(predictedProbability)), <span class="co"># Get ests and CIs</span></span>
<span id="cb119-5"><a href="#cb119-5"></a>         <span class="at">bin_pred =</span> <span class="fu">mean</span>(predictedProbability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb119-6"><a href="#cb119-6"></a>         <span class="at">bin_prob =</span> <span class="fu">mean</span>(disorder, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb119-7"><a href="#cb119-7"></a>         <span class="at">se =</span> <span class="fu">sd</span>(disorder, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb119-8"><a href="#cb119-8"></a>         <span class="at">ul =</span> bin_prob <span class="sc">+</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>) <span class="sc">*</span> se,</span>
<span id="cb119-9"><a href="#cb119-9"></a>         <span class="at">ll =</span> bin_prob <span class="sc">-</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>) <span class="sc">*</span> se) <span class="sc">%&gt;%</span></span>
<span id="cb119-10"><a href="#cb119-10"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb119-11"><a href="#cb119-11"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bin_pred, <span class="at">y =</span> bin_prob, <span class="at">ymin =</span> ll, <span class="at">ymax =</span> ul)) <span class="sc">+</span></span>
<span id="cb119-12"><a href="#cb119-12"></a>  <span class="fu">geom_pointrange</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb119-13"><a href="#cb119-13"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb119-14"><a href="#cb119-14"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb119-15"><a href="#cb119-15"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span> <span class="co"># 45 degree line indicating perfect calibration</span></span>
<span id="cb119-16"><a href="#cb119-16"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb119-17"><a href="#cb119-17"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">formula =</span> y<span class="sc">~-</span><span class="dv">1</span> <span class="sc">+</span> x) <span class="sc">+</span></span>
<span id="cb119-18"><a href="#cb119-18"></a>  <span class="co"># straight line fit through estimates</span></span>
<span id="cb119-19"><a href="#cb119-19"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> predictedProbability, <span class="at">y =</span> disorder),</span>
<span id="cb119-20"><a href="#cb119-20"></a>              <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">"loess"</span>) <span class="sc">+</span></span>
<span id="cb119-21"><a href="#cb119-21"></a>  <span class="co"># loess fit through estimates</span></span>
<span id="cb119-22"><a href="#cb119-22"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb119-23"><a href="#cb119-23"></a>  <span class="fu">ylab</span>(<span class="st">"Observed Probability"</span>) <span class="sc">+</span></span>
<span id="cb119-24"><a href="#cb119-24"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb119-25"><a href="#cb119-25"></a>  <span class="fu">xlab</span>(<span class="st">"Predicted Probability"</span>)</span>
<span id="cb119-26"><a href="#cb119-26"></a></span>
<span id="cb119-27"><a href="#cb119-27"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydataSDT, <span class="fu">aes</span>(<span class="at">x =</span> predictedProbability)) <span class="sc">+</span></span>
<span id="cb119-28"><a href="#cb119-28"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">bins =</span> <span class="dv">200</span>) <span class="sc">+</span></span>
<span id="cb119-29"><a href="#cb119-29"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb119-30"><a href="#cb119-30"></a>  <span class="fu">xlab</span>(<span class="st">"Histogram of Predicted Probability"</span>) <span class="sc">+</span></span>
<span id="cb119-31"><a href="#cb119-31"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb119-32"><a href="#cb119-32"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb119-33"><a href="#cb119-33"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span>
<span id="cb119-34"><a href="#cb119-34"></a></span>
<span id="cb119-35"><a href="#cb119-35"></a>g <span class="ot">&lt;-</span> <span class="fu">arrangeGrob</span>(g1, g2, <span class="at">respect =</span> <span class="cn">TRUE</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.25</span>), <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="fu">grid.arrange</span>(g)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-calibrationPlot3" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Calibration Plot 3.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-calibrationPlot3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-calibrationPlot3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="Figure&nbsp;9.26: Calibration Plot 3."><img src="prediction_files/figure-html/fig-calibrationPlot3-1.png" class="img-fluid figure-img" alt="Calibration Plot 3." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-calibrationPlot3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.26: Calibration Plot 3.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-brierScores" class="level4" data-number="9.4.3.2"><h4 data-number="9.4.3.2" class="anchored" data-anchor-id="sec-brierScores">
<span class="header-section-number">9.4.3.2</span> Brier Scores</h4>
<p>Brier scores were calculated using the <code>rms</code> package <span class="citation" data-cites="R-rms">(<a href="references.html#ref-R-rms" role="doc-biblioref">Harrell, Jr., 2021</a>)</span>. Smaller values reflect greater <a href="#sec-calibration">calibration accuracy</a>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="fu">val.prob</span>(</span>
<span id="cb121-2"><a href="#cb121-2"></a>  mydataSDT<span class="sc">$</span>predictedProbability,</span>
<span id="cb121-3"><a href="#cb121-3"></a>  mydataSDT<span class="sc">$</span>disorder, <span class="at">pl =</span> <span class="cn">FALSE</span>)[<span class="st">"Brier"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>    Brier 
0.2659086 </code></pre>
</div>
</div>
</section><section id="sec-hoslerLemeshow" class="level4" data-number="9.4.3.3"><h4 data-number="9.4.3.3" class="anchored" data-anchor-id="sec-hoslerLemeshow">
<span class="header-section-number">9.4.3.3</span> Hosler-Lemeshow Test</h4>
<p>The Hosler-Lemeshow goodness of fit (GOF) test evaluates the null hypothesis that there is no difference between the predicted versus observed frequencies of an event. The test requires specifying how many groups/bins (<span class="math inline">\(g\)</span>) to use to calculate quantiles. Smaller <span class="math inline">\(\chi^2\)</span> values (and larger <em>p</em>-values) reflect greater <a href="#sec-calibration">calibration accuracy</a>. A statistically significant <span class="math inline">\(\chi^2\)</span> (<em>p</em> &lt; .05) indicates a significant degree of miscalibration. The Hosler-Lemeshow GOF test was calculated using the <code>ResourceSelection</code> package <span class="citation" data-cites="R-ResourceSelection">(<a href="references.html#ref-R-ResourceSelection" role="doc-biblioref">Lele et al., 2019</a>)</span>. The table of predicted versus observed frequencies was generated using the <code>PredictABEL</code> package <span class="citation" data-cites="R-PredictABEL">(<a href="references.html#ref-R-PredictABEL" role="doc-biblioref">Kundu et al., 2020</a>)</span>.</p>
<p>For each number of bins (<span class="math inline">\(g\)</span>) specified below, the predictions show statistically significant miscalibration.</p>
<p><span class="math inline">\(g = 2\)</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a>gValue <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb123-2"><a href="#cb123-2"></a></span>
<span id="cb123-3"><a href="#cb123-3"></a><span class="fu">hoslem.test</span>(</span>
<span id="cb123-4"><a href="#cb123-4"></a>  mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb123-5"><a href="#cb123-5"></a>  mydataSDT<span class="sc">$</span>predictedProbability,</span>
<span id="cb123-6"><a href="#cb123-6"></a>  <span class="at">g =</span> gValue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer and Lemeshow goodness of fit (GOF) test

data:  mydataSDT$disorder, mydataSDT$predictedProbability
X-squared = NA, df = 0, p-value = NA</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="fu">plotCalibration</span>(</span>
<span id="cb125-2"><a href="#cb125-2"></a>  <span class="at">data =</span> <span class="fu">na.omit</span>(myDataNoMissing),</span>
<span id="cb125-3"><a href="#cb125-3"></a>  <span class="at">cOutcome =</span> colNumberOutcome,</span>
<span id="cb125-4"><a href="#cb125-4"></a>  <span class="at">predRisk =</span> myDataNoMissing<span class="sc">$</span>predictedProbability,</span>
<span id="cb125-5"><a href="#cb125-5"></a>  <span class="at">groups =</span> gValue)<span class="sc">$</span>Table_HLtest</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                total meanpred meanobs predicted observed
[0.0000,0.0588)    57    0.029   0.228      1.64       13
[0.0588,1.0000]    53    0.194   0.509     10.29       27</code></pre>
</div>
</div>
<p><span class="math inline">\(g = 4\)</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a>gValue <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb127-2"><a href="#cb127-2"></a></span>
<span id="cb127-3"><a href="#cb127-3"></a><span class="fu">hoslem.test</span>(</span>
<span id="cb127-4"><a href="#cb127-4"></a>  mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb127-5"><a href="#cb127-5"></a>  mydataSDT<span class="sc">$</span>predictedProbability,</span>
<span id="cb127-6"><a href="#cb127-6"></a>  <span class="at">g =</span> gValue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer and Lemeshow goodness of fit (GOF) test

data:  mydataSDT$disorder, mydataSDT$predictedProbability
X-squared = NA, df = 2, p-value = NA</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="fu">plotCalibration</span>(</span>
<span id="cb129-2"><a href="#cb129-2"></a>  <span class="at">data =</span> <span class="fu">na.omit</span>(myDataNoMissing),</span>
<span id="cb129-3"><a href="#cb129-3"></a>  <span class="at">cOutcome =</span> colNumberOutcome,</span>
<span id="cb129-4"><a href="#cb129-4"></a>  <span class="at">predRisk =</span> myDataNoMissing<span class="sc">$</span>predictedProbability,</span>
<span id="cb129-5"><a href="#cb129-5"></a>  <span class="at">groups =</span> gValue)<span class="sc">$</span>Table_HLtest</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                total meanpred meanobs predicted observed
[0.0000,0.0343)    34    0.019   0.206      0.66        7
[0.0343,0.0588)    23    0.043   0.261      0.98        6
[0.0588,0.1569)    26    0.095   0.346      2.48        9
[0.1569,1.0000]    27    0.289   0.667      7.81       18</code></pre>
</div>
</div>
<p><span class="math inline">\(g = 6\)</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a>gValue <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb131-2"><a href="#cb131-2"></a></span>
<span id="cb131-3"><a href="#cb131-3"></a><span class="fu">hoslem.test</span>(</span>
<span id="cb131-4"><a href="#cb131-4"></a>  mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb131-5"><a href="#cb131-5"></a>  mydataSDT<span class="sc">$</span>predictedProbability,</span>
<span id="cb131-6"><a href="#cb131-6"></a>  <span class="at">g =</span> gValue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer and Lemeshow goodness of fit (GOF) test

data:  mydataSDT$disorder, mydataSDT$predictedProbability
X-squared = NA, df = 4, p-value = NA</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="fu">plotCalibration</span>(</span>
<span id="cb133-2"><a href="#cb133-2"></a>  <span class="at">data =</span> <span class="fu">na.omit</span>(myDataNoMissing),</span>
<span id="cb133-3"><a href="#cb133-3"></a>  <span class="at">cOutcome =</span> colNumberOutcome,</span>
<span id="cb133-4"><a href="#cb133-4"></a>  <span class="at">predRisk =</span> myDataNoMissing<span class="sc">$</span>predictedProbability,</span>
<span id="cb133-5"><a href="#cb133-5"></a>  <span class="at">groups =</span> gValue)<span class="sc">$</span>Table_HLtest</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                total meanpred meanobs predicted observed
[0.0000,0.0245)    19    0.013   0.211      0.25        4
[0.0245,0.0392)    23    0.030   0.217      0.68        5
[0.0392,0.0588)    15    0.047   0.267      0.71        4
[0.0588,0.1127)    17    0.074   0.235      1.26        4
[0.1127,0.2206)    19    0.167   0.474      3.18        9
[0.2206,1.0000]    17    0.344   0.824      5.85       14</code></pre>
</div>
</div>
<p><span class="math inline">\(g = 8\)</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a>gValue <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb135-2"><a href="#cb135-2"></a></span>
<span id="cb135-3"><a href="#cb135-3"></a><span class="fu">hoslem.test</span>(</span>
<span id="cb135-4"><a href="#cb135-4"></a>  mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb135-5"><a href="#cb135-5"></a>  mydataSDT<span class="sc">$</span>predictedProbability,</span>
<span id="cb135-6"><a href="#cb135-6"></a>  <span class="at">g =</span> gValue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer and Lemeshow goodness of fit (GOF) test

data:  mydataSDT$disorder, mydataSDT$predictedProbability
X-squared = NA, df = 6, p-value = NA</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="fu">plotCalibration</span>(</span>
<span id="cb137-2"><a href="#cb137-2"></a>  <span class="at">data =</span> <span class="fu">na.omit</span>(myDataNoMissing),</span>
<span id="cb137-3"><a href="#cb137-3"></a>  <span class="at">cOutcome =</span> colNumberOutcome,</span>
<span id="cb137-4"><a href="#cb137-4"></a>  <span class="at">predRisk =</span> myDataNoMissing<span class="sc">$</span>predictedProbability,</span>
<span id="cb137-5"><a href="#cb137-5"></a>  <span class="at">groups =</span> gValue)<span class="sc">$</span>Table_HLtest</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                total meanpred meanobs predicted observed
[0.0000,0.0245)    19    0.013   0.211      0.25        4
[0.0245,0.0343)    15    0.027   0.200      0.41        3
0.0343              8    0.034   0.250      0.27        2
[0.0392,0.0588)    15    0.047   0.267      0.71        4
[0.0588,0.0931)    13    0.066   0.077      0.86        1
[0.0931,0.1569)    13    0.124   0.615      1.62        8
[0.1569,0.2402)    15    0.206   0.400      3.09        6
[0.2402,1.0000]    12    0.394   1.000      4.73       12</code></pre>
</div>
</div>
<p><span class="math inline">\(g = 10\)</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a>gValue <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb139-2"><a href="#cb139-2"></a></span>
<span id="cb139-3"><a href="#cb139-3"></a><span class="fu">hoslem.test</span>(</span>
<span id="cb139-4"><a href="#cb139-4"></a>  mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb139-5"><a href="#cb139-5"></a>  mydataSDT<span class="sc">$</span>predictedProbability,</span>
<span id="cb139-6"><a href="#cb139-6"></a>  <span class="at">g =</span> gValue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer and Lemeshow goodness of fit (GOF) test

data:  mydataSDT$disorder, mydataSDT$predictedProbability
X-squared = NA, df = 8, p-value = NA</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a><span class="fu">plotCalibration</span>(</span>
<span id="cb141-2"><a href="#cb141-2"></a>  <span class="at">data =</span> <span class="fu">na.omit</span>(myDataNoMissing),</span>
<span id="cb141-3"><a href="#cb141-3"></a>  <span class="at">cOutcome =</span> colNumberOutcome,</span>
<span id="cb141-4"><a href="#cb141-4"></a>  <span class="at">predRisk =</span> myDataNoMissing<span class="sc">$</span>predictedProbability,</span>
<span id="cb141-5"><a href="#cb141-5"></a>  <span class="at">groups =</span> gValue)<span class="sc">$</span>Table_HLtest</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                total meanpred meanobs predicted observed
[0.0000,0.0245)    19    0.013   0.211      0.25        4
0.0245              7    0.025   0.143      0.17        1
0.0294              8    0.029   0.250      0.24        2
[0.0343,0.0441)    13    0.036   0.231      0.47        3
[0.0441,0.0588)    10    0.051   0.300      0.51        3
[0.0588,0.0735)    10    0.063   0.100      0.63        1
[0.0735,0.1324)    10    0.099   0.500      0.99        5
[0.1324,0.2059)    12    0.165   0.583      1.98        7
[0.2059,0.2598)    10    0.222   0.300      2.22        3
[0.2598,1.0000]    11    0.408   1.000      4.49       11</code></pre>
</div>
</div>
</section><section id="sec-spiegelhalterZ" class="level4" data-number="9.4.3.4"><h4 data-number="9.4.3.4" class="anchored" data-anchor-id="sec-spiegelhalterZ">
<span class="header-section-number">9.4.3.4</span> Spiegelhalter’s z</h4>
<p>Spiegelhalter’s <span class="math inline">\(z\)</span> was calculated using the <code>rms</code> package <span class="citation" data-cites="R-rms">(<a href="references.html#ref-R-rms" role="doc-biblioref">Harrell, Jr., 2021</a>)</span>. Smaller <span class="math inline">\(z\)</span> values (and larger associated <span class="math inline">\(p\)</span>-values) reflect greater <a href="#sec-calibration">calibration accuracy</a>. A statistically significant Spiegelhalter’s <span class="math inline">\(z\)</span> (<em>p</em> &lt; .05) indicates a significant degree of miscalibration.</p>
<p>In this case, the predictions show statistically significant miscalibration.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a><span class="fu">val.prob</span>(</span>
<span id="cb143-2"><a href="#cb143-2"></a>  mydataSDT<span class="sc">$</span>predictedProbability,</span>
<span id="cb143-3"><a href="#cb143-3"></a>  mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb143-4"><a href="#cb143-4"></a>  <span class="at">pl =</span> <span class="cn">FALSE</span>)[<span class="st">"S:z"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     S:z 
10.52663 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a><span class="fu">val.prob</span>(</span>
<span id="cb145-2"><a href="#cb145-2"></a>  mydataSDT<span class="sc">$</span>predictedProbability,</span>
<span id="cb145-3"><a href="#cb145-3"></a>  mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb145-4"><a href="#cb145-4"></a>  <span class="at">pl =</span> <span class="cn">FALSE</span>)[<span class="st">"S:p"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         S:p 
6.512514e-26 </code></pre>
</div>
</div>
</section><section id="sec-calibrationContinuous" class="level4" data-number="9.4.3.5"><h4 data-number="9.4.3.5" class="anchored" data-anchor-id="sec-calibrationContinuous">
<span class="header-section-number">9.4.3.5</span> Calibration for predicting a continuous outcome</h4>
<p>When predicting a continuous outcome, <a href="#sec-calibration">calibration</a> of the predicted values in relation to the outcome values can be examined in multiple ways including:</p>
<ul>
<li>in a <a href="#sec-calibration">calibration plot</a>, the extent to which the intercept is near zero and the slope is near one</li>
<li>in a <a href="#sec-calibration">calibration plot</a>, the extent to which the 95% confidence interval of the observed value, across all values of the predicted values, includes the diagonal reference line with an intercept of zero and a slope of one.</li>
<li><a href="#sec-meanError">mean error</a></li>
<li><a href="#sec-meanAbsoluteError">mean absolute error</a></li>
<li><a href="#sec-meanSquaredError">mean squared error</a></li>
<li><a href="#sec-rootMeanSquaredError">root mean squared error</a></li>
</ul>
<p>With a plot of the predictions on the x-axis, and the outcomes on the y-axis (i.e., a <a href="#sec-calibrationPlot">calibration plot</a>), <a href="#sec-calibration">calibration</a> can be examined graphically as the extent to which the best-fit regression line has an intercept (alpha) close to zero and a slope (beta) close to one <span class="citation" data-cites="Steyerberg2014 Stevens2020">(<a href="references.html#ref-Stevens2020" role="doc-biblioref">Stevens &amp; Poppe, 2020</a>; <a href="references.html#ref-Steyerberg2014" role="doc-biblioref">Steyerberg &amp; Vergouwe, 2014</a>)</span>. The intercept is also called “calibration-in-the-large”, whereas “calibration-in-the-small” refers to the extent to which the predicted values match the observed values at a specific predicted value (e.g., when the weather forecaster says that there is a 10% chance of rain, does it actually rain 10% of the time?). For predictions to be well <a href="#sec-calibration">calibrated</a>, the intercept should be close to zero and the slope should be close to one. If the slope is close to one but the intercept is not close to zero (or the intercept is close to zero but the slope is not close to one), the predictions would not be considered well <a href="#sec-calibration">calibrated</a>. The 95% confidence interval of the observed value, across all values of the predicted values, should include the diagonal reference line whose intercept is zero and whose slope is one.</p>
<p>For instance, based on the intercept and slope of the <a href="#sec-calibrationPlot">calibration plot</a> in <a href="#fig-calibrationContinuousOutcome" class="quarto-xref">Figure&nbsp;<span>9.27</span></a>, the predictions are not well calibrated, despite having a slope near one, because the 95% confidence interval of the intercept does not include zero. The best-fit line is the yellow line. The intercept from the best-fit line is positive, as shown in the regression equation. This is a case of underprediction, where the predicted values are consistently less than the observed values. The confidence interval of the observed value (i.e., the purple band) is the interval within which we have 95% confidence that the true observed value would lie for a given predicted value, based on the model. The 95% prediction interval of the observed value (i.e., the dashed red lines) is the interval within which we would expect that 95% of future observations would lie for a given predicted value. The black diagonal line indicates the reference line with an intercept of zero and a slope of one. The predictions would be significantly <a href="#sec-calibration">miscalibrated</a> at a given level of the predicted values if the 95% confidence interval of the observed value does not include the reference line at that level of the predicted value. In this case, the 95% confidence interval of the observed value does not include the reference line (i.e., the actual observed value) at lower levels of the predicted values, so the predictions are <a href="#sec-calibration">miscalibrated</a> lower levels of the predicted values.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="co">#95 prediction interval based on linear model</span></span>
<span id="cb147-2"><a href="#cb147-2"></a>calibrationModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb147-3"><a href="#cb147-3"></a>  continuousOutcome <span class="sc">~</span> testScore,</span>
<span id="cb147-4"><a href="#cb147-4"></a>  <span class="at">data =</span> mydataSDT)</span>
<span id="cb147-5"><a href="#cb147-5"></a>calibrationModelPredictionInterval <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb147-6"><a href="#cb147-6"></a>  <span class="at">testScore =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(mydataSDT<span class="sc">$</span>testScore, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb147-7"><a href="#cb147-7"></a>                  <span class="at">to =</span> <span class="fu">max</span>(mydataSDT<span class="sc">$</span>testScore, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb147-8"><a href="#cb147-8"></a>                  <span class="at">length.out =</span> <span class="dv">1000</span>))</span>
<span id="cb147-9"><a href="#cb147-9"></a>calibrationModelPredictionInterval <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb147-10"><a href="#cb147-10"></a>  calibrationModelPredictionInterval,</span>
<span id="cb147-11"><a href="#cb147-11"></a>  <span class="fu">data.frame</span>(<span class="fu">predict</span>(</span>
<span id="cb147-12"><a href="#cb147-12"></a>    calibrationModel,</span>
<span id="cb147-13"><a href="#cb147-13"></a>    <span class="at">newdata =</span> calibrationModelPredictionInterval,</span>
<span id="cb147-14"><a href="#cb147-14"></a>    <span class="at">interval =</span> <span class="st">"predict"</span>,</span>
<span id="cb147-15"><a href="#cb147-15"></a>    <span class="at">level =</span> <span class="fl">0.95</span>)))</span>
<span id="cb147-16"><a href="#cb147-16"></a></span>
<span id="cb147-17"><a href="#cb147-17"></a><span class="fu">ggplot</span>(</span>
<span id="cb147-18"><a href="#cb147-18"></a>  mydataSDT,</span>
<span id="cb147-19"><a href="#cb147-19"></a>  <span class="fu">aes</span>(</span>
<span id="cb147-20"><a href="#cb147-20"></a>    <span class="at">x =</span> testScore,</span>
<span id="cb147-21"><a href="#cb147-21"></a>    <span class="at">y =</span> continuousOutcome)) <span class="sc">+</span></span>
<span id="cb147-22"><a href="#cb147-22"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb147-23"><a href="#cb147-23"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb147-24"><a href="#cb147-24"></a>    <span class="at">data =</span> calibrationModelPredictionInterval,</span>
<span id="cb147-25"><a href="#cb147-25"></a>    <span class="fu">aes</span>(<span class="at">y =</span> lwr),</span>
<span id="cb147-26"><a href="#cb147-26"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb147-27"><a href="#cb147-27"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> <span class="co">#Lower estimate of 95% prediction interval of linear model</span></span>
<span id="cb147-28"><a href="#cb147-28"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb147-29"><a href="#cb147-29"></a>    <span class="at">data =</span> calibrationModelPredictionInterval,</span>
<span id="cb147-30"><a href="#cb147-30"></a>    <span class="fu">aes</span>(<span class="at">y =</span> upr),</span>
<span id="cb147-31"><a href="#cb147-31"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb147-32"><a href="#cb147-32"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> <span class="co">#Upper estimate of 95% prediction interval of linear model</span></span>
<span id="cb147-33"><a href="#cb147-33"></a>  <span class="co">#geom_ribbon(data = calibrationModelPredictionInterval, aes(y = fit, ymin = lwr, ymax = upr), fill = viridis(3)[1], alpha = 0.7) + #95% prediction interval of linear model</span></span>
<span id="cb147-34"><a href="#cb147-34"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb147-35"><a href="#cb147-35"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb147-36"><a href="#cb147-36"></a>    <span class="at">color =</span> <span class="fu">viridis</span>(<span class="dv">3</span>)[<span class="dv">3</span>], <span class="at">fill =</span> <span class="fu">viridis</span>(<span class="dv">3</span>)[<span class="dv">1</span>],</span>
<span id="cb147-37"><a href="#cb147-37"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> <span class="co">#95% confidence interval of linear model</span></span>
<span id="cb147-38"><a href="#cb147-38"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb147-39"><a href="#cb147-39"></a>    <span class="at">slope =</span> <span class="dv">1</span>,</span>
<span id="cb147-40"><a href="#cb147-40"></a>    <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb147-41"><a href="#cb147-41"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">2.4</span>) <span class="sc">+</span></span>
<span id="cb147-42"><a href="#cb147-42"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="fl">2.4</span>) <span class="sc">+</span></span>
<span id="cb147-43"><a href="#cb147-43"></a>  <span class="fu">xlab</span>(<span class="st">"Predicted Value"</span>) <span class="sc">+</span></span>
<span id="cb147-44"><a href="#cb147-44"></a>  <span class="fu">ylab</span>(<span class="st">"Observed Value"</span>) <span class="sc">+</span></span>
<span id="cb147-45"><a href="#cb147-45"></a>  <span class="fu">stat_cor</span>(</span>
<span id="cb147-46"><a href="#cb147-46"></a>    <span class="at">label.y =</span> <span class="fl">2.2</span>,</span>
<span id="cb147-47"><a href="#cb147-47"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..rr.label..))) <span class="sc">+</span></span>
<span id="cb147-48"><a href="#cb147-48"></a>  <span class="fu">stat_regline_equation</span>(<span class="at">label.y =</span> <span class="fl">2.0</span>) <span class="sc">+</span></span>
<span id="cb147-49"><a href="#cb147-49"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-calibrationContinuousOutcome" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Calibration Plot for Predictions of a Continuous Outcome, With Best-Fit Line. The black diagonal line indicates the reference line with an intercept of zero and a slope of one. The yellow line is the best-fit line. The purple band is the 95% confidence interval of the observed value. The dashed red lines are the 95% prediction interval of the observed value. The predictions are not well calibrated because the 95% confidence interval of the intercept does not include zero (even though the 95% confidence interval of the slope includes one). The intercept from the best-fit line is positive, as shown in the regression equation. This is a case of underprediction, where the predicted values are consistently less than the observed values. The 95% confidence interval of the observed value does not include the reference line (i.e., the actual observed value) at lower levels of the predicted values, so the predictions are miscalibrated at lower levels of the predicted values." data-fig-scap="Calibration Plot for Predictions of a Continuous Outcome, With Best-Fit Line.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-calibrationContinuousOutcome-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-calibrationContinuousOutcome-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Figure&nbsp;9.27: Calibration Plot for Predictions of a Continuous Outcome, With Best-Fit Line. The black diagonal line indicates the reference line with an intercept of zero and a slope of one. The yellow line is the best-fit line. The purple band is the 95% confidence interval of the observed value. The dashed red lines are the 95% prediction interval of the observed value. The predictions are not well calibrated because the 95% confidence interval of the intercept does not include zero (even though the 95% confidence interval of the slope includes one). The intercept from the best-fit line is positive, as shown in the regression equation. This is a case of underprediction, where the predicted values are consistently less than the observed values. The 95% confidence interval of the observed value does not include the reference line (i.e., the actual observed value) at lower levels of the predicted values, so the predictions are miscalibrated at lower levels of the predicted values."><img src="prediction_files/figure-html/fig-calibrationContinuousOutcome-1.png" class="img-fluid figure-img" data-fig-scap="Calibration Plot for Predictions of a Continuous Outcome, With Best-Fit Line." alt="Calibration Plot for Predictions of a Continuous Outcome, With Best-Fit Line. The black diagonal line indicates the reference line with an intercept of zero and a slope of one. The yellow line is the best-fit line. The purple band is the 95% confidence interval of the observed value. The dashed red lines are the 95% prediction interval of the observed value. The predictions are not well calibrated because the 95% confidence interval of the intercept does not include zero (even though the 95% confidence interval of the slope includes one). The intercept from the best-fit line is positive, as shown in the regression equation. This is a case of underprediction, where the predicted values are consistently less than the observed values. The 95% confidence interval of the observed value does not include the reference line (i.e., the actual observed value) at lower levels of the predicted values, so the predictions are miscalibrated at lower levels of the predicted values." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-calibrationContinuousOutcome-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.27: Calibration Plot for Predictions of a Continuous Outcome, With Best-Fit Line. The black diagonal line indicates the reference line with an intercept of zero and a slope of one. The yellow line is the best-fit line. The purple band is the 95% confidence interval of the observed value. The dashed red lines are the 95% prediction interval of the observed value. The predictions are not well calibrated because the 95% confidence interval of the intercept does not include zero (even though the 95% confidence interval of the slope includes one). The intercept from the best-fit line is positive, as shown in the regression equation. This is a case of underprediction, where the predicted values are consistently less than the observed values. The 95% confidence interval of the observed value does not include the reference line (i.e., the actual observed value) at lower levels of the predicted values, so the predictions are miscalibrated at lower levels of the predicted values.
</figcaption></figure>
</div>
</div>
</div>
<p>Gold-standard recommendations include examining the predicted values in relation to the observed values using locally estimated scatterplot smoothing (LOESS) <span class="citation" data-cites="Austin2014">(<a href="references.html#ref-Austin2014" role="doc-biblioref">Austin &amp; Steyerberg, 2014</a>)</span>, such as in <a href="#fig-calibrationContinuousOutcomeLOESS" class="quarto-xref">Figure&nbsp;<span>9.28</span></a>. We can examine whether the LOESS-based 95% confidence interval of the observed value at every level of the predicted values includes the diagonal reference line (i.e., the actual observed value). In this case, the 95% confidence interval of the observed value does not include the reference line at lower levels of the predicted values, so the predictions are <a href="#sec-calibration">miscalibrated</a> at lower levels of the predicted values.</p>
<p>(ref:calibrationContinuousOutcomeLOESSCaption) Calibration Plot for Predictions of a Continuous Outcome, With LOESS Best-Fit Line. The yellow line is the best-fit line based on LOESS. The purple band is the 95% confidence interval of the observed value. The dashed red lines are the 95% prediction interval of the observed value. The 95% confidence interval of the observed value does not include the reference line (i.e., the actual observed value) at lower levels of the predicted values, so the predictions are miscalibrated at lower levels of the predicted values.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-calibrationContinuousOutcomeLOESS" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Calibration Plot for Predictions of a Continuous Outcome, With LOESS Best-Fit Line. The yellow line is the best-fit line based on LOESS. The purple band is the 95% confidence interval of the observed value. The dashed red lines are the 95% prediction interval of the observed value. The 95% confidence interval of the observed value does not include the reference line (i.e., the actual observed value) at lower levels of the predicted values, so the predictions are miscalibrated at lower levels of the predicted values." data-fig-scap="Calibration Plot for Predictions of a Continuous Outcome, With LOESS Best-Fit Line.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-calibrationContinuousOutcomeLOESS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-calibrationContinuousOutcomeLOESS-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Figure&nbsp;9.28: Calibration Plot for Predictions of a Continuous Outcome, With LOESS Best-Fit Line. The yellow line is the best-fit line based on LOESS. The purple band is the 95% confidence interval of the observed value. The dashed red lines are the 95% prediction interval of the observed value. The 95% confidence interval of the observed value does not include the reference line (i.e., the actual observed value) at lower levels of the predicted values, so the predictions are miscalibrated at lower levels of the predicted values."><img src="prediction_files/figure-html/fig-calibrationContinuousOutcomeLOESS-1.png" class="img-fluid figure-img" data-fig-scap="Calibration Plot for Predictions of a Continuous Outcome, With LOESS Best-Fit Line." alt="Calibration Plot for Predictions of a Continuous Outcome, With LOESS Best-Fit Line. The yellow line is the best-fit line based on LOESS. The purple band is the 95% confidence interval of the observed value. The dashed red lines are the 95% prediction interval of the observed value. The 95% confidence interval of the observed value does not include the reference line (i.e., the actual observed value) at lower levels of the predicted values, so the predictions are miscalibrated at lower levels of the predicted values." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-calibrationContinuousOutcomeLOESS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.28: Calibration Plot for Predictions of a Continuous Outcome, With LOESS Best-Fit Line. The yellow line is the best-fit line based on LOESS. The purple band is the 95% confidence interval of the observed value. The dashed red lines are the 95% prediction interval of the observed value. The 95% confidence interval of the observed value does not include the reference line (i.e., the actual observed value) at lower levels of the predicted values, so the predictions are miscalibrated at lower levels of the predicted values.
</figcaption></figure>
</div>
</div>
</div>
</section></section></section><section id="sec-cutoffAccuracy" class="level2" data-number="9.5"><h2 data-number="9.5" class="anchored" data-anchor-id="sec-cutoffAccuracy">
<span class="header-section-number">9.5</span> Prediction Accuracy at a Given Cutoff</h2>
<section id="sec-setCutoff" class="level3" data-number="9.5.1"><h3 data-number="9.5.1" class="anchored" data-anchor-id="sec-setCutoff">
<span class="header-section-number">9.5.1</span> Set a Cutoff</h3>
<p>Here, I set a cutoff at the Youden’s J Statistic to calculate the accuracy statistics at that cutoff:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a>cutoff <span class="ot">&lt;-</span> <span class="fl">0.205</span></span>
<span id="cb148-2"><a href="#cb148-2"></a></span>
<span id="cb148-3"><a href="#cb148-3"></a>mydataSDT<span class="sc">$</span>diagnosis <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb148-4"><a href="#cb148-4"></a>mydataSDT<span class="sc">$</span>diagnosis[mydataSDT<span class="sc">$</span>testScore <span class="sc">&lt;</span> cutoff] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb148-5"><a href="#cb148-5"></a>mydataSDT<span class="sc">$</span>diagnosis[mydataSDT<span class="sc">$</span>testScore <span class="sc">&gt;=</span> cutoff] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb148-6"><a href="#cb148-6"></a></span>
<span id="cb148-7"><a href="#cb148-7"></a>mydataSDT<span class="sc">$</span>diagnosisFactor <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb148-8"><a href="#cb148-8"></a>  mydataSDT<span class="sc">$</span>diagnosis,</span>
<span id="cb148-9"><a href="#cb148-9"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb148-10"><a href="#cb148-10"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Decision: Diagnosis"</span>, <span class="st">"Decision: No Diagnosis"</span>))</span>
<span id="cb148-11"><a href="#cb148-11"></a></span>
<span id="cb148-12"><a href="#cb148-12"></a>mydataSDT<span class="sc">$</span>disorderFactor <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb148-13"><a href="#cb148-13"></a>  mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb148-14"><a href="#cb148-14"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb148-15"><a href="#cb148-15"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Truth: Disorder"</span>, <span class="st">"Truth: No Disorder"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-accuracyAtCutoff" class="level3" data-number="9.5.2"><h3 data-number="9.5.2" class="anchored" data-anchor-id="sec-accuracyAtCutoff">
<span class="header-section-number">9.5.2</span> Accuracy at a Given Cutoff</h3>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>accuracyAtCutoff()</code> function that estimates the prediction accuracy at a given cutoff.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a><span class="fu">accuracyAtCutoff</span>(</span>
<span id="cb149-2"><a href="#cb149-2"></a>  <span class="at">predicted =</span> mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb149-3"><a href="#cb149-3"></a>  <span class="at">actual =</span> mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb149-4"><a href="#cb149-4"></a>  <span class="at">cutoff =</span> cutoff) <span class="sc">%&gt;%</span> </span>
<span id="cb149-5"><a href="#cb149-5"></a>  t <span class="sc">%&gt;%</span> </span>
<span id="cb149-6"><a href="#cb149-6"></a>  <span class="fu">round</span>(., <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                               [,1]
cutoff                                         0.20
TP                                            26.00
TN                                            56.00
FP                                            14.00
FN                                            14.00
SR                                             0.36
BR                                             0.36
percentAccuracy                               74.55
percentAccuracyByChance                       53.72
percentAccuracyPredictingFromBaseRate         63.64
RIOC                                           0.45
relativeImprovementOverPredictingFromBaseRate  0.15
SN                                             0.65
SP                                             0.80
TPrate                                         0.65
TNrate                                         0.80
FNrate                                         0.35
FPrate                                         0.20
HR                                             0.65
FAR                                            0.20
PPV                                            0.65
NPV                                            0.80
FDR                                            0.35
FOR                                            0.20
youdenJ                                        0.45
balancedAccuracy                               0.73
f1Score                                        0.65
mcc                                            0.45
diagnosticOddsRatio                            7.43
positiveLikelihoodRatio                        3.25
negativeLikelihoodRatio                        0.44
dPrimeSDT                                      1.23
betaSDT                                        1.32
cSDT                                           0.23
aSDT                                           0.79
bSDT                                           1.33
informationGain                                0.15
differenceBetweenPredictedAndObserved         -0.27</code></pre>
</div>
</div>
<p>There are also test calculators available online:</p>
<ul>
<li><a href="http://araw.mede.uic.edu/cgi-bin/testcalc.pl" class="uri">http://araw.mede.uic.edu/cgi-bin/testcalc.pl</a></li>
<li><a href="https://dlrs.shinyapps.io/shinyDLRs/" class="uri">https://dlrs.shinyapps.io/shinyDLRs/</a></li>
</ul></section><section id="sec-confusionMatrix" class="level3" data-number="9.5.3"><h3 data-number="9.5.3" class="anchored" data-anchor-id="sec-confusionMatrix">
<span class="header-section-number">9.5.3</span> Confusion Matrix aka 2x2 Accuracy Table aka Cross-Tabulation aka Contingency Table</h3>
<p>A <a href="#sec-confusionMatrix">confusion matrix</a> (aka 2x2 accuracy table, cross-tabulation table, or contigency table) is a matrix for categorical data that presents the predicted outcome on one dimension and the actual outcome (truth) on the other dimension. If the predictions and outcomes are dichotomous, the <a href="#sec-confusionMatrix">confusion matrix</a> is a 2x2 matrix with two rows and two columns that represent four possible predicted-actual combinations (<a href="#sec-decisionOutcomes-overview">decision outcomes</a>). In such a case, the confusion matrix provides a tabular count of each type of accurate cases (<a href="#sec-truePositive">true positives</a> and <a href="#sec-trueNegative">true negatives</a>) versus the number of each type of error (<a href="#sec-falsePositive">false positives</a> and <a href="#sec-falseNegative">false negatives</a>), as shown in <a href="#fig-confusionMatrix" class="quarto-xref">Figure&nbsp;<span>9.29</span></a>. An example of a <a href="#sec-confusionMatrix">confusion matrix</a> is in <a href="#fig-twoByTwoMatrix1" class="quarto-xref">Figure&nbsp;<span>9.4</span></a>.</p>
<div id="fig-confusionMatrix" class="quarto-float quarto-figure quarto-figure-center anchored" alt="[Confusion Matrix](#sec-confusionMatrix).">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-confusionMatrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/confusionMatrix.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29" title="Figure&nbsp;9.29: Confusion Matrix."><img src="images/confusionMatrix.png" class="img-fluid figure-img" style="width:100.0%" alt="[Confusion Matrix](#sec-confusionMatrix)."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-confusionMatrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.29: <a href="#sec-confusionMatrix">Confusion Matrix</a>.
</figcaption></figure>
</div>
<section id="sec-confusionMatrix-number" class="level4" data-number="9.5.3.1"><h4 data-number="9.5.3.1" class="anchored" data-anchor-id="sec-confusionMatrix-number">
<span class="header-section-number">9.5.3.1</span> Number</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a><span class="fu">table</span>(mydataSDT<span class="sc">$</span>diagnosisFactor, mydataSDT<span class="sc">$</span>disorderFactor)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                        
                         Truth: Disorder Truth: No Disorder
  Decision: Diagnosis                 26                 14
  Decision: No Diagnosis              14                 56</code></pre>
</div>
</div>
</section><section id="sec-confusionMatrix-numberMargins" class="level4" data-number="9.5.3.2"><h4 data-number="9.5.3.2" class="anchored" data-anchor-id="sec-confusionMatrix-numberMargins">
<span class="header-section-number">9.5.3.2</span> Number with margins added</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(mydataSDT<span class="sc">$</span>diagnosisFactor, mydataSDT<span class="sc">$</span>disorderFactor))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                        
                         Truth: Disorder Truth: No Disorder Sum
  Decision: Diagnosis                 26                 14  40
  Decision: No Diagnosis              14                 56  70
  Sum                                 40                 70 110</code></pre>
</div>
</div>
</section><section id="sec-confusionMatrix-numberMarginsProportions" class="level4" data-number="9.5.3.3"><h4 data-number="9.5.3.3" class="anchored" data-anchor-id="sec-confusionMatrix-numberMarginsProportions">
<span class="header-section-number">9.5.3.3</span> Proportions</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(mydataSDT<span class="sc">$</span>diagnosisFactor, mydataSDT<span class="sc">$</span>disorderFactor))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                        
                         Truth: Disorder Truth: No Disorder
  Decision: Diagnosis          0.2363636          0.1272727
  Decision: No Diagnosis       0.1272727          0.5090909</code></pre>
</div>
</div>
</section><section id="sec-confusionMatrix-numberMarginsProportionsMargins" class="level4" data-number="9.5.3.4"><h4 data-number="9.5.3.4" class="anchored" data-anchor-id="sec-confusionMatrix-numberMarginsProportionsMargins">
<span class="header-section-number">9.5.3.4</span> Proportions with margins added</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(mydataSDT<span class="sc">$</span>diagnosisFactor, mydataSDT<span class="sc">$</span>disorderFactor)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                        
                         Truth: Disorder Truth: No Disorder       Sum
  Decision: Diagnosis          0.2363636          0.1272727 0.3636364
  Decision: No Diagnosis       0.1272727          0.5090909 0.6363636
  Sum                          0.3636364          0.6363636 1.0000000</code></pre>
</div>
</div>
</section></section><section id="sec-truePositive" class="level3" data-number="9.5.4"><h3 data-number="9.5.4" class="anchored" data-anchor-id="sec-truePositive">
<span class="header-section-number">9.5.4</span> True Positives (TP)</h3>
<p>True positives (TPs) are instances in which a positive classification (e.g., a disorder present) is correct—that is, the test says that a classification is present, and the classification is present. True positives are also called valid positives (VPs) or hits. Higher values (relative to the same sample size) reflect greater accuracy. The formula for true positives is in <a href="#eq-truePositive" class="quarto-xref">Equation&nbsp;<span>9.36</span></a>:</p>
<p><span id="eq-truePositive"><span class="math display">\[
\begin{aligned}
  \text{TP} &amp;= \text{BR} \times \text{SR} \times N
\end{aligned}
\tag{9.36}\]</span></span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1"></a>TPvalue <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(</span>
<span id="cb159-2"><a href="#cb159-2"></a>  mydataSDT<span class="sc">$</span>diagnosis <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> mydataSDT<span class="sc">$</span>disorder <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb159-3"><a href="#cb159-3"></a></span>
<span id="cb159-4"><a href="#cb159-4"></a>TPvalue</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 26</code></pre>
</div>
</div>
</section><section id="sec-trueNegative" class="level3" data-number="9.5.5"><h3 data-number="9.5.5" class="anchored" data-anchor-id="sec-trueNegative">
<span class="header-section-number">9.5.5</span> True Negatives (TN)</h3>
<p>True negatives (TNs) are instances in which a negative classification (e.g., absence of a disorder) is correct—that is, the test says that a classification is not present, and the classification is actually not present. True negatives are also called valid negatives (VNs) or correct rejections. Higher values (relative to the same sample size) reflect greater accuracy. The formula for true negatives is in <a href="#eq-trueNegative" class="quarto-xref">Equation&nbsp;<span>9.37</span></a>:</p>
<p><span id="eq-trueNegative"><span class="math display">\[
\begin{aligned}
  \text{TN} &amp;= (1 - \text{BR}) \times (1 - \text{SR}) \times N
\end{aligned}
\tag{9.37}\]</span></span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a>TNvalue <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(</span>
<span id="cb161-2"><a href="#cb161-2"></a>  mydataSDT<span class="sc">$</span>diagnosis <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> mydataSDT<span class="sc">$</span>disorder <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb161-3"><a href="#cb161-3"></a></span>
<span id="cb161-4"><a href="#cb161-4"></a>TNvalue</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 56</code></pre>
</div>
</div>
</section><section id="sec-falsePositive" class="level3" data-number="9.5.6"><h3 data-number="9.5.6" class="anchored" data-anchor-id="sec-falsePositive">
<span class="header-section-number">9.5.6</span> False Positives (FP)</h3>
<p>False positives (FPs) are instances in which a positive classification (e.g., a disorder present) is incorrect—that is, the test says that a classification is present, and the classification is not present. False positives are also called false alarms (FAs). Lower values (relative to the same sample size) reflect greater accuracy. The formula for false positives is in <a href="#eq-falsePositive" class="quarto-xref">Equation&nbsp;<span>9.38</span></a>:</p>
<p><span id="eq-falsePositive"><span class="math display">\[
\begin{aligned}
  \text{FP} &amp;= (1 - \text{BR}) \times \text{SR} \times N
\end{aligned}
\tag{9.38}\]</span></span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1"></a>FPvalue <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(</span>
<span id="cb163-2"><a href="#cb163-2"></a>  mydataSDT<span class="sc">$</span>diagnosis <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> mydataSDT<span class="sc">$</span>disorder <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb163-3"><a href="#cb163-3"></a></span>
<span id="cb163-4"><a href="#cb163-4"></a>FPvalue</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 14</code></pre>
</div>
</div>
</section><section id="sec-falseNegative" class="level3" data-number="9.5.7"><h3 data-number="9.5.7" class="anchored" data-anchor-id="sec-falseNegative">
<span class="header-section-number">9.5.7</span> False Negatives (FN)</h3>
<p>False negatives (FNs) are instances in which a negative classification (e.g., absence of a disorder) is incorrect—that is, the test says that a classification is not present, and the classification is present. False negatives are also called misses. Lower values (relative to the same sample size) reflect greater accuracy. The formula for false negatives is in <a href="#eq-falseNegative" class="quarto-xref">Equation&nbsp;<span>9.39</span></a>:</p>
<p><span id="eq-falseNegative"><span class="math display">\[
\begin{aligned}
  \text{FN} &amp;= \text{BR} \times (1 - \text{SR}) \times N
\end{aligned}
\tag{9.39}\]</span></span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1"></a>FNvalue <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(</span>
<span id="cb165-2"><a href="#cb165-2"></a>  mydataSDT<span class="sc">$</span>diagnosis <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> mydataSDT<span class="sc">$</span>disorder <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb165-3"><a href="#cb165-3"></a></span>
<span id="cb165-4"><a href="#cb165-4"></a>FNvalue</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 14</code></pre>
</div>
</div>
</section><section id="sec-sampleSize-prediction" class="level3" data-number="9.5.8"><h3 data-number="9.5.8" class="anchored" data-anchor-id="sec-sampleSize-prediction">
<span class="header-section-number">9.5.8</span> Sample Size (<em>N</em>)</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1"></a>sampleSize <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb167-2"><a href="#cb167-2"></a>  value <span class="ot">&lt;-</span> TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN</span>
<span id="cb167-3"><a href="#cb167-3"></a>  </span>
<span id="cb167-4"><a href="#cb167-4"></a>  <span class="fu">return</span>(value)</span>
<span id="cb167-5"><a href="#cb167-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb168"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1"></a><span class="fu">sampleSize</span>(</span>
<span id="cb168-2"><a href="#cb168-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb168-3"><a href="#cb168-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb168-4"><a href="#cb168-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb168-5"><a href="#cb168-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 110</code></pre>
</div>
</div>
</section><section id="sec-selectionRatio" class="level3" data-number="9.5.9"><h3 data-number="9.5.9" class="anchored" data-anchor-id="sec-selectionRatio">
<span class="header-section-number">9.5.9</span> Selection Ratio (SR)</h3>
<p>The selection ratio (SR) is the marginal probability of selection, independent of other things: <span class="math inline">\(P(R_i)\)</span>. In clinical psychology, the selection ratio is the proportion of people who test positive for the disorder, as in <a href="#eq-selectionRatio" class="quarto-xref">Equation&nbsp;<span>9.40</span></a>:</p>
<p><span id="eq-selectionRatio"><span class="math display">\[
\begin{aligned}
  \text{SR} &amp;= P(R_i) \\
  &amp;= \frac{\text{TP} + \text{FP}}{N}
\end{aligned}
\tag{9.40}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a>selectionRatio <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb170-2"><a href="#cb170-2"></a>  N <span class="ot">&lt;-</span> TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN</span>
<span id="cb170-3"><a href="#cb170-3"></a>  value <span class="ot">&lt;-</span> (TP <span class="sc">+</span> FP)<span class="sc">/</span>N</span>
<span id="cb170-4"><a href="#cb170-4"></a>  </span>
<span id="cb170-5"><a href="#cb170-5"></a>  <span class="fu">return</span>(value)</span>
<span id="cb170-6"><a href="#cb170-6"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a><span class="fu">selectionRatio</span>(</span>
<span id="cb171-2"><a href="#cb171-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb171-3"><a href="#cb171-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb171-4"><a href="#cb171-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb171-5"><a href="#cb171-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3636364</code></pre>
</div>
</div>
</section><section id="sec-pretestProbability" class="level3" data-number="9.5.10"><h3 data-number="9.5.10" class="anchored" data-anchor-id="sec-pretestProbability">
<span class="header-section-number">9.5.10</span> Base Rate (BR)</h3>
<p>The <a href="#sec-baseRate">base rate</a> (BR) of a classification is its <a href="#sec-baseRate">marginal probability</a>, independent of other things: <span class="math inline">\(P(C_i)\)</span>. In clinical psychology, the base rate of a disorder is its prevalence in the population, as in <a href="#eq-baseRate" class="quarto-xref">Equation&nbsp;<span>9.41</span></a>. Without additional information, the <a href="#sec-baseRate">base rate</a> is used as the initial <em>pretest probability</em>.</p>
<p><span id="eq-baseRate"><span class="math display">\[
\begin{aligned}
  \text{BR} &amp;= P(C_i) \\
  &amp;= \frac{\text{TP} + \text{FN}}{N}
\end{aligned}
\tag{9.41}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a>baseRate <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb173-2"><a href="#cb173-2"></a>  N <span class="ot">&lt;-</span> TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN</span>
<span id="cb173-3"><a href="#cb173-3"></a>  value <span class="ot">&lt;-</span> (TP <span class="sc">+</span> FN)<span class="sc">/</span>N</span>
<span id="cb173-4"><a href="#cb173-4"></a>  </span>
<span id="cb173-5"><a href="#cb173-5"></a>  <span class="fu">return</span>(value)</span>
<span id="cb173-6"><a href="#cb173-6"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1"></a><span class="fu">baseRate</span>(</span>
<span id="cb174-2"><a href="#cb174-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb174-3"><a href="#cb174-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb174-4"><a href="#cb174-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb174-5"><a href="#cb174-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3636364</code></pre>
</div>
</div>
</section><section id="sec-pretestOdds" class="level3" data-number="9.5.11"><h3 data-number="9.5.11" class="anchored" data-anchor-id="sec-pretestOdds">
<span class="header-section-number">9.5.11</span> Pretest Odds</h3>
<p>The pretest odds of a classification can be estimated using the pretest probability (i.e., <a href="#sec-baseRate">base rate</a>). To convert a probability to odds, divide the probability by one minus that probability, as in <a href="#eq-pretestOdds" class="quarto-xref">Equation&nbsp;<span>9.42</span></a>.</p>
<p><span id="eq-pretestOdds"><span class="math display">\[
\begin{aligned}
  \text{pretest odds} &amp;= \frac{\text{pretest probability}}{1 - \text{pretest probability}} \\
\end{aligned}
\tag{9.42}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb176"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1"></a>pretestOdds <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN, <span class="at">pretestProb =</span> <span class="cn">NULL</span>){</span>
<span id="cb176-2"><a href="#cb176-2"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(pretestProb)){</span>
<span id="cb176-3"><a href="#cb176-3"></a>    pretestProbability <span class="ot">&lt;-</span> pretestProb</span>
<span id="cb176-4"><a href="#cb176-4"></a>  } <span class="cf">else</span> {</span>
<span id="cb176-5"><a href="#cb176-5"></a>    N <span class="ot">&lt;-</span> TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN</span>
<span id="cb176-6"><a href="#cb176-6"></a>    pretestProbability <span class="ot">&lt;-</span> (TP <span class="sc">+</span> FN)<span class="sc">/</span>N</span>
<span id="cb176-7"><a href="#cb176-7"></a>  }</span>
<span id="cb176-8"><a href="#cb176-8"></a>  </span>
<span id="cb176-9"><a href="#cb176-9"></a>  value <span class="ot">&lt;-</span> pretestProbability <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pretestProbability)</span>
<span id="cb176-10"><a href="#cb176-10"></a>  </span>
<span id="cb176-11"><a href="#cb176-11"></a>  <span class="fu">return</span>(value)</span>
<span id="cb176-12"><a href="#cb176-12"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1"></a><span class="fu">pretestOdds</span>(</span>
<span id="cb177-2"><a href="#cb177-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb177-3"><a href="#cb177-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb177-4"><a href="#cb177-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb177-5"><a href="#cb177-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5714286</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1"></a><span class="fu">pretestOdds</span>(<span class="at">pretestProb =</span> <span class="fu">baseRate</span>(</span>
<span id="cb179-2"><a href="#cb179-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb179-3"><a href="#cb179-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb179-4"><a href="#cb179-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb179-5"><a href="#cb179-5"></a>  <span class="at">FN =</span> FNvalue))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5714286</code></pre>
</div>
</div>
</section><section id="sec-percentAccuracy" class="level3" data-number="9.5.12"><h3 data-number="9.5.12" class="anchored" data-anchor-id="sec-percentAccuracy">
<span class="header-section-number">9.5.12</span> Percent Accuracy</h3>
<p>Percent Accuracy is also called overall accuracy. Higher values reflect greater accuracy. The formula for percent accuracy is in <a href="#eq-percentAccuracy" class="quarto-xref">Equation&nbsp;<span>9.43</span></a>. Percent accuracy has several problems. First, it treats all errors (<a href="#sec-falsePositive">FP</a> and <a href="#sec-falseNegative">FN</a>) as equally important. However, in practice, it is rarely the case that <a href="#sec-falsePositive">false positives</a> and <a href="#sec-falseNegative">false negatives</a> are equally important. Second, percent accuracy can be misleading because it is highly influenced by <a href="#sec-baseRate">base rates</a>. You can have a high percent accuracy by predicting from the <a href="#sec-baseRate">base rate</a> and saying that no one has the characteristic (if the <a href="#sec-baseRate">base rate</a> is low) or that everyone has the characteristic (if the <a href="#sec-baseRate">base rate</a> is high). Thus, it is also important to consider other aspects of accuracy.</p>
<p><span id="eq-percentAccuracy"><span class="math display">\[
\text{Percent Accuracy} = 100\% \times \frac{\text{TP} + \text{TN}}{N}
\tag{9.43}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb181"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1"></a>percentAccuracy <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb181-2"><a href="#cb181-2"></a>  N <span class="ot">&lt;-</span> TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN</span>
<span id="cb181-3"><a href="#cb181-3"></a>  value <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> ((TP <span class="sc">+</span> TN)<span class="sc">/</span>N)</span>
<span id="cb181-4"><a href="#cb181-4"></a>  </span>
<span id="cb181-5"><a href="#cb181-5"></a>  <span class="fu">return</span>(value)</span>
<span id="cb181-6"><a href="#cb181-6"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1"></a><span class="fu">percentAccuracy</span>(</span>
<span id="cb182-2"><a href="#cb182-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb182-3"><a href="#cb182-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb182-4"><a href="#cb182-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb182-5"><a href="#cb182-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 74.54545</code></pre>
</div>
</div>
</section><section id="sec-percentAccuracyByChance" class="level3" data-number="9.5.13"><h3 data-number="9.5.13" class="anchored" data-anchor-id="sec-percentAccuracyByChance">
<span class="header-section-number">9.5.13</span> Percent Accuracy by Chance</h3>
<p>The formula for calculating percent accuracy by chance is in <a href="#eq-PercentAccuracyByChance" class="quarto-xref">Equation&nbsp;<span>9.44</span></a>.</p>
<p><span id="eq-PercentAccuracyByChance"><span class="math display">\[
\begin{aligned}
  \text{Percent Accuracy by Chance} &amp;= 100\% \times [P(\text{TP}) + P(\text{TN})] \\
  &amp;= 100\% \times \{(\text{BR} \times {\text{SR}}) + [(1 - \text{BR}) \times (1 - \text{SR})]\}
\end{aligned}
\tag{9.44}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1"></a>percentAccuracyByChance <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb184-2"><a href="#cb184-2"></a>  N <span class="ot">&lt;-</span> TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN</span>
<span id="cb184-3"><a href="#cb184-3"></a>  BR <span class="ot">&lt;-</span> (TP <span class="sc">+</span> FN)<span class="sc">/</span>N</span>
<span id="cb184-4"><a href="#cb184-4"></a>  SR <span class="ot">&lt;-</span> (TP <span class="sc">+</span> FP)<span class="sc">/</span>N</span>
<span id="cb184-5"><a href="#cb184-5"></a>  value <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> ((BR <span class="sc">*</span> SR) <span class="sc">+</span> ((<span class="dv">1</span> <span class="sc">-</span> BR) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> SR)))</span>
<span id="cb184-6"><a href="#cb184-6"></a>  </span>
<span id="cb184-7"><a href="#cb184-7"></a>  <span class="fu">return</span>(value)</span>
<span id="cb184-8"><a href="#cb184-8"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb185"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1"></a><span class="fu">percentAccuracyByChance</span>(</span>
<span id="cb185-2"><a href="#cb185-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb185-3"><a href="#cb185-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb185-4"><a href="#cb185-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb185-5"><a href="#cb185-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 53.71901</code></pre>
</div>
</div>
</section><section id="sec-percentAccuracyPredictingFromBaseRate" class="level3" data-number="9.5.14"><h3 data-number="9.5.14" class="anchored" data-anchor-id="sec-percentAccuracyPredictingFromBaseRate">
<span class="header-section-number">9.5.14</span> Percent Accuracy Predicting from the Base Rate</h3>
<p><a href="#sec-predictingFromBaseRate"><em>Predicting from the base rate</em></a> is going with the most likely outcome in every prediction. It is also called “betting from the base rate”. If the <a href="#sec-baseRate">base rate</a> is less than .50, it would involve predicting that the condition is absent for every case. If the <a href="#sec-baseRate">base rate</a> is .50 or above, it would involve predicting that the condition is present for every case. <a href="#sec-predictingFromBaseRate">Predicting from the base rate</a> is a special case of <a href="#sec-percentAccuracyByChance">percent accuracy by chance</a> when the <a href="#sec-selectionRatio">selection ratio</a> is set to either one (if the <a href="#sec-baseRate">base rate</a> <span class="math inline">\(\geq\)</span> .5) or zero (if the <a href="#sec-baseRate">base rate</a> &lt; .5).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1"></a>percentAccuracyPredictingFromBaseRate <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb187-2"><a href="#cb187-2"></a>  N <span class="ot">&lt;-</span> TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN</span>
<span id="cb187-3"><a href="#cb187-3"></a>  BR <span class="ot">&lt;-</span> (TP <span class="sc">+</span> FN)<span class="sc">/</span>N</span>
<span id="cb187-4"><a href="#cb187-4"></a>  </span>
<span id="cb187-5"><a href="#cb187-5"></a>  <span class="fu">ifelse</span>(BR <span class="sc">&gt;=</span> .<span class="dv">5</span>, SR <span class="ot">&lt;-</span> <span class="dv">1</span>, <span class="cn">NA</span>)</span>
<span id="cb187-6"><a href="#cb187-6"></a>  <span class="fu">ifelse</span>(BR <span class="sc">&lt;</span> .<span class="dv">5</span>, SR <span class="ot">&lt;-</span> <span class="dv">0</span>, <span class="cn">NA</span>)</span>
<span id="cb187-7"><a href="#cb187-7"></a></span>
<span id="cb187-8"><a href="#cb187-8"></a>  value <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> ((BR <span class="sc">*</span> SR) <span class="sc">+</span> ((<span class="dv">1</span> <span class="sc">-</span> BR) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> SR)))</span>
<span id="cb187-9"><a href="#cb187-9"></a>  </span>
<span id="cb187-10"><a href="#cb187-10"></a>  <span class="fu">return</span>(value)</span>
<span id="cb187-11"><a href="#cb187-11"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb188"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1"></a><span class="fu">percentAccuracyPredictingFromBaseRate</span>(</span>
<span id="cb188-2"><a href="#cb188-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb188-3"><a href="#cb188-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb188-4"><a href="#cb188-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb188-5"><a href="#cb188-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 63.63636</code></pre>
</div>
</div>
</section><section id="sec-relativeImprovementOverChance" class="level3" data-number="9.5.15"><h3 data-number="9.5.15" class="anchored" data-anchor-id="sec-relativeImprovementOverChance">
<span class="header-section-number">9.5.15</span> Relative Improvement Over Chance (RIOC)</h3>
<p>Relative improvement over chance (RIOC) is a prediction’s improvement over chance as a proportion of the maximum possible improvement over chance, as described by <span class="citation" data-cites="Farrington1989">Farrington &amp; Loeber (<a href="references.html#ref-Farrington1989" role="doc-biblioref">1989</a>)</span>. Higher values reflect greater accuracy. The formula for calculating RIOC is in <a href="#eq-relativeImprovementOverChance" class="quarto-xref">Equation&nbsp;<span>9.45</span></a>.</p>
<p><span id="eq-relativeImprovementOverChance"><span class="math display">\[
\begin{aligned}
  \text{relative improvement over chance (RIOC)} &amp;= \frac{\text{total correct} - \text{chance correct}}{\text{maximum correct} - \text{chance correct}} \\
\end{aligned}
\tag{9.45}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb190"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1"></a>relativeImprovementOverChance <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb190-2"><a href="#cb190-2"></a>  N <span class="ot">&lt;-</span> TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN</span>
<span id="cb190-3"><a href="#cb190-3"></a>  actualYes <span class="ot">&lt;-</span> TP <span class="sc">+</span> FN</span>
<span id="cb190-4"><a href="#cb190-4"></a>  predictedYes <span class="ot">&lt;-</span> TP <span class="sc">+</span> FP</span>
<span id="cb190-5"><a href="#cb190-5"></a>  value <span class="ot">&lt;-</span> ((N <span class="sc">*</span> (TP <span class="sc">+</span> TN)) <span class="sc">-</span> (actualYes <span class="sc">*</span> predictedYes <span class="sc">+</span> (N <span class="sc">-</span> predictedYes) <span class="sc">*</span> (N <span class="sc">-</span> actualYes))) <span class="sc">/</span> ((N <span class="sc">*</span> (actualYes <span class="sc">+</span> N <span class="sc">-</span> predictedYes)) <span class="sc">-</span> (actualYes <span class="sc">*</span> predictedYes <span class="sc">+</span> (N <span class="sc">-</span> predictedYes) <span class="sc">*</span> (N <span class="sc">-</span> actualYes)))</span>
<span id="cb190-6"><a href="#cb190-6"></a>  </span>
<span id="cb190-7"><a href="#cb190-7"></a>  <span class="fu">return</span>(value)</span>
<span id="cb190-8"><a href="#cb190-8"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb191"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1"></a><span class="fu">relativeImprovementOverChance</span>(</span>
<span id="cb191-2"><a href="#cb191-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb191-3"><a href="#cb191-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb191-4"><a href="#cb191-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb191-5"><a href="#cb191-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.45</code></pre>
</div>
</div>
</section><section id="sec-relativeImprovementOverPredictingFromBaseRate" class="level3" data-number="9.5.16"><h3 data-number="9.5.16" class="anchored" data-anchor-id="sec-relativeImprovementOverPredictingFromBaseRate">
<span class="header-section-number">9.5.16</span> Relative Improvement Over Predicting from the Base Rate</h3>
<p>Relative improvement over <a href="#sec-predictingFromBaseRate">predicting from the base rate</a> is a prediction’s improvement over <a href="#sec-predictingFromBaseRate">predicting from the base rate</a> as a proportion of the maximum possible improvement over <a href="#sec-predictingFromBaseRate">predicting from the base rate</a>. Higher values reflect greater accuracy. The formula for calculating relative improvement over predicting from the base rate is in <a href="#eq-relativeImprovementOverPredictingFromBaseRate" class="quarto-xref">Equation&nbsp;<span>9.46</span></a>.</p>
<p><span id="eq-relativeImprovementOverPredictingFromBaseRate"><span class="math display">\[
\scriptsize
\begin{aligned}
  \text{relative improvement over predicting from base rate} &amp;= \frac{\text{total correct} - \text{correct by predicting from base rate}}{\text{maximum correct} - \text{correct by predicting from base rate}} \\
\end{aligned}
\tag{9.46}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb193"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1"></a>relativeImprovementOverPredictingFromBaseRate <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb193-2"><a href="#cb193-2"></a>  N <span class="ot">&lt;-</span> TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN</span>
<span id="cb193-3"><a href="#cb193-3"></a>  BR <span class="ot">&lt;-</span> (TP <span class="sc">+</span> FN)<span class="sc">/</span>N</span>
<span id="cb193-4"><a href="#cb193-4"></a></span>
<span id="cb193-5"><a href="#cb193-5"></a>  <span class="fu">ifelse</span>(BR <span class="sc">&gt;=</span> .<span class="dv">5</span>, SR <span class="ot">&lt;-</span> <span class="dv">1</span>, <span class="cn">NA</span>)</span>
<span id="cb193-6"><a href="#cb193-6"></a>  <span class="fu">ifelse</span>(BR <span class="sc">&lt;</span> .<span class="dv">5</span>, SR <span class="ot">&lt;-</span> <span class="dv">0</span>, <span class="cn">NA</span>)</span>
<span id="cb193-7"><a href="#cb193-7"></a>  </span>
<span id="cb193-8"><a href="#cb193-8"></a>  actualYes <span class="ot">&lt;-</span> TP <span class="sc">+</span> FN</span>
<span id="cb193-9"><a href="#cb193-9"></a>  predictedYes <span class="ot">&lt;-</span> SR <span class="sc">*</span> N</span>
<span id="cb193-10"><a href="#cb193-10"></a>  value <span class="ot">&lt;-</span> ((N <span class="sc">*</span> (TP <span class="sc">+</span> TN)) <span class="sc">-</span> (actualYes <span class="sc">*</span> predictedYes <span class="sc">+</span> (N <span class="sc">-</span> predictedYes) <span class="sc">*</span> (N <span class="sc">-</span> actualYes))) <span class="sc">/</span> ((N <span class="sc">*</span> (actualYes <span class="sc">+</span> N <span class="sc">-</span> predictedYes)) <span class="sc">-</span> (actualYes <span class="sc">*</span> predictedYes <span class="sc">+</span> (N <span class="sc">-</span> predictedYes) <span class="sc">*</span> (N <span class="sc">-</span> actualYes)))</span>
<span id="cb193-11"><a href="#cb193-11"></a>  </span>
<span id="cb193-12"><a href="#cb193-12"></a>  <span class="fu">return</span>(value)</span>
<span id="cb193-13"><a href="#cb193-13"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb194"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1"></a><span class="fu">relativeImprovementOverPredictingFromBaseRate</span>(</span>
<span id="cb194-2"><a href="#cb194-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb194-3"><a href="#cb194-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb194-4"><a href="#cb194-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb194-5"><a href="#cb194-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.15</code></pre>
</div>
</div>
</section><section id="sec-sensitivity" class="level3" data-number="9.5.17"><h3 data-number="9.5.17" class="anchored" data-anchor-id="sec-sensitivity">
<span class="header-section-number">9.5.17</span> Sensitivity (SN)</h3>
<p>Sensitivity (SN) is also called true positive rate (TPR), hit rate (HR), or recall. Sensitivity is the <a href="#sec-conditionalProbability">conditional probability</a> of a positive test given that the person has the condition: <span class="math inline">\(P(R|C)\)</span>. Higher values reflect greater accuracy. The formula for calculating sensitivity is in <a href="#eq-sensitivity" class="quarto-xref">Equation&nbsp;<span>9.47</span></a>. As described in <a href="#sec-accuracyCutoff" class="quarto-xref"><span>Section 9.1.2.6.1</span></a> and as depicted in <a href="#fig-sensitivitySpecificity" class="quarto-xref">Figure&nbsp;<span>9.30</span></a>, as the cutoff increases (becomes more conservative), sensitivity decreases. As the cutoff decreases, sensitivity increases.</p>
<p><span id="eq-sensitivity"><span class="math display">\[
\begin{aligned}
  \text{sensitivity (SN)} &amp;= P(R|C) \\
  &amp;= \frac{\text{TP}}{\text{TP} + \text{FN}} = \frac{\text{TP}}{N \times \text{BR}} = 1 - \text{FNR}
\end{aligned}
\tag{9.47}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb196"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1"></a>sensitivity <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb196-2"><a href="#cb196-2"></a>  value <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)</span>
<span id="cb196-3"><a href="#cb196-3"></a>  </span>
<span id="cb196-4"><a href="#cb196-4"></a>  <span class="fu">return</span>(value)</span>
<span id="cb196-5"><a href="#cb196-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb197"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1"></a><span class="fu">sensitivity</span>(</span>
<span id="cb197-2"><a href="#cb197-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb197-3"><a href="#cb197-3"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.65</code></pre>
</div>
</div>
<p>Below I compute sensitivity and <a href="#sec-specificity">specificity</a> at every possible cutoff.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb199"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1"></a>possibleCutoffs <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">na.omit</span>(mydataSDT<span class="sc">$</span>testScore))</span>
<span id="cb199-2"><a href="#cb199-2"></a>possibleCutoffs <span class="ot">&lt;-</span> possibleCutoffs[<span class="fu">order</span>(possibleCutoffs)]</span>
<span id="cb199-3"><a href="#cb199-3"></a>possibleCutoffs <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb199-4"><a href="#cb199-4"></a>  possibleCutoffs,</span>
<span id="cb199-5"><a href="#cb199-5"></a>  <span class="fu">max</span>(possibleCutoffs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fl">0.01</span>)</span>
<span id="cb199-6"><a href="#cb199-6"></a></span>
<span id="cb199-7"><a href="#cb199-7"></a>specificity <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb199-8"><a href="#cb199-8"></a>  value <span class="ot">&lt;-</span> TN<span class="sc">/</span>(TN <span class="sc">+</span> FP)</span>
<span id="cb199-9"><a href="#cb199-9"></a>  </span>
<span id="cb199-10"><a href="#cb199-10"></a>  <span class="fu">return</span>(value)</span>
<span id="cb199-11"><a href="#cb199-11"></a>}</span>
<span id="cb199-12"><a href="#cb199-12"></a></span>
<span id="cb199-13"><a href="#cb199-13"></a>accuracyVariables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cutoff"</span>, <span class="st">"TP"</span>, <span class="st">"TN"</span>, <span class="st">"FP"</span>, <span class="st">"FN"</span>)</span>
<span id="cb199-14"><a href="#cb199-14"></a></span>
<span id="cb199-15"><a href="#cb199-15"></a>accuracyStats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(</span>
<span id="cb199-16"><a href="#cb199-16"></a>  <span class="at">nrow =</span> <span class="fu">length</span>(possibleCutoffs),</span>
<span id="cb199-17"><a href="#cb199-17"></a>  <span class="at">ncol =</span> <span class="fu">length</span>(accuracyVariables)))</span>
<span id="cb199-18"><a href="#cb199-18"></a></span>
<span id="cb199-19"><a href="#cb199-19"></a><span class="fu">names</span>(accuracyStats) <span class="ot">&lt;-</span> accuracyVariables</span>
<span id="cb199-20"><a href="#cb199-20"></a></span>
<span id="cb199-21"><a href="#cb199-21"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(possibleCutoffs)){</span>
<span id="cb199-22"><a href="#cb199-22"></a>  newCutoff <span class="ot">&lt;-</span> possibleCutoffs[i]</span>
<span id="cb199-23"><a href="#cb199-23"></a>  </span>
<span id="cb199-24"><a href="#cb199-24"></a>  mydataSDT<span class="sc">$</span>diagnosis <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb199-25"><a href="#cb199-25"></a>  mydataSDT<span class="sc">$</span>diagnosis[mydataSDT<span class="sc">$</span>testScore <span class="sc">&lt;</span> newCutoff] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb199-26"><a href="#cb199-26"></a>  mydataSDT<span class="sc">$</span>diagnosis[mydataSDT<span class="sc">$</span>testScore <span class="sc">&gt;=</span> newCutoff] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb199-27"><a href="#cb199-27"></a>  </span>
<span id="cb199-28"><a href="#cb199-28"></a>  accuracyStats[i, <span class="st">"cutoff"</span>] <span class="ot">&lt;-</span> newCutoff</span>
<span id="cb199-29"><a href="#cb199-29"></a>  accuracyStats[i, <span class="st">"TP"</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(</span>
<span id="cb199-30"><a href="#cb199-30"></a>    mydataSDT<span class="sc">$</span>diagnosis <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> mydataSDT<span class="sc">$</span>disorder <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb199-31"><a href="#cb199-31"></a>  accuracyStats[i, <span class="st">"TN"</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(</span>
<span id="cb199-32"><a href="#cb199-32"></a>    mydataSDT<span class="sc">$</span>diagnosis <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> mydataSDT<span class="sc">$</span>disorder <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb199-33"><a href="#cb199-33"></a>  accuracyStats[i, <span class="st">"FP"</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(</span>
<span id="cb199-34"><a href="#cb199-34"></a>    mydataSDT<span class="sc">$</span>diagnosis <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> mydataSDT<span class="sc">$</span>disorder <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb199-35"><a href="#cb199-35"></a>  accuracyStats[i, <span class="st">"FN"</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(</span>
<span id="cb199-36"><a href="#cb199-36"></a>    mydataSDT<span class="sc">$</span>diagnosis <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> mydataSDT<span class="sc">$</span>disorder <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb199-37"><a href="#cb199-37"></a>}</span>
<span id="cb199-38"><a href="#cb199-38"></a></span>
<span id="cb199-39"><a href="#cb199-39"></a>accuracyStats<span class="sc">$</span>sensitivity <span class="ot">&lt;-</span> accuracyStats<span class="sc">$</span>TPrate <span class="ot">&lt;-</span> <span class="fu">sensitivity</span>(</span>
<span id="cb199-40"><a href="#cb199-40"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb199-41"><a href="#cb199-41"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb199-42"><a href="#cb199-42"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb199-43"><a href="#cb199-43"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb199-44"><a href="#cb199-44"></a></span>
<span id="cb199-45"><a href="#cb199-45"></a>accuracyStats<span class="sc">$</span>specificity <span class="ot">&lt;-</span> accuracyStats<span class="sc">$</span>TNrate <span class="ot">&lt;-</span> <span class="fu">specificity</span>(</span>
<span id="cb199-46"><a href="#cb199-46"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb199-47"><a href="#cb199-47"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb199-48"><a href="#cb199-48"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb199-49"><a href="#cb199-49"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb199-50"><a href="#cb199-50"></a></span>
<span id="cb199-51"><a href="#cb199-51"></a>sensitivitySpecificityData <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(</span>
<span id="cb199-52"><a href="#cb199-52"></a>  accuracyStats,</span>
<span id="cb199-53"><a href="#cb199-53"></a>  <span class="at">cols =</span> <span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">"sensitivity"</span>,<span class="st">"specificity"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sensitivitySpecificity" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Sensitivity and Specificity as a Function of the Cutoff.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-sensitivitySpecificity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-sensitivitySpecificity-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Figure&nbsp;9.30: Sensitivity and Specificity as a Function of the Cutoff."><img src="prediction_files/figure-html/fig-sensitivitySpecificity-1.png" class="img-fluid figure-img" alt="Sensitivity and Specificity as a Function of the Cutoff." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sensitivitySpecificity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.30: Sensitivity and Specificity as a Function of the Cutoff.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-specificity" class="level3" data-number="9.5.18"><h3 data-number="9.5.18" class="anchored" data-anchor-id="sec-specificity">
<span class="header-section-number">9.5.18</span> Specificity (SP)</h3>
<p>Specificity (SP) is also called true negative rate (TNR) or selectivity. Specificity is the <a href="#sec-conditionalProbability">conditional probability</a> of a negative test given that the person does not have the condition: <span class="math inline">\(P(\text{not } R|\text{not } C)\)</span>. Higher values reflect greater accuracy. The formula for calculating specificity is in <a href="#eq-specificity" class="quarto-xref">Equation&nbsp;<span>9.48</span></a>. As described in <a href="#sec-accuracyCutoff" class="quarto-xref"><span>Section 9.1.2.6.1</span></a> and as depicted in <a href="#fig-sensitivitySpecificity" class="quarto-xref">Figure&nbsp;<span>9.30</span></a>, as the cutoff increases (becomes more conservative), specificity increases. As the cutoff decreases, specificity decreases.</p>
<p><span id="eq-specificity"><span class="math display">\[
\begin{aligned}
  \text{specificity (SP)} &amp;= P(\text{not } R|\text{not } C) \\
  &amp;= \frac{\text{TN}}{\text{TN} + \text{FP}} = \frac{\text{TN}}{N (1 - \text{BR})} = 1 - \text{FPR}
\end{aligned}
\tag{9.48}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb200"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1"></a>specificity <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb200-2"><a href="#cb200-2"></a>  value <span class="ot">&lt;-</span> TN<span class="sc">/</span>(TN <span class="sc">+</span> FP)</span>
<span id="cb200-3"><a href="#cb200-3"></a>  </span>
<span id="cb200-4"><a href="#cb200-4"></a>  <span class="fu">return</span>(value)</span>
<span id="cb200-5"><a href="#cb200-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb201"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1"></a><span class="fu">specificity</span>(<span class="at">TN =</span> TNvalue, <span class="at">FP =</span> FPvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8</code></pre>
</div>
</div>
</section><section id="sec-falseNegativeRate" class="level3" data-number="9.5.19"><h3 data-number="9.5.19" class="anchored" data-anchor-id="sec-falseNegativeRate">
<span class="header-section-number">9.5.19</span> False Negative Rate (FNR)</h3>
<p>The false negative rate (FNR) is also called the miss rate. The false negative rate is the <a href="#sec-conditionalProbability">conditional probability</a> of a negative test given that the person has the condition: <span class="math inline">\(P(\text{not } R|C)\)</span>. Lower values reflect greater accuracy. The formula for calculating false negative rate is in <a href="#eq-falseNegativeRate" class="quarto-xref">Equation&nbsp;<span>9.49</span></a>.</p>
<p><span id="eq-falseNegativeRate"><span class="math display">\[
\begin{aligned}
  \text{false negative rate (FNR)} &amp;= P(\text{not } R|C) \\
  &amp;= \frac{\text{FN}}{\text{FN} + \text{TP}} = \frac{\text{FN}}{N \times \text{BR}} = 1 - \text{TPR}
\end{aligned}
\tag{9.49}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb203"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1"></a>falseNegativeRate <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb203-2"><a href="#cb203-2"></a>  value <span class="ot">&lt;-</span> FN<span class="sc">/</span>(FN <span class="sc">+</span> TP)</span>
<span id="cb203-3"><a href="#cb203-3"></a>  </span>
<span id="cb203-4"><a href="#cb203-4"></a>  <span class="fu">return</span>(value)</span>
<span id="cb203-5"><a href="#cb203-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb204"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1"></a><span class="fu">falseNegativeRate</span>(</span>
<span id="cb204-2"><a href="#cb204-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb204-3"><a href="#cb204-3"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.35</code></pre>
</div>
</div>
</section><section id="sec-falsePositiveRate" class="level3" data-number="9.5.20"><h3 data-number="9.5.20" class="anchored" data-anchor-id="sec-falsePositiveRate">
<span class="header-section-number">9.5.20</span> False Positive Rate (FPR)</h3>
<p>The false positive rate (FPR) is also called the false alarm rate (FAR) or fall-out. The false positive rate is the <a href="#sec-conditionalProbability">conditional probability</a> of a positive test given that the person does not have the condition: <span class="math inline">\(P(R|\text{not } C)\)</span>. Lower values reflect greater accuracy. The formula for calculating false positive rate is in <a href="#eq-falsePositiveRate" class="quarto-xref">Equation&nbsp;<span>9.50</span></a>.</p>
<p><span id="eq-falsePositiveRate"><span class="math display">\[
\begin{aligned}
  \text{false positive rate (FPR)} &amp;= P(R|\text{not } C) \\
  &amp;= \frac{\text{FP}}{\text{FP} + \text{TN}} = \frac{\text{FP}}{N (1 - \text{BR})} = 1 - \text{TNR}
\end{aligned}
\tag{9.50}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb206"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1"></a>falsePositiveRate <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb206-2"><a href="#cb206-2"></a>  value <span class="ot">&lt;-</span> FP<span class="sc">/</span>(FP <span class="sc">+</span> TN)</span>
<span id="cb206-3"><a href="#cb206-3"></a>  </span>
<span id="cb206-4"><a href="#cb206-4"></a>  <span class="fu">return</span>(value)</span>
<span id="cb206-5"><a href="#cb206-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb207"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1"></a><span class="fu">falsePositiveRate</span>(</span>
<span id="cb207-2"><a href="#cb207-2"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb207-3"><a href="#cb207-3"></a>  <span class="at">FP =</span> FPvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2</code></pre>
</div>
</div>
</section><section id="sec-ppv" class="level3" data-number="9.5.21"><h3 data-number="9.5.21" class="anchored" data-anchor-id="sec-ppv">
<span class="header-section-number">9.5.21</span> Positive Predictive Value (PPV)</h3>
<p>The positive predictive value (PPV) is also called the positive predictive power (PPP) or precision. Many people confuse <a href="#sec-sensitivity">sensitivity</a> (<span class="math inline">\(P(R|C)\)</span>) with its inverse <a href="#sec-conditionalProbability">conditional probability</a>, PPV (<span class="math inline">\(P(C|R)\)</span>). PPV is the <a href="#sec-conditionalProbability">conditional probability</a> of having the condition given a positive test: <span class="math inline">\(P(C|R)\)</span>. Higher values reflect greater accuracy. The formula for calculating positive predictive value is in <a href="#eq-positivePredictiveValue" class="quarto-xref">Equation&nbsp;<span>9.51</span></a>.</p>
<p>PPV can be low even when <a href="#sec-sensitivity">sensitivity</a> is high because it depends not only on <a href="#sec-sensitivity">sensitivity</a>, but also on <a href="#sec-specificity">specificity</a> and the <a href="#sec-baseRate">base rate</a>. Because PPV depends on the <a href="#sec-baseRate">base rate</a>, PPV is not an intrinsic property of a measure. The same measure will have a different PPV in different contexts with different <a href="#sec-baseRate">base rates</a> <span class="citation" data-cites="Treat2023">(<a href="references.html#ref-Treat2023" role="doc-biblioref">Treat &amp; Viken, 2023</a>)</span>. As described in <a href="#sec-accuracyCutoff" class="quarto-xref"><span>Section 9.1.2.6.1</span></a> and as depicted in <a href="#fig-ppvNPVbaseRate" class="quarto-xref">Figure&nbsp;<span>9.31</span></a>, as the <a href="#sec-baseRate">base rate</a> increases, PPV increases. As the <a href="#sec-baseRate">base rate</a> decreases, PPV decreases. PPV also differs as a function of the cutoff. As described in <a href="#sec-accuracyCutoff" class="quarto-xref"><span>Section 9.1.2.6.1</span></a> and as depicted in <a href="#fig-ppvNPVcutoff" class="quarto-xref">Figure&nbsp;<span>9.32</span></a>, as the cutoff increases (becomes more conservative), PPV increases. As the cutoff decreases (becomes more liberal), PPV decreases.</p>
<p><span id="eq-positivePredictiveValue"><span class="math display">\[
\small
\begin{aligned}
  \text{positive predictive value (PPV)} &amp;= P(C|R) \\
  &amp;= \frac{\text{TP}}{\text{TP} + \text{FP}} = \frac{\text{TP}}{N \times \text{SR}}\\
  &amp;= \frac{\text{sensitivity} \times {\text{BR}}}{\text{sensitivity} \times {\text{BR}} + [(1 - \text{specificity}) \times (1 - \text{BR})]}
\end{aligned}
\tag{9.51}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb209"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1"></a>positivePredictiveValue <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN, <span class="at">BR =</span> <span class="cn">NULL</span>, SN, SP){</span>
<span id="cb209-2"><a href="#cb209-2"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(BR)){</span>
<span id="cb209-3"><a href="#cb209-3"></a>    value <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FP)</span>
<span id="cb209-4"><a href="#cb209-4"></a>  } <span class="cf">else</span>{</span>
<span id="cb209-5"><a href="#cb209-5"></a>    value <span class="ot">&lt;-</span> (SN <span class="sc">*</span> BR)<span class="sc">/</span>(SN <span class="sc">*</span> BR <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> SP) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> BR))</span>
<span id="cb209-6"><a href="#cb209-6"></a>  }</span>
<span id="cb209-7"><a href="#cb209-7"></a>  </span>
<span id="cb209-8"><a href="#cb209-8"></a>  <span class="fu">return</span>(value)</span>
<span id="cb209-9"><a href="#cb209-9"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb210"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1"></a><span class="fu">positivePredictiveValue</span>(</span>
<span id="cb210-2"><a href="#cb210-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb210-3"><a href="#cb210-3"></a>  <span class="at">FP =</span> FPvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.65</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb212"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1"></a><span class="fu">positivePredictiveValue</span>(</span>
<span id="cb212-2"><a href="#cb212-2"></a>  <span class="at">BR =</span> <span class="fu">baseRate</span>(</span>
<span id="cb212-3"><a href="#cb212-3"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb212-4"><a href="#cb212-4"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb212-5"><a href="#cb212-5"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb212-6"><a href="#cb212-6"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb212-7"><a href="#cb212-7"></a>  <span class="at">SN =</span> <span class="fu">sensitivity</span>(</span>
<span id="cb212-8"><a href="#cb212-8"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb212-9"><a href="#cb212-9"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb212-10"><a href="#cb212-10"></a>  <span class="at">SP =</span> <span class="fu">specificity</span>(</span>
<span id="cb212-11"><a href="#cb212-11"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb212-12"><a href="#cb212-12"></a>    <span class="at">FP =</span> FPvalue))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.65</code></pre>
</div>
</div>
<p>Below I compute PPV and <a href="#sec-npv">NPV</a> at every possible <a href="#sec-baseRate">base rate</a> given the <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a> at the current cutoff.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb214"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1"></a>negativePredictiveValue <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN, <span class="at">BR =</span> <span class="cn">NULL</span>, SN, SP){</span>
<span id="cb214-2"><a href="#cb214-2"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(BR)){</span>
<span id="cb214-3"><a href="#cb214-3"></a>    value <span class="ot">&lt;-</span> TN<span class="sc">/</span>(TN <span class="sc">+</span> FN)</span>
<span id="cb214-4"><a href="#cb214-4"></a>  } <span class="cf">else</span>{</span>
<span id="cb214-5"><a href="#cb214-5"></a>    value <span class="ot">&lt;-</span> (SP <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> BR))<span class="sc">/</span>(SP <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> BR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> SN) <span class="sc">*</span> BR)</span>
<span id="cb214-6"><a href="#cb214-6"></a>  }</span>
<span id="cb214-7"><a href="#cb214-7"></a>  </span>
<span id="cb214-8"><a href="#cb214-8"></a>  <span class="fu">return</span>(value)</span>
<span id="cb214-9"><a href="#cb214-9"></a>}</span>
<span id="cb214-10"><a href="#cb214-10"></a></span>
<span id="cb214-11"><a href="#cb214-11"></a>ppvNPVbaseRateData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb214-12"><a href="#cb214-12"></a>  <span class="at">BR =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>),</span>
<span id="cb214-13"><a href="#cb214-13"></a>  <span class="at">SN =</span> <span class="fu">sensitivity</span>(</span>
<span id="cb214-14"><a href="#cb214-14"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb214-15"><a href="#cb214-15"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb214-16"><a href="#cb214-16"></a>  <span class="at">SP =</span> <span class="fu">specificity</span>(</span>
<span id="cb214-17"><a href="#cb214-17"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb214-18"><a href="#cb214-18"></a>    <span class="at">FP =</span> FPvalue))</span>
<span id="cb214-19"><a href="#cb214-19"></a></span>
<span id="cb214-20"><a href="#cb214-20"></a>ppvNPVbaseRateData<span class="sc">$</span>positivePredictiveValue <span class="ot">&lt;-</span> <span class="fu">positivePredictiveValue</span>(</span>
<span id="cb214-21"><a href="#cb214-21"></a>  <span class="at">BR =</span> ppvNPVbaseRateData<span class="sc">$</span>BR,</span>
<span id="cb214-22"><a href="#cb214-22"></a>  <span class="at">SN =</span> ppvNPVbaseRateData<span class="sc">$</span>SN,</span>
<span id="cb214-23"><a href="#cb214-23"></a>  <span class="at">SP =</span> ppvNPVbaseRateData<span class="sc">$</span>SP)</span>
<span id="cb214-24"><a href="#cb214-24"></a></span>
<span id="cb214-25"><a href="#cb214-25"></a>ppvNPVbaseRateData<span class="sc">$</span>negativePredictiveValue <span class="ot">&lt;-</span> <span class="fu">negativePredictiveValue</span>(</span>
<span id="cb214-26"><a href="#cb214-26"></a>  <span class="at">BR =</span> ppvNPVbaseRateData<span class="sc">$</span>BR,</span>
<span id="cb214-27"><a href="#cb214-27"></a>  <span class="at">SN =</span> ppvNPVbaseRateData<span class="sc">$</span>SN,</span>
<span id="cb214-28"><a href="#cb214-28"></a>  <span class="at">SP =</span> ppvNPVbaseRateData<span class="sc">$</span>SP)</span>
<span id="cb214-29"><a href="#cb214-29"></a></span>
<span id="cb214-30"><a href="#cb214-30"></a>ppvNPVbaseRateData_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(</span>
<span id="cb214-31"><a href="#cb214-31"></a>  ppvNPVbaseRateData,</span>
<span id="cb214-32"><a href="#cb214-32"></a>  <span class="at">cols =</span> <span class="fu">all_of</span>(<span class="fu">c</span>(</span>
<span id="cb214-33"><a href="#cb214-33"></a>    <span class="st">"positivePredictiveValue"</span>,<span class="st">"negativePredictiveValue"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ppvNPVbaseRate" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Positive Predictive Value and Negative Predictive Value as a Function of the Base Rate.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ppvNPVbaseRate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-ppvNPVbaseRate-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Figure&nbsp;9.31: Positive Predictive Value and Negative Predictive Value as a Function of the Base Rate."><img src="prediction_files/figure-html/fig-ppvNPVbaseRate-1.png" class="img-fluid figure-img" alt="Positive Predictive Value and Negative Predictive Value as a Function of the Base Rate." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ppvNPVbaseRate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.31: Positive Predictive Value and Negative Predictive Value as a Function of the Base Rate.
</figcaption></figure>
</div>
</div>
</div>
<p>Below I compute PPV and <a href="#sec-npv">NPV</a> at every possible cutoff.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb215"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1"></a>accuracyStats<span class="sc">$</span>positivePredictiveValue <span class="ot">&lt;-</span> <span class="fu">positivePredictiveValue</span>(</span>
<span id="cb215-2"><a href="#cb215-2"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb215-3"><a href="#cb215-3"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb215-4"><a href="#cb215-4"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb215-5"><a href="#cb215-5"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb215-6"><a href="#cb215-6"></a></span>
<span id="cb215-7"><a href="#cb215-7"></a>accuracyStats<span class="sc">$</span>negativePredictiveValue <span class="ot">&lt;-</span> <span class="fu">negativePredictiveValue</span>(</span>
<span id="cb215-8"><a href="#cb215-8"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb215-9"><a href="#cb215-9"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb215-10"><a href="#cb215-10"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb215-11"><a href="#cb215-11"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb215-12"><a href="#cb215-12"></a></span>
<span id="cb215-13"><a href="#cb215-13"></a>ppvNPVcutoffData <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(</span>
<span id="cb215-14"><a href="#cb215-14"></a>  accuracyStats,</span>
<span id="cb215-15"><a href="#cb215-15"></a>  <span class="at">cols =</span> <span class="fu">all_of</span>(<span class="fu">c</span>(</span>
<span id="cb215-16"><a href="#cb215-16"></a>    <span class="st">"positivePredictiveValue"</span>,<span class="st">"negativePredictiveValue"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ppvNPVcutoff" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Positive Predictive Value and Negative Predictive Value as a Function of the Cutoff.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ppvNPVcutoff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-ppvNPVcutoff-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="Figure&nbsp;9.32: Positive Predictive Value and Negative Predictive Value as a Function of the Cutoff."><img src="prediction_files/figure-html/fig-ppvNPVcutoff-1.png" class="img-fluid figure-img" alt="Positive Predictive Value and Negative Predictive Value as a Function of the Cutoff." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ppvNPVcutoff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.32: Positive Predictive Value and Negative Predictive Value as a Function of the Cutoff.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-npv" class="level3" data-number="9.5.22"><h3 data-number="9.5.22" class="anchored" data-anchor-id="sec-npv">
<span class="header-section-number">9.5.22</span> Negative Predictive Value (NPV)</h3>
<p>The negative predictive value (NPV) is also called the negative predictive power (NPP). Many people confuse <a href="#sec-specificity">specificity</a> (<span class="math inline">\(P(\text{not } R|\text{not } C)\)</span>) with its inverse <a href="#sec-conditionalProbability">conditional probability</a>, NPV (<span class="math inline">\(P(\text{not } C| \text{not } R)\)</span>). NPV is the <a href="#sec-conditionalProbability">conditional probability</a> of not having the condition given a negative test: <span class="math inline">\(P(\text{not } C| \text{not } R)\)</span>. Higher values reflect greater accuracy. The formula for calculating negative predictive value is in <a href="#eq-negativePredictiveValue" class="quarto-xref">Equation&nbsp;<span>9.52</span></a>.</p>
<p>NPV can be low even when <a href="#sec-specificity">specificity</a> is high because it depends not only on <a href="#sec-specificity">specificity</a>, but also on <a href="#sec-sensitivity">sensitivity</a> and the <a href="#sec-baseRate">base rate</a>. Because NPV depends on the <a href="#sec-baseRate">base rate</a>, NPV is not an intrinsic property of a measure. The same measure will have a different NPV in different contexts with different <a href="#sec-baseRate">base rates</a> <span class="citation" data-cites="Treat2023">(<a href="references.html#ref-Treat2023" role="doc-biblioref">Treat &amp; Viken, 2023</a>)</span>. As described in <a href="#sec-accuracyCutoff" class="quarto-xref"><span>Section 9.1.2.6.1</span></a> and as depicted in <a href="#fig-ppvNPVbaseRate" class="quarto-xref">Figure&nbsp;<span>9.31</span></a>, as the <a href="#sec-baseRate">base rate</a> increases, NPV decreases. As the <a href="#sec-baseRate">base rate</a> decreases, NPV increases. NPV also differs as a function of the cutoff. As described in <a href="#sec-accuracyCutoff" class="quarto-xref"><span>Section 9.1.2.6.1</span></a> and as depicted in <a href="#fig-ppvNPVcutoff" class="quarto-xref">Figure&nbsp;<span>9.32</span></a>, as the cutoff increases (becomes more conservative), NPV decreases. As the cutoff decreases (becomes more liberal), NPV decreases.</p>
<p><span id="eq-negativePredictiveValue"><span class="math display">\[
\small
\begin{aligned}
  \text{negative predictive value (NPV)} &amp;= P(\text{not } C|\text{not } R) \\
  &amp;= \frac{\text{TN}}{\text{TN} + \text{FN}} = \frac{\text{TN}}{N(\text{1 - SR})}\\
  &amp;= \frac{\text{specificity} \times (1-{\text{BR}})}{\text{specificity} \times (1-{\text{BR}}) + [(1 - \text{sensitivity}) \times \text{BR}]}
\end{aligned}
\tag{9.52}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb216"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1"></a>negativePredictiveValue <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN, <span class="at">BR =</span> <span class="cn">NULL</span>, SN, SP){</span>
<span id="cb216-2"><a href="#cb216-2"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(BR)){</span>
<span id="cb216-3"><a href="#cb216-3"></a>    value <span class="ot">&lt;-</span> TN<span class="sc">/</span>(TN <span class="sc">+</span> FN)</span>
<span id="cb216-4"><a href="#cb216-4"></a>  } <span class="cf">else</span>{</span>
<span id="cb216-5"><a href="#cb216-5"></a>    value <span class="ot">&lt;-</span> (SP <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> BR))<span class="sc">/</span>(SP <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> BR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> SN) <span class="sc">*</span> BR)</span>
<span id="cb216-6"><a href="#cb216-6"></a>  }</span>
<span id="cb216-7"><a href="#cb216-7"></a>  </span>
<span id="cb216-8"><a href="#cb216-8"></a>  <span class="fu">return</span>(value)</span>
<span id="cb216-9"><a href="#cb216-9"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb217"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1"></a><span class="fu">negativePredictiveValue</span>(</span>
<span id="cb217-2"><a href="#cb217-2"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb217-3"><a href="#cb217-3"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb219"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1"></a><span class="fu">negativePredictiveValue</span>(</span>
<span id="cb219-2"><a href="#cb219-2"></a>  <span class="at">BR =</span> <span class="fu">baseRate</span>(</span>
<span id="cb219-3"><a href="#cb219-3"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb219-4"><a href="#cb219-4"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb219-5"><a href="#cb219-5"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb219-6"><a href="#cb219-6"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb219-7"><a href="#cb219-7"></a>  <span class="at">SN =</span> <span class="fu">sensitivity</span>(</span>
<span id="cb219-8"><a href="#cb219-8"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb219-9"><a href="#cb219-9"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb219-10"><a href="#cb219-10"></a>  <span class="at">SP =</span> <span class="fu">specificity</span>(</span>
<span id="cb219-11"><a href="#cb219-11"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb219-12"><a href="#cb219-12"></a>    <span class="at">FP =</span> FPvalue))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8</code></pre>
</div>
</div>
</section><section id="sec-falseDiscoveryRate" class="level3" data-number="9.5.23"><h3 data-number="9.5.23" class="anchored" data-anchor-id="sec-falseDiscoveryRate">
<span class="header-section-number">9.5.23</span> False Discovery Rate (FDR)</h3>
<p>Many people confuse the false positive rate (<span class="math inline">\(P(R|\text{not } C)\)</span>) with its inverse <a href="#sec-conditionalProbability">conditional probability</a>, the false discovery rate (<span class="math inline">\(P(\text{not } C| R)\)</span>). The false discovery rate (FDR) is the <a href="#sec-conditionalProbability">conditional probability</a> of not having the condition given a positive test: <span class="math inline">\(P(\text{not } C| R)\)</span>. Lower values reflect greater accuracy. The formula for calculating false discovery rate is in <a href="#eq-falseDiscoveryRate" class="quarto-xref">Equation&nbsp;<span>9.53</span></a>.</p>
<p><span id="eq-falseDiscoveryRate"><span class="math display">\[
\begin{aligned}
  \text{false discovery rate (FDR)} &amp;= P(\text{not } C|R) \\
  &amp;= \frac{\text{FP}}{\text{FP} + \text{TP}} = 1 - \text{PPV}
\end{aligned}
\tag{9.53}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb221"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1"></a>falseDiscoveryRate <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb221-2"><a href="#cb221-2"></a>  value <span class="ot">&lt;-</span> FP<span class="sc">/</span>(FP <span class="sc">+</span> TP)</span>
<span id="cb221-3"><a href="#cb221-3"></a>  </span>
<span id="cb221-4"><a href="#cb221-4"></a>  <span class="fu">return</span>(value)</span>
<span id="cb221-5"><a href="#cb221-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb222"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1"></a><span class="fu">falseDiscoveryRate</span>(</span>
<span id="cb222-2"><a href="#cb222-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb222-3"><a href="#cb222-3"></a>  <span class="at">FP =</span> FPvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.35</code></pre>
</div>
</div>
</section><section id="sec-falseOmissionRate" class="level3" data-number="9.5.24"><h3 data-number="9.5.24" class="anchored" data-anchor-id="sec-falseOmissionRate">
<span class="header-section-number">9.5.24</span> False Omission Rate (FOR)</h3>
<p>Many people confuse the false negative rate (<span class="math inline">\(P(\text{not } R|C)\)</span>) with its inverse <a href="#sec-conditionalProbability">conditional probability</a>, the false omission rate (<span class="math inline">\(P(C|\text{not } R)\)</span>). The false omission rate (FOR) is the conditional probability of having the condition given a negative test: <span class="math inline">\(P(C|\text{not } R)\)</span>. Lower values reflect greater accuracy. The formula for calculating false omission rate is in <a href="#eq-falseOmissionRate" class="quarto-xref">Equation&nbsp;<span>9.54</span></a>.</p>
<p><span id="eq-falseOmissionRate"><span class="math display">\[
\begin{aligned}
  \text{false omission rate (FOR)} &amp;= P(C|\text{not } R) \\
  &amp;= \frac{\text{FN}}{\text{FN} + \text{TN}} = 1 - \text{NPV}
\end{aligned}
\tag{9.54}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb224"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1"></a>falseOmissionRate <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb224-2"><a href="#cb224-2"></a>  value <span class="ot">&lt;-</span> FN<span class="sc">/</span>(FN <span class="sc">+</span> TN)</span>
<span id="cb224-3"><a href="#cb224-3"></a>  </span>
<span id="cb224-4"><a href="#cb224-4"></a>  <span class="fu">return</span>(value)</span>
<span id="cb224-5"><a href="#cb224-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb225"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1"></a><span class="fu">falseOmissionRate</span>(</span>
<span id="cb225-2"><a href="#cb225-2"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb225-3"><a href="#cb225-3"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2</code></pre>
</div>
</div>
</section><section id="sec-youdenJ-example" class="level3" data-number="9.5.25"><h3 data-number="9.5.25" class="anchored" data-anchor-id="sec-youdenJ-example">
<span class="header-section-number">9.5.25</span> Youden’s J Statistic</h3>
<p>Youden’s J statistic is also called Youden’s Index or informedness. Youden’s J statistic is the sum of <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a> (and subtracting one). Higher values reflect greater accuracy. The formula for calculating Youden’s J statistic is in <a href="#eq-youdenIndex" class="quarto-xref">Equation&nbsp;<span>9.55</span></a>.</p>
<p><span id="eq-youdenIndex"><span class="math display">\[
\begin{aligned}
  \text{Youden's J statistic} &amp;= \text{sensitivity} + \text{specificity} - 1
\end{aligned}
\tag{9.55}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb227"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1"></a>youdenJ <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb227-2"><a href="#cb227-2"></a>  SN <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)</span>
<span id="cb227-3"><a href="#cb227-3"></a>  SP <span class="ot">&lt;-</span> TN<span class="sc">/</span>(TN <span class="sc">+</span> FP)</span>
<span id="cb227-4"><a href="#cb227-4"></a>  value <span class="ot">&lt;-</span> SN <span class="sc">+</span> SP <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb227-5"><a href="#cb227-5"></a>  </span>
<span id="cb227-6"><a href="#cb227-6"></a>  <span class="fu">return</span>(value)</span>
<span id="cb227-7"><a href="#cb227-7"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb228"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1"></a><span class="fu">youdenJ</span>(</span>
<span id="cb228-2"><a href="#cb228-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb228-3"><a href="#cb228-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb228-4"><a href="#cb228-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb228-5"><a href="#cb228-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.45</code></pre>
</div>
</div>
</section><section id="sec-balancedAccuracy" class="level3" data-number="9.5.26"><h3 data-number="9.5.26" class="anchored" data-anchor-id="sec-balancedAccuracy">
<span class="header-section-number">9.5.26</span> Balanced Accuracy</h3>
<p>Balanced accuracy is the average of <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a>. Higher values reflect greater accuracy. The formula for calculating balanced accuracy is in <a href="#eq-balancedAccuracy" class="quarto-xref">Equation&nbsp;<span>9.56</span></a>.</p>
<p><span id="eq-balancedAccuracy"><span class="math display">\[
\begin{aligned}
  \text{balanced accuracy} &amp;= \frac{\text{sensitivity} + \text{specificity}}{2}
\end{aligned}
\tag{9.56}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb230"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1"></a>balancedAccuracy <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb230-2"><a href="#cb230-2"></a>  SN <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)</span>
<span id="cb230-3"><a href="#cb230-3"></a>  SP <span class="ot">&lt;-</span> TN<span class="sc">/</span>(TN <span class="sc">+</span> FP)</span>
<span id="cb230-4"><a href="#cb230-4"></a>  value <span class="ot">&lt;-</span> (SN <span class="sc">+</span> SP) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb230-5"><a href="#cb230-5"></a>  </span>
<span id="cb230-6"><a href="#cb230-6"></a>  <span class="fu">return</span>(value)</span>
<span id="cb230-7"><a href="#cb230-7"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb231"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1"></a><span class="fu">balancedAccuracy</span>(</span>
<span id="cb231-2"><a href="#cb231-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb231-3"><a href="#cb231-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb231-4"><a href="#cb231-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb231-5"><a href="#cb231-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.725</code></pre>
</div>
</div>
</section><section id="sec-fScore" class="level3" data-number="9.5.27"><h3 data-number="9.5.27" class="anchored" data-anchor-id="sec-fScore">
<span class="header-section-number">9.5.27</span> F-Score</h3>
<p>The F-score combines <a href="#sec-ppv">precision</a> (<a href="#sec-ppv">positive predictive value</a>) and <a href="#sec-sensitivity">recall</a> (<a href="#sec-sensitivity">sensitivity</a>), where <span class="math inline">\(\beta\)</span> indicates how many times more important <a href="#sec-sensitivity">sensitivity</a> is than the <a href="#sec-ppv">positive predictive value</a>. If <a href="#sec-sensitivity">sensitivity</a> and the <a href="#sec-ppv">positive predictive value</a> are equally important, <span class="math inline">\(\beta = 1\)</span>, and the F-score is called the <span class="math inline">\(F_1\)</span> score. Higher values reflect greater accuracy. The formula for calculating the F-score is in <a href="#eq-FScore" class="quarto-xref">Equation&nbsp;<span>9.57</span></a>.</p>
<p><span id="eq-FScore"><span class="math display">\[
\begin{aligned}
  F_\beta &amp;= (1 + \beta^2) \cdot \frac{\text{positive predictive value} \cdot \text{sensitivity}}{(\beta^2 \cdot \text{positive predictive value}) + \text{sensitivity}} \\
  &amp;= \frac{(1 + \beta^2) \cdot \text{TP}}{(1 + \beta^2) \cdot \text{TP} + \beta^2 \cdot \text{FN} + \text{FP}}
\end{aligned}
\tag{9.57}\]</span></span></p>
<p>The <span class="math inline">\(F_1\)</span> score is the harmonic mean of <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-ppv">positive predictive value</a>. The formula for calculating the <span class="math inline">\(F_1\)</span> score is in <a href="#eq-F1Score" class="quarto-xref">Equation&nbsp;<span>9.58</span></a>.</p>
<p><span id="eq-F1Score"><span class="math display">\[
\begin{aligned}
  F_1 &amp;= \frac{2 \cdot \text{positive predictive value} \cdot \text{sensitivity}}{(\text{positive predictive value}) + \text{sensitivity}} \\
  &amp;= \frac{2 \cdot \text{TP}}{2 \cdot \text{TP} + \text{FN} + \text{FP}}
\end{aligned}
\tag{9.58}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb233"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1"></a>fScore <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN, <span class="at">beta =</span> <span class="dv">1</span>){</span>
<span id="cb233-2"><a href="#cb233-2"></a>  value <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">+</span> beta<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> TP) <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">+</span> beta<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> TP <span class="sc">+</span> beta<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> FN <span class="sc">+</span> FP)</span>
<span id="cb233-3"><a href="#cb233-3"></a>  </span>
<span id="cb233-4"><a href="#cb233-4"></a>  <span class="fu">return</span>(value)</span>
<span id="cb233-5"><a href="#cb233-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb234"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1"></a><span class="fu">fScore</span>(</span>
<span id="cb234-2"><a href="#cb234-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb234-3"><a href="#cb234-3"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb234-4"><a href="#cb234-4"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.65</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb236"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1"></a><span class="fu">fScore</span>(</span>
<span id="cb236-2"><a href="#cb236-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb236-3"><a href="#cb236-3"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb236-4"><a href="#cb236-4"></a>  <span class="at">FN =</span> FNvalue,</span>
<span id="cb236-5"><a href="#cb236-5"></a>  <span class="at">beta =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.65</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb238"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1"></a><span class="fu">fScore</span>(</span>
<span id="cb238-2"><a href="#cb238-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb238-3"><a href="#cb238-3"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb238-4"><a href="#cb238-4"></a>  <span class="at">FN =</span> FNvalue,</span>
<span id="cb238-5"><a href="#cb238-5"></a>  <span class="at">beta =</span> <span class="fl">0.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.65</code></pre>
</div>
</div>
</section><section id="sec-matthewsCorrelationCoefficient" class="level3" data-number="9.5.28"><h3 data-number="9.5.28" class="anchored" data-anchor-id="sec-matthewsCorrelationCoefficient">
<span class="header-section-number">9.5.28</span> Matthews Correlation Coefficient (MCC)</h3>
<p>The Matthews correlation coefficient (MCC) is also called the phi coefficient. It is a correlation coefficient between predicted and observed values from a binary classification. Higher values reflect greater accuracy. The formula for calculating the MCC is in <a href="#eq-matthewsCorrelationCoefficient" class="quarto-xref">Equation&nbsp;<span>9.59</span></a>.</p>
<p><span id="eq-matthewsCorrelationCoefficient"><span class="math display">\[
\begin{aligned}
  \text{MCC} &amp;= \frac{\text{TP} \times \text{TN} - \text{FP} \times \text{FN}}{\sqrt{(\text{TP} + \text{FP})(\text{TP} + \text{FN})(\text{TN} + \text{FP})(\text{TN} + \text{FN})}}
\end{aligned}
\tag{9.59}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb240"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1"></a>mcc <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb240-2"><a href="#cb240-2"></a>  TP <span class="ot">&lt;-</span> <span class="fu">as.double</span>(TP)</span>
<span id="cb240-3"><a href="#cb240-3"></a>  TN <span class="ot">&lt;-</span> <span class="fu">as.double</span>(TN)</span>
<span id="cb240-4"><a href="#cb240-4"></a>  FP <span class="ot">&lt;-</span> <span class="fu">as.double</span>(FP)</span>
<span id="cb240-5"><a href="#cb240-5"></a>  FN <span class="ot">&lt;-</span> <span class="fu">as.double</span>(FN)</span>
<span id="cb240-6"><a href="#cb240-6"></a>  value <span class="ot">&lt;-</span> ((TP <span class="sc">*</span> TN) <span class="sc">-</span> (FP <span class="sc">*</span> FN)) <span class="sc">/</span> <span class="fu">sqrt</span>((TP <span class="sc">+</span> FP) <span class="sc">*</span> (TP <span class="sc">+</span> FN) <span class="sc">*</span> (TN <span class="sc">+</span> FP) <span class="sc">*</span> (TN <span class="sc">+</span> FN))</span>
<span id="cb240-7"><a href="#cb240-7"></a>  </span>
<span id="cb240-8"><a href="#cb240-8"></a>  <span class="fu">return</span>(value)</span>
<span id="cb240-9"><a href="#cb240-9"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb241"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1"></a><span class="fu">mcc</span>(</span>
<span id="cb241-2"><a href="#cb241-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb241-3"><a href="#cb241-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb241-4"><a href="#cb241-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb241-5"><a href="#cb241-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.45</code></pre>
</div>
</div>
</section><section id="sec-diagnosticOddsRatio" class="level3" data-number="9.5.29"><h3 data-number="9.5.29" class="anchored" data-anchor-id="sec-diagnosticOddsRatio">
<span class="header-section-number">9.5.29</span> Diagnostic Odds Ratio</h3>
<p>The diagnostic odds ratio is the odds of a positive test among people with the condition relative to the odds of a positive test among people without the condition. Higher values reflect greater accuracy. The formula for calculating the diagnostic odds ratio is in <a href="#eq-diagnosticOddsRatio" class="quarto-xref">Equation&nbsp;<span>9.60</span></a>. If the predictor is bad, the diagnostic odds ratio could be less than one, and values can go up from there. If the diagnostic odds ratio is greater than 2, we take the odds ratio seriously because we are twice as likely to predict accurately than inaccurately. However, the diagnostic odds ratio ignores/hides <a href="#sec-baseRate">base rates</a>. When interpreting the diagnostic odds ratio, it is important to keep in mind the clinical significance, because otherwise it is not very meaningful. Consider a risk factor that has a diagnostic odds ratio of 3 for tuberculosis, i.e., it puts you at 3 times as likely to develop tuberculosis. The prevalence of tuberculosis is relatively low. Assuming the prevalence of tuberculosis is less than 1/10th of 1%, your risk of developing tuberculosis is still very low even if the risk factor (with a diagnostic odds ratio of 3) is present.</p>
<p><span id="eq-diagnosticOddsRatio"><span class="math display">\[
\begin{aligned}
  \text{diagnostic odds ratio} &amp;= \frac{\text{TP} \times \text{TN}}{\text{FP} \times \text{FN}} \\
  &amp;= \frac{\text{sensitivity} \times \text{specificity}}{(1 - \text{sensitivity}) \times (1 - \text{specificity})} \\
  &amp;= \frac{\text{PPV} \times \text{NPV}}{(1 - \text{PPV}) \times (1 - \text{NPV})} \\
  &amp;= \frac{\text{LR+}}{\text{LR}-}
\end{aligned}
\tag{9.60}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb243"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1"></a>diagnosticOddsRatio <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb243-2"><a href="#cb243-2"></a>  value <span class="ot">&lt;-</span> (TP <span class="sc">*</span> TN) <span class="sc">/</span> (FP <span class="sc">*</span> FN)</span>
<span id="cb243-3"><a href="#cb243-3"></a>  </span>
<span id="cb243-4"><a href="#cb243-4"></a>  <span class="fu">return</span>(value)</span>
<span id="cb243-5"><a href="#cb243-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb244"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1"></a><span class="fu">diagnosticOddsRatio</span>(</span>
<span id="cb244-2"><a href="#cb244-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb244-3"><a href="#cb244-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb244-4"><a href="#cb244-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb244-5"><a href="#cb244-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 7.428571</code></pre>
</div>
</div>
</section><section id="sec-diagnosticLikelihoodRatio" class="level3" data-number="9.5.30"><h3 data-number="9.5.30" class="anchored" data-anchor-id="sec-diagnosticLikelihoodRatio">
<span class="header-section-number">9.5.30</span> Diagnostic Likelihood Ratio</h3>
<p>A likelihood ratio is the ratio of two probabilities. It can be used to compare the likelihood of two possibilities. The diagnostic likelihood ratio is an index of the predictive validity of an instrument: it is the ratio of the probability that a test result is correct to the probability that the test result is incorrect. The diagnostic likelihood ratio is also called the risk ratio. There are two types of diagnostic likelihood ratios: the <a href="#sec-positiveLikelihoodRatio">positive likelihood ratio</a> and the <a href="#sec-negativeLikelihoodRatio">negative likelihood ratio</a>.</p>
<section id="sec-positiveLikelihoodRatio" class="level4" data-number="9.5.30.1"><h4 data-number="9.5.30.1" class="anchored" data-anchor-id="sec-positiveLikelihoodRatio">
<span class="header-section-number">9.5.30.1</span> Positive Likelihood Ratio (LR+)</h4>
<p>The positive likelihood ratio (LR+) compares the <a href="#sec-sensitivity">true positive rate</a> to the <a href="#sec-falsePositiveRate">false positive rate</a>. Positive likelihood ratio values range from 1 to infinity. Higher values reflect greater accuracy, because it indicates the degree to which a <a href="#sec-truePositive">true positive</a> is more likely than a <a href="#sec-falsePositive">false positive</a>. The formula for calculating the positive likelihood ratio is in <a href="#eq-positiveLikelihoodRatio" class="quarto-xref">Equation&nbsp;<span>9.61</span></a>.</p>
<p><span id="eq-positiveLikelihoodRatio"><span class="math display">\[
\begin{aligned}
  \text{positive likelihood ratio (LR+)} &amp;= \frac{\text{TPR}}{\text{FPR}} \\
  &amp;= \frac{P(R|C)}{P(R|\text{not } C)} \\
  &amp;= \frac{P(R|C)}{1 - P(\text{not } R|\text{not } C)} \\
  &amp;= \frac{\text{sensitivity}}{1 - \text{specificity}}
\end{aligned}
\tag{9.61}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb246"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1"></a>positiveLikelihoodRatio <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb246-2"><a href="#cb246-2"></a>  SN <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)</span>
<span id="cb246-3"><a href="#cb246-3"></a>  SP <span class="ot">&lt;-</span> TN<span class="sc">/</span>(TN <span class="sc">+</span> FP)</span>
<span id="cb246-4"><a href="#cb246-4"></a>  </span>
<span id="cb246-5"><a href="#cb246-5"></a>  value <span class="ot">&lt;-</span> SN<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> SP)</span>
<span id="cb246-6"><a href="#cb246-6"></a>  </span>
<span id="cb246-7"><a href="#cb246-7"></a>  <span class="fu">return</span>(value)</span>
<span id="cb246-8"><a href="#cb246-8"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb247"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1"></a><span class="fu">positiveLikelihoodRatio</span>(</span>
<span id="cb247-2"><a href="#cb247-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb247-3"><a href="#cb247-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb247-4"><a href="#cb247-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb247-5"><a href="#cb247-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 3.25</code></pre>
</div>
</div>
</section><section id="sec-negativeLikelihoodRatio" class="level4" data-number="9.5.30.2"><h4 data-number="9.5.30.2" class="anchored" data-anchor-id="sec-negativeLikelihoodRatio">
<span class="header-section-number">9.5.30.2</span> Negative Likelihood Ratio (LR−)</h4>
<p>The negative likelihood ratio (LR−) compares the <a href="#sec-falseNegativeRate">false negative rate</a> to the <a href="#sec-specificity">true negative rate</a>. Negative likelihood ratio values range from 0 to 1. Smaller values reflect greater accuracy, because it indicates that a <a href="#sec-falseNegative">false negative</a> is less likely than a <a href="#sec-trueNegative">true negative</a>. The formula for calculating the negative likelihood ratio is in <a href="#eq-negativeLikelihoodRatio" class="quarto-xref">Equation&nbsp;<span>9.62</span></a>.</p>
<p><span id="eq-negativeLikelihoodRatio"><span class="math display">\[
\begin{aligned}
  \text{negative likelihood ratio } (\text{LR}-) &amp;= \frac{\text{FNR}}{\text{TNR}} \\
  &amp;= \frac{P(\text{not } R|C)}{P(\text{not } R|\text{not } C)} \\
  &amp;= \frac{1 - P(R|C)}{P(\text{not } R|\text{not } C)} \\
  &amp;= \frac{1 - \text{sensitivity}}{\text{specificity}}
\end{aligned}
\tag{9.62}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb249"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1"></a>negativeLikelihoodRatio <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb249-2"><a href="#cb249-2"></a>  SN <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)</span>
<span id="cb249-3"><a href="#cb249-3"></a>  SP <span class="ot">&lt;-</span> TN<span class="sc">/</span>(TN <span class="sc">+</span> FP)</span>
<span id="cb249-4"><a href="#cb249-4"></a>  </span>
<span id="cb249-5"><a href="#cb249-5"></a>  value <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> SN)<span class="sc">/</span>SP</span>
<span id="cb249-6"><a href="#cb249-6"></a>  </span>
<span id="cb249-7"><a href="#cb249-7"></a>  <span class="fu">return</span>(value)</span>
<span id="cb249-8"><a href="#cb249-8"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb250"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1"></a><span class="fu">negativeLikelihoodRatio</span>(</span>
<span id="cb250-2"><a href="#cb250-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb250-3"><a href="#cb250-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb250-4"><a href="#cb250-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb250-5"><a href="#cb250-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4375</code></pre>
</div>
</div>
</section></section><section id="sec-posttestOdds" class="level3" data-number="9.5.31"><h3 data-number="9.5.31" class="anchored" data-anchor-id="sec-posttestOdds">
<span class="header-section-number">9.5.31</span> Posttest Odds</h3>
<p>As presented in <a href="#eq-bayes5" class="quarto-xref">Equation&nbsp;<span>9.16</span></a>, the posttest (or posterior) odds are equal to the <a href="#sec-pretestOdds">pretest odds</a> multiplied by the <a href="#sec-diagnosticLikelihoodRatio">likelihood ratio</a>. The posttest odds and <a href="#sec-posttestProbability">posttest probability</a> can be useful to calculate when the <a href="#sec-baseRate">pretest probability</a> is different from the <a href="#sec-baseRate">pretest probability</a> (or prevalence) of the classification. For instance, you might use a different <a href="#sec-baseRate">pretest probability</a> if a test result is already known and you want to know the updated <a href="#sec-posttestProbability">posttest probability</a> after conducting a second test. The formula for calculating posttest odds is in <a href="#eq-posttestOdds" class="quarto-xref">Equation&nbsp;<span>9.63</span></a>.</p>
<p><span id="eq-posttestOdds"><span class="math display">\[
\begin{aligned}
  \text{posttest odds} &amp;= \text{pretest odds} \times \text{likelihood ratio} \\
\end{aligned}
\tag{9.63}\]</span></span></p>
<p>For calculating the posttest odds of a <a href="#sec-truePositive">true positive</a> compared to a <a href="#sec-falsePositive">false positive</a>, we use the <a href="#sec-positiveLikelihoodRatio">positive likelihood ratio</a>, described later. We would use the <a href="#sec-negativeLikelihoodRatio">negative likelihood ratio</a> if we wanted to calculate the posttest odds of a <a href="#sec-falseNegative">false negative</a> compared to a <a href="#sec-trueNegative">true negative</a>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb252"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1"></a>posttestOdds <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN, <span class="at">pretestProb =</span> <span class="cn">NULL</span>, <span class="at">SN =</span> <span class="cn">NULL</span>, <span class="at">SP =</span> <span class="cn">NULL</span>, <span class="at">likelihoodRatio =</span> <span class="cn">NULL</span>){</span>
<span id="cb252-2"><a href="#cb252-2"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(pretestProb) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(SN) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(SP)){</span>
<span id="cb252-3"><a href="#cb252-3"></a>    pretestProbability <span class="ot">&lt;-</span> pretestProb</span>
<span id="cb252-4"><a href="#cb252-4"></a>    pretestOdds <span class="ot">&lt;-</span> pretestProbability <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pretestProbability)</span>
<span id="cb252-5"><a href="#cb252-5"></a>    </span>
<span id="cb252-6"><a href="#cb252-6"></a>    likelihoodRatio <span class="ot">&lt;-</span> SN<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> SP)</span>
<span id="cb252-7"><a href="#cb252-7"></a>  } <span class="cf">else</span> <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(pretestProb) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(likelihoodRatio)){</span>
<span id="cb252-8"><a href="#cb252-8"></a>    pretestProbability <span class="ot">&lt;-</span> pretestProb</span>
<span id="cb252-9"><a href="#cb252-9"></a>    pretestOdds <span class="ot">&lt;-</span> pretestProbability <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pretestProbability)</span>
<span id="cb252-10"><a href="#cb252-10"></a>    </span>
<span id="cb252-11"><a href="#cb252-11"></a>    likelihoodRatio <span class="ot">&lt;-</span> likelihoodRatio</span>
<span id="cb252-12"><a href="#cb252-12"></a>  } <span class="cf">else</span> {</span>
<span id="cb252-13"><a href="#cb252-13"></a>    N <span class="ot">&lt;-</span> TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN</span>
<span id="cb252-14"><a href="#cb252-14"></a>    pretestProbability <span class="ot">&lt;-</span> (TP <span class="sc">+</span> FN)<span class="sc">/</span>N</span>
<span id="cb252-15"><a href="#cb252-15"></a>    pretestOdds <span class="ot">&lt;-</span> pretestProbability <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pretestProbability)</span>
<span id="cb252-16"><a href="#cb252-16"></a>    </span>
<span id="cb252-17"><a href="#cb252-17"></a>    SN <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)</span>
<span id="cb252-18"><a href="#cb252-18"></a>    SP <span class="ot">&lt;-</span> TN<span class="sc">/</span>(TN <span class="sc">+</span> FP)</span>
<span id="cb252-19"><a href="#cb252-19"></a>    likelihoodRatio <span class="ot">&lt;-</span> SN<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> SP)</span>
<span id="cb252-20"><a href="#cb252-20"></a>  }</span>
<span id="cb252-21"><a href="#cb252-21"></a>  </span>
<span id="cb252-22"><a href="#cb252-22"></a>  value <span class="ot">&lt;-</span> pretestOdds <span class="sc">*</span> likelihoodRatio</span>
<span id="cb252-23"><a href="#cb252-23"></a>  </span>
<span id="cb252-24"><a href="#cb252-24"></a>  <span class="fu">return</span>(value)</span>
<span id="cb252-25"><a href="#cb252-25"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb253"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1"></a><span class="fu">posttestOdds</span>(</span>
<span id="cb253-2"><a href="#cb253-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb253-3"><a href="#cb253-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb253-4"><a href="#cb253-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb253-5"><a href="#cb253-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.857143</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb255"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1"></a><span class="fu">posttestOdds</span>(</span>
<span id="cb255-2"><a href="#cb255-2"></a>  <span class="at">pretestProb =</span> <span class="fu">baseRate</span>(</span>
<span id="cb255-3"><a href="#cb255-3"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb255-4"><a href="#cb255-4"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb255-5"><a href="#cb255-5"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb255-6"><a href="#cb255-6"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb255-7"><a href="#cb255-7"></a>  <span class="at">SN =</span> <span class="fu">sensitivity</span>(</span>
<span id="cb255-8"><a href="#cb255-8"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb255-9"><a href="#cb255-9"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb255-10"><a href="#cb255-10"></a>  <span class="at">SP =</span> <span class="fu">specificity</span>(</span>
<span id="cb255-11"><a href="#cb255-11"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb255-12"><a href="#cb255-12"></a>    <span class="at">FP =</span> FPvalue))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.857143</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb257"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1"></a><span class="fu">posttestOdds</span>(</span>
<span id="cb257-2"><a href="#cb257-2"></a>  <span class="at">pretestProb =</span> <span class="fu">baseRate</span>(</span>
<span id="cb257-3"><a href="#cb257-3"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb257-4"><a href="#cb257-4"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb257-5"><a href="#cb257-5"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb257-6"><a href="#cb257-6"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb257-7"><a href="#cb257-7"></a>  <span class="at">likelihoodRatio =</span> <span class="fu">positiveLikelihoodRatio</span>(</span>
<span id="cb257-8"><a href="#cb257-8"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb257-9"><a href="#cb257-9"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb257-10"><a href="#cb257-10"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb257-11"><a href="#cb257-11"></a>    <span class="at">FN =</span> FNvalue))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.857143</code></pre>
</div>
</div>
</section><section id="sec-posttestProbability" class="level3" data-number="9.5.32"><h3 data-number="9.5.32" class="anchored" data-anchor-id="sec-posttestProbability">
<span class="header-section-number">9.5.32</span> Posttest Probability</h3>
<p>The posttest probability is the probability of having the disorder given a test result. When the <a href="#sec-baseRate">base rate</a> is used as the <a href="#sec-baseRate">pretest probability</a>, the posttest probability given a positive test is equal to <a href="#sec-ppv">positive predictive value</a>. To convert odds to a probability, divide the odds by one plus the odds, as is in <a href="#eq-posttestProbability" class="quarto-xref">Equation&nbsp;<span>9.64</span></a>.</p>
<p><span id="eq-posttestProbability"><span class="math display">\[
\begin{aligned}
  \text{posttest probability} &amp;= \frac{\text{posttest odds}}{1 + \text{posttest odds}}
\end{aligned}
\tag{9.64}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb259"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1"></a>posttestProbability <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN, <span class="at">pretestProb =</span> <span class="cn">NULL</span>, <span class="at">SN =</span> <span class="cn">NULL</span>, <span class="at">SP =</span> <span class="cn">NULL</span>, <span class="at">likelihoodRatio =</span> <span class="cn">NULL</span>){</span>
<span id="cb259-2"><a href="#cb259-2"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(pretestProb) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(SN) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(SP)){</span>
<span id="cb259-3"><a href="#cb259-3"></a>    pretestProbability <span class="ot">&lt;-</span> pretestProb</span>
<span id="cb259-4"><a href="#cb259-4"></a>    pretestOdds <span class="ot">&lt;-</span> pretestProbability <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pretestProbability)</span>
<span id="cb259-5"><a href="#cb259-5"></a>    </span>
<span id="cb259-6"><a href="#cb259-6"></a>    likelihoodRatio <span class="ot">&lt;-</span> SN<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> SP)</span>
<span id="cb259-7"><a href="#cb259-7"></a>  } <span class="cf">else</span> <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(pretestProb) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(likelihoodRatio)){</span>
<span id="cb259-8"><a href="#cb259-8"></a>    pretestProbability <span class="ot">&lt;-</span> pretestProb</span>
<span id="cb259-9"><a href="#cb259-9"></a>    pretestOdds <span class="ot">&lt;-</span> pretestProbability <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pretestProbability)</span>
<span id="cb259-10"><a href="#cb259-10"></a>    </span>
<span id="cb259-11"><a href="#cb259-11"></a>    likelihoodRatio <span class="ot">&lt;-</span> likelihoodRatio</span>
<span id="cb259-12"><a href="#cb259-12"></a>  } <span class="cf">else</span> {</span>
<span id="cb259-13"><a href="#cb259-13"></a>    N <span class="ot">&lt;-</span> TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN</span>
<span id="cb259-14"><a href="#cb259-14"></a>    pretestProbability <span class="ot">&lt;-</span> (TP <span class="sc">+</span> FN)<span class="sc">/</span>N</span>
<span id="cb259-15"><a href="#cb259-15"></a>    pretestOdds <span class="ot">&lt;-</span> pretestProbability <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pretestProbability)</span>
<span id="cb259-16"><a href="#cb259-16"></a>    </span>
<span id="cb259-17"><a href="#cb259-17"></a>    SN <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)</span>
<span id="cb259-18"><a href="#cb259-18"></a>    SP <span class="ot">&lt;-</span> TN<span class="sc">/</span>(TN <span class="sc">+</span> FP)</span>
<span id="cb259-19"><a href="#cb259-19"></a>    likelihoodRatio <span class="ot">&lt;-</span> SN<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> SP)</span>
<span id="cb259-20"><a href="#cb259-20"></a>  }</span>
<span id="cb259-21"><a href="#cb259-21"></a>  </span>
<span id="cb259-22"><a href="#cb259-22"></a>  posttestOdds <span class="ot">&lt;-</span> pretestOdds <span class="sc">*</span> likelihoodRatio</span>
<span id="cb259-23"><a href="#cb259-23"></a>  value <span class="ot">&lt;-</span> posttestOdds <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> posttestOdds)</span>
<span id="cb259-24"><a href="#cb259-24"></a>  </span>
<span id="cb259-25"><a href="#cb259-25"></a>  <span class="fu">return</span>(value)</span>
<span id="cb259-26"><a href="#cb259-26"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb260"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1"></a><span class="fu">posttestProbability</span>(</span>
<span id="cb260-2"><a href="#cb260-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb260-3"><a href="#cb260-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb260-4"><a href="#cb260-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb260-5"><a href="#cb260-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.65</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb262"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1"></a><span class="fu">posttestProbability</span>(</span>
<span id="cb262-2"><a href="#cb262-2"></a>  <span class="at">pretestProb =</span> <span class="fu">baseRate</span>(</span>
<span id="cb262-3"><a href="#cb262-3"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb262-4"><a href="#cb262-4"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb262-5"><a href="#cb262-5"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb262-6"><a href="#cb262-6"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb262-7"><a href="#cb262-7"></a>  <span class="at">SN =</span> <span class="fu">sensitivity</span>(</span>
<span id="cb262-8"><a href="#cb262-8"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb262-9"><a href="#cb262-9"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb262-10"><a href="#cb262-10"></a>  <span class="at">SP =</span> <span class="fu">specificity</span>(</span>
<span id="cb262-11"><a href="#cb262-11"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb262-12"><a href="#cb262-12"></a>    <span class="at">FP =</span> FPvalue))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.65</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb264"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1"></a><span class="fu">posttestProbability</span>(</span>
<span id="cb264-2"><a href="#cb264-2"></a>  <span class="at">pretestProb =</span> <span class="fu">baseRate</span>(</span>
<span id="cb264-3"><a href="#cb264-3"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb264-4"><a href="#cb264-4"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb264-5"><a href="#cb264-5"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb264-6"><a href="#cb264-6"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb264-7"><a href="#cb264-7"></a>  <span class="at">likelihoodRatio =</span> <span class="fu">positiveLikelihoodRatio</span>(</span>
<span id="cb264-8"><a href="#cb264-8"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb264-9"><a href="#cb264-9"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb264-10"><a href="#cb264-10"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb264-11"><a href="#cb264-11"></a>    <span class="at">FN =</span> FNvalue))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.65</code></pre>
</div>
</div>
<p>Consider the following example: Assume the <a href="#sec-baseRate">base rate</a> of the condition is .03%. We have two tests. Test A has a <a href="#sec-sensitivity">sensitivity</a> of .95 and a <a href="#sec-specificity">specificity</a> of .80. Test B has a <a href="#sec-sensitivity">sensitivity</a> of .70 and a <a href="#sec-specificity">specificity</a> of .90. What is the probability of having the condition if a person has a positive test on Test A? Assuming the errors of the two tests are independent, what is the probability of having the condition if the person has a positive test on Test B after having a positive test on Test A?</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb266"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1"></a>probGivenTestA <span class="ot">&lt;-</span> <span class="fu">posttestProbability</span>(</span>
<span id="cb266-2"><a href="#cb266-2"></a>  <span class="at">pretestProb =</span> .<span class="dv">003</span>,</span>
<span id="cb266-3"><a href="#cb266-3"></a>  <span class="at">SN =</span> .<span class="dv">95</span>,</span>
<span id="cb266-4"><a href="#cb266-4"></a>  <span class="at">SP =</span> .<span class="dv">80</span>)</span>
<span id="cb266-5"><a href="#cb266-5"></a></span>
<span id="cb266-6"><a href="#cb266-6"></a>probGivenTestAthenB <span class="ot">&lt;-</span> <span class="fu">posttestProbability</span>(</span>
<span id="cb266-7"><a href="#cb266-7"></a>  <span class="at">pretestProb =</span> probGivenTestA,</span>
<span id="cb266-8"><a href="#cb266-8"></a>  <span class="at">SN =</span> .<span class="dv">70</span>,</span>
<span id="cb266-9"><a href="#cb266-9"></a>  <span class="at">SP =</span> .<span class="dv">90</span>)</span>
<span id="cb266-10"><a href="#cb266-10"></a></span>
<span id="cb266-11"><a href="#cb266-11"></a>probGivenTestA</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01409147</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb268"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1"></a>probGivenTestAthenB</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09095054</code></pre>
</div>
</div>
<p>The probability of having the condition if a person has a positive test on Test A is <span class="math inline">\(1.4\)</span>%. The probability of having the condition if the person has a positive test on Test B after having a positive test on Test A is <span class="math inline">\(9.1\)</span>%.</p>
</section><section id="sec-nomogram" class="level3" data-number="9.5.33"><h3 data-number="9.5.33" class="anchored" data-anchor-id="sec-nomogram">
<span class="header-section-number">9.5.33</span> Probability Nomogram</h3>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>nomogrammer()</code> function that creates a probability nomogram plot, adapted from <a href="https://github.com/achekroud/nomogrammer" class="uri">https://github.com/achekroud/nomogrammer</a>. In <a href="#fig-nomogramPlot" class="quarto-xref">Figure&nbsp;<span>9.33</span></a>, the probability nomogram is generated using the number of <a href="#sec-truePositive">true positives</a>, <a href="#sec-trueNegative">true negatives</a>, <a href="#sec-falsePositive">false positives</a>, and <a href="#sec-falseNegative">false negatives</a> at a given cutoff.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb270"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1"></a><span class="fu">nomogrammer</span>(</span>
<span id="cb270-2"><a href="#cb270-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb270-3"><a href="#cb270-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb270-4"><a href="#cb270-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb270-5"><a href="#cb270-5"></a>  <span class="at">FN =</span> FNvalue</span>
<span id="cb270-6"><a href="#cb270-6"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-nomogramPlot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Probability Nomogram.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-nomogramPlot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-nomogramPlot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33" title="Figure&nbsp;9.33: Probability Nomogram."><img src="prediction_files/figure-html/fig-nomogramPlot-1.png" class="img-fluid figure-img" alt="Probability Nomogram." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nomogramPlot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.33: Probability Nomogram.
</figcaption></figure>
</div>
</div>
</div>
<p>The blue line indicates the <a href="#sec-posttestProbability">posterior probability</a> of the condition given a positive test. The pink line indicates the <a href="#sec-posttestProbability">posterior probability</a> of the condition given a negative test. One can also generate the probability nomogram from the <a href="#sec-pretestProbability">base rate</a> and the <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a> of the test at a given cutoff:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb271"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1"></a><span class="fu">nomogrammer</span>(</span>
<span id="cb271-2"><a href="#cb271-2"></a>  <span class="at">pretestProb =</span> <span class="fu">baseRate</span>(<span class="at">TP =</span> TPvalue, <span class="at">TN =</span> TNvalue, <span class="at">FP =</span> FPvalue, <span class="at">FN =</span> FNvalue),</span>
<span id="cb271-3"><a href="#cb271-3"></a>  <span class="at">SN =</span> <span class="fu">sensitivity</span>(<span class="at">TP =</span> TPvalue, <span class="at">FN =</span> FNvalue),</span>
<span id="cb271-4"><a href="#cb271-4"></a>  <span class="at">SP =</span> <span class="fu">specificity</span>(<span class="at">TN =</span> TNvalue, <span class="at">FP =</span> FPvalue)</span>
<span id="cb271-5"><a href="#cb271-5"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>One can also generate the probability nomogram from the <a href="#sec-pretestProbability">base rate</a>, <a href="#sec-positiveLikelihoodRatio">positive likelihood ratio</a>, and <a href="#sec-negativeLikelihoodRatio">negative likelihood ratio</a> at a given cutoff:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb272"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1"></a><span class="fu">nomogrammer</span>(</span>
<span id="cb272-2"><a href="#cb272-2"></a>  <span class="at">pretestProb =</span> <span class="fu">baseRate</span>(<span class="at">TP =</span> TPvalue, <span class="at">TN =</span> TNvalue, <span class="at">FP =</span> FPvalue, <span class="at">FN =</span> FNvalue),</span>
<span id="cb272-3"><a href="#cb272-3"></a>  <span class="at">PLR =</span> <span class="fu">positiveLikelihoodRatio</span>(</span>
<span id="cb272-4"><a href="#cb272-4"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb272-5"><a href="#cb272-5"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb272-6"><a href="#cb272-6"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb272-7"><a href="#cb272-7"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb272-8"><a href="#cb272-8"></a>  <span class="at">NLR =</span> <span class="fu">negativeLikelihoodRatio</span>(</span>
<span id="cb272-9"><a href="#cb272-9"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb272-10"><a href="#cb272-10"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb272-11"><a href="#cb272-11"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb272-12"><a href="#cb272-12"></a>    <span class="at">FN =</span> FNvalue)</span>
<span id="cb272-13"><a href="#cb272-13"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-dPrimeSDT" class="level3" data-number="9.5.34"><h3 data-number="9.5.34" class="anchored" data-anchor-id="sec-dPrimeSDT">
<span class="header-section-number">9.5.34</span> <span class="math inline">\(d'\)</span> Sensitivity from Signal Detection Theory</h3>
<p><span class="math inline">\(d'\)</span> (<span class="math inline">\(d\)</span> prime) is an index of sensitivity from <a href="#sec-sdt">signal detection theory</a>, as described by <span class="citation" data-cites="Stanislaw1999">Stanislaw &amp; Todorov (<a href="references.html#ref-Stanislaw1999" role="doc-biblioref">1999</a>)</span>. Higher values reflect greater accuracy. The formula for calculating <span class="math inline">\(d'\)</span> is in <a href="#eq-dPrimeSDT" class="quarto-xref">Equation&nbsp;<span>9.65</span></a>.</p>
<p><span id="eq-dPrimeSDT"><span class="math display">\[
d' = z(\text{hit rate}) - z(\text{false alarm rate})
\tag{9.65}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb273"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1"></a>dPrimeSDT <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb273-2"><a href="#cb273-2"></a>  HR <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)</span>
<span id="cb273-3"><a href="#cb273-3"></a>  FAR <span class="ot">&lt;-</span> FP<span class="sc">/</span>(FP <span class="sc">+</span> TN)</span>
<span id="cb273-4"><a href="#cb273-4"></a>  value <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(HR) <span class="sc">-</span> <span class="fu">qnorm</span>(FAR)</span>
<span id="cb273-5"><a href="#cb273-5"></a>  </span>
<span id="cb273-6"><a href="#cb273-6"></a>  <span class="fu">return</span>(value)</span>
<span id="cb273-7"><a href="#cb273-7"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb274"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1"></a><span class="fu">dPrimeSDT</span>(</span>
<span id="cb274-2"><a href="#cb274-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb274-3"><a href="#cb274-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb274-4"><a href="#cb274-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb274-5"><a href="#cb274-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.226942</code></pre>
</div>
</div>
</section><section id="sec-aSDT" class="level3" data-number="9.5.35"><h3 data-number="9.5.35" class="anchored" data-anchor-id="sec-aSDT">
<span class="header-section-number">9.5.35</span> <span class="math inline">\(A\)</span> (Non-Parametric) Sensitivity from Signal Detection Theory</h3>
<p><span class="math inline">\(A\)</span> is a non-parametric index of sensitivity from <a href="#sec-sdt">signal detection theory</a>, as described by <span class="citation" data-cites="Zhang2005">Zhang &amp; Mueller (<a href="references.html#ref-Zhang2005" role="doc-biblioref">2005</a>)</span>. Higher values reflect greater accuracy. The formula for calculating <span class="math inline">\(A\)</span> is in <a href="#eq-aSDT" class="quarto-xref">Equation&nbsp;<span>9.66</span></a>.</p>
<p><a href="https://sites.google.com/a/mtu.edu/whynotaprime/" class="uri">https://sites.google.com/a/mtu.edu/whynotaprime/</a> (archived at <a href="https://perma.cc/W2M2-39TJ" class="uri">https://perma.cc/W2M2-39TJ</a>)</p>
<p><span id="eq-aSDT"><span class="math display">\[
A =
\begin{cases}
\frac{3}{4} + \frac{H - F}{4} - F(1 - H) &amp; \text{if } F \leq 0.5 \leq H ; \\
\frac{3}{4} + \frac{H - F}{4} - \frac{F}{4H} &amp; \text{if } F \leq H \leq 0.5 ;\\
\frac{3}{4} + \frac{H - F}{4} - \frac{1 - H}{4(1 - F)} &amp; \text{if } 0.5 \leq F \leq H .
\end{cases}
\tag{9.66}\]</span></span></p>
<p>where <span class="math inline">\(H\)</span> is the hit rate and <span class="math inline">\(F\)</span> is the false alarm rate.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb276"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1"></a>aSDT <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb276-2"><a href="#cb276-2"></a>  HR <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)</span>
<span id="cb276-3"><a href="#cb276-3"></a>  FAR <span class="ot">&lt;-</span> FP<span class="sc">/</span>(FP <span class="sc">+</span> TN)</span>
<span id="cb276-4"><a href="#cb276-4"></a>  </span>
<span id="cb276-5"><a href="#cb276-5"></a>  <span class="fu">ifelse</span>(FAR <span class="sc">&lt;=</span> .<span class="dv">5</span> <span class="sc">&amp;</span> HR <span class="sc">&gt;=</span> .<span class="dv">5</span>, value <span class="ot">&lt;-</span> (<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span> ((HR <span class="sc">-</span> FAR)<span class="sc">/</span><span class="dv">4</span>) <span class="sc">-</span> (FAR <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> HR)), <span class="cn">NA</span>)</span>
<span id="cb276-6"><a href="#cb276-6"></a>  <span class="fu">ifelse</span>(FAR <span class="sc">&lt;=</span> HR <span class="sc">&amp;</span> HR <span class="sc">&lt;=</span> .<span class="dv">5</span>, value <span class="ot">&lt;-</span> (<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span> ((HR <span class="sc">-</span> FAR)<span class="sc">/</span><span class="dv">4</span>) <span class="sc">-</span> (FAR<span class="sc">/</span>(<span class="dv">4</span> <span class="sc">*</span> HR)), <span class="cn">NA</span>)</span>
<span id="cb276-7"><a href="#cb276-7"></a>  <span class="fu">ifelse</span>(FAR <span class="sc">&gt;=</span> .<span class="dv">5</span> <span class="sc">&amp;</span> FAR <span class="sc">&lt;=</span> HR, value <span class="ot">&lt;-</span> (<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span> ((HR <span class="sc">-</span> FAR)<span class="sc">/</span><span class="dv">4</span>) <span class="sc">-</span> ((<span class="dv">1</span> <span class="sc">-</span> HR)<span class="sc">/</span>(<span class="dv">4</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> FAR))), <span class="cn">NA</span>)</span>
<span id="cb276-8"><a href="#cb276-8"></a>  </span>
<span id="cb276-9"><a href="#cb276-9"></a>  <span class="fu">return</span>(value)</span>
<span id="cb276-10"><a href="#cb276-10"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb277"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1"></a><span class="fu">aSDT</span>(</span>
<span id="cb277-2"><a href="#cb277-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb277-3"><a href="#cb277-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb277-4"><a href="#cb277-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb277-5"><a href="#cb277-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7925</code></pre>
</div>
</div>
</section><section id="sec-betaSDT" class="level3" data-number="9.5.36"><h3 data-number="9.5.36" class="anchored" data-anchor-id="sec-betaSDT">
<span class="header-section-number">9.5.36</span> <span class="math inline">\(\beta\)</span> Bias from Signal Detection Theory</h3>
<p><span class="math inline">\(\beta\)</span> is an index of bias from <a href="#sec-sdt">signal detection theory</a>, as described by <span class="citation" data-cites="Stanislaw1999">Stanislaw &amp; Todorov (<a href="references.html#ref-Stanislaw1999" role="doc-biblioref">1999</a>)</span>. Smaller values reflect greater accuracy. The formula for calculating <span class="math inline">\(\beta\)</span> is in <a href="#eq-betaSDT" class="quarto-xref">Equation&nbsp;<span>9.67</span></a>.</p>
<p><span id="eq-betaSDT"><span class="math display">\[
\beta = e^{\bigg\{\frac{\big[\phi^{-1}(F)\big]^2 - \big[\phi^{-1}(H)\big]}{2}\bigg\}^2}
\tag{9.67}\]</span></span></p>
<p>where <span class="math inline">\(H\)</span> is the hit rate, <span class="math inline">\(F\)</span> is the false alarm rate, and <span class="math inline">\(\phi\)</span> (phi) is a mathematical function that converts a <em>z</em> score to a probability by determining the portion of the normal distribution that lies to the left of the <em>z</em> score.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb279"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1"></a>betaSDT <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb279-2"><a href="#cb279-2"></a>  HR <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)</span>
<span id="cb279-3"><a href="#cb279-3"></a>  FAR <span class="ot">&lt;-</span> FP<span class="sc">/</span>(FP <span class="sc">+</span> TN)</span>
<span id="cb279-4"><a href="#cb279-4"></a>  value <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">qnorm</span>(FAR)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">-</span> <span class="fu">qnorm</span>(HR)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb279-5"><a href="#cb279-5"></a>  </span>
<span id="cb279-6"><a href="#cb279-6"></a>  <span class="fu">return</span>(value)</span>
<span id="cb279-7"><a href="#cb279-7"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb280"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1"></a><span class="fu">betaSDT</span>(</span>
<span id="cb280-2"><a href="#cb280-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb280-3"><a href="#cb280-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb280-4"><a href="#cb280-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb280-5"><a href="#cb280-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.323034</code></pre>
</div>
</div>
</section><section id="sec-cSDT" class="level3" data-number="9.5.37"><h3 data-number="9.5.37" class="anchored" data-anchor-id="sec-cSDT">
<span class="header-section-number">9.5.37</span> <span class="math inline">\(c\)</span> Bias from Signal Detection Theory</h3>
<p><span class="math inline">\(c\)</span> is an index of bias from <a href="#sec-sdt">signal detection theory</a>, as described by <span class="citation" data-cites="Stanislaw1999">Stanislaw &amp; Todorov (<a href="references.html#ref-Stanislaw1999" role="doc-biblioref">1999</a>)</span>. Smaller values reflect greater accuracy. The formula for calculating <span class="math inline">\(c\)</span> is in <a href="#eq-cSDT" class="quarto-xref">Equation&nbsp;<span>9.68</span></a>.</p>
<p><span id="eq-cSDT"><span class="math display">\[
c = - \frac{\phi^{-1}(H) + \phi^{-1}(F)}{2}
\tag{9.68}\]</span></span></p>
<p>where <span class="math inline">\(H\)</span> is the hit rate, <span class="math inline">\(F\)</span> is the false alarm rate, and <span class="math inline">\(\phi\)</span> (phi) is a mathematical function that converts a <em>z</em> score to a probability by determining the portion of the normal distribution that lies to the left of the <em>z</em> score.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb282"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1"></a>cSDT <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb282-2"><a href="#cb282-2"></a>  HR <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)</span>
<span id="cb282-3"><a href="#cb282-3"></a>  FAR <span class="ot">&lt;-</span> FP<span class="sc">/</span>(FP <span class="sc">+</span> TN)</span>
<span id="cb282-4"><a href="#cb282-4"></a>  value <span class="ot">&lt;-</span> <span class="sc">-</span>(<span class="fu">qnorm</span>(HR) <span class="sc">+</span> <span class="fu">qnorm</span>(FAR))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb282-5"><a href="#cb282-5"></a>  </span>
<span id="cb282-6"><a href="#cb282-6"></a>  <span class="fu">return</span>(value)</span>
<span id="cb282-7"><a href="#cb282-7"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb283"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1"></a><span class="fu">cSDT</span>(</span>
<span id="cb283-2"><a href="#cb283-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb283-3"><a href="#cb283-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb283-4"><a href="#cb283-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb283-5"><a href="#cb283-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2281504</code></pre>
</div>
</div>
</section><section id="sec-bSDT" class="level3" data-number="9.5.38"><h3 data-number="9.5.38" class="anchored" data-anchor-id="sec-bSDT">
<span class="header-section-number">9.5.38</span> <span class="math inline">\(b\)</span> (Non-Parametric) Bias from Signal Detection Theory</h3>
<p><span class="math inline">\(b\)</span> is a non-parametric index of bias from <a href="#sec-sdt">signal detection theory</a>, as described by <span class="citation" data-cites="Zhang2005">Zhang &amp; Mueller (<a href="references.html#ref-Zhang2005" role="doc-biblioref">2005</a>)</span>. Smaller values reflect greater accuracy. The formula for calculating <span class="math inline">\(b\)</span> is in <a href="#eq-bSDT" class="quarto-xref">Equation&nbsp;<span>9.69</span></a>.</p>
<p><span id="eq-bSDT"><span class="math display">\[
b =
\begin{cases}
\frac{5 - 4H}{1 + 4F} &amp; \text{if } F \leq 0.5 \leq H ; \\
\frac{H^2 + H}{H^2 + F} &amp; \text{if } F \leq H \leq 0.5 ;\\
\frac{(1 - F)^2 + (1 - H)}{(1 - F)^2 + (1 - F)} &amp; \text{if } 0.5 \leq F \leq H .
\end{cases}
\tag{9.69}\]</span></span></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb285"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1"></a>bSDT <span class="ot">&lt;-</span> <span class="cf">function</span>(TP, TN, FP, FN){</span>
<span id="cb285-2"><a href="#cb285-2"></a>  HR <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)</span>
<span id="cb285-3"><a href="#cb285-3"></a>  FAR <span class="ot">&lt;-</span> FP<span class="sc">/</span>(FP <span class="sc">+</span> TN)</span>
<span id="cb285-4"><a href="#cb285-4"></a>  </span>
<span id="cb285-5"><a href="#cb285-5"></a>  <span class="fu">ifelse</span>(FAR <span class="sc">&lt;=</span> .<span class="dv">5</span> <span class="sc">&amp;</span> HR <span class="sc">&gt;=</span> .<span class="dv">5</span>, value <span class="ot">&lt;-</span>(<span class="dv">5</span> <span class="sc">-</span> (<span class="dv">4</span> <span class="sc">*</span> HR))<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> (<span class="dv">4</span> <span class="sc">*</span> FAR)), <span class="cn">NA</span>)</span>
<span id="cb285-6"><a href="#cb285-6"></a>  <span class="fu">ifelse</span>(FAR <span class="sc">&lt;=</span> HR <span class="sc">&amp;</span> HR <span class="sc">&lt;=</span> .<span class="dv">5</span>, value <span class="ot">&lt;-</span> (HR<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> HR)<span class="sc">/</span>(HR<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> FAR), <span class="cn">NA</span>)</span>
<span id="cb285-7"><a href="#cb285-7"></a>  <span class="fu">ifelse</span>(FAR <span class="sc">&gt;=</span> .<span class="dv">5</span> <span class="sc">&amp;</span> FAR <span class="sc">&lt;=</span> HR, value <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">-</span> FAR)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> HR))<span class="sc">/</span>((<span class="dv">1</span> <span class="sc">-</span> FAR)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> FAR)), <span class="cn">NA</span>)</span>
<span id="cb285-8"><a href="#cb285-8"></a>  </span>
<span id="cb285-9"><a href="#cb285-9"></a>  <span class="fu">return</span>(value)</span>
<span id="cb285-10"><a href="#cb285-10"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb286"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1"></a><span class="fu">bSDT</span>(</span>
<span id="cb286-2"><a href="#cb286-2"></a>  <span class="at">TP =</span> TPvalue,</span>
<span id="cb286-3"><a href="#cb286-3"></a>  <span class="at">TN =</span> TNvalue,</span>
<span id="cb286-4"><a href="#cb286-4"></a>  <span class="at">FP =</span> FPvalue,</span>
<span id="cb286-5"><a href="#cb286-5"></a>  <span class="at">FN =</span> FNvalue)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.333333</code></pre>
</div>
</div>
</section><section id="sec-miscalibration" class="level3" data-number="9.5.39"><h3 data-number="9.5.39" class="anchored" data-anchor-id="sec-miscalibration">
<span class="header-section-number">9.5.39</span> Mean Difference between Predicted Versus Observed Values (Miscalibration)</h3>
<p>The mean difference between predicted values versus observed values at a given cutoff is an index of <a href="#sec-calibration">miscalibration</a> of predictions at that cutoff. It is called “calibration-in-the-small” (as opposed to calibration-in-the-large, which spans all cutoffs). Values closer to zero reflect greater accuracy. Values above zero indicate that the predicted values are, on average, greater than the observed values. Values below zero indicate that the observed values are, on average, greater than the predicted values.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb288"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1"></a>miscalibration <span class="ot">&lt;-</span> <span class="cf">function</span>(predicted, actual, cutoff, <span class="at">bins =</span> <span class="dv">10</span>){</span>
<span id="cb288-2"><a href="#cb288-2"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">na.omit</span>(<span class="fu">cbind</span>(predicted, actual)))</span>
<span id="cb288-3"><a href="#cb288-3"></a>  </span>
<span id="cb288-4"><a href="#cb288-4"></a>  calibrationTable <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb288-5"><a href="#cb288-5"></a>    data,</span>
<span id="cb288-6"><a href="#cb288-6"></a>    <span class="at">bin =</span> <span class="fu">cut_number</span>(</span>
<span id="cb288-7"><a href="#cb288-7"></a>      predicted,</span>
<span id="cb288-8"><a href="#cb288-8"></a>      <span class="at">n =</span> <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb288-9"><a href="#cb288-9"></a>    <span class="fu">group_by</span>(bin) <span class="sc">%&gt;%</span></span>
<span id="cb288-10"><a href="#cb288-10"></a>    <span class="fu">summarise</span>(</span>
<span id="cb288-11"><a href="#cb288-11"></a>      <span class="at">n =</span> <span class="fu">length</span>(predicted),</span>
<span id="cb288-12"><a href="#cb288-12"></a>      <span class="at">meanPredicted =</span> <span class="fu">mean</span>(predicted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb288-13"><a href="#cb288-13"></a>      <span class="at">meanObserved =</span> <span class="fu">mean</span>(actual, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb288-14"><a href="#cb288-14"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb288-15"><a href="#cb288-15"></a>  </span>
<span id="cb288-16"><a href="#cb288-16"></a>  calibrationTable<span class="sc">$</span>cutoffMin <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(<span class="fu">str_split</span>(</span>
<span id="cb288-17"><a href="#cb288-17"></a>    calibrationTable<span class="sc">$</span>bin,</span>
<span id="cb288-18"><a href="#cb288-18"></a>    <span class="at">pattern =</span> <span class="st">","</span>,</span>
<span id="cb288-19"><a href="#cb288-19"></a>    <span class="at">simplify =</span> <span class="cn">TRUE</span>)[,<span class="dv">1</span>],</span>
<span id="cb288-20"><a href="#cb288-20"></a>    <span class="st">"[^[:alnum:]</span><span class="sc">\\</span><span class="st">-</span><span class="sc">\\</span><span class="st">.]"</span>, <span class="st">""</span>))</span>
<span id="cb288-21"><a href="#cb288-21"></a>  calibrationTable<span class="sc">$</span>cutoffMax <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(<span class="fu">str_split</span>(</span>
<span id="cb288-22"><a href="#cb288-22"></a>    calibrationTable<span class="sc">$</span>bin,</span>
<span id="cb288-23"><a href="#cb288-23"></a>    <span class="at">pattern =</span> <span class="st">","</span>,</span>
<span id="cb288-24"><a href="#cb288-24"></a>    <span class="at">simplify =</span> <span class="cn">TRUE</span>)[,<span class="dv">2</span>],</span>
<span id="cb288-25"><a href="#cb288-25"></a>    <span class="st">"[^[:alnum:]</span><span class="sc">\\</span><span class="st">-</span><span class="sc">\\</span><span class="st">.]"</span>, <span class="st">""</span>))</span>
<span id="cb288-26"><a href="#cb288-26"></a></span>
<span id="cb288-27"><a href="#cb288-27"></a>  calibrationTable<span class="sc">$</span>inRange <span class="ot">&lt;-</span> <span class="fu">with</span>(</span>
<span id="cb288-28"><a href="#cb288-28"></a>    calibrationTable,</span>
<span id="cb288-29"><a href="#cb288-29"></a>    cutoff <span class="sc">&gt;=</span> cutoffMin <span class="sc">&amp;</span> cutoff <span class="sc">&lt;=</span> cutoffMax)</span>
<span id="cb288-30"><a href="#cb288-30"></a>  </span>
<span id="cb288-31"><a href="#cb288-31"></a>  <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">which</span>(calibrationTable<span class="sc">$</span>inRange <span class="sc">==</span> <span class="cn">TRUE</span>)) <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb288-32"><a href="#cb288-32"></a>    nearestCutoff <span class="ot">&lt;-</span> calibrationTable<span class="sc">$</span>bin[<span class="fu">min</span>(<span class="fu">which</span>(</span>
<span id="cb288-33"><a href="#cb288-33"></a>      calibrationTable<span class="sc">$</span>inRange <span class="sc">==</span> <span class="cn">TRUE</span>))]</span>
<span id="cb288-34"><a href="#cb288-34"></a>    calibrationAtNearestCutoff <span class="ot">&lt;-</span> calibrationTable[<span class="fu">which</span>(</span>
<span id="cb288-35"><a href="#cb288-35"></a>      calibrationTable<span class="sc">$</span>bin <span class="sc">==</span> nearestCutoff),]</span>
<span id="cb288-36"><a href="#cb288-36"></a>    calibrationAtNearestCutoff <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(calibrationTable[<span class="fu">max</span>(<span class="fu">which</span>(</span>
<span id="cb288-37"><a href="#cb288-37"></a>      calibrationTable<span class="sc">$</span>inRange <span class="sc">==</span> <span class="cn">TRUE</span>)),])</span>
<span id="cb288-38"><a href="#cb288-38"></a>    </span>
<span id="cb288-39"><a href="#cb288-39"></a>    meanPredicted <span class="ot">&lt;-</span> calibrationAtNearestCutoff[, <span class="st">"meanPredicted"</span>]</span>
<span id="cb288-40"><a href="#cb288-40"></a>    meanObserved <span class="ot">&lt;-</span> calibrationAtNearestCutoff[, <span class="st">"meanObserved"</span>]</span>
<span id="cb288-41"><a href="#cb288-41"></a>    differenceBetweenPredictedAndObserved <span class="ot">&lt;-</span> meanPredicted <span class="sc">-</span> meanObserved</span>
<span id="cb288-42"><a href="#cb288-42"></a>  } <span class="cf">else</span>{</span>
<span id="cb288-43"><a href="#cb288-43"></a>    differenceBetweenPredictedAndObserved <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb288-44"><a href="#cb288-44"></a>  }</span>
<span id="cb288-45"><a href="#cb288-45"></a>  </span>
<span id="cb288-46"><a href="#cb288-46"></a>  <span class="fu">return</span>(differenceBetweenPredictedAndObserved)</span>
<span id="cb288-47"><a href="#cb288-47"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb289"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1"></a><span class="fu">miscalibration</span>(</span>
<span id="cb289-2"><a href="#cb289-2"></a>  <span class="at">predicted =</span> mydataSDT<span class="sc">$</span>predictedProbability,</span>
<span id="cb289-3"><a href="#cb289-3"></a>  <span class="at">actual =</span> mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb289-4"><a href="#cb289-4"></a>  <span class="at">cutoff =</span> cutoff)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] -0.07843137</code></pre>
</div>
</div>
</section></section><section id="sec-optimalCutoff" class="level2" data-number="9.6"><h2 data-number="9.6" class="anchored" data-anchor-id="sec-optimalCutoff">
<span class="header-section-number">9.6</span> Optimal Cutoff Specification</h2>
<p>There are two ways to improve diagnostic performance <span class="citation" data-cites="Swets2000">(<a href="references.html#ref-Swets2000" role="doc-biblioref">Swets et al., 2000</a>)</span>. One way is to increase the diagnostic accuracy of the assessment. The second way is to increase the utility of the diagnostic decisions that are made, based on where we set the cutoff. The optimal cutoff depends on the differential costs of <a href="#sec-falsePositive">false positives</a> versus <a href="#sec-falseNegative">false negatives</a>, as applied in <a href="#sec-decisionTheory">decision theory</a>. When differential costs of <a href="#sec-falsePositive">false positives</a> versus <a href="#sec-falseNegative">false negatives</a> cannot be specified, an alternative approach to specifying the optimal cutoff is to use <a href="#sec-informationTheory">information theory</a>.</p>
<section id="sec-decisionTheory" class="level3" data-number="9.6.1"><h3 data-number="9.6.1" class="anchored" data-anchor-id="sec-decisionTheory">
<span class="header-section-number">9.6.1</span> Decision Theory</h3>
<p>According to the decision theory approach to picking the optimal cutoff, the optimal cutoff depends on the value/importance placed on each of the four decision outcomes [(<a href="#sec-truePositive">true positives</a>, <a href="#sec-trueNegative">true negatives</a>, <a href="#sec-falsePositive">false positives</a>, <a href="#sec-falseNegative">false negatives</a>); <span class="citation" data-cites="Treat2023">Treat &amp; Viken (<a href="references.html#ref-Treat2023" role="doc-biblioref">2023</a>)</span>]. Utility is the relative value placed on a specific decision-making outcome (i.e., user-perceived benefit or cost): utilities typically range between zero and one, where a value of zero represents the least desired outcome, and a value of one indicates the most desired outcome. According to the decision theory approach, the optimal cutoff is the cutoff with the highest overall utility.</p>
<section id="sec-overallUtilityCutoff" class="level4" data-number="9.6.1.1"><h4 data-number="9.6.1.1" class="anchored" data-anchor-id="sec-overallUtilityCutoff">
<span class="header-section-number">9.6.1.1</span> Overall utility of a specific cutoff value</h4>
<p>The overall utility of a specific cutoff value is a utilities-weighted sum of the probabilities of the four decision-making outcomes (<a href="#sec-truePositive">hits</a>, <a href="#sec-falseNegative">misses</a>, <a href="#sec-trueNegative">correct rejections</a>, <a href="#sec-falsePositive">false alarms</a>). That is, overall utility is the sum of the product of the probability of a particular outcome (TP, TN, FP, FN; e.g., <span class="math inline">\(\text{BR} \times \text{TP rate}\)</span>) and the utility of that outcome (e.g., how much we value <a href="#sec-truePositive">TPs</a> relative to other outcomes). Higher values reflect greater utility, so you would pick the cutoff with the highest overall utility. The formula for calculating overall utility is in <a href="#eq-overallUtility" class="quarto-xref">Equation&nbsp;<span>9.70</span></a>:</p>
<p><span id="eq-overallUtility"><span class="math display">\[
\begin{aligned}
  U_\text{overall} = \ &amp; (\text{BR})(\text{HR})(U_\text{H}) \\
  &amp;+ (\text{BR})(1 - \text{HR})(U_\text{M}) \\
  &amp;+ (1 - \text{BR})(\text{FAR})(U_\text{FA}) \\
  &amp;+ (1 - \text{BR})(1 - \text{FAR})(U_\text{CR})
\end{aligned}
\tag{9.70}\]</span></span></p>
<p>where <span class="math inline">\(\text{BR} = \text{base rate}\)</span>, <span class="math inline">\(\text{HR} = \text{hit rate (true positive rate)}\)</span>, <span class="math inline">\(\text{FAR} = \text{false alarm rate (false positive rate)}\)</span>, <span class="math inline">\(U_\text{H} = \text{utility of hits (true positives)}\)</span>, <span class="math inline">\(U_\text{M} = \text{utility of misses (false negatives)}\)</span>, <span class="math inline">\(U_\text{FA} = \text{utility of false alarms (false positives)}\)</span>, <span class="math inline">\(U_\text{CR} = \text{utility of correct rejections (true negatives)}\)</span>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb291"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1"></a>Uoverall <span class="ot">&lt;-</span> <span class="cf">function</span>(BR, HR, FAR, UH, UM, UCR, UFA){</span>
<span id="cb291-2"><a href="#cb291-2"></a>  (BR<span class="sc">*</span>HR<span class="sc">*</span>UH) <span class="sc">+</span> (BR<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> HR)<span class="sc">*</span>UM) <span class="sc">+</span> ((<span class="dv">1</span> <span class="sc">-</span> BR)<span class="sc">*</span>FAR<span class="sc">*</span>UFA) <span class="sc">+</span> ((<span class="dv">1</span> <span class="sc">-</span> BR)<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> FAR)<span class="sc">*</span>(UCR))</span>
<span id="cb291-3"><a href="#cb291-3"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb292"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1"></a><span class="fu">Uoverall</span>(</span>
<span id="cb292-2"><a href="#cb292-2"></a>  <span class="at">BR =</span> <span class="fu">baseRate</span>(</span>
<span id="cb292-3"><a href="#cb292-3"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb292-4"><a href="#cb292-4"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb292-5"><a href="#cb292-5"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb292-6"><a href="#cb292-6"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb292-7"><a href="#cb292-7"></a>  <span class="at">HR =</span> <span class="fu">sensitivity</span>(</span>
<span id="cb292-8"><a href="#cb292-8"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb292-9"><a href="#cb292-9"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb292-10"><a href="#cb292-10"></a>  <span class="at">FAR =</span> <span class="fu">falsePositiveRate</span>(</span>
<span id="cb292-11"><a href="#cb292-11"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb292-12"><a href="#cb292-12"></a>    <span class="at">FP =</span> FPvalue),</span>
<span id="cb292-13"><a href="#cb292-13"></a>  <span class="at">UH =</span> <span class="dv">1</span>,</span>
<span id="cb292-14"><a href="#cb292-14"></a>  <span class="at">UM =</span> <span class="dv">0</span>,</span>
<span id="cb292-15"><a href="#cb292-15"></a>  <span class="at">UCR =</span> <span class="fl">0.75</span>,</span>
<span id="cb292-16"><a href="#cb292-16"></a>  <span class="at">UFA =</span> <span class="fl">0.25</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.65</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb294"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1"></a><span class="fu">Uoverall</span>(</span>
<span id="cb294-2"><a href="#cb294-2"></a>  <span class="at">BR =</span> <span class="fu">baseRate</span>(</span>
<span id="cb294-3"><a href="#cb294-3"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb294-4"><a href="#cb294-4"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb294-5"><a href="#cb294-5"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb294-6"><a href="#cb294-6"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb294-7"><a href="#cb294-7"></a>  <span class="at">HR =</span> <span class="fu">sensitivity</span>(</span>
<span id="cb294-8"><a href="#cb294-8"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb294-9"><a href="#cb294-9"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb294-10"><a href="#cb294-10"></a>  <span class="at">FAR =</span> <span class="fu">falsePositiveRate</span>(</span>
<span id="cb294-11"><a href="#cb294-11"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb294-12"><a href="#cb294-12"></a>    <span class="at">FP =</span> FPvalue),</span>
<span id="cb294-13"><a href="#cb294-13"></a>  <span class="at">UH =</span> <span class="dv">1</span>,</span>
<span id="cb294-14"><a href="#cb294-14"></a>  <span class="at">UM =</span> <span class="dv">0</span>,</span>
<span id="cb294-15"><a href="#cb294-15"></a>  <span class="at">UCR =</span> <span class="dv">1</span>,</span>
<span id="cb294-16"><a href="#cb294-16"></a>  <span class="at">UFA =</span> <span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7454545</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb296"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1"></a><span class="fu">Uoverall</span>(</span>
<span id="cb296-2"><a href="#cb296-2"></a>  <span class="at">BR =</span> <span class="fu">baseRate</span>(</span>
<span id="cb296-3"><a href="#cb296-3"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb296-4"><a href="#cb296-4"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb296-5"><a href="#cb296-5"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb296-6"><a href="#cb296-6"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb296-7"><a href="#cb296-7"></a>  <span class="at">HR =</span> <span class="fu">sensitivity</span>(</span>
<span id="cb296-8"><a href="#cb296-8"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb296-9"><a href="#cb296-9"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb296-10"><a href="#cb296-10"></a>  <span class="at">FAR =</span> <span class="fu">falsePositiveRate</span>(</span>
<span id="cb296-11"><a href="#cb296-11"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb296-12"><a href="#cb296-12"></a>    <span class="at">FP =</span> FPvalue),</span>
<span id="cb296-13"><a href="#cb296-13"></a>  <span class="at">UH =</span> <span class="fl">0.75</span>,</span>
<span id="cb296-14"><a href="#cb296-14"></a>  <span class="at">UM =</span> <span class="fl">0.25</span>,</span>
<span id="cb296-15"><a href="#cb296-15"></a>  <span class="at">UCR =</span> <span class="dv">1</span>,</span>
<span id="cb296-16"><a href="#cb296-16"></a>  <span class="at">UFA =</span> <span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7181818</code></pre>
</div>
</div>
</section><section id="sec-utilityRatio" class="level4" data-number="9.6.1.2"><h4 data-number="9.6.1.2" class="anchored" data-anchor-id="sec-utilityRatio">
<span class="header-section-number">9.6.1.2</span> Utility ratio</h4>
<p>The utility ratio is the user-perceived relative importance of decisions about negative versus positive cases. If the utility ratio value is one, it indicates that identifying negative cases and positive cases is equally important. Values above one indicate greater relative importance of identifying negative cases than positive cases. Values below one indicate greater relative importance of identifying positive cases than negative cases. Values of one indicate that you are maximizing percent accuracy. The formula for calculating the utility ratio is in <a href="#eq-utilityRatio" class="quarto-xref">Equation&nbsp;<span>9.71</span></a>:</p>
<p><span id="eq-utilityRatio"><span class="math display">\[
\text{Utility Ratio} = \frac{U_\text{CR} - U_\text{FA}}{U_\text{H} - U_\text{M}}
\tag{9.71}\]</span></span></p>
<p>where <span class="math inline">\(U_\text{H} = \text{utility of hits (true positives)}\)</span>, <span class="math inline">\(U_\text{M} = \text{utility of misses (false negatives)}\)</span>, <span class="math inline">\(U_\text{FA} = \text{utility of false alarms (false positives)}\)</span>, <span class="math inline">\(U_\text{CR} = \text{utility of correct rejections (true negatives)}\)</span>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb298"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1"></a>utilityRatio <span class="ot">&lt;-</span> <span class="cf">function</span>(UH, UM, UCR, UFA){</span>
<span id="cb298-2"><a href="#cb298-2"></a>  (UCR <span class="sc">-</span> UFA) <span class="sc">/</span> (UH <span class="sc">-</span> UM)</span>
<span id="cb298-3"><a href="#cb298-3"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb299"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1"></a><span class="fu">utilityRatio</span>(<span class="at">UH =</span> <span class="dv">1</span>, <span class="at">UM =</span> <span class="dv">0</span>, <span class="at">UCR =</span> <span class="fl">0.75</span>, <span class="at">UFA =</span> <span class="fl">0.25</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb301"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1"></a><span class="fu">utilityRatio</span>(<span class="at">UH =</span> <span class="dv">1</span>, <span class="at">UM =</span> <span class="dv">0</span>, <span class="at">UCR =</span> <span class="dv">1</span>, <span class="at">UFA =</span> <span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb303"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1"></a><span class="fu">utilityRatio</span>(<span class="at">UH =</span> <span class="fl">0.75</span>, <span class="at">UM =</span> <span class="fl">0.25</span>, <span class="at">UCR =</span> <span class="dv">1</span>, <span class="at">UFA =</span> <span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p><a href="#sec-decisionTheory">Decision theory</a> has key advantages, because it identifies the cutoff that would help you best achieve the goals/purpose of the assessment. However, it can be challenging to specify the relative costs of errors. If you cannot decide values for outcomes (relative importance between <a href="#sec-falsePositive">FP</a> and <a href="#sec-falseNegative">FN</a>), you can use <a href="#sec-informationTheory">information theory</a> to identify the optimal cutoff.</p>
</section></section><section id="sec-informationTheory" class="level3" data-number="9.6.2"><h3 data-number="9.6.2" class="anchored" data-anchor-id="sec-informationTheory">
<span class="header-section-number">9.6.2</span> Information Theory</h3>
<p>When the user does not differentially weigh the value/importance of the four decision-making outcomes (<a href="#sec-truePositive">hits</a>, <a href="#sec-falseNegative">misses</a>, <a href="#sec-trueNegative">correct rejections</a>, <a href="#sec-falsePositive">false alarms</a>), the information theory approach can be useful for specifying the optimal cutoff. According to the information theory approach, the optimal cutoff is the cutoff that provides the greatest information gain <span class="citation" data-cites="Treat2023">(<a href="references.html#ref-Treat2023" role="doc-biblioref">Treat &amp; Viken, 2023</a>)</span>.</p>
<section id="sec-informationGain" class="level4" data-number="9.6.2.1"><h4 data-number="9.6.2.1" class="anchored" data-anchor-id="sec-informationGain">
<span class="header-section-number">9.6.2.1</span> Information Gain</h4>
<p>Information gain (<span class="math inline">\(I_\text{gain}\)</span>) is the reduction of uncertainty about the true classification of a case that results from administering an assessment or prediction measure <span class="citation" data-cites="Treat2023">(<a href="references.html#ref-Treat2023" role="doc-biblioref">Treat &amp; Viken, 2023</a>)</span>. Greater values reflect greater reduction of uncertainty, so the optimal cutoff can be specified as the cutoff with the highest information gain.</p>
<section id="sec-IgainTreat2023" class="level5" data-number="9.6.2.1.1"><h5 data-number="9.6.2.1.1" class="anchored" data-anchor-id="sec-IgainTreat2023">
<span class="header-section-number">9.6.2.1.1</span> Formula from <span class="citation" data-cites="Treat2023">Treat &amp; Viken (<a href="references.html#ref-Treat2023" role="doc-biblioref">2023</a>)</span>
</h5>
<p>The formula from <span class="citation" data-cites="Treat2023">Treat &amp; Viken (<a href="references.html#ref-Treat2023" role="doc-biblioref">2023</a>)</span> for calculating information gain is in <a href="#eq-informationGain1" class="quarto-xref">Equation&nbsp;<span>9.72</span></a>:</p>
<p><span id="eq-informationGain1"><span class="math display">\[
\begin{aligned}
  I_\text{gain} = \ &amp; (\text{BR})(\text{HR})\bigg[\log_2\bigg(\frac{\text{HR}}{G}\bigg)\bigg] \\
  &amp;+ (\text{BR})(1 - \text{HR})\bigg[\log_2\bigg(\frac{1 - \text{HR}}{1 - G}\bigg)\bigg] \\
  &amp;+ (1 - \text{BR})(\text{FAR})\bigg[\log_2\bigg(\frac{\text{FAR}}{G}\bigg)\bigg] \\
  &amp;+ (1 - \text{BR})(1 - \text{FAR})\bigg[\log_2\bigg(\frac{1 - \text{FAR}}{1 - G}\bigg)\bigg]
\end{aligned}
\tag{9.72}\]</span></span></p>
<p>where <span class="math inline">\(\text{BR} =\)</span> <a href="#sec-baseRate">base rate</a>, <span class="math inline">\(\text{HR} =\)</span> <a href="#sec-sensitivity">hit rate</a> (<a href="#sec-sensitivity">true positive rate</a>), <span class="math inline">\(\text{FAR} =\)</span> <a href="#sec-falsePositiveRate">false alarm rate</a> (<a href="#sec-falsePositiveRate">false positive rate</a>), <span class="math inline">\(G =\)</span> <a href="#sec-selectionRatio">selection ratio</a> <span class="math inline">\(= \text{BR} (\text{HR}) + (1 - \text{BR}) (\text{FAR})\)</span>, as reported in <span class="citation" data-cites="Somoza1989">Somoza et al. (<a href="references.html#ref-Somoza1989" role="doc-biblioref">1989</a>)</span> (see below).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb305"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1"></a>Igain <span class="ot">&lt;-</span> <span class="cf">function</span>(BR, HR, FAR){</span>
<span id="cb305-2"><a href="#cb305-2"></a>  G <span class="ot">&lt;-</span> BR<span class="sc">*</span>(HR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> BR)<span class="sc">*</span>(FAR)</span>
<span id="cb305-3"><a href="#cb305-3"></a>  </span>
<span id="cb305-4"><a href="#cb305-4"></a>  (BR<span class="sc">*</span>HR<span class="sc">*</span><span class="fu">log2</span>(HR<span class="sc">/</span>G)) <span class="sc">+</span> </span>
<span id="cb305-5"><a href="#cb305-5"></a>    (BR<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> HR)<span class="sc">*</span>(<span class="fu">log2</span>((<span class="dv">1</span> <span class="sc">-</span> HR)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> G)))) <span class="sc">+</span> </span>
<span id="cb305-6"><a href="#cb305-6"></a>    ((<span class="dv">1</span> <span class="sc">-</span> BR)<span class="sc">*</span>FAR<span class="sc">*</span>(<span class="fu">log2</span>(FAR<span class="sc">/</span>G))) <span class="sc">+</span> </span>
<span id="cb305-7"><a href="#cb305-7"></a>    ((<span class="dv">1</span> <span class="sc">-</span> BR)<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> FAR)<span class="sc">*</span>(<span class="fu">log2</span>((<span class="dv">1</span> <span class="sc">-</span> FAR)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> G))))</span>
<span id="cb305-8"><a href="#cb305-8"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb306"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1"></a><span class="fu">Igain</span>(</span>
<span id="cb306-2"><a href="#cb306-2"></a>  <span class="at">BR =</span> <span class="fu">baseRate</span>(</span>
<span id="cb306-3"><a href="#cb306-3"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb306-4"><a href="#cb306-4"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb306-5"><a href="#cb306-5"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb306-6"><a href="#cb306-6"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb306-7"><a href="#cb306-7"></a>  <span class="at">HR =</span> <span class="fu">sensitivity</span>(</span>
<span id="cb306-8"><a href="#cb306-8"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb306-9"><a href="#cb306-9"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb306-10"><a href="#cb306-10"></a>  <span class="at">FAR =</span> <span class="fu">falsePositiveRate</span>(</span>
<span id="cb306-11"><a href="#cb306-11"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb306-12"><a href="#cb306-12"></a>    <span class="at">FP =</span> FPvalue))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1465904</code></pre>
</div>
</div>
</section><section id="sec-IgainMetz1973" class="level5" data-number="9.6.2.1.2"><h5 data-number="9.6.2.1.2" class="anchored" data-anchor-id="sec-IgainMetz1973">
<span class="header-section-number">9.6.2.1.2</span> Alternative formula from <span class="citation" data-cites="Metz1973">Metz et al. (<a href="references.html#ref-Metz1973" role="doc-biblioref">1973</a>)</span>
</h5>
<p>The alternative formula from <span class="citation" data-cites="Metz1973">Metz et al. (<a href="references.html#ref-Metz1973" role="doc-biblioref">1973</a>)</span> for calculating information gain is in <a href="#eq-informationGain2" class="quarto-xref">Equation&nbsp;<span>9.73</span></a>:</p>
<p><span id="eq-informationGain2"><span class="math display">\[
\begin{aligned}
  I_\text{gain} = \ &amp; p(S|s) \cdot p(s) \cdot log_2\Bigg\{\frac{p(S|s)}{p(S|s) \cdot p(s) + p(S|n)[1 - p(s)]}\Bigg\} \\
  &amp;+ p(S|n)[1 - p(s)] \times log_2\Bigg\{\frac{p(S|n)}{p(S|s) \cdot p(s) + p(S|n)[1 - p(s)]}\Bigg\} \\
  &amp;+ [1 - p(S|s)] \cdot p(s) \times log_2\Bigg\{\frac{1 - p(S|s)}{1 - p(S|s) \cdot p(s) - p(S|n)[1 - p(s)]}\Bigg\} \\
  &amp;+ [1 - p(S|n)][1 - p(s)] \times log_2\Bigg\{\frac{1 - p(S|n)}{1 - p(S|s) \cdot p(s) - p(S|n)[1 - p(s)]}\Bigg\}
\end{aligned}
\tag{9.73}\]</span></span></p>
<p>where <span class="math inline">\(p(S|s) =\)</span> <a href="#sec-sensitivity">sensitivity</a> (<a href="#sec-sensitivity">hit rate</a> or <a href="#sec-sensitivity">true positive rate</a>); i.e., the <a href="#sec-conditionalProbability">conditional probability</a> of deciding a signal is present (<span class="math inline">\(S\)</span>) when the signal is in fact present(<span class="math inline">\(s\)</span>), <span class="math inline">\(p(S|n) =\)</span> <a href="#sec-falsePositiveRate">false positive rate</a> (<a href="#sec-falsePositiveRate">false alarm rate</a>); i.e., the <a href="#sec-conditionalProbability">conditional probability</a> of deciding a signal is present (<span class="math inline">\(S\)</span>) when the signal is in fact absent (<span class="math inline">\(n\)</span>), <span class="math inline">\(p(s) =\)</span> <a href="#sec-baseRate">base rate</a>, i.e., the probability that the signal is in fact present (<span class="math inline">\(s\)</span>).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb308"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1"></a>Igain2 <span class="ot">&lt;-</span> <span class="cf">function</span>(BR, HR, FAR){</span>
<span id="cb308-2"><a href="#cb308-2"></a>  HR <span class="sc">*</span> BR <span class="sc">*</span> <span class="fu">log2</span>(HR <span class="sc">/</span> ((HR <span class="sc">*</span> BR) <span class="sc">+</span> (FAR <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> BR)))) <span class="sc">+</span></span>
<span id="cb308-3"><a href="#cb308-3"></a>    FAR <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> BR) <span class="sc">*</span> <span class="fu">log2</span>(FAR <span class="sc">/</span> ((HR <span class="sc">*</span> BR) <span class="sc">+</span> (FAR <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> BR)))) <span class="sc">+</span></span>
<span id="cb308-4"><a href="#cb308-4"></a>    (<span class="dv">1</span> <span class="sc">-</span> HR) <span class="sc">*</span> BR <span class="sc">*</span> <span class="fu">log2</span>((<span class="dv">1</span> <span class="sc">-</span> HR) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> (HR <span class="sc">*</span> BR) <span class="sc">-</span> (FAR <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> BR)))) <span class="sc">+</span></span>
<span id="cb308-5"><a href="#cb308-5"></a>    (<span class="dv">1</span> <span class="sc">-</span> FAR) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> BR) <span class="sc">*</span> <span class="fu">log2</span>((<span class="dv">1</span> <span class="sc">-</span> FAR) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> (HR <span class="sc">*</span> BR) <span class="sc">-</span> (FAR <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> BR))))</span>
<span id="cb308-6"><a href="#cb308-6"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb309"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1"></a><span class="fu">Igain2</span>(</span>
<span id="cb309-2"><a href="#cb309-2"></a>  <span class="at">BR =</span> <span class="fu">baseRate</span>(</span>
<span id="cb309-3"><a href="#cb309-3"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb309-4"><a href="#cb309-4"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb309-5"><a href="#cb309-5"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb309-6"><a href="#cb309-6"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb309-7"><a href="#cb309-7"></a>  <span class="at">HR =</span> <span class="fu">sensitivity</span>(</span>
<span id="cb309-8"><a href="#cb309-8"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb309-9"><a href="#cb309-9"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb309-10"><a href="#cb309-10"></a>  <span class="at">FAR =</span> <span class="fu">falsePositiveRate</span>(</span>
<span id="cb309-11"><a href="#cb309-11"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb309-12"><a href="#cb309-12"></a>    <span class="at">FP =</span> FPvalue))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1465904</code></pre>
</div>
</div>
</section><section id="sec-IgainSomoza1989" class="level5" data-number="9.6.2.1.3"><h5 data-number="9.6.2.1.3" class="anchored" data-anchor-id="sec-IgainSomoza1989">
<span class="header-section-number">9.6.2.1.3</span> Alternative formula from <span class="citation" data-cites="Somoza1989">Somoza et al. (<a href="references.html#ref-Somoza1989" role="doc-biblioref">1989</a>)</span>
</h5>
<p>The alternative formula from <span class="citation" data-cites="Somoza1989">Somoza et al. (<a href="references.html#ref-Somoza1989" role="doc-biblioref">1989</a>)</span> for calculating information gain is in <a href="#eq-informationGain3" class="quarto-xref">Equation&nbsp;<span>9.74</span></a>:</p>
<p><span id="eq-informationGain3"><span class="math display">\[
\begin{aligned}
  I_\text{gain} = \ &amp; [(\text{TPR})(\text{Pr})] \times \log_2(\text{TPR}/G) \\
  &amp;+ [(\text{FPR})(1 - \text{Pr})] \times \log_2(\text{FPR}/G) \\
  &amp;+ [(1 - \text{TPR})(\text{Pr})] \times \log_2\bigg(\frac{1 - \text{TPR}}{1 - G}\bigg) \\
  &amp;+ [(1 - \text{FPR})(1 - \text{Pr})] \times \log_2\bigg(\frac{1 - \text{FPR}}{1 - G}\bigg)
\end{aligned}
\tag{9.74}\]</span></span></p>
<p>where <span class="math inline">\(\text{TP} =\)</span> <a href="#sec-sensitivity">true positive rate</a> (<a href="#sec-sensitivity">hit rate</a>), <span class="math inline">\(\text{Pr} =\)</span> <a href="#sec-baseRate">prevalence</a> (<a href="#sec-baseRate">base rate</a>), <span class="math inline">\(\text{FP} =\)</span> <a href="#sec-falsePositiveRate">false positive rate</a> (<a href="#sec-falsePositiveRate">false alarm rate</a>), <span class="math inline">\(G = \text{Pr} (\text{TP}) + (1 - \text{Pr}) (\text{FP}) =\)</span> <a href="#sec-selectionRatio">selection ratio</a></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb311"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1"></a>Igain3 <span class="ot">&lt;-</span> <span class="cf">function</span>(BR, HR, FAR){</span>
<span id="cb311-2"><a href="#cb311-2"></a>  G <span class="ot">&lt;-</span> BR<span class="sc">*</span>(HR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> BR)<span class="sc">*</span>(FAR)</span>
<span id="cb311-3"><a href="#cb311-3"></a>  </span>
<span id="cb311-4"><a href="#cb311-4"></a>  ((HR)<span class="sc">*</span>(BR))<span class="sc">*</span><span class="fu">log2</span>((HR<span class="sc">/</span>G)) <span class="sc">+</span> </span>
<span id="cb311-5"><a href="#cb311-5"></a>    ((FAR)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>BR))<span class="sc">*</span><span class="fu">log2</span>((FAR<span class="sc">/</span>G)) <span class="sc">+</span> </span>
<span id="cb311-6"><a href="#cb311-6"></a>    ((<span class="dv">1</span><span class="sc">-</span>HR)<span class="sc">*</span>(BR))<span class="sc">*</span><span class="fu">log2</span>((<span class="dv">1</span><span class="sc">-</span>HR)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>G)) <span class="sc">+</span> </span>
<span id="cb311-7"><a href="#cb311-7"></a>    ((<span class="dv">1</span><span class="sc">-</span>FAR)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>BR))<span class="sc">*</span><span class="fu">log2</span>((<span class="dv">1</span><span class="sc">-</span>FAR)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>G))</span>
<span id="cb311-8"><a href="#cb311-8"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb312"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1"></a><span class="fu">Igain3</span>(</span>
<span id="cb312-2"><a href="#cb312-2"></a>  <span class="at">BR =</span> <span class="fu">baseRate</span>(</span>
<span id="cb312-3"><a href="#cb312-3"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb312-4"><a href="#cb312-4"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb312-5"><a href="#cb312-5"></a>    <span class="at">FP =</span> FPvalue,</span>
<span id="cb312-6"><a href="#cb312-6"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb312-7"><a href="#cb312-7"></a>  <span class="at">HR =</span> <span class="fu">sensitivity</span>(</span>
<span id="cb312-8"><a href="#cb312-8"></a>    <span class="at">TP =</span> TPvalue,</span>
<span id="cb312-9"><a href="#cb312-9"></a>    <span class="at">FN =</span> FNvalue),</span>
<span id="cb312-10"><a href="#cb312-10"></a>  <span class="at">FAR =</span> <span class="fu">falsePositiveRate</span>(</span>
<span id="cb312-11"><a href="#cb312-11"></a>    <span class="at">TN =</span> TNvalue,</span>
<span id="cb312-12"><a href="#cb312-12"></a>    <span class="at">FP =</span> FPvalue))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1465904</code></pre>
</div>
</div>
</section><section id="sec-IgainExamples" class="level5" data-number="9.6.2.1.4"><h5 data-number="9.6.2.1.4" class="anchored" data-anchor-id="sec-IgainExamples">
<span class="header-section-number">9.6.2.1.4</span> Examples</h5>
<p>Case A from Exhibit 38.2 <span class="citation" data-cites="Treat2023">(<a href="references.html#ref-Treat2023" role="doc-biblioref">Treat &amp; Viken, 2023</a>)</span>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb314"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1"></a><span class="fu">Igain</span>(<span class="at">HR =</span> (<span class="dv">911</span><span class="sc">/</span><span class="dv">1899</span>), <span class="at">FAR =</span> (<span class="dv">509</span><span class="sc">/</span><span class="dv">4757</span>), <span class="at">BR =</span> (<span class="dv">1899</span><span class="sc">/</span><span class="dv">6656</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.112081</code></pre>
</div>
</div>
<p>Case B from Exhibit 38.2 <span class="citation" data-cites="Treat2023">(<a href="references.html#ref-Treat2023" role="doc-biblioref">Treat &amp; Viken, 2023</a>)</span>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb316"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1"></a><span class="fu">Igain</span>(<span class="at">HR =</span> (<span class="dv">1597</span><span class="sc">/</span><span class="dv">3328</span>), <span class="at">FAR =</span> (<span class="dv">356</span><span class="sc">/</span><span class="dv">3328</span>), <span class="at">BR =</span> (<span class="dv">3328</span><span class="sc">/</span><span class="dv">6656</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1283265</code></pre>
</div>
</div>
<p>Case C from Exhibit 38.2 <span class="citation" data-cites="Treat2023">(<a href="references.html#ref-Treat2023" role="doc-biblioref">Treat &amp; Viken, 2023</a>)</span>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb318"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1"></a><span class="fu">Igain</span>(<span class="at">HR =</span> (<span class="dv">2040</span><span class="sc">/</span><span class="dv">3328</span>), <span class="at">FAR =</span> (<span class="dv">654</span><span class="sc">/</span><span class="dv">3328</span>), <span class="at">BR =</span> (<span class="dv">3328</span><span class="sc">/</span><span class="dv">6656</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1347846</code></pre>
</div>
</div>
<p>Case B from Exhibit 38.3 <span class="citation" data-cites="Treat2023">(<a href="references.html#ref-Treat2023" role="doc-biblioref">Treat &amp; Viken, 2023</a>)</span>:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb320"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1"></a><span class="fu">Igain</span>(<span class="at">HR =</span> (<span class="dv">1164</span><span class="sc">/</span><span class="dv">1899</span>), <span class="at">FAR =</span> (<span class="dv">935</span><span class="sc">/</span><span class="dv">4757</span>), <span class="at">BR =</span> (<span class="dv">1899</span><span class="sc">/</span><span class="dv">6656</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1135549</code></pre>
</div>
</div>
</section><section id="sec-baseRateEffectsIgain" class="level5" data-number="9.6.2.1.5"><h5 data-number="9.6.2.1.5" class="anchored" data-anchor-id="sec-baseRateEffectsIgain">
<span class="header-section-number">9.6.2.1.5</span> Effect of Base Rate</h5>
<p>Information gain depends on the <a href="#sec-baseRate">base rate</a> <span class="citation" data-cites="Treat2023">(<a href="references.html#ref-Treat2023" role="doc-biblioref">Treat &amp; Viken, 2023</a>)</span>, as depicted in <a href="#fig-informationGainBaseRate" class="quarto-xref">Figure&nbsp;<span>9.34</span></a>. The maximum reduction of uncertainty (i.e., greatest information) occurs when the <a href="#sec-baseRate">base rate</a> is 0.5. A <a href="#sec-baseRate">base rate</a> tells us little a priori about the condition if the probability of the condition is 50/50, so the measure can provide more benefit. If the <a href="#sec-baseRate">base rate</a> is 0.3 or 0.7, we can do better than <a href="#sec-predictingFromBaseRate">going with the base rate</a>. If the <a href="#sec-baseRate">base rate</a> is 0.9 or 0.1, it is difficult for our measure to do better than <a href="#sec-predictingFromBaseRate">going with the base rate</a>. If the <a href="#sec-baseRate">base rate</a> is 0.05 of 0.95 (or more extreme), it is likely that our measure will do almost nothing in terms of information gain.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-informationGainBaseRate" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Information Gain as a Function of the Base Rate (BR).">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-informationGainBaseRate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-informationGainBaseRate-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Figure&nbsp;9.34: Information Gain as a Function of the Base Rate (BR)."><img src="prediction_files/figure-html/fig-informationGainBaseRate-1.png" class="img-fluid figure-img" alt="Information Gain as a Function of the Base Rate (BR)." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-informationGainBaseRate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.34: Information Gain as a Function of the Base Rate (BR).
</figcaption></figure>
</div>
</div>
</div>
</section></section></section></section><section id="sec-accuracyAtEveryPossibleCutoff" class="level2" data-number="9.7"><h2 data-number="9.7" class="anchored" data-anchor-id="sec-accuracyAtEveryPossibleCutoff">
<span class="header-section-number">9.7</span> Accuracy at Every Possible Cutoff</h2>
<section id="sec-specifyUtility" class="level3" data-number="9.7.1"><h3 data-number="9.7.1" class="anchored" data-anchor-id="sec-specifyUtility">
<span class="header-section-number">9.7.1</span> Specify utility of each outcome</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb322"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1"></a>utilityHits <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb322-2"><a href="#cb322-2"></a>utilityMisses <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb322-3"><a href="#cb322-3"></a>utilityCorrectRejections <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb322-4"><a href="#cb322-4"></a>utilityFalseAlarms <span class="ot">&lt;-</span> <span class="fl">0.25</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-calculateAccuracyAtEveryPossibleCutoff" class="level3" data-number="9.7.2"><h3 data-number="9.7.2" class="anchored" data-anchor-id="sec-calculateAccuracyAtEveryPossibleCutoff">
<span class="header-section-number">9.7.2</span> Calculate Accuracy</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb323"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1"></a>possibleCutoffs <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">na.omit</span>(mydataSDT<span class="sc">$</span>testScore))</span>
<span id="cb323-2"><a href="#cb323-2"></a>possibleCutoffs <span class="ot">&lt;-</span> possibleCutoffs[<span class="fu">order</span>(possibleCutoffs)]</span>
<span id="cb323-3"><a href="#cb323-3"></a>possibleCutoffs <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb323-4"><a href="#cb323-4"></a>  possibleCutoffs, <span class="fu">max</span>(possibleCutoffs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fl">0.01</span>)</span>
<span id="cb323-5"><a href="#cb323-5"></a></span>
<span id="cb323-6"><a href="#cb323-6"></a>accuracyVariables <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb323-7"><a href="#cb323-7"></a>  <span class="st">"cutoff"</span>, <span class="st">"TP"</span>, <span class="st">"TN"</span>, <span class="st">"FP"</span>, <span class="st">"FN"</span>, <span class="st">"differenceBetweenPredictedAndObserved"</span>)</span>
<span id="cb323-8"><a href="#cb323-8"></a></span>
<span id="cb323-9"><a href="#cb323-9"></a>accuracyStats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb323-10"><a href="#cb323-10"></a>  <span class="fu">matrix</span>(</span>
<span id="cb323-11"><a href="#cb323-11"></a>    <span class="at">nrow =</span> <span class="fu">length</span>(possibleCutoffs),</span>
<span id="cb323-12"><a href="#cb323-12"></a>    <span class="at">ncol =</span> <span class="fu">length</span>(accuracyVariables)))</span>
<span id="cb323-13"><a href="#cb323-13"></a><span class="fu">names</span>(accuracyStats) <span class="ot">&lt;-</span> accuracyVariables</span>
<span id="cb323-14"><a href="#cb323-14"></a></span>
<span id="cb323-15"><a href="#cb323-15"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(possibleCutoffs)){</span>
<span id="cb323-16"><a href="#cb323-16"></a>  cutoff <span class="ot">&lt;-</span> possibleCutoffs[i]</span>
<span id="cb323-17"><a href="#cb323-17"></a>  </span>
<span id="cb323-18"><a href="#cb323-18"></a>  mydataSDT<span class="sc">$</span>diagnosis <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb323-19"><a href="#cb323-19"></a>  mydataSDT<span class="sc">$</span>diagnosis[mydataSDT<span class="sc">$</span>testScore <span class="sc">&lt;</span> cutoff] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb323-20"><a href="#cb323-20"></a>  mydataSDT<span class="sc">$</span>diagnosis[mydataSDT<span class="sc">$</span>testScore <span class="sc">&gt;=</span> cutoff] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb323-21"><a href="#cb323-21"></a>  </span>
<span id="cb323-22"><a href="#cb323-22"></a>  accuracyStats[i, <span class="st">"cutoff"</span>] <span class="ot">&lt;-</span> cutoff</span>
<span id="cb323-23"><a href="#cb323-23"></a>  accuracyStats[i, <span class="st">"TP"</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(</span>
<span id="cb323-24"><a href="#cb323-24"></a>    mydataSDT<span class="sc">$</span>diagnosis <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> mydataSDT<span class="sc">$</span>disorder <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb323-25"><a href="#cb323-25"></a>  accuracyStats[i, <span class="st">"TN"</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(</span>
<span id="cb323-26"><a href="#cb323-26"></a>    mydataSDT<span class="sc">$</span>diagnosis <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> mydataSDT<span class="sc">$</span>disorder <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb323-27"><a href="#cb323-27"></a>  accuracyStats[i, <span class="st">"FP"</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(</span>
<span id="cb323-28"><a href="#cb323-28"></a>    mydataSDT<span class="sc">$</span>diagnosis <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> mydataSDT<span class="sc">$</span>disorder <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb323-29"><a href="#cb323-29"></a>  accuracyStats[i, <span class="st">"FN"</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(</span>
<span id="cb323-30"><a href="#cb323-30"></a>    mydataSDT<span class="sc">$</span>diagnosis <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> mydataSDT<span class="sc">$</span>disorder <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb323-31"><a href="#cb323-31"></a>  </span>
<span id="cb323-32"><a href="#cb323-32"></a>  accuracyStats[i, <span class="st">"differenceBetweenPredictedAndObserved"</span>] <span class="ot">&lt;-</span> </span>
<span id="cb323-33"><a href="#cb323-33"></a>    <span class="fu">miscalibration</span>(</span>
<span id="cb323-34"><a href="#cb323-34"></a>      <span class="at">predicted =</span> mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb323-35"><a href="#cb323-35"></a>      <span class="at">actual =</span> mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb323-36"><a href="#cb323-36"></a>      <span class="at">cutoff =</span> cutoff)</span>
<span id="cb323-37"><a href="#cb323-37"></a>}</span>
<span id="cb323-38"><a href="#cb323-38"></a></span>
<span id="cb323-39"><a href="#cb323-39"></a>accuracyStats<span class="sc">$</span>N <span class="ot">&lt;-</span> <span class="fu">sampleSize</span>(</span>
<span id="cb323-40"><a href="#cb323-40"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-41"><a href="#cb323-41"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-42"><a href="#cb323-42"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-43"><a href="#cb323-43"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-44"><a href="#cb323-44"></a></span>
<span id="cb323-45"><a href="#cb323-45"></a>accuracyStats<span class="sc">$</span>selectionRatio <span class="ot">&lt;-</span> <span class="fu">selectionRatio</span>(</span>
<span id="cb323-46"><a href="#cb323-46"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-47"><a href="#cb323-47"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-48"><a href="#cb323-48"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-49"><a href="#cb323-49"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-50"><a href="#cb323-50"></a>accuracyStats<span class="sc">$</span>baseRate <span class="ot">&lt;-</span> <span class="fu">baseRate</span>(</span>
<span id="cb323-51"><a href="#cb323-51"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-52"><a href="#cb323-52"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-53"><a href="#cb323-53"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-54"><a href="#cb323-54"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-55"><a href="#cb323-55"></a></span>
<span id="cb323-56"><a href="#cb323-56"></a>accuracyStats<span class="sc">$</span>percentAccuracy <span class="ot">&lt;-</span> <span class="fu">percentAccuracy</span>(</span>
<span id="cb323-57"><a href="#cb323-57"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-58"><a href="#cb323-58"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-59"><a href="#cb323-59"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-60"><a href="#cb323-60"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-61"><a href="#cb323-61"></a>accuracyStats<span class="sc">$</span>percentAccuracyByChance <span class="ot">&lt;-</span> <span class="fu">percentAccuracyByChance</span>(</span>
<span id="cb323-62"><a href="#cb323-62"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-63"><a href="#cb323-63"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-64"><a href="#cb323-64"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-65"><a href="#cb323-65"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-66"><a href="#cb323-66"></a>accuracyStats<span class="sc">$</span>relativeImprovementOverChance <span class="ot">&lt;-</span> <span class="fu">relativeImprovementOverChance</span>(</span>
<span id="cb323-67"><a href="#cb323-67"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-68"><a href="#cb323-68"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-69"><a href="#cb323-69"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-70"><a href="#cb323-70"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-71"><a href="#cb323-71"></a>accuracyStats<span class="sc">$</span>relativeImprovementOverPredictingFromBaseRate <span class="ot">&lt;-</span> </span>
<span id="cb323-72"><a href="#cb323-72"></a>  <span class="fu">relativeImprovementOverPredictingFromBaseRate</span>(</span>
<span id="cb323-73"><a href="#cb323-73"></a>    <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-74"><a href="#cb323-74"></a>    <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-75"><a href="#cb323-75"></a>    <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-76"><a href="#cb323-76"></a>    <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-77"><a href="#cb323-77"></a></span>
<span id="cb323-78"><a href="#cb323-78"></a>accuracyStats<span class="sc">$</span>sensitivity <span class="ot">&lt;-</span> accuracyStats<span class="sc">$</span>TPrate <span class="ot">&lt;-</span> <span class="fu">sensitivity</span>(</span>
<span id="cb323-79"><a href="#cb323-79"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-80"><a href="#cb323-80"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-81"><a href="#cb323-81"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-82"><a href="#cb323-82"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-83"><a href="#cb323-83"></a>accuracyStats<span class="sc">$</span>specificity <span class="ot">&lt;-</span> accuracyStats<span class="sc">$</span>TNrate <span class="ot">&lt;-</span> <span class="fu">specificity</span>(</span>
<span id="cb323-84"><a href="#cb323-84"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-85"><a href="#cb323-85"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-86"><a href="#cb323-86"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-87"><a href="#cb323-87"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-88"><a href="#cb323-88"></a>accuracyStats<span class="sc">$</span>FNrate <span class="ot">&lt;-</span> <span class="fu">falseNegativeRate</span>(</span>
<span id="cb323-89"><a href="#cb323-89"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-90"><a href="#cb323-90"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-91"><a href="#cb323-91"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-92"><a href="#cb323-92"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-93"><a href="#cb323-93"></a>accuracyStats<span class="sc">$</span>FPrate <span class="ot">&lt;-</span> <span class="fu">falsePositiveRate</span>(</span>
<span id="cb323-94"><a href="#cb323-94"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-95"><a href="#cb323-95"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-96"><a href="#cb323-96"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-97"><a href="#cb323-97"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-98"><a href="#cb323-98"></a></span>
<span id="cb323-99"><a href="#cb323-99"></a>accuracyStats<span class="sc">$</span>youdenJ <span class="ot">&lt;-</span> <span class="fu">youdenJ</span>(</span>
<span id="cb323-100"><a href="#cb323-100"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-101"><a href="#cb323-101"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-102"><a href="#cb323-102"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-103"><a href="#cb323-103"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-104"><a href="#cb323-104"></a></span>
<span id="cb323-105"><a href="#cb323-105"></a>accuracyStats<span class="sc">$</span>positivePredictiveValue <span class="ot">&lt;-</span> <span class="fu">positivePredictiveValue</span>(</span>
<span id="cb323-106"><a href="#cb323-106"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-107"><a href="#cb323-107"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-108"><a href="#cb323-108"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-109"><a href="#cb323-109"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-110"><a href="#cb323-110"></a>accuracyStats<span class="sc">$</span>negativePredictiveValue <span class="ot">&lt;-</span> <span class="fu">negativePredictiveValue</span>(</span>
<span id="cb323-111"><a href="#cb323-111"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-112"><a href="#cb323-112"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-113"><a href="#cb323-113"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-114"><a href="#cb323-114"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-115"><a href="#cb323-115"></a>accuracyStats<span class="sc">$</span>falseDiscoveryRate <span class="ot">&lt;-</span> <span class="fu">falseDiscoveryRate</span>(</span>
<span id="cb323-116"><a href="#cb323-116"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-117"><a href="#cb323-117"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-118"><a href="#cb323-118"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-119"><a href="#cb323-119"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-120"><a href="#cb323-120"></a>accuracyStats<span class="sc">$</span>falseOmissionRate <span class="ot">&lt;-</span> <span class="fu">falseOmissionRate</span>(</span>
<span id="cb323-121"><a href="#cb323-121"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-122"><a href="#cb323-122"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-123"><a href="#cb323-123"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-124"><a href="#cb323-124"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-125"><a href="#cb323-125"></a></span>
<span id="cb323-126"><a href="#cb323-126"></a>accuracyStats<span class="sc">$</span>balancedAccuracy <span class="ot">&lt;-</span> <span class="fu">balancedAccuracy</span>(</span>
<span id="cb323-127"><a href="#cb323-127"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-128"><a href="#cb323-128"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-129"><a href="#cb323-129"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-130"><a href="#cb323-130"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-131"><a href="#cb323-131"></a>accuracyStats<span class="sc">$</span>f1Score <span class="ot">&lt;-</span> <span class="fu">fScore</span>(</span>
<span id="cb323-132"><a href="#cb323-132"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-133"><a href="#cb323-133"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-134"><a href="#cb323-134"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-135"><a href="#cb323-135"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-136"><a href="#cb323-136"></a>accuracyStats<span class="sc">$</span>mcc <span class="ot">&lt;-</span> <span class="fu">mcc</span>(</span>
<span id="cb323-137"><a href="#cb323-137"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-138"><a href="#cb323-138"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-139"><a href="#cb323-139"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-140"><a href="#cb323-140"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-141"><a href="#cb323-141"></a></span>
<span id="cb323-142"><a href="#cb323-142"></a>accuracyStats<span class="sc">$</span>diagnosticOddsRatio <span class="ot">&lt;-</span> <span class="fu">diagnosticOddsRatio</span>(</span>
<span id="cb323-143"><a href="#cb323-143"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-144"><a href="#cb323-144"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-145"><a href="#cb323-145"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-146"><a href="#cb323-146"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-147"><a href="#cb323-147"></a>accuracyStats<span class="sc">$</span>positiveLikelihoodRatio <span class="ot">&lt;-</span> <span class="fu">positiveLikelihoodRatio</span>(</span>
<span id="cb323-148"><a href="#cb323-148"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-149"><a href="#cb323-149"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-150"><a href="#cb323-150"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-151"><a href="#cb323-151"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-152"><a href="#cb323-152"></a>accuracyStats<span class="sc">$</span>negativeLikelihoodRatio <span class="ot">&lt;-</span> <span class="fu">negativeLikelihoodRatio</span>(</span>
<span id="cb323-153"><a href="#cb323-153"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-154"><a href="#cb323-154"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-155"><a href="#cb323-155"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-156"><a href="#cb323-156"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-157"><a href="#cb323-157"></a></span>
<span id="cb323-158"><a href="#cb323-158"></a>accuracyStats<span class="sc">$</span>dPrimeSDT <span class="ot">&lt;-</span> <span class="fu">dPrimeSDT</span>(</span>
<span id="cb323-159"><a href="#cb323-159"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-160"><a href="#cb323-160"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-161"><a href="#cb323-161"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-162"><a href="#cb323-162"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-163"><a href="#cb323-163"></a>accuracyStats<span class="sc">$</span>betaSDT <span class="ot">&lt;-</span> <span class="fu">betaSDT</span>(</span>
<span id="cb323-164"><a href="#cb323-164"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-165"><a href="#cb323-165"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-166"><a href="#cb323-166"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-167"><a href="#cb323-167"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-168"><a href="#cb323-168"></a>accuracyStats<span class="sc">$</span>cSDT <span class="ot">&lt;-</span> <span class="fu">cSDT</span>(</span>
<span id="cb323-169"><a href="#cb323-169"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-170"><a href="#cb323-170"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-171"><a href="#cb323-171"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-172"><a href="#cb323-172"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-173"><a href="#cb323-173"></a>accuracyStats<span class="sc">$</span>ASDT <span class="ot">&lt;-</span> <span class="fu">aSDT</span>(</span>
<span id="cb323-174"><a href="#cb323-174"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-175"><a href="#cb323-175"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-176"><a href="#cb323-176"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-177"><a href="#cb323-177"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-178"><a href="#cb323-178"></a>accuracyStats<span class="sc">$</span>bSDT <span class="ot">&lt;-</span> <span class="fu">bSDT</span>(</span>
<span id="cb323-179"><a href="#cb323-179"></a>  <span class="at">TP =</span> accuracyStats<span class="sc">$</span>TP,</span>
<span id="cb323-180"><a href="#cb323-180"></a>  <span class="at">TN =</span> accuracyStats<span class="sc">$</span>TN,</span>
<span id="cb323-181"><a href="#cb323-181"></a>  <span class="at">FP =</span> accuracyStats<span class="sc">$</span>FP,</span>
<span id="cb323-182"><a href="#cb323-182"></a>  <span class="at">FN =</span> accuracyStats<span class="sc">$</span>FN)</span>
<span id="cb323-183"><a href="#cb323-183"></a></span>
<span id="cb323-184"><a href="#cb323-184"></a>accuracyStats<span class="sc">$</span>overallUtility <span class="ot">&lt;-</span> <span class="fu">Uoverall</span>(</span>
<span id="cb323-185"><a href="#cb323-185"></a>  <span class="at">BR =</span> accuracyStats<span class="sc">$</span>baseRate,</span>
<span id="cb323-186"><a href="#cb323-186"></a>  <span class="at">HR =</span> accuracyStats<span class="sc">$</span>TPrate,</span>
<span id="cb323-187"><a href="#cb323-187"></a>  <span class="at">FAR =</span> accuracyStats<span class="sc">$</span>FPrate,</span>
<span id="cb323-188"><a href="#cb323-188"></a>  <span class="at">UH =</span> utilityHits,</span>
<span id="cb323-189"><a href="#cb323-189"></a>  <span class="at">UM =</span> utilityMisses,</span>
<span id="cb323-190"><a href="#cb323-190"></a>  <span class="at">UCR =</span> utilityCorrectRejections,</span>
<span id="cb323-191"><a href="#cb323-191"></a>  <span class="at">UFA =</span> utilityFalseAlarms)</span>
<span id="cb323-192"><a href="#cb323-192"></a>accuracyStats<span class="sc">$</span>utilityRatio <span class="ot">&lt;-</span> <span class="fu">utilityRatio</span>(</span>
<span id="cb323-193"><a href="#cb323-193"></a>  <span class="at">UH =</span> utilityHits,</span>
<span id="cb323-194"><a href="#cb323-194"></a>  <span class="at">UM =</span> utilityMisses,</span>
<span id="cb323-195"><a href="#cb323-195"></a>  <span class="at">UCR =</span> utilityCorrectRejections,</span>
<span id="cb323-196"><a href="#cb323-196"></a>  <span class="at">UFA =</span> utilityFalseAlarms)</span>
<span id="cb323-197"><a href="#cb323-197"></a>accuracyStats<span class="sc">$</span>informationGain <span class="ot">&lt;-</span> <span class="fu">Igain</span>(</span>
<span id="cb323-198"><a href="#cb323-198"></a>  <span class="at">BR =</span> accuracyStats<span class="sc">$</span>baseRate,</span>
<span id="cb323-199"><a href="#cb323-199"></a>  <span class="at">HR =</span> accuracyStats<span class="sc">$</span>TPrate,</span>
<span id="cb323-200"><a href="#cb323-200"></a>  <span class="at">FAR =</span> accuracyStats<span class="sc">$</span>FPrate)</span>
<span id="cb323-201"><a href="#cb323-201"></a></span>
<span id="cb323-202"><a href="#cb323-202"></a><span class="co">#Replace NaN and INF values with NA</span></span>
<span id="cb323-203"><a href="#cb323-203"></a>is.nan.data.frame <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb323-204"><a href="#cb323-204"></a>  <span class="fu">do.call</span>(cbind, <span class="fu">lapply</span>(x, is.nan))</span>
<span id="cb323-205"><a href="#cb323-205"></a></span>
<span id="cb323-206"><a href="#cb323-206"></a>accuracyStats[<span class="fu">is.nan.data.frame</span>(accuracyStats)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb323-207"><a href="#cb323-207"></a>accuracyStats <span class="ot">&lt;-</span> <span class="fu">do.call</span>(</span>
<span id="cb323-208"><a href="#cb323-208"></a>  data.frame,</span>
<span id="cb323-209"><a href="#cb323-209"></a>  <span class="fu">lapply</span>(</span>
<span id="cb323-210"><a href="#cb323-210"></a>    accuracyStats,</span>
<span id="cb323-211"><a href="#cb323-211"></a>    <span class="cf">function</span>(x) <span class="fu">replace</span>(x, <span class="fu">is.infinite</span>(x), <span class="cn">NA</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-allAccuracyStatistics" class="level3" data-number="9.7.3"><h3 data-number="9.7.3" class="anchored" data-anchor-id="sec-allAccuracyStatistics">
<span class="header-section-number">9.7.3</span> All Accuracy Statistics</h3>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains an R function that estimates the prediction accuracy at every possible cutoff.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb324"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1"></a><span class="fu">accuracyAtEachCutoff</span>(</span>
<span id="cb324-2"><a href="#cb324-2"></a>  <span class="at">predicted =</span> mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb324-3"><a href="#cb324-3"></a>  <span class="at">actual =</span> mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb324-4"><a href="#cb324-4"></a>  <span class="at">UH =</span> utilityHits,</span>
<span id="cb324-5"><a href="#cb324-5"></a>  <span class="at">UM =</span> utilityMisses,</span>
<span id="cb324-6"><a href="#cb324-6"></a>  <span class="at">UCR =</span> utilityCorrectRejections,</span>
<span id="cb324-7"><a href="#cb324-7"></a>  <span class="at">UFA =</span> utilityFalseAlarms)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["cutoff"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["TP"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["TN"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["FP"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["FN"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["SR"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["BR"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["percentAccuracy"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["percentAccuracyByChance"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["percentAccuracyPredictingFromBaseRate"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["RIOC"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["relativeImprovementOverPredictingFromBaseRate"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["SN"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["SP"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["TPrate"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["TNrate"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["FNrate"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["FPrate"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["HR"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["FAR"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["PPV"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["NPV"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["FDR"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["FOR"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["youdenJ"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["balancedAccuracy"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["f1Score"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["mcc"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["diagnosticOddsRatio"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["positiveLikelihoodRatio"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["negativeLikelihoodRatio"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["dPrimeSDT"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["betaSDT"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["cSDT"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["aSDT"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["bSDT"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["informationGain"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["overallUtility"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["differenceBetweenPredictedAndObserved"],"name":[39],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.03","2":"40","3":"0","4":"70","5":"0","6":"1.000000000","7":"0.3636364","8":"36.36364","9":"36.36364","10":"63.63636","11":"NA","12":"-0.3750","13":"1.000","14":"0.00000000","15":"1.000","16":"0.00000000","17":"0.000","18":"1.00000000","19":"1.000","20":"1.00000000","21":"0.3636364","22":"NA","23":"0.6363636","24":"NA","25":"0.00000000","26":"0.5000000","27":"0.53333333","28":"NA","29":"NA","30":"1.000000","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"0.5227273","39":"-0.15315789"},{"1":"0.04","2":"39","3":"0","4":"70","5":"1","6":"0.990909091","7":"0.3636364","8":"35.45455","9":"36.61157","10":"63.63636","11":"-1.75000000","12":"-0.3875","13":"0.975","14":"0.00000000","15":"0.975","16":"0.00000000","17":"0.025","18":"1.00000000","19":"0.975","20":"1.00000000","21":"0.3577982","22":"0.0000000","23":"0.6422018","24":"1.0000000","25":"-0.02500000","26":"0.4875000","27":"0.52348993","28":"-0.12670851","29":"0.000000","30":"0.975000","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"0.5136364","39":"-0.15315789"},{"1":"0.05","2":"39","3":"4","4":"66","5":"1","6":"0.954545455","7":"0.3636364","8":"39.09091","9":"37.60331","10":"63.63636","11":"0.45000000","12":"-0.3375","13":"0.975","14":"0.05714286","15":"0.975","16":"0.05714286","17":"0.025","18":"0.94285714","19":"0.975","20":"0.94285714","21":"0.3714286","22":"0.8000000","23":"0.6285714","24":"0.2000000","25":"0.03214286","26":"0.5160714","27":"0.53793103","28":"0.07423075","29":"2.363636","30":"1.034091","31":"0.4375000","32":"0.3807445","33":"0.5097870","34":"-1.76959175","35":"0.6486607","36":"0.4679054","37":"0.004344655","38":"0.5318182","39":"-0.15315789"},{"1":"0.06","2":"39","3":"7","4":"63","5":"1","6":"0.927272727","7":"0.3636364","8":"41.81818","9":"38.34711","10":"63.63636","11":"0.65625000","12":"-0.3000","13":"0.975","14":"0.10000000","15":"0.975","16":"0.10000000","17":"0.025","18":"0.90000000","19":"0.975","20":"0.90000000","21":"0.3823529","22":"0.8750000","23":"0.6176471","24":"0.1250000","25":"0.07500000","26":"0.5375000","27":"0.54929577","28":"0.13892973","29":"4.333333","30":"1.083333","31":"0.2500000","32":"0.6784124","33":"0.3330235","34":"-1.62075778","35":"0.7062500","36":"0.3181818","37":"0.016236862","38":"0.5454545","39":"-0.15315789"},{"1":"0.07","2":"39","3":"9","4":"61","5":"1","6":"0.909090909","7":"0.3636364","8":"43.63636","9":"38.84298","10":"63.63636","11":"0.72500000","12":"-0.2750","13":"0.975","14":"0.12857143","15":"0.975","16":"0.12857143","17":"0.025","18":"0.87142857","19":"0.975","20":"0.87142857","21":"0.3900000","22":"0.9000000","23":"0.6100000","24":"0.1000000","25":"0.10357143","26":"0.5517857","27":"0.55714286","28":"0.17330815","29":"5.754098","30":"1.118852","31":"0.1944444","32":"0.8267940","33":"0.2784011","34":"-1.54656701","35":"0.7272817","36":"0.2862166","37":"0.025933843","38":"0.5545455","39":"-0.06285714"},{"1":"0.08","2":"36","3":"15","4":"55","5":"4","6":"0.827272727","7":"0.3636364","8":"46.36364","9":"41.07438","10":"63.63636","11":"0.42105263","12":"-0.2375","13":"0.900","14":"0.21428571","15":"0.900","16":"0.21428571","17":"0.100","18":"0.78571429","19":"0.900","20":"0.78571429","21":"0.3956044","22":"0.7894737","23":"0.6043956","24":"0.2105263","25":"0.11428571","26":"0.5571429","27":"0.54961832","28":"0.14543652","29":"2.454545","30":"1.145455","31":"0.4666667","32":"0.4899130","33":"0.6017932","34":"-1.03659509","35":"0.6619048","36":"0.5607843","37":"0.016346743","38":"0.5545455","39":"-0.16000000"},{"1":"0.09","2":"35","3":"21","4":"49","5":"5","6":"0.763636364","7":"0.3636364","8":"50.90909","9":"42.80992","10":"63.63636","11":"0.47115385","12":"-0.1750","13":"0.875","14":"0.30000000","15":"0.875","16":"0.30000000","17":"0.125","18":"0.70000000","19":"0.875","20":"0.70000000","21":"0.4166667","22":"0.8076923","23":"0.5833333","24":"0.1923077","25":"0.17500000","26":"0.5875000","27":"0.56451613","28":"0.19814848","29":"3.000000","30":"1.250000","31":"0.4166667","32":"0.6259489","33":"0.5920561","34":"-0.83737495","35":"0.6895833","36":"0.5512821","37":"0.030459378","38":"0.5727273","39":"-0.12692308"},{"1":"0.10","2":"33","3":"27","4":"43","5":"7","6":"0.690909091","7":"0.3636364","8":"54.54545","9":"44.79339","10":"63.63636","11":"0.43382353","12":"-0.1250","13":"0.825","14":"0.38571429","15":"0.825","16":"0.38571429","17":"0.175","18":"0.61428571","19":"0.825","20":"0.61428571","21":"0.4342105","22":"0.7941176","23":"0.5657895","24":"0.2058824","25":"0.21071429","26":"0.6053571","27":"0.56896552","28":"0.21934450","29":"2.960133","30":"1.343023","31":"0.4537037","32":"0.6440825","33":"0.6739957","34":"-0.61254803","35":"0.6892526","36":"0.6057656","37":"0.036674939","38":"0.5818182","39":"-0.12692308"},{"1":"0.11","2":"31","3":"33","4":"37","5":"9","6":"0.618181818","7":"0.3636364","8":"58.18182","9":"46.77686","10":"63.63636","11":"0.41071429","12":"-0.0750","13":"0.775","14":"0.47142857","15":"0.775","16":"0.47142857","17":"0.225","18":"0.52857143","19":"0.775","20":"0.52857143","21":"0.4558824","22":"0.7857143","23":"0.5441176","24":"0.2142857","25":"0.24642857","26":"0.6232143","27":"0.57407407","28":"0.24400064","29":"3.072072","30":"1.466216","31":"0.4772727","32":"0.6837357","33":"0.7537029","34":"-0.41354716","35":"0.6922890","36":"0.6447485","37":"0.044745633","38":"0.5909091","39":"-0.16600000"},{"1":"0.12","2":"30","3":"37","4":"33","5":"10","6":"0.572727273","7":"0.3636364","8":"60.90909","9":"48.01653","10":"63.63636","11":"0.41489362","12":"-0.0375","13":"0.750","14":"0.52857143","15":"0.750","16":"0.52857143","17":"0.250","18":"0.47142857","19":"0.750","20":"0.47142857","21":"0.4761905","22":"0.7872340","23":"0.5238095","24":"0.2127660","25":"0.27857143","26":"0.6392857","27":"0.58252427","28":"0.27089213","29":"3.363636","30":"1.590909","31":"0.4729730","32":"0.7461690","33":"0.7985967","34":"-0.30140523","35":"0.7017857","36":"0.6930693","37":"0.054810014","38":"0.6000000","39":"-0.16600000"},{"1":"0.13","2":"29","3":"37","4":"33","5":"11","6":"0.563636364","7":"0.3636364","8":"60.00000","9":"48.26446","10":"63.63636","11":"0.36979167","12":"-0.0500","13":"0.725","14":"0.52857143","15":"0.725","16":"0.52857143","17":"0.275","18":"0.47142857","19":"0.725","20":"0.47142857","21":"0.4677419","22":"0.7708333","23":"0.5322581","24":"0.2291667","25":"0.25357143","26":"0.6267857","27":"0.56862745","28":"0.24595909","29":"2.955923","30":"1.537879","31":"0.5202703","32":"0.6694394","33":"0.8385428","34":"-0.26304042","35":"0.6837500","36":"0.7277228","37":"0.044856721","38":"0.5909091","39":"-0.16600000"},{"1":"0.14","2":"28","3":"40","4":"30","5":"12","6":"0.527272727","7":"0.3636364","8":"61.81818","9":"49.25620","10":"63.63636","11":"0.36538462","12":"-0.0250","13":"0.700","14":"0.57142857","15":"0.700","16":"0.57142857","17":"0.300","18":"0.42857143","19":"0.700","20":"0.42857143","21":"0.4827586","22":"0.7692308","23":"0.5172414","24":"0.2307692","25":"0.27142857","26":"0.6357143","27":"0.57142857","28":"0.26152843","29":"3.111111","30":"1.633333","31":"0.5250000","32":"0.7044129","33":"0.8857720","34":"-0.17219407","35":"0.6892857","36":"0.8105263","37":"0.050419999","38":"0.5954545","39":"0.05800000"},{"1":"0.15","2":"27","3":"44","4":"26","5":"13","6":"0.481818182","7":"0.3636364","8":"64.54545","9":"50.49587","10":"63.63636","11":"0.37280702","12":"0.0125","13":"0.675","14":"0.62857143","15":"0.675","16":"0.62857143","17":"0.325","18":"0.37142857","19":"0.675","20":"0.37142857","21":"0.5094340","22":"0.7719298","23":"0.4905660","24":"0.2280702","25":"0.30357143","26":"0.6517857","27":"0.58064516","28":"0.29225675","29":"3.514793","30":"1.817308","31":"0.5170455","32":"0.7818343","33":"0.9520532","34":"-0.06284504","35":"0.7051786","36":"0.9252874","37":"0.062565649","38":"0.6045455","39":"0.05800000"},{"1":"0.16","2":"27","3":"48","4":"22","5":"13","6":"0.445454545","7":"0.3636364","8":"68.18182","9":"51.48760","10":"63.63636","11":"0.41393443","12":"0.0625","13":"0.675","14":"0.68571429","15":"0.675","16":"0.68571429","17":"0.325","18":"0.31428571","19":"0.675","20":"0.31428571","21":"0.5510204","22":"0.7868852","23":"0.4489796","24":"0.2131148","25":"0.36071429","26":"0.6803571","27":"0.60674157","28":"0.34912376","29":"4.531469","30":"2.147727","31":"0.4739583","32":"0.9375007","33":"1.0141506","34":"0.01498818","35":"0.7380357","36":"1.0189873","37":"0.089093164","38":"0.6227273","39":"0.05800000"},{"1":"0.17","2":"26","3":"51","4":"19","5":"14","6":"0.409090909","7":"0.3636364","8":"70.00000","9":"52.47934","10":"63.63636","11":"0.40769231","12":"0.0875","13":"0.650","14":"0.72857143","15":"0.650","16":"0.72857143","17":"0.350","18":"0.27142857","19":"0.650","20":"0.27142857","21":"0.5777778","22":"0.7846154","23":"0.4222222","24":"0.2153846","25":"0.37857143","26":"0.6892857","27":"0.61176471","28":"0.37039398","29":"4.984962","30":"2.394737","31":"0.4803922","32":"0.9938186","33":"1.1172821","34":"0.11158883","35":"0.7496429","36":"1.1506849","37":"0.099582301","38":"0.6272727","39":"-0.26900000"},{"1":"0.18","2":"26","3":"53","4":"17","5":"14","6":"0.390909091","7":"0.3636364","8":"71.81818","9":"52.97521","10":"63.63636","11":"0.42537313","12":"0.1125","13":"0.650","14":"0.75714286","15":"0.650","16":"0.75714286","17":"0.350","18":"0.24285714","19":"0.650","20":"0.24285714","21":"0.6046512","22":"0.7910448","23":"0.3953488","24":"0.2089552","25":"0.40714286","26":"0.7035714","27":"0.62650602","28":"0.40137859","29":"5.789916","30":"2.676471","31":"0.4622642","32":"1.0824619","33":"1.1838445","34":"0.15591048","35":"0.7667857","36":"1.2173913","37":"0.116784793","38":"0.6363636","39":"-0.26900000"},{"1":"0.19","2":"26","3":"54","4":"16","5":"14","6":"0.381818182","7":"0.3636364","8":"72.72727","9":"53.22314","10":"63.63636","11":"0.43382353","12":"0.1250","13":"0.650","14":"0.77142857","15":"0.650","16":"0.77142857","17":"0.350","18":"0.22857143","19":"0.650","20":"0.22857143","21":"0.6190476","22":"0.7941176","23":"0.3809524","24":"0.2058824","25":"0.42142857","26":"0.7107143","27":"0.63414634","28":"0.41727646","29":"6.267857","30":"2.843750","31":"0.4537037","32":"1.1288802","33":"1.2240985","34":"0.17911965","35":"0.7753571","36":"1.2537313","37":"0.126146866","38":"0.6409091","39":"-0.26900000"},{"1":"0.22","2":"26","3":"56","4":"14","5":"14","6":"0.363636364","7":"0.3636364","8":"74.54545","9":"53.71901","10":"63.63636","11":"0.45000000","12":"0.1500","13":"0.650","14":"0.80000000","15":"0.650","16":"0.80000000","17":"0.350","18":"0.20000000","19":"0.650","20":"0.20000000","21":"0.6500000","22":"0.8000000","23":"0.3500000","24":"0.2000000","25":"0.45000000","26":"0.7250000","27":"0.65000000","28":"0.45000000","29":"7.428571","30":"3.250000","31":"0.4375000","32":"1.2269417","33":"1.3230335","34":"0.22815038","35":"0.7925000","36":"1.3333333","37":"0.146590406","38":"0.6500000","39":"-0.26900000"},{"1":"0.23","2":"25","3":"56","4":"14","5":"15","6":"0.354545455","7":"0.3636364","8":"73.63636","9":"53.96694","10":"63.63636","11":"0.41901408","12":"0.1375","13":"0.625","14":"0.80000000","15":"0.625","16":"0.80000000","17":"0.375","18":"0.20000000","19":"0.625","20":"0.20000000","21":"0.6410256","22":"0.7887324","23":"0.3589744","24":"0.2112676","25":"0.42500000","26":"0.7125000","27":"0.63291139","28":"0.42737240","29":"6.666667","30":"3.125000","31":"0.4687500","32":"1.1602606","33":"1.3544529","34":"0.26149093","35":"0.7812500","36":"1.3888889","37":"0.131586452","38":"0.6409091","39":"-0.26900000"},{"1":"0.24","2":"24","3":"56","4":"14","5":"16","6":"0.345454545","7":"0.3636364","8":"72.72727","9":"54.21488","10":"63.63636","11":"0.38888889","12":"0.1250","13":"0.600","14":"0.80000000","15":"0.600","16":"0.80000000","17":"0.400","18":"0.20000000","19":"0.600","20":"0.20000000","21":"0.6315789","22":"0.7777778","23":"0.3684211","24":"0.2222222","25":"0.40000000","26":"0.7000000","27":"0.61538462","28":"0.40465132","29":"6.000000","30":"3.000000","31":"0.5000000","32":"1.0949683","33":"1.3799824","34":"0.29413707","35":"0.7700000","36":"1.4444444","37":"0.117461204","38":"0.6318182","39":"-0.26900000"},{"1":"0.25","2":"24","3":"57","4":"13","5":"16","6":"0.336363636","7":"0.3636364","8":"73.63636","9":"54.46281","10":"63.63636","11":"0.39726027","12":"0.1375","13":"0.600","14":"0.81428571","15":"0.600","16":"0.81428571","17":"0.400","18":"0.18571429","19":"0.600","20":"0.18571429","21":"0.6486486","22":"0.7808219","23":"0.3513514","24":"0.2191781","25":"0.41428571","26":"0.7071429","27":"0.62337662","28":"0.42180982","29":"6.576923","30":"3.230769","31":"0.4912281","32":"1.1471477","33":"1.4438995","34":"0.32022676","35":"0.7792857","36":"1.4918033","37":"0.127592849","38":"0.6363636","39":"-0.26900000"},{"1":"0.26","2":"23","3":"57","4":"13","5":"17","6":"0.327272727","7":"0.3636364","8":"72.72727","9":"54.71074","10":"63.63636","11":"0.36824324","12":"0.1250","13":"0.575","14":"0.81428571","15":"0.575","16":"0.81428571","17":"0.425","18":"0.18571429","19":"0.575","20":"0.18571429","21":"0.6388889","22":"0.7702703","23":"0.3611111","24":"0.2297297","25":"0.38928571","26":"0.6946429","27":"0.60526316","28":"0.39909875","29":"5.932127","30":"3.096154","31":"0.5219298","32":"1.0829191","33":"1.4645630","34":"0.35234110","35":"0.7683929","36":"1.5491803","37":"0.113772953","38":"0.6272727","39":"-0.26900000"},{"1":"0.27","2":"22","3":"57","4":"13","5":"18","6":"0.318181818","7":"0.3636364","8":"71.81818","9":"54.95868","10":"63.63636","11":"0.34000000","12":"0.1125","13":"0.550","14":"0.81428571","15":"0.550","16":"0.81428571","17":"0.450","18":"0.18571429","19":"0.550","20":"0.18571429","21":"0.6285714","22":"0.7600000","23":"0.3714286","24":"0.2400000","25":"0.36428571","26":"0.6821429","27":"0.58666667","28":"0.37623267","29":"5.358974","30":"2.961538","31":"0.5526316","32":"1.0194620","33":"1.4792636","34":"0.38406964","35":"0.7575000","36":"1.6065574","37":"0.100753808","38":"0.6181818","39":"-0.26900000"},{"1":"0.28","2":"21","3":"57","4":"13","5":"19","6":"0.309090909","7":"0.3636364","8":"70.90909","9":"55.20661","10":"63.63636","11":"0.31250000","12":"0.1000","13":"0.525","14":"0.81428571","15":"0.525","16":"0.81428571","17":"0.475","18":"0.18571429","19":"0.525","20":"0.18571429","21":"0.6176471","22":"0.7500000","23":"0.3823529","24":"0.2500000","25":"0.33928571","26":"0.6696429","27":"0.56756757","28":"0.35318182","29":"4.846154","30":"2.826923","31":"0.5833333","32":"0.9565074","33":"1.4880607","34":"0.41554693","35":"0.7466071","36":"1.6639344","37":"0.088510379","38":"0.6090909","39":"-0.26900000"},{"1":"0.30","2":"21","3":"58","4":"12","5":"19","6":"0.300000000","7":"0.3636364","8":"71.81818","9":"55.45455","10":"63.63636","11":"0.32142857","12":"0.1125","13":"0.525","14":"0.82857143","15":"0.525","16":"0.82857143","17":"0.475","18":"0.17142857","19":"0.525","20":"0.17142857","21":"0.6363636","22":"0.7532468","23":"0.3636364","24":"0.2467532","25":"0.35357143","26":"0.6767857","27":"0.57534247","28":"0.37115374","29":"5.342105","30":"3.062500","31":"0.5732759","32":"1.0112418","33":"1.5650117","34":"0.44291413","35":"0.7569643","36":"1.7203390","37":"0.097698184","38":"0.6136364","39":"-0.21750000"},{"1":"0.32","2":"20","3":"58","4":"12","5":"20","6":"0.290909091","7":"0.3636364","8":"70.90909","9":"55.70248","10":"63.63636","11":"0.29487179","12":"0.1000","13":"0.500","14":"0.82857143","15":"0.500","16":"0.82857143","17":"0.500","18":"0.17142857","19":"0.500","20":"0.17142857","21":"0.6250000","22":"0.7435897","23":"0.3750000","24":"0.2564103","25":"0.32857143","26":"0.6642857","27":"0.55555556","28":"0.34800583","29":"4.833333","30":"2.916667","31":"0.6034483","32":"0.9485350","33":"1.5680916","34":"0.47426752","35":"0.7464286","36":"1.7796610","37":"0.085643927","38":"0.6045455","39":"-0.21750000"},{"1":"0.33","2":"19","3":"59","4":"11","5":"21","6":"0.272727273","7":"0.3636364","8":"70.90909","9":"56.19835","10":"63.63636","11":"0.27812500","12":"0.1000","13":"0.475","14":"0.84285714","15":"0.475","16":"0.84285714","17":"0.525","18":"0.15714286","19":"0.475","20":"0.15714286","21":"0.6333333","22":"0.7375000","23":"0.3666667","24":"0.2625000","25":"0.31785714","26":"0.6589286","27":"0.54285714","28":"0.34332495","29":"4.852814","30":"3.022727","31":"0.6228814","32":"0.9435632","33":"1.6558651","34":"0.53448838","35":"0.7467575","36":"1.8304175","37":"0.083096767","38":"0.6000000","39":"-0.21750000"},{"1":"0.34","2":"18","3":"60","4":"10","5":"22","6":"0.254545455","7":"0.3636364","8":"70.90909","9":"56.69421","10":"63.63636","11":"0.26219512","12":"0.1000","13":"0.450","14":"0.85714286","15":"0.450","16":"0.85714286","17":"0.550","18":"0.14285714","19":"0.450","20":"0.14285714","21":"0.6428571","22":"0.7317073","23":"0.3571429","24":"0.2682927","25":"0.30714286","26":"0.6535714","27":"0.52941176","28":"0.33918254","29":"4.909091","30":"3.150000","31":"0.6416667","32":"0.9419092","33":"1.7541037","34":"0.59661594","35":"0.7474206","36":"1.8893485","37":"0.080875397","38":"0.5954545","39":"-0.21750000"},{"1":"0.35","2":"18","3":"61","4":"9","5":"22","6":"0.245454545","7":"0.3636364","8":"71.81818","9":"56.94215","10":"63.63636","11":"0.27108434","12":"0.1125","13":"0.450","14":"0.87142857","15":"0.450","16":"0.87142857","17":"0.550","18":"0.12857143","19":"0.450","20":"0.12857143","21":"0.6666667","22":"0.7349398","23":"0.3333333","24":"0.2650602","25":"0.32142857","26":"0.6607143","27":"0.53731343","28":"0.35928788","29":"5.545455","30":"3.500000","31":"0.6311475","32":"1.0075087","33":"1.8854033","34":"0.62941569","35":"0.7589286","36":"1.9708738","37":"0.090753149","38":"0.6000000","39":"-0.21750000"},{"1":"0.38","2":"17","3":"61","4":"9","5":"23","6":"0.236363636","7":"0.3636364","8":"70.90909","9":"57.19008","10":"63.63636","11":"0.24702381","12":"0.1000","13":"0.425","14":"0.87142857","15":"0.425","16":"0.87142857","17":"0.575","18":"0.12857143","19":"0.425","20":"0.12857143","21":"0.6538462","22":"0.7261905","23":"0.3461538","24":"0.2738095","25":"0.29642857","26":"0.6482143","27":"0.51515152","28":"0.33563926","29":"5.009662","30":"3.305556","31":"0.6598361","32":"0.9440516","33":"1.8666666","34":"0.66114423","35":"0.7484769","36":"1.9587063","37":"0.078996666","38":"0.5909091","39":"-0.21750000"},{"1":"0.41","2":"17","3":"62","4":"8","5":"23","6":"0.227272727","7":"0.3636364","8":"71.81818","9":"57.43802","10":"63.63636","11":"0.25588235","12":"0.1125","13":"0.425","14":"0.88571429","15":"0.425","16":"0.88571429","17":"0.575","18":"0.11428571","19":"0.425","20":"0.11428571","21":"0.6800000","22":"0.7294118","23":"0.3200000","24":"0.2705882","25":"0.31071429","26":"0.6553571","27":"0.52307692","28":"0.35666523","29":"5.728261","30":"3.718750","31":"0.6491935","32":"1.0149285","33":"2.0278612","34":"0.69658269","35":"0.7604517","36":"2.0535876","37":"0.089245125","38":"0.5954545","39":"-0.21750000"},{"1":"0.43","2":"16","3":"62","4":"8","5":"24","6":"0.218181818","7":"0.3636364","8":"70.90909","9":"57.68595","10":"63.63636","11":"0.23255814","12":"0.1000","13":"0.400","14":"0.88571429","15":"0.400","16":"0.88571429","17":"0.600","18":"0.11428571","19":"0.400","20":"0.11428571","21":"0.6666667","22":"0.7209302","23":"0.3333333","24":"0.2790698","25":"0.28571429","26":"0.6428571","27":"0.50000000","28":"0.33277916","29":"5.166667","30":"3.500000","31":"0.6774194","32":"0.9506999","33":"1.9992501","34":"0.72869703","35":"0.7500000","36":"2.0416667","37":"0.077491235","38":"0.5863636","39":"-0.21750000"},{"1":"0.44","2":"16","3":"63","4":"7","5":"24","6":"0.209090909","7":"0.3636364","8":"71.81818","9":"57.93388","10":"63.63636","11":"0.24137931","12":"0.1125","13":"0.400","14":"0.90000000","15":"0.400","16":"0.90000000","17":"0.600","18":"0.10000000","19":"0.400","20":"0.10000000","21":"0.6956522","22":"0.7241379","23":"0.3043478","24":"0.2758621","25":"0.30000000","26":"0.6500000","27":"0.50793651","28":"0.35487608","29":"6.000000","30":"4.000000","31":"0.6666667","32":"1.0282045","33":"2.2014029","34":"0.76744933","35":"0.7625000","36":"2.1538462","37":"0.088216764","38":"0.5909091","39":"0.18200000"},{"1":"0.45","2":"14","3":"63","4":"7","5":"26","6":"0.190909091","7":"0.3636364","8":"70.00000","9":"58.42975","10":"63.63636","11":"0.19662921","12":"0.0875","13":"0.350","14":"0.90000000","15":"0.350","16":"0.90000000","17":"0.650","18":"0.10000000","19":"0.350","20":"0.10000000","21":"0.6666667","22":"0.7078652","23":"0.3333333","24":"0.2921348","25":"0.25000000","26":"0.6250000","27":"0.45901639","28":"0.30599503","29":"4.846154","30":"3.500000","31":"0.7222222","32":"0.8962311","33":"2.1105557","34":"0.83343602","35":"0.7410714","36":"2.1235955","37":"0.065256486","38":"0.5727273","39":"0.18200000"},{"1":"0.46","2":"14","3":"64","4":"6","5":"26","6":"0.181818182","7":"0.3636364","8":"70.90909","9":"58.67769","10":"63.63636","11":"0.20555556","12":"0.1000","13":"0.350","14":"0.91428571","15":"0.350","16":"0.91428571","17":"0.650","18":"0.08571429","19":"0.350","20":"0.08571429","21":"0.7000000","22":"0.7111111","23":"0.3000000","24":"0.2888889","25":"0.26428571","26":"0.6321429","27":"0.46666667","28":"0.32962220","29":"5.743590","30":"4.083333","31":"0.7109375","32":"0.9823075","33":"2.3654473","34":"0.87647419","35":"0.7548469","36":"2.2692967","37":"0.075831541","38":"0.5772727","39":"0.18200000"},{"1":"0.47","2":"14","3":"65","4":"5","5":"26","6":"0.172727273","7":"0.3636364","8":"71.81818","9":"58.92562","10":"63.63636","11":"0.21428571","12":"0.1125","13":"0.350","14":"0.92857143","15":"0.350","16":"0.92857143","17":"0.650","18":"0.07142857","19":"0.350","20":"0.07142857","21":"0.7368421","22":"0.7142857","23":"0.2631579","24":"0.2857143","25":"0.27857143","26":"0.6392857","27":"0.47457627","28":"0.35450151","29":"7.000000","30":"4.900000","31":"0.7000000","32":"1.0799133","33":"2.7161600","34":"0.92527713","35":"0.7686224","36":"2.4364641","37":"0.088005894","38":"0.5818182","39":"0.18200000"},{"1":"0.48","2":"14","3":"67","4":"3","5":"26","6":"0.154545455","7":"0.3636364","8":"73.63636","9":"59.42149","10":"63.63636","11":"0.23118280","12":"0.1375","13":"0.350","14":"0.95714286","15":"0.350","16":"0.95714286","17":"0.650","18":"0.04285714","19":"0.350","20":"0.04285714","21":"0.8235294","22":"0.7204301","23":"0.1764706","24":"0.2795699","25":"0.30714286","26":"0.6535714","27":"0.49122807","28":"0.40874599","29":"12.025641","30":"8.166667","31":"0.6791045","32":"1.3331311","33":"4.0645455","34":"1.05188600","35":"0.7961735","36":"2.8574514","37":"0.119011460","38":"0.5909091","39":"0.18200000"},{"1":"0.49","2":"13","3":"68","4":"2","5":"27","6":"0.136363636","7":"0.3636364","8":"73.63636","9":"59.91736","10":"63.63636","11":"0.21842105","12":"0.1375","13":"0.325","14":"0.97142857","15":"0.325","16":"0.97142857","17":"0.675","18":"0.02857143","19":"0.325","20":"0.02857143","21":"0.8666667","22":"0.7157895","23":"0.1333333","24":"0.2842105","25":"0.29642857","26":"0.6482143","27":"0.47272727","28":"0.41551972","29":"16.370370","30":"11.375000","31":"0.6948529","32":"1.4484543","33":"5.5083424","34":"1.17798934","35":"0.8021291","36":"3.2089155","37":"0.124710399","38":"0.5863636","39":"0.18200000"},{"1":"0.50","2":"12","3":"68","4":"2","5":"28","6":"0.127272727","7":"0.3636364","8":"72.72727","9":"60.16529","10":"63.63636","11":"0.19791667","12":"0.1250","13":"0.300","14":"0.97142857","15":"0.300","16":"0.97142857","17":"0.700","18":"0.02857143","19":"0.300","20":"0.02857143","21":"0.8571429","22":"0.7083333","23":"0.1428571","24":"0.2916667","25":"0.27142857","26":"0.6357143","27":"0.44444444","28":"0.39177340","29":"14.571429","30":"10.500000","31":"0.7205882","32":"1.3778160","33":"5.3212905","34":"1.21330850","35":"0.7940476","36":"3.2891566","37":"0.110329323","38":"0.5772727","39":"0.18200000"},{"1":"0.52","2":"12","3":"70","4":"0","5":"28","6":"0.109090909","7":"0.3636364","8":"74.54545","9":"60.66116","10":"63.63636","11":"0.21428571","12":"0.1500","13":"0.300","14":"1.00000000","15":"0.300","16":"1.00000000","17":"0.700","18":"0.00000000","19":"0.300","20":"0.00000000","21":"1.0000000","22":"0.7142857","23":"0.0000000","24":"0.2857143","25":"0.30000000","26":"0.6500000","27":"0.46153846","28":"0.46291005","29":"NA","30":"NA","31":"0.7000000","32":"NA","33":"NA","34":"NA","35":"0.8250000","36":"4.3333333","37":"NA","38":"0.5863636","39":"0.18200000"},{"1":"0.56","2":"11","3":"70","4":"0","5":"29","6":"0.100000000","7":"0.3636364","8":"73.63636","9":"60.90909","10":"63.63636","11":"0.19444444","12":"0.1375","13":"0.275","14":"1.00000000","15":"0.275","16":"1.00000000","17":"0.725","18":"0.00000000","19":"0.275","20":"0.00000000","21":"1.0000000","22":"0.7070707","23":"0.0000000","24":"0.2929293","25":"0.27500000","26":"0.6375000","27":"0.43137255","28":"0.44095855","29":"NA","30":"NA","31":"0.7250000","32":"NA","33":"NA","34":"NA","35":"0.8187500","36":"4.6363636","37":"NA","38":"0.5772727","39":"-0.13818182"},{"1":"0.58","2":"10","3":"70","4":"0","5":"30","6":"0.090909091","7":"0.3636364","8":"72.72727","9":"61.15702","10":"63.63636","11":"0.17500000","12":"0.1250","13":"0.250","14":"1.00000000","15":"0.250","16":"1.00000000","17":"0.750","18":"0.00000000","19":"0.250","20":"0.00000000","21":"1.0000000","22":"0.7000000","23":"0.0000000","24":"0.3000000","25":"0.25000000","26":"0.6250000","27":"0.40000000","28":"0.41833001","29":"NA","30":"NA","31":"0.7500000","32":"NA","33":"NA","34":"NA","35":"0.8125000","36":"5.0000000","37":"NA","38":"0.5681818","39":"-0.13818182"},{"1":"0.70","2":"9","3":"70","4":"0","5":"31","6":"0.081818182","7":"0.3636364","8":"71.81818","9":"61.40496","10":"63.63636","11":"0.15594059","12":"0.1125","13":"0.225","14":"1.00000000","15":"0.225","16":"1.00000000","17":"0.775","18":"0.00000000","19":"0.225","20":"0.00000000","21":"1.0000000","22":"0.6930693","23":"0.0000000","24":"0.3069307","25":"0.22500000","26":"0.6125000","27":"0.36734694","28":"0.39489314","29":"NA","30":"NA","31":"0.7750000","32":"NA","33":"NA","34":"NA","35":"0.8062500","36":"5.4444444","37":"NA","38":"0.5590909","39":"-0.13818182"},{"1":"0.71","2":"8","3":"70","4":"0","5":"32","6":"0.072727273","7":"0.3636364","8":"70.90909","9":"61.65289","10":"63.63636","11":"0.13725490","12":"0.1000","13":"0.200","14":"1.00000000","15":"0.200","16":"1.00000000","17":"0.800","18":"0.00000000","19":"0.200","20":"0.00000000","21":"1.0000000","22":"0.6862745","23":"0.0000000","24":"0.3137255","25":"0.20000000","26":"0.6000000","27":"0.33333333","28":"0.37047929","29":"NA","30":"NA","31":"0.8000000","32":"NA","33":"NA","34":"NA","35":"0.8000000","36":"6.0000000","37":"NA","38":"0.5500000","39":"-0.13818182"},{"1":"0.74","2":"6","3":"70","4":"0","5":"34","6":"0.054545455","7":"0.3636364","8":"69.09091","9":"62.14876","10":"63.63636","11":"0.10096154","12":"0.0750","13":"0.150","14":"1.00000000","15":"0.150","16":"1.00000000","17":"0.850","18":"0.00000000","19":"0.150","20":"0.00000000","21":"1.0000000","22":"0.6730769","23":"0.0000000","24":"0.3269231","25":"0.15000000","26":"0.5750000","27":"0.26086957","28":"0.31774445","29":"NA","30":"NA","31":"0.8500000","32":"NA","33":"NA","34":"NA","35":"0.7875000","36":"7.6666667","37":"NA","38":"0.5318182","39":"-0.13818182"},{"1":"0.77","2":"5","3":"70","4":"0","5":"35","6":"0.045454545","7":"0.3636364","8":"68.18182","9":"62.39669","10":"63.63636","11":"0.08333333","12":"0.0625","13":"0.125","14":"1.00000000","15":"0.125","16":"1.00000000","17":"0.875","18":"0.00000000","19":"0.125","20":"0.00000000","21":"1.0000000","22":"0.6666667","23":"0.0000000","24":"0.3333333","25":"0.12500000","26":"0.5625000","27":"0.22222222","28":"0.28867513","29":"NA","30":"NA","31":"0.8750000","32":"NA","33":"NA","34":"NA","35":"0.7812500","36":"9.0000000","37":"NA","38":"0.5227273","39":"-0.13818182"},{"1":"0.82","2":"4","3":"70","4":"0","5":"36","6":"0.036363636","7":"0.3636364","8":"67.27273","9":"62.64463","10":"63.63636","11":"0.06603774","12":"0.0500","13":"0.100","14":"1.00000000","15":"0.100","16":"1.00000000","17":"0.900","18":"0.00000000","19":"0.100","20":"0.00000000","21":"1.0000000","22":"0.6603774","23":"0.0000000","24":"0.3396226","25":"0.10000000","26":"0.5500000","27":"0.18181818","28":"0.25697808","29":"NA","30":"NA","31":"0.9000000","32":"NA","33":"NA","34":"NA","35":"0.7750000","36":"11.0000000","37":"NA","38":"0.5136364","39":"-0.13818182"},{"1":"0.86","2":"3","3":"70","4":"0","5":"37","6":"0.027272727","7":"0.3636364","8":"66.36364","9":"62.89256","10":"63.63636","11":"0.04906542","12":"0.0375","13":"0.075","14":"1.00000000","15":"0.075","16":"1.00000000","17":"0.925","18":"0.00000000","19":"0.075","20":"0.00000000","21":"1.0000000","22":"0.6542056","23":"0.0000000","24":"0.3457944","25":"0.07500000","26":"0.5375000","27":"0.13953488","28":"0.22150716","29":"NA","30":"NA","31":"0.9250000","32":"NA","33":"NA","34":"NA","35":"0.7687500","36":"14.3333333","37":"NA","38":"0.5045455","39":"-0.13818182"},{"1":"0.96","2":"2","3":"70","4":"0","5":"38","6":"0.018181818","7":"0.3636364","8":"65.45455","9":"63.14050","10":"63.63636","11":"0.03240741","12":"0.0250","13":"0.050","14":"1.00000000","15":"0.050","16":"1.00000000","17":"0.950","18":"0.00000000","19":"0.050","20":"0.00000000","21":"1.0000000","22":"0.6481481","23":"0.0000000","24":"0.3518519","25":"0.05000000","26":"0.5250000","27":"0.09523810","28":"0.18002057","29":"NA","30":"NA","31":"0.9500000","32":"NA","33":"NA","34":"NA","35":"0.7625000","36":"21.0000000","37":"NA","38":"0.4954545","39":"-0.13818182"},{"1":"2.07","2":"1","3":"70","4":"0","5":"39","6":"0.009090909","7":"0.3636364","8":"64.54545","9":"63.38843","10":"63.63636","11":"0.01605505","12":"0.0125","13":"0.025","14":"1.00000000","15":"0.025","16":"1.00000000","17":"0.975","18":"0.00000000","19":"0.025","20":"0.00000000","21":"1.0000000","22":"0.6422018","23":"0.0000000","24":"0.3577982","25":"0.02500000","26":"0.5125000","27":"0.04878049","28":"0.12670851","29":"NA","30":"NA","31":"0.9750000","32":"NA","33":"NA","34":"NA","35":"0.7562500","36":"41.0000000","37":"NA","38":"0.4863636","39":"-0.13818182"},{"1":"2.08","2":"0","3":"70","4":"0","5":"40","6":"0.000000000","7":"0.3636364","8":"63.63636","9":"63.63636","10":"63.63636","11":"0.00000000","12":"0.0000","13":"0.000","14":"1.00000000","15":"0.000","16":"1.00000000","17":"1.000","18":"0.00000000","19":"0.000","20":"0.00000000","21":"NA","22":"0.6363636","23":"NA","24":"0.3636364","25":"0.00000000","26":"0.5000000","27":"NA","28":"NA","29":"NA","30":"NA","31":"1.0000000","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"0.4772727","39":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb325"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1"></a>accuracyStats</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div id="tbl-accuracyStatsHtml" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-accuracyStatsHtml-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.1: Accuracy Statistics.
</figcaption><div aria-describedby="tbl-accuracyStatsHtml-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["cutoff"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["TP"],"name":[2],"type":["int"],"align":["right"]},{"label":["TN"],"name":[3],"type":["int"],"align":["right"]},{"label":["FP"],"name":[4],"type":["int"],"align":["right"]},{"label":["FN"],"name":[5],"type":["int"],"align":["right"]},{"label":["differenceBetweenPredictedAndObserved"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["N"],"name":[7],"type":["int"],"align":["right"]},{"label":["selectionRatio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["baseRate"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["percentAccuracy"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["percentAccuracyByChance"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["relativeImprovementOverChance"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["relativeImprovementOverPredictingFromBaseRate"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["TPrate"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["sensitivity"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["TNrate"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["specificity"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["FNrate"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["FPrate"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["youdenJ"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["positivePredictiveValue"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["negativePredictiveValue"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["falseDiscoveryRate"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["falseOmissionRate"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["balancedAccuracy"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["f1Score"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["mcc"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["diagnosticOddsRatio"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["positiveLikelihoodRatio"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["negativeLikelihoodRatio"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["dPrimeSDT"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["betaSDT"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["cSDT"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["ASDT"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["bSDT"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["overallUtility"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["utilityRatio"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["informationGain"],"name":[38],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.03","2":"40","3":"0","4":"70","5":"0","6":"-0.15315789","7":"110","8":"1.000000000","9":"0.3636364","10":"36.36364","11":"36.36364","12":"NA","13":"-0.3750","14":"1.000","15":"1.000","16":"0.00000000","17":"0.00000000","18":"0.000","19":"1.00000000","20":"0.00000000","21":"0.3636364","22":"NA","23":"0.6363636","24":"NA","25":"0.5000000","26":"0.53333333","27":"NA","28":"NA","29":"1.000000","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"0.5227273","37":"0.5","38":"NA"},{"1":"0.04","2":"39","3":"0","4":"70","5":"1","6":"-0.15315789","7":"110","8":"0.990909091","9":"0.3636364","10":"35.45455","11":"36.61157","12":"-1.75000000","13":"-0.3875","14":"0.975","15":"0.975","16":"0.00000000","17":"0.00000000","18":"0.025","19":"1.00000000","20":"-0.02500000","21":"0.3577982","22":"0.0000000","23":"0.6422018","24":"1.0000000","25":"0.4875000","26":"0.52348993","27":"-0.12670851","28":"0.000000","29":"0.975000","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"0.5136364","37":"0.5","38":"NA"},{"1":"0.05","2":"39","3":"4","4":"66","5":"1","6":"-0.15315789","7":"110","8":"0.954545455","9":"0.3636364","10":"39.09091","11":"37.60331","12":"0.45000000","13":"-0.3375","14":"0.975","15":"0.975","16":"0.05714286","17":"0.05714286","18":"0.025","19":"0.94285714","20":"0.03214286","21":"0.3714286","22":"0.8000000","23":"0.6285714","24":"0.2000000","25":"0.5160714","26":"0.53793103","27":"0.07423075","28":"2.363636","29":"1.034091","30":"0.4375000","31":"0.3807445","32":"0.5097870","33":"-1.76959175","34":"0.6486607","35":"0.4679054","36":"0.5318182","37":"0.5","38":"0.004344655"},{"1":"0.06","2":"39","3":"7","4":"63","5":"1","6":"-0.15315789","7":"110","8":"0.927272727","9":"0.3636364","10":"41.81818","11":"38.34711","12":"0.65625000","13":"-0.3000","14":"0.975","15":"0.975","16":"0.10000000","17":"0.10000000","18":"0.025","19":"0.90000000","20":"0.07500000","21":"0.3823529","22":"0.8750000","23":"0.6176471","24":"0.1250000","25":"0.5375000","26":"0.54929577","27":"0.13892973","28":"4.333333","29":"1.083333","30":"0.2500000","31":"0.6784124","32":"0.3330235","33":"-1.62075778","34":"0.7062500","35":"0.3181818","36":"0.5454545","37":"0.5","38":"0.016236862"},{"1":"0.07","2":"39","3":"9","4":"61","5":"1","6":"-0.06285714","7":"110","8":"0.909090909","9":"0.3636364","10":"43.63636","11":"38.84298","12":"0.72500000","13":"-0.2750","14":"0.975","15":"0.975","16":"0.12857143","17":"0.12857143","18":"0.025","19":"0.87142857","20":"0.10357143","21":"0.3900000","22":"0.9000000","23":"0.6100000","24":"0.1000000","25":"0.5517857","26":"0.55714286","27":"0.17330815","28":"5.754098","29":"1.118852","30":"0.1944444","31":"0.8267940","32":"0.2784011","33":"-1.54656701","34":"0.7272817","35":"0.2862166","36":"0.5545455","37":"0.5","38":"0.025933843"},{"1":"0.08","2":"36","3":"15","4":"55","5":"4","6":"-0.16000000","7":"110","8":"0.827272727","9":"0.3636364","10":"46.36364","11":"41.07438","12":"0.42105263","13":"-0.2375","14":"0.900","15":"0.900","16":"0.21428571","17":"0.21428571","18":"0.100","19":"0.78571429","20":"0.11428571","21":"0.3956044","22":"0.7894737","23":"0.6043956","24":"0.2105263","25":"0.5571429","26":"0.54961832","27":"0.14543652","28":"2.454545","29":"1.145455","30":"0.4666667","31":"0.4899130","32":"0.6017932","33":"-1.03659509","34":"0.6619048","35":"0.5607843","36":"0.5545455","37":"0.5","38":"0.016346743"},{"1":"0.09","2":"35","3":"21","4":"49","5":"5","6":"-0.12692308","7":"110","8":"0.763636364","9":"0.3636364","10":"50.90909","11":"42.80992","12":"0.47115385","13":"-0.1750","14":"0.875","15":"0.875","16":"0.30000000","17":"0.30000000","18":"0.125","19":"0.70000000","20":"0.17500000","21":"0.4166667","22":"0.8076923","23":"0.5833333","24":"0.1923077","25":"0.5875000","26":"0.56451613","27":"0.19814848","28":"3.000000","29":"1.250000","30":"0.4166667","31":"0.6259489","32":"0.5920561","33":"-0.83737495","34":"0.6895833","35":"0.5512821","36":"0.5727273","37":"0.5","38":"0.030459378"},{"1":"0.10","2":"33","3":"27","4":"43","5":"7","6":"-0.12692308","7":"110","8":"0.690909091","9":"0.3636364","10":"54.54545","11":"44.79339","12":"0.43382353","13":"-0.1250","14":"0.825","15":"0.825","16":"0.38571429","17":"0.38571429","18":"0.175","19":"0.61428571","20":"0.21071429","21":"0.4342105","22":"0.7941176","23":"0.5657895","24":"0.2058824","25":"0.6053571","26":"0.56896552","27":"0.21934450","28":"2.960133","29":"1.343023","30":"0.4537037","31":"0.6440825","32":"0.6739957","33":"-0.61254803","34":"0.6892526","35":"0.6057656","36":"0.5818182","37":"0.5","38":"0.036674939"},{"1":"0.11","2":"31","3":"33","4":"37","5":"9","6":"-0.16600000","7":"110","8":"0.618181818","9":"0.3636364","10":"58.18182","11":"46.77686","12":"0.41071429","13":"-0.0750","14":"0.775","15":"0.775","16":"0.47142857","17":"0.47142857","18":"0.225","19":"0.52857143","20":"0.24642857","21":"0.4558824","22":"0.7857143","23":"0.5441176","24":"0.2142857","25":"0.6232143","26":"0.57407407","27":"0.24400064","28":"3.072072","29":"1.466216","30":"0.4772727","31":"0.6837357","32":"0.7537029","33":"-0.41354716","34":"0.6922890","35":"0.6447485","36":"0.5909091","37":"0.5","38":"0.044745633"},{"1":"0.12","2":"30","3":"37","4":"33","5":"10","6":"-0.16600000","7":"110","8":"0.572727273","9":"0.3636364","10":"60.90909","11":"48.01653","12":"0.41489362","13":"-0.0375","14":"0.750","15":"0.750","16":"0.52857143","17":"0.52857143","18":"0.250","19":"0.47142857","20":"0.27857143","21":"0.4761905","22":"0.7872340","23":"0.5238095","24":"0.2127660","25":"0.6392857","26":"0.58252427","27":"0.27089213","28":"3.363636","29":"1.590909","30":"0.4729730","31":"0.7461690","32":"0.7985967","33":"-0.30140523","34":"0.7013996","35":"0.6552160","36":"0.6000000","37":"0.5","38":"0.054810014"},{"1":"0.13","2":"29","3":"37","4":"33","5":"11","6":"-0.16600000","7":"110","8":"0.563636364","9":"0.3636364","10":"60.00000","11":"48.26446","12":"0.36979167","13":"-0.0500","14":"0.725","15":"0.725","16":"0.52857143","17":"0.52857143","18":"0.275","19":"0.47142857","20":"0.25357143","21":"0.4677419","22":"0.7708333","23":"0.5322581","24":"0.2291667","25":"0.6267857","26":"0.56862745","27":"0.24595909","28":"2.955923","29":"1.537879","30":"0.5202703","31":"0.6694394","32":"0.8385428","33":"-0.26304042","34":"0.6833253","35":"0.6861581","36":"0.5909091","37":"0.5","38":"0.044856721"},{"1":"0.14","2":"28","3":"40","4":"30","5":"12","6":"0.05800000","7":"110","8":"0.527272727","9":"0.3636364","10":"61.81818","11":"49.25620","12":"0.36538462","13":"-0.0250","14":"0.700","15":"0.700","16":"0.57142857","17":"0.57142857","18":"0.300","19":"0.42857143","20":"0.27142857","21":"0.4827586","22":"0.7692308","23":"0.5172414","24":"0.2307692","25":"0.6357143","26":"0.57142857","27":"0.26152843","28":"3.111111","29":"1.633333","30":"0.5250000","31":"0.7044129","32":"0.8857720","33":"-0.17219407","34":"0.6866071","35":"0.6977273","36":"0.5954545","37":"0.5","38":"0.050419999"},{"1":"0.15","2":"27","3":"44","4":"26","5":"13","6":"0.05800000","7":"110","8":"0.481818182","9":"0.3636364","10":"64.54545","11":"50.49587","12":"0.37280702","13":"0.0125","14":"0.675","15":"0.675","16":"0.62857143","17":"0.62857143","18":"0.325","19":"0.37142857","20":"0.30357143","21":"0.5094340","22":"0.7719298","23":"0.4905660","24":"0.2280702","25":"0.6517857","26":"0.58064516","27":"0.29225675","28":"3.514793","29":"1.817308","30":"0.5170455","31":"0.7818343","32":"0.9520532","33":"-0.06284504","34":"0.6966315","35":"0.7034490","36":"0.6045455","37":"0.5","38":"0.062565649"},{"1":"0.16","2":"27","3":"48","4":"22","5":"13","6":"0.05800000","7":"110","8":"0.445454545","9":"0.3636364","10":"68.18182","11":"51.48760","12":"0.41393443","13":"0.0625","14":"0.675","15":"0.675","16":"0.68571429","17":"0.68571429","18":"0.325","19":"0.31428571","20":"0.36071429","21":"0.5510204","22":"0.7868852","23":"0.4489796","24":"0.2131148","25":"0.6803571","26":"0.60674157","27":"0.34912376","28":"4.531469","29":"2.147727","30":"0.4739583","31":"0.9375007","32":"1.0141506","33":"0.01498818","34":"0.7216890","35":"0.6879414","36":"0.6227273","37":"0.5","38":"0.089093164"},{"1":"0.17","2":"26","3":"51","4":"19","5":"14","6":"-0.26900000","7":"110","8":"0.409090909","9":"0.3636364","10":"70.00000","11":"52.47934","12":"0.40769231","13":"0.0875","14":"0.650","15":"0.650","16":"0.72857143","17":"0.72857143","18":"0.350","19":"0.27142857","20":"0.37857143","21":"0.5777778","22":"0.7846154","23":"0.4222222","24":"0.2153846","25":"0.6892857","26":"0.61176471","27":"0.37039398","28":"4.984962","29":"2.394737","30":"0.4803922","31":"0.9938186","32":"1.1172821","33":"0.11158883","34":"0.7245448","35":"0.6994004","36":"0.6272727","37":"0.5","38":"0.099582301"},{"1":"0.18","2":"26","3":"53","4":"17","5":"14","6":"-0.26900000","7":"110","8":"0.390909091","9":"0.3636364","10":"71.81818","11":"52.97521","12":"0.42537313","13":"0.1125","14":"0.650","15":"0.650","16":"0.75714286","17":"0.75714286","18":"0.350","19":"0.24285714","20":"0.40714286","21":"0.6046512","22":"0.7910448","23":"0.3953488","24":"0.2089552","25":"0.7035714","26":"0.62650602","27":"0.40137859","28":"5.789916","29":"2.676471","30":"0.4622642","31":"1.0824619","32":"1.1838445","33":"0.15591048","34":"0.7362197","35":"0.6939715","36":"0.6363636","37":"0.5","38":"0.116784793"},{"1":"0.19","2":"26","3":"54","4":"16","5":"14","6":"-0.26900000","7":"110","8":"0.381818182","9":"0.3636364","10":"72.72727","11":"53.22314","12":"0.43382353","13":"0.1250","14":"0.650","15":"0.650","16":"0.77142857","17":"0.77142857","18":"0.350","19":"0.22857143","20":"0.42142857","21":"0.6190476","22":"0.7941176","23":"0.3809524","24":"0.2058824","25":"0.7107143","26":"0.63414634","27":"0.41727646","28":"6.267857","29":"2.843750","30":"0.4537037","31":"1.1288802","32":"1.2240985","33":"0.17911965","34":"0.7419312","35":"0.6916069","36":"0.6409091","37":"0.5","38":"0.126146866"},{"1":"0.22","2":"26","3":"56","4":"14","5":"14","6":"-0.26900000","7":"110","8":"0.363636364","9":"0.3636364","10":"74.54545","11":"53.71901","12":"0.45000000","13":"0.1500","14":"0.650","15":"0.650","16":"0.80000000","17":"0.80000000","18":"0.350","19":"0.20000000","20":"0.45000000","21":"0.6500000","22":"0.8000000","23":"0.3500000","24":"0.2000000","25":"0.7250000","26":"0.65000000","27":"0.45000000","28":"7.428571","29":"3.250000","30":"0.4375000","31":"1.2269417","32":"1.3230335","33":"0.22815038","34":"0.7531250","35":"0.6875000","36":"0.6500000","37":"0.5","38":"0.146590406"},{"1":"0.23","2":"25","3":"56","4":"14","5":"15","6":"-0.26900000","7":"110","8":"0.354545455","9":"0.3636364","10":"73.63636","11":"53.96694","12":"0.41901408","13":"0.1375","14":"0.625","15":"0.625","16":"0.80000000","17":"0.80000000","18":"0.375","19":"0.20000000","20":"0.42500000","21":"0.6410256","22":"0.7887324","23":"0.3589744","24":"0.2112676","25":"0.7125000","26":"0.63291139","27":"0.42737240","28":"6.666667","29":"3.125000","30":"0.4687500","31":"1.1602606","32":"1.3544529","33":"0.26149093","34":"0.7390625","35":"0.7048611","36":"0.6409091","37":"0.5","38":"0.131586452"},{"1":"0.24","2":"24","3":"56","4":"14","5":"16","6":"-0.26900000","7":"110","8":"0.345454545","9":"0.3636364","10":"72.72727","11":"54.21488","12":"0.38888889","13":"0.1250","14":"0.600","15":"0.600","16":"0.80000000","17":"0.80000000","18":"0.400","19":"0.20000000","20":"0.40000000","21":"0.6315789","22":"0.7777778","23":"0.3684211","24":"0.2222222","25":"0.7000000","26":"0.61538462","27":"0.40465132","28":"6.000000","29":"3.000000","30":"0.5000000","31":"1.0949683","32":"1.3799824","33":"0.29413707","34":"0.7250000","35":"0.7222222","36":"0.6318182","37":"0.5","38":"0.117461204"},{"1":"0.25","2":"24","3":"57","4":"13","5":"16","6":"-0.26900000","7":"110","8":"0.336363636","9":"0.3636364","10":"73.63636","11":"54.46281","12":"0.39726027","13":"0.1375","14":"0.600","15":"0.600","16":"0.81428571","17":"0.81428571","18":"0.400","19":"0.18571429","20":"0.41428571","21":"0.6486486","22":"0.7808219","23":"0.3513514","24":"0.2191781","25":"0.7071429","26":"0.62337662","27":"0.42180982","28":"6.576923","29":"3.230769","30":"0.4912281","31":"1.1471477","32":"1.4438995","33":"0.32022676","34":"0.7307644","35":"0.7195745","36":"0.6363636","37":"0.5","38":"0.127592849"},{"1":"0.26","2":"23","3":"57","4":"13","5":"17","6":"-0.26900000","7":"110","8":"0.327272727","9":"0.3636364","10":"72.72727","11":"54.71074","12":"0.36824324","13":"0.1250","14":"0.575","15":"0.575","16":"0.81428571","17":"0.81428571","18":"0.425","19":"0.18571429","20":"0.38928571","21":"0.6388889","22":"0.7702703","23":"0.3611111","24":"0.2297297","25":"0.6946429","26":"0.60526316","27":"0.39909875","28":"5.932127","29":"3.096154","30":"0.5219298","31":"1.0829191","32":"1.4645630","33":"0.35234110","34":"0.7168390","35":"0.7364968","36":"0.6272727","37":"0.5","38":"0.113772953"},{"1":"0.27","2":"22","3":"57","4":"13","5":"18","6":"-0.26900000","7":"110","8":"0.318181818","9":"0.3636364","10":"71.81818","11":"54.95868","12":"0.34000000","13":"0.1125","14":"0.550","15":"0.550","16":"0.81428571","17":"0.81428571","18":"0.450","19":"0.18571429","20":"0.36428571","21":"0.6285714","22":"0.7600000","23":"0.3714286","24":"0.2400000","25":"0.6821429","26":"0.58666667","27":"0.37623267","28":"5.358974","29":"2.961538","30":"0.5526316","31":"1.0194620","32":"1.4792636","33":"0.38406964","34":"0.7029135","35":"0.7534190","36":"0.6181818","37":"0.5","38":"0.100753808"},{"1":"0.28","2":"21","3":"57","4":"13","5":"19","6":"-0.26900000","7":"110","8":"0.309090909","9":"0.3636364","10":"70.90909","11":"55.20661","12":"0.31250000","13":"0.1000","14":"0.525","15":"0.525","16":"0.81428571","17":"0.81428571","18":"0.475","19":"0.18571429","20":"0.33928571","21":"0.6176471","22":"0.7500000","23":"0.3823529","24":"0.2500000","25":"0.6696429","26":"0.56756757","27":"0.35318182","28":"4.846154","29":"2.826923","30":"0.5833333","31":"0.9565074","32":"1.4880607","33":"0.41554693","34":"0.6889881","35":"0.7703412","36":"0.6090909","37":"0.5","38":"0.088510379"},{"1":"0.30","2":"21","3":"58","4":"12","5":"19","6":"-0.21750000","7":"110","8":"0.300000000","9":"0.3636364","10":"71.81818","11":"55.45455","12":"0.32142857","13":"0.1125","14":"0.525","15":"0.525","16":"0.82857143","17":"0.82857143","18":"0.475","19":"0.17142857","20":"0.35357143","21":"0.6363636","22":"0.7532468","23":"0.3636364","24":"0.2467532","25":"0.6767857","26":"0.57534247","27":"0.37115374","28":"5.342105","29":"3.062500","30":"0.5732759","31":"1.0112418","32":"1.5650117","33":"0.44291413","34":"0.6950739","35":"0.7666352","36":"0.6136364","37":"0.5","38":"0.097698184"},{"1":"0.32","2":"20","3":"58","4":"12","5":"20","6":"-0.21750000","7":"110","8":"0.290909091","9":"0.3636364","10":"70.90909","11":"55.70248","12":"0.29487179","13":"0.1000","14":"0.500","15":"0.500","16":"0.82857143","17":"0.82857143","18":"0.500","19":"0.17142857","20":"0.32857143","21":"0.6250000","22":"0.7435897","23":"0.3750000","24":"0.2564103","25":"0.6642857","26":"0.55555556","27":"0.34800583","28":"4.833333","29":"2.916667","30":"0.6034483","31":"0.9485350","32":"1.5680916","33":"0.47426752","34":"0.6812808","35":"0.7831358","36":"0.6045455","37":"0.5","38":"0.085643927"},{"1":"0.33","2":"19","3":"59","4":"11","5":"21","6":"-0.21750000","7":"110","8":"0.272727273","9":"0.3636364","10":"70.90909","11":"56.19835","12":"0.27812500","13":"0.1000","14":"0.475","15":"0.475","16":"0.84285714","17":"0.84285714","18":"0.525","19":"0.15714286","20":"0.31785714","21":"0.6333333","22":"0.7375000","23":"0.3666667","24":"0.2625000","25":"0.6589286","26":"0.54285714","27":"0.34332495","28":"4.852814","29":"3.022727","30":"0.6228814","31":"0.9435632","32":"1.6558651","33":"0.53448838","34":"0.6737439","35":"0.7953620","36":"0.6000000","37":"0.5","38":"0.083096767"},{"1":"0.34","2":"18","3":"60","4":"10","5":"22","6":"-0.21750000","7":"110","8":"0.254545455","9":"0.3636364","10":"70.90909","11":"56.69421","12":"0.26219512","13":"0.1000","14":"0.450","15":"0.450","16":"0.85714286","17":"0.85714286","18":"0.550","19":"0.14285714","20":"0.30714286","21":"0.6428571","22":"0.7317073","23":"0.3571429","24":"0.2682927","25":"0.6535714","26":"0.52941176","27":"0.33918254","28":"4.909091","29":"3.150000","30":"0.6416667","31":"0.9419092","32":"1.7541037","33":"0.59661594","34":"0.6663690","35":"0.8070513","36":"0.5954545","37":"0.5","38":"0.080875397"},{"1":"0.35","2":"18","3":"61","4":"9","5":"22","6":"-0.21750000","7":"110","8":"0.245454545","9":"0.3636364","10":"71.81818","11":"56.94215","12":"0.27108434","13":"0.1125","14":"0.450","15":"0.450","16":"0.87142857","17":"0.87142857","18":"0.550","19":"0.12857143","20":"0.32142857","21":"0.6666667","22":"0.7349398","23":"0.3333333","24":"0.2650602","25":"0.6607143","26":"0.53731343","27":"0.35928788","28":"5.545455","29":"3.500000","30":"0.6311475","31":"1.0075087","32":"1.8854033","33":"0.62941569","34":"0.6725703","35":"0.8029033","36":"0.6000000","37":"0.5","38":"0.090753149"},{"1":"0.38","2":"17","3":"61","4":"9","5":"23","6":"-0.21750000","7":"110","8":"0.236363636","9":"0.3636364","10":"70.90909","11":"57.19008","12":"0.24702381","13":"0.1000","14":"0.425","15":"0.425","16":"0.87142857","17":"0.87142857","18":"0.575","19":"0.12857143","20":"0.29642857","21":"0.6538462","22":"0.7261905","23":"0.3461538","24":"0.2738095","25":"0.6482143","26":"0.51515152","27":"0.33563926","28":"5.009662","29":"3.305556","30":"0.6598361","31":"0.9440516","32":"1.8666666","33":"0.66114423","34":"0.6591481","35":"0.8182330","36":"0.5909091","37":"0.5","38":"0.078996666"},{"1":"0.41","2":"17","3":"62","4":"8","5":"23","6":"-0.21750000","7":"110","8":"0.227272727","9":"0.3636364","10":"71.81818","11":"57.43802","12":"0.25588235","13":"0.1125","14":"0.425","15":"0.425","16":"0.88571429","17":"0.88571429","18":"0.575","19":"0.11428571","20":"0.31071429","21":"0.6800000","22":"0.7294118","23":"0.3200000","24":"0.2705882","25":"0.6553571","26":"0.52307692","27":"0.35666523","28":"5.728261","29":"3.718750","30":"0.6491935","31":"1.0149285","32":"2.0278612","33":"0.69658269","34":"0.6653802","35":"0.8139663","36":"0.5954545","37":"0.5","38":"0.089245125"},{"1":"0.43","2":"16","3":"62","4":"8","5":"24","6":"-0.21750000","7":"110","8":"0.218181818","9":"0.3636364","10":"70.90909","11":"57.68595","12":"0.23255814","13":"0.1000","14":"0.400","15":"0.400","16":"0.88571429","17":"0.88571429","18":"0.600","19":"0.11428571","20":"0.28571429","21":"0.6666667","22":"0.7209302","23":"0.3333333","24":"0.2790698","25":"0.6428571","26":"0.50000000","27":"0.33277916","28":"5.166667","29":"3.500000","30":"0.6774194","31":"0.9506999","32":"1.9992501","33":"0.72869703","34":"0.6520737","35":"0.8289345","36":"0.5863636","37":"0.5","38":"0.077491235"},{"1":"0.44","2":"16","3":"63","4":"7","5":"24","6":"0.18200000","7":"110","8":"0.209090909","9":"0.3636364","10":"71.81818","11":"57.93388","12":"0.24137931","13":"0.1125","14":"0.400","15":"0.400","16":"0.90000000","17":"0.90000000","18":"0.600","19":"0.10000000","20":"0.30000000","21":"0.6956522","22":"0.7241379","23":"0.3043478","24":"0.2758621","25":"0.6500000","26":"0.50793651","27":"0.35487608","28":"6.000000","29":"4.000000","30":"0.6666667","31":"1.0282045","32":"2.2014029","33":"0.76744933","34":"0.6583333","35":"0.8245614","36":"0.5909091","37":"0.5","38":"0.088216764"},{"1":"0.45","2":"14","3":"63","4":"7","5":"26","6":"0.18200000","7":"110","8":"0.190909091","9":"0.3636364","10":"70.00000","11":"58.42975","12":"0.19662921","13":"0.0875","14":"0.350","15":"0.350","16":"0.90000000","17":"0.90000000","18":"0.650","19":"0.10000000","20":"0.25000000","21":"0.6666667","22":"0.7078652","23":"0.3333333","24":"0.2921348","25":"0.6250000","26":"0.45901639","27":"0.30599503","28":"4.846154","29":"3.500000","30":"0.7222222","31":"0.8962311","32":"2.1105557","33":"0.83343602","34":"0.6319444","35":"0.8538012","36":"0.5727273","37":"0.5","38":"0.065256486"},{"1":"0.46","2":"14","3":"64","4":"6","5":"26","6":"0.18200000","7":"110","8":"0.181818182","9":"0.3636364","10":"70.90909","11":"58.67769","12":"0.20555556","13":"0.1000","14":"0.350","15":"0.350","16":"0.91428571","17":"0.91428571","18":"0.650","19":"0.08571429","20":"0.26428571","21":"0.7000000","22":"0.7111111","23":"0.3000000","24":"0.2888889","25":"0.6321429","26":"0.46666667","27":"0.32962220","28":"5.743590","29":"4.083333","30":"0.7109375","31":"0.9823075","32":"2.3654473","33":"0.87647419","34":"0.6383371","35":"0.8489972","36":"0.5772727","37":"0.5","38":"0.075831541"},{"1":"0.47","2":"14","3":"65","4":"5","5":"26","6":"0.18200000","7":"110","8":"0.172727273","9":"0.3636364","10":"71.81818","11":"58.92562","12":"0.21428571","13":"0.1125","14":"0.350","15":"0.350","16":"0.92857143","17":"0.92857143","18":"0.650","19":"0.07142857","20":"0.27857143","21":"0.7368421","22":"0.7142857","23":"0.2631579","24":"0.2857143","25":"0.6392857","26":"0.47457627","27":"0.35450151","28":"7.000000","29":"4.900000","30":"0.7000000","31":"1.0799133","32":"2.7161600","33":"0.92527713","34":"0.6446429","35":"0.8444444","36":"0.5818182","37":"0.5","38":"0.088005894"},{"1":"0.48","2":"14","3":"67","4":"3","5":"26","6":"0.18200000","7":"110","8":"0.154545455","9":"0.3636364","10":"73.63636","11":"59.42149","12":"0.23118280","13":"0.1375","14":"0.350","15":"0.350","16":"0.95714286","17":"0.95714286","18":"0.650","19":"0.04285714","20":"0.30714286","21":"0.8235294","22":"0.7204301","23":"0.1764706","24":"0.2795699","25":"0.6535714","26":"0.49122807","27":"0.40874599","28":"12.025641","29":"8.166667","30":"0.6791045","31":"1.3331311","32":"4.0645455","33":"1.05188600","34":"0.6570096","35":"0.8360388","36":"0.5909091","37":"0.5","38":"0.119011460"},{"1":"0.49","2":"13","3":"68","4":"2","5":"27","6":"0.18200000","7":"110","8":"0.136363636","9":"0.3636364","10":"73.63636","11":"59.91736","12":"0.21842105","13":"0.1375","14":"0.325","15":"0.325","16":"0.97142857","17":"0.97142857","18":"0.675","19":"0.02857143","20":"0.29642857","21":"0.8666667","22":"0.7157895","23":"0.1333333","24":"0.2842105","25":"0.6482143","26":"0.47272727","27":"0.41551972","28":"16.370370","29":"11.375000","30":"0.6948529","31":"1.4484543","32":"5.5083424","33":"1.17798934","34":"0.6503939","35":"0.8452153","36":"0.5863636","37":"0.5","38":"0.124710399"},{"1":"0.50","2":"12","3":"68","4":"2","5":"28","6":"0.18200000","7":"110","8":"0.127272727","9":"0.3636364","10":"72.72727","11":"60.16529","12":"0.19791667","13":"0.1250","14":"0.300","15":"0.300","16":"0.97142857","17":"0.97142857","18":"0.700","19":"0.02857143","20":"0.27142857","21":"0.8571429","22":"0.7083333","23":"0.1428571","24":"0.2916667","25":"0.6357143","26":"0.44444444","27":"0.39177340","28":"14.571429","29":"10.500000","30":"0.7205882","31":"1.3778160","32":"5.3212905","33":"1.21330850","34":"0.6377101","35":"0.8582694","36":"0.5772727","37":"0.5","38":"0.110329323"},{"1":"0.52","2":"12","3":"70","4":"0","5":"28","6":"0.18200000","7":"110","8":"0.109090909","9":"0.3636364","10":"74.54545","11":"60.66116","12":"0.21428571","13":"0.1500","14":"0.300","15":"0.300","16":"1.00000000","17":"1.00000000","18":"0.700","19":"0.00000000","20":"0.30000000","21":"1.0000000","22":"0.7142857","23":"0.0000000","24":"0.2857143","25":"0.6500000","26":"0.46153846","27":"0.46291005","28":"NA","29":"NA","30":"0.7000000","31":"NA","32":"NA","33":"NA","34":"0.6500000","35":"0.8500000","36":"0.5863636","37":"0.5","38":"NA"},{"1":"0.56","2":"11","3":"70","4":"0","5":"29","6":"-0.13818182","7":"110","8":"0.100000000","9":"0.3636364","10":"73.63636","11":"60.90909","12":"0.19444444","13":"0.1375","14":"0.275","15":"0.275","16":"1.00000000","17":"1.00000000","18":"0.725","19":"0.00000000","20":"0.27500000","21":"1.0000000","22":"0.7070707","23":"0.0000000","24":"0.2929293","25":"0.6375000","26":"0.43137255","27":"0.44095855","28":"NA","29":"NA","30":"0.7250000","31":"NA","32":"NA","33":"NA","34":"0.6375000","35":"0.8625000","36":"0.5772727","37":"0.5","38":"NA"},{"1":"0.58","2":"10","3":"70","4":"0","5":"30","6":"-0.13818182","7":"110","8":"0.090909091","9":"0.3636364","10":"72.72727","11":"61.15702","12":"0.17500000","13":"0.1250","14":"0.250","15":"0.250","16":"1.00000000","17":"1.00000000","18":"0.750","19":"0.00000000","20":"0.25000000","21":"1.0000000","22":"0.7000000","23":"0.0000000","24":"0.3000000","25":"0.6250000","26":"0.40000000","27":"0.41833001","28":"NA","29":"NA","30":"0.7500000","31":"NA","32":"NA","33":"NA","34":"0.6250000","35":"0.8750000","36":"0.5681818","37":"0.5","38":"NA"},{"1":"0.70","2":"9","3":"70","4":"0","5":"31","6":"-0.13818182","7":"110","8":"0.081818182","9":"0.3636364","10":"71.81818","11":"61.40496","12":"0.15594059","13":"0.1125","14":"0.225","15":"0.225","16":"1.00000000","17":"1.00000000","18":"0.775","19":"0.00000000","20":"0.22500000","21":"1.0000000","22":"0.6930693","23":"0.0000000","24":"0.3069307","25":"0.6125000","26":"0.36734694","27":"0.39489314","28":"NA","29":"NA","30":"0.7750000","31":"NA","32":"NA","33":"NA","34":"0.6125000","35":"0.8875000","36":"0.5590909","37":"0.5","38":"NA"},{"1":"0.71","2":"8","3":"70","4":"0","5":"32","6":"-0.13818182","7":"110","8":"0.072727273","9":"0.3636364","10":"70.90909","11":"61.65289","12":"0.13725490","13":"0.1000","14":"0.200","15":"0.200","16":"1.00000000","17":"1.00000000","18":"0.800","19":"0.00000000","20":"0.20000000","21":"1.0000000","22":"0.6862745","23":"0.0000000","24":"0.3137255","25":"0.6000000","26":"0.33333333","27":"0.37047929","28":"NA","29":"NA","30":"0.8000000","31":"NA","32":"NA","33":"NA","34":"0.6000000","35":"0.9000000","36":"0.5500000","37":"0.5","38":"NA"},{"1":"0.74","2":"6","3":"70","4":"0","5":"34","6":"-0.13818182","7":"110","8":"0.054545455","9":"0.3636364","10":"69.09091","11":"62.14876","12":"0.10096154","13":"0.0750","14":"0.150","15":"0.150","16":"1.00000000","17":"1.00000000","18":"0.850","19":"0.00000000","20":"0.15000000","21":"1.0000000","22":"0.6730769","23":"0.0000000","24":"0.3269231","25":"0.5750000","26":"0.26086957","27":"0.31774445","28":"NA","29":"NA","30":"0.8500000","31":"NA","32":"NA","33":"NA","34":"0.5750000","35":"0.9250000","36":"0.5318182","37":"0.5","38":"NA"},{"1":"0.77","2":"5","3":"70","4":"0","5":"35","6":"-0.13818182","7":"110","8":"0.045454545","9":"0.3636364","10":"68.18182","11":"62.39669","12":"0.08333333","13":"0.0625","14":"0.125","15":"0.125","16":"1.00000000","17":"1.00000000","18":"0.875","19":"0.00000000","20":"0.12500000","21":"1.0000000","22":"0.6666667","23":"0.0000000","24":"0.3333333","25":"0.5625000","26":"0.22222222","27":"0.28867513","28":"NA","29":"NA","30":"0.8750000","31":"NA","32":"NA","33":"NA","34":"0.5625000","35":"0.9375000","36":"0.5227273","37":"0.5","38":"NA"},{"1":"0.82","2":"4","3":"70","4":"0","5":"36","6":"-0.13818182","7":"110","8":"0.036363636","9":"0.3636364","10":"67.27273","11":"62.64463","12":"0.06603774","13":"0.0500","14":"0.100","15":"0.100","16":"1.00000000","17":"1.00000000","18":"0.900","19":"0.00000000","20":"0.10000000","21":"1.0000000","22":"0.6603774","23":"0.0000000","24":"0.3396226","25":"0.5500000","26":"0.18181818","27":"0.25697808","28":"NA","29":"NA","30":"0.9000000","31":"NA","32":"NA","33":"NA","34":"0.5500000","35":"0.9500000","36":"0.5136364","37":"0.5","38":"NA"},{"1":"0.86","2":"3","3":"70","4":"0","5":"37","6":"-0.13818182","7":"110","8":"0.027272727","9":"0.3636364","10":"66.36364","11":"62.89256","12":"0.04906542","13":"0.0375","14":"0.075","15":"0.075","16":"1.00000000","17":"1.00000000","18":"0.925","19":"0.00000000","20":"0.07500000","21":"1.0000000","22":"0.6542056","23":"0.0000000","24":"0.3457944","25":"0.5375000","26":"0.13953488","27":"0.22150716","28":"NA","29":"NA","30":"0.9250000","31":"NA","32":"NA","33":"NA","34":"0.5375000","35":"0.9625000","36":"0.5045455","37":"0.5","38":"NA"},{"1":"0.96","2":"2","3":"70","4":"0","5":"38","6":"-0.13818182","7":"110","8":"0.018181818","9":"0.3636364","10":"65.45455","11":"63.14050","12":"0.03240741","13":"0.0250","14":"0.050","15":"0.050","16":"1.00000000","17":"1.00000000","18":"0.950","19":"0.00000000","20":"0.05000000","21":"1.0000000","22":"0.6481481","23":"0.0000000","24":"0.3518519","25":"0.5250000","26":"0.09523810","27":"0.18002057","28":"NA","29":"NA","30":"0.9500000","31":"NA","32":"NA","33":"NA","34":"0.5250000","35":"0.9750000","36":"0.4954545","37":"0.5","38":"NA"},{"1":"2.07","2":"1","3":"70","4":"0","5":"39","6":"-0.13818182","7":"110","8":"0.009090909","9":"0.3636364","10":"64.54545","11":"63.38843","12":"0.01605505","13":"0.0125","14":"0.025","15":"0.025","16":"1.00000000","17":"1.00000000","18":"0.975","19":"0.00000000","20":"0.02500000","21":"1.0000000","22":"0.6422018","23":"0.0000000","24":"0.3577982","25":"0.5125000","26":"0.04878049","27":"0.12670851","28":"NA","29":"NA","30":"0.9750000","31":"NA","32":"NA","33":"NA","34":"0.5125000","35":"0.9875000","36":"0.4863636","37":"0.5","38":"NA"},{"1":"2.08","2":"0","3":"70","4":"0","5":"40","6":"NA","7":"110","8":"0.000000000","9":"0.3636364","10":"63.63636","11":"63.63636","12":"0.00000000","13":"0.0000","14":"0.000","15":"0.000","16":"1.00000000","17":"1.00000000","18":"1.000","19":"0.00000000","20":"0.00000000","21":"NA","22":"0.6363636","23":"NA","24":"0.3636364","25":"0.5000000","26":"0.00000000","27":"NA","28":"NA","29":"NA","30":"1.0000000","31":"NA","32":"NA","33":"NA","34":"0.5000000","35":"1.0000000","36":"0.4772727","37":"0.5","38":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-youdenJ" class="level3" data-number="9.7.4"><h3 data-number="9.7.4" class="anchored" data-anchor-id="sec-allAccuracyStatistics-youdenJ">
<span class="header-section-number">9.7.4</span> Youden’s J Statistic</h3>
<section id="sec-allAccuracyStatistics-youdenJthreshold" class="level4" data-number="9.7.4.1"><h4 data-number="9.7.4.1" class="anchored" data-anchor-id="sec-allAccuracyStatistics-youdenJthreshold">
<span class="header-section-number">9.7.4.1</span> Threshold</h4>
<p>Threshold at maximum combination of <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a>:</p>
<p><span class="math inline">\(\text{max}(\text{sensitivity} + \text{specificity})\)</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb326"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1"></a>youdenIndex <span class="ot">&lt;-</span> <span class="fu">coords</span>(<span class="fu">roc</span>(<span class="at">data =</span> mydataSDT,</span>
<span id="cb326-2"><a href="#cb326-2"></a>                          <span class="at">response =</span> disorder,</span>
<span id="cb326-3"><a href="#cb326-3"></a>                          <span class="at">predictor =</span> testScore,</span>
<span id="cb326-4"><a href="#cb326-4"></a>                          <span class="at">smooth =</span> <span class="cn">FALSE</span>),</span>
<span id="cb326-5"><a href="#cb326-5"></a>                      <span class="at">x =</span> <span class="st">"best"</span>,</span>
<span id="cb326-6"><a href="#cb326-6"></a>                      <span class="at">best.method =</span> <span class="st">"youden"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb326-7"><a href="#cb326-7"></a></span>
<span id="cb326-8"><a href="#cb326-8"></a>youdenIndex</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.205</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-youdenJaccuracy" class="level4" data-number="9.7.4.2"><h4 data-number="9.7.4.2" class="anchored" data-anchor-id="sec-allAccuracyStatistics-youdenJaccuracy">
<span class="header-section-number">9.7.4.2</span> Accuracy statistics at cutoff of Youden’s J Statistic</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb328"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1"></a>accuracyStats[<span class="fu">head</span>(<span class="fu">which</span>(</span>
<span id="cb328-2"><a href="#cb328-2"></a>  accuracyStats<span class="sc">$</span>cutoff <span class="sc">&gt;=</span> youdenIndex), <span class="dv">1</span>),]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["cutoff"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["TP"],"name":[2],"type":["int"],"align":["right"]},{"label":["TN"],"name":[3],"type":["int"],"align":["right"]},{"label":["FP"],"name":[4],"type":["int"],"align":["right"]},{"label":["FN"],"name":[5],"type":["int"],"align":["right"]},{"label":["differenceBetweenPredictedAndObserved"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["N"],"name":[7],"type":["int"],"align":["right"]},{"label":["selectionRatio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["baseRate"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["percentAccuracy"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["percentAccuracyByChance"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["relativeImprovementOverChance"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["relativeImprovementOverPredictingFromBaseRate"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["TPrate"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["sensitivity"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["TNrate"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["specificity"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["FNrate"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["FPrate"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["youdenJ"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["positivePredictiveValue"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["negativePredictiveValue"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["falseDiscoveryRate"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["falseOmissionRate"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["balancedAccuracy"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["f1Score"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["mcc"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["diagnosticOddsRatio"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["positiveLikelihoodRatio"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["negativeLikelihoodRatio"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["dPrimeSDT"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["betaSDT"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["cSDT"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["ASDT"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["bSDT"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["overallUtility"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["utilityRatio"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["informationGain"],"name":[38],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.22","2":"26","3":"56","4":"14","5":"14","6":"-0.269","7":"110","8":"0.3636364","9":"0.3636364","10":"74.54545","11":"53.71901","12":"0.45","13":"0.15","14":"0.65","15":"0.65","16":"0.8","17":"0.8","18":"0.35","19":"0.2","20":"0.45","21":"0.65","22":"0.8","23":"0.35","24":"0.2","25":"0.725","26":"0.65","27":"0.45","28":"7.428571","29":"3.25","30":"0.4375","31":"1.226942","32":"1.323034","33":"0.2281504","34":"0.753125","35":"0.6875","36":"0.65","37":"0.5","38":"0.1465904","_rn_":"18"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb329"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1"></a>accuracyStats[<span class="fu">which</span>(</span>
<span id="cb329-2"><a href="#cb329-2"></a>  accuracyStats<span class="sc">$</span>youdenJ <span class="sc">==</span> <span class="fu">max</span>(accuracyStats<span class="sc">$</span>youdenJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["cutoff"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["TP"],"name":[2],"type":["int"],"align":["right"]},{"label":["TN"],"name":[3],"type":["int"],"align":["right"]},{"label":["FP"],"name":[4],"type":["int"],"align":["right"]},{"label":["FN"],"name":[5],"type":["int"],"align":["right"]},{"label":["differenceBetweenPredictedAndObserved"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["N"],"name":[7],"type":["int"],"align":["right"]},{"label":["selectionRatio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["baseRate"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["percentAccuracy"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["percentAccuracyByChance"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["relativeImprovementOverChance"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["relativeImprovementOverPredictingFromBaseRate"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["TPrate"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["sensitivity"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["TNrate"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["specificity"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["FNrate"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["FPrate"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["youdenJ"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["positivePredictiveValue"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["negativePredictiveValue"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["falseDiscoveryRate"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["falseOmissionRate"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["balancedAccuracy"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["f1Score"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["mcc"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["diagnosticOddsRatio"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["positiveLikelihoodRatio"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["negativeLikelihoodRatio"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["dPrimeSDT"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["betaSDT"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["cSDT"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["ASDT"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["bSDT"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["overallUtility"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["utilityRatio"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["informationGain"],"name":[38],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.22","2":"26","3":"56","4":"14","5":"14","6":"-0.269","7":"110","8":"0.3636364","9":"0.3636364","10":"74.54545","11":"53.71901","12":"0.45","13":"0.15","14":"0.65","15":"0.65","16":"0.8","17":"0.8","18":"0.35","19":"0.2","20":"0.45","21":"0.65","22":"0.8","23":"0.35","24":"0.2","25":"0.725","26":"0.65","27":"0.45","28":"7.428571","29":"3.25","30":"0.4375","31":"1.226942","32":"1.323034","33":"0.2281504","34":"0.753125","35":"0.6875","36":"0.65","37":"0.5","38":"0.1465904","_rn_":"18"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="sec-allAccuracyStatistics-topLeftROC" class="level3" data-number="9.7.5"><h3 data-number="9.7.5" class="anchored" data-anchor-id="sec-allAccuracyStatistics-topLeftROC">
<span class="header-section-number">9.7.5</span> Closest to the Top Left of the ROC Curve</h3>
<section id="sec-allAccuracyStatistics-topLeftROCthreshold" class="level4" data-number="9.7.5.1"><h4 data-number="9.7.5.1" class="anchored" data-anchor-id="sec-allAccuracyStatistics-topLeftROCthreshold">
<span class="header-section-number">9.7.5.1</span> Threshold</h4>
<p>Threshold where the ROC plot is closest to the Top Left:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb330"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1"></a>closestToTheTopLeft <span class="ot">&lt;-</span> <span class="fu">coords</span>(<span class="fu">roc</span>(</span>
<span id="cb330-2"><a href="#cb330-2"></a>  <span class="at">data =</span> mydataSDT,</span>
<span id="cb330-3"><a href="#cb330-3"></a>  <span class="at">response =</span> disorder,</span>
<span id="cb330-4"><a href="#cb330-4"></a>  <span class="at">predictor =</span> testScore,</span>
<span id="cb330-5"><a href="#cb330-5"></a>  <span class="at">smooth =</span> <span class="cn">FALSE</span>),</span>
<span id="cb330-6"><a href="#cb330-6"></a>  <span class="at">x =</span> <span class="st">"best"</span>,</span>
<span id="cb330-7"><a href="#cb330-7"></a>  <span class="at">best.method =</span> <span class="st">"closest.topleft"</span>)[[<span class="dv">1</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-allAccuracyStatistics-topLeftROCaccuracy" class="level4" data-number="9.7.5.2"><h4 data-number="9.7.5.2" class="anchored" data-anchor-id="sec-allAccuracyStatistics-topLeftROCaccuracy">
<span class="header-section-number">9.7.5.2</span> Accuracy stats at cutoff where the ROC plot is closest to the Top Left</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb331"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1"></a>accuracyStats[<span class="fu">head</span>(<span class="fu">which</span>(</span>
<span id="cb331-2"><a href="#cb331-2"></a>  accuracyStats<span class="sc">$</span>cutoff <span class="sc">&gt;=</span> closestToTheTopLeft), <span class="dv">1</span>),]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["cutoff"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["TP"],"name":[2],"type":["int"],"align":["right"]},{"label":["TN"],"name":[3],"type":["int"],"align":["right"]},{"label":["FP"],"name":[4],"type":["int"],"align":["right"]},{"label":["FN"],"name":[5],"type":["int"],"align":["right"]},{"label":["differenceBetweenPredictedAndObserved"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["N"],"name":[7],"type":["int"],"align":["right"]},{"label":["selectionRatio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["baseRate"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["percentAccuracy"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["percentAccuracyByChance"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["relativeImprovementOverChance"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["relativeImprovementOverPredictingFromBaseRate"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["TPrate"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["sensitivity"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["TNrate"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["specificity"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["FNrate"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["FPrate"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["youdenJ"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["positivePredictiveValue"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["negativePredictiveValue"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["falseDiscoveryRate"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["falseOmissionRate"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["balancedAccuracy"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["f1Score"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["mcc"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["diagnosticOddsRatio"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["positiveLikelihoodRatio"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["negativeLikelihoodRatio"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["dPrimeSDT"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["betaSDT"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["cSDT"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["ASDT"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["bSDT"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["overallUtility"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["utilityRatio"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["informationGain"],"name":[38],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.22","2":"26","3":"56","4":"14","5":"14","6":"-0.269","7":"110","8":"0.3636364","9":"0.3636364","10":"74.54545","11":"53.71901","12":"0.45","13":"0.15","14":"0.65","15":"0.65","16":"0.8","17":"0.8","18":"0.35","19":"0.2","20":"0.45","21":"0.65","22":"0.8","23":"0.35","24":"0.2","25":"0.725","26":"0.65","27":"0.45","28":"7.428571","29":"3.25","30":"0.4375","31":"1.226942","32":"1.323034","33":"0.2281504","34":"0.753125","35":"0.6875","36":"0.65","37":"0.5","38":"0.1465904","_rn_":"18"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="sec-allAccuracyStatistics-cutoff" class="level3" data-number="9.7.6"><h3 data-number="9.7.6" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoff">
<span class="header-section-number">9.7.6</span> Cutoff that optimizes each of the following criteria:</h3>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains an R function that identifies the cutoff that optimizes each of various accuracy estimates.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb332"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1"></a><span class="fu">optimalCutoff</span>(</span>
<span id="cb332-2"><a href="#cb332-2"></a>  <span class="at">predicted =</span> mydataSDT<span class="sc">$</span>testScore,</span>
<span id="cb332-3"><a href="#cb332-3"></a>  <span class="at">actual =</span> mydataSDT<span class="sc">$</span>disorder,</span>
<span id="cb332-4"><a href="#cb332-4"></a>  <span class="at">UH =</span> utilityHits,</span>
<span id="cb332-5"><a href="#cb332-5"></a>  <span class="at">UM =</span> utilityMisses,</span>
<span id="cb332-6"><a href="#cb332-6"></a>  <span class="at">UCR =</span> utilityCorrectRejections,</span>
<span id="cb332-7"><a href="#cb332-7"></a>  <span class="at">UFA =</span> utilityFalseAlarms)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[[1]]
  percentAccuracyCutoff percentAccuracyOptimal
1                  0.22               74.54545
2                  0.52               74.54545

[[2]]
  percentAccuracyByChanceCutoff percentAccuracyByChanceOptimal
1                          2.08                       63.63636

[[3]]
  RIOCCutoff RIOCOptimal
1       0.07       0.725

[[4]]
  relativeImprovementOverPredictingFromBaseRateCutoff
1                                                0.22
2                                                0.52
  relativeImprovementOverPredictingFromBaseRateOptimal
1                                                 0.15
2                                                 0.15

[[5]]
   PPVCutoff PPVOptimal
1       0.52          1
2       0.56          1
3       0.58          1
4       0.70          1
5       0.71          1
6       0.74          1
7       0.77          1
8       0.82          1
9       0.86          1
10      0.96          1
11      2.07          1

[[6]]
  NPVCutoff NPVOptimal
1      0.07        0.9

[[7]]
  youdenJCutoff youdenJOptimal
1          0.22           0.45

[[8]]
  balancedAccuracyCutoff balancedAccuracyOptimal
1                   0.22                   0.725

[[9]]
  f1ScoreCutoff f1ScoreOptimal
1          0.22           0.65

[[10]]
  mccCutoff mccOptimal
1      0.52    0.46291

[[11]]
  diagnosticOddsRatioCutoff diagnosticOddsRatioOptimal
1                      0.49                   16.37037

[[12]]
  positiveLikelihoodRatioCutoff positiveLikelihoodRatioOptimal
1                          0.49                         11.375

[[13]]
  negativeLikelihoodRatioCutoff negativeLikelihoodRatioOptimal
1                          0.07                      0.1944444

[[14]]
  dPrimeSDTCutoff dPrimeSDTOptimal
1            0.49         1.448454

[[15]]
  betaSDTCutoff betaSDTOptimal
1          0.07      0.2784011

[[16]]
  cSDTCutoff cSDTOptimal
1       0.16  0.01498818

[[17]]
  aSDTCutoff aSDTOptimal
1       0.52       0.825

[[18]]
  bSDTCutoff bSDTOptimal
1       0.07   0.2862166

[[19]]
  differenceBetweenPredictedAndObservedCutoff
1                                        0.14
2                                        0.15
3                                        0.16
  differenceBetweenPredictedAndObservedOptimal
1                                        0.058
2                                        0.058
3                                        0.058

[[20]]
  informationGainCutoff informationGainOptimal
1                  0.22              0.1465904

[[21]]
  overallUtilityCutoff overallUtilityOptimal
1                 0.22                  0.65</code></pre>
</div>
</div>
<section id="sec-allAccuracyStatistics-cutoffPercentAccuracy" class="level4" data-number="9.7.6.1"><h4 data-number="9.7.6.1" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffPercentAccuracy">
<span class="header-section-number">9.7.6.1</span> Percent Accuracy</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb334"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb334-2"><a href="#cb334-2"></a>  accuracyStats<span class="sc">$</span>percentAccuracy <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb334-3"><a href="#cb334-3"></a>    accuracyStats<span class="sc">$</span>percentAccuracy,</span>
<span id="cb334-4"><a href="#cb334-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.22 0.52</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffPercentAccuracyByChance" class="level4" data-number="9.7.6.2"><h4 data-number="9.7.6.2" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffPercentAccuracyByChance">
<span class="header-section-number">9.7.6.2</span> Percent Accuracy by Chance</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb336"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb336-2"><a href="#cb336-2"></a>  accuracyStats<span class="sc">$</span>percentAccuracyByChance <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb336-3"><a href="#cb336-3"></a>    accuracyStats<span class="sc">$</span>percentAccuracyByChance,</span>
<span id="cb336-4"><a href="#cb336-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 2.08</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffROIC" class="level4" data-number="9.7.6.3"><h4 data-number="9.7.6.3" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffROIC">
<span class="header-section-number">9.7.6.3</span> Relative Improvement Over Chance (ROIC)</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb338"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb338-2"><a href="#cb338-2"></a>  accuracyStats<span class="sc">$</span>relativeImprovementOverChance <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb338-3"><a href="#cb338-3"></a>    accuracyStats<span class="sc">$</span>relativeImprovementOverChance,</span>
<span id="cb338-4"><a href="#cb338-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffRelativeImprovementOverPredictingFromBaseRate" class="level4" data-number="9.7.6.4"><h4 data-number="9.7.6.4" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffRelativeImprovementOverPredictingFromBaseRate">
<span class="header-section-number">9.7.6.4</span> Relative Improvement Over Predicting from the Base Rate</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb340"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb340-2"><a href="#cb340-2"></a>  accuracyStats<span class="sc">$</span>relativeImprovementOverPredictingFromBaseRate <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb340-3"><a href="#cb340-3"></a>    accuracyStats<span class="sc">$</span>relativeImprovementOverPredictingFromBaseRate,</span>
<span id="cb340-4"><a href="#cb340-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.22 0.52</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffSensitivity" class="level4" data-number="9.7.6.5"><h4 data-number="9.7.6.5" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffSensitivity">
<span class="header-section-number">9.7.6.5</span> Sensitivity</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb342"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb342-2"><a href="#cb342-2"></a>  accuracyStats<span class="sc">$</span>sensitivity <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb342-3"><a href="#cb342-3"></a>    accuracyStats<span class="sc">$</span>sensitivity,</span>
<span id="cb342-4"><a href="#cb342-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffSpecificity" class="level4" data-number="9.7.6.6"><h4 data-number="9.7.6.6" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffSpecificity">
<span class="header-section-number">9.7.6.6</span> Specificity</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb344"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb344-2"><a href="#cb344-2"></a>  accuracyStats<span class="sc">$</span>specificity <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb344-3"><a href="#cb344-3"></a>    accuracyStats<span class="sc">$</span>specificity,</span>
<span id="cb344-4"><a href="#cb344-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] 0.52 0.56 0.58 0.70 0.71 0.74 0.77 0.82 0.86 0.96 2.07 2.08</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffPPV" class="level4" data-number="9.7.6.7"><h4 data-number="9.7.6.7" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffPPV">
<span class="header-section-number">9.7.6.7</span> Positive Predictive Value</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb346"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb346-2"><a href="#cb346-2"></a>  accuracyStats<span class="sc">$</span>positivePredictiveValue <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb346-3"><a href="#cb346-3"></a>    accuracyStats<span class="sc">$</span>positivePredictiveValue,</span>
<span id="cb346-4"><a href="#cb346-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] 0.52 0.56 0.58 0.70 0.71 0.74 0.77 0.82 0.86 0.96 2.07</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffNPV" class="level4" data-number="9.7.6.8"><h4 data-number="9.7.6.8" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffNPV">
<span class="header-section-number">9.7.6.8</span> Negative Predictive Value</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb348"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb348-2"><a href="#cb348-2"></a>  accuracyStats<span class="sc">$</span>negativePredictiveValue <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb348-3"><a href="#cb348-3"></a>    accuracyStats<span class="sc">$</span>negativePredictiveValue,</span>
<span id="cb348-4"><a href="#cb348-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffYoudenJ" class="level4" data-number="9.7.6.9"><h4 data-number="9.7.6.9" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffYoudenJ">
<span class="header-section-number">9.7.6.9</span> Youden’s J Statistic</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb350"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb350-2"><a href="#cb350-2"></a>  accuracyStats<span class="sc">$</span>youdenJ <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb350-3"><a href="#cb350-3"></a>    accuracyStats<span class="sc">$</span>youdenJ,</span>
<span id="cb350-4"><a href="#cb350-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.22</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffBalancedAccuracy" class="level4" data-number="9.7.6.10"><h4 data-number="9.7.6.10" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffBalancedAccuracy">
<span class="header-section-number">9.7.6.10</span> Balanced Accuracy</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb352"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb352-2"><a href="#cb352-2"></a>  accuracyStats<span class="sc">$</span>balancedAccuracy <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb352-3"><a href="#cb352-3"></a>    accuracyStats<span class="sc">$</span>balancedAccuracy,</span>
<span id="cb352-4"><a href="#cb352-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.22</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffF1" class="level4" data-number="9.7.6.11"><h4 data-number="9.7.6.11" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffF1">
<span class="header-section-number">9.7.6.11</span> F1 Score</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb354"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb354-2"><a href="#cb354-2"></a>  accuracyStats<span class="sc">$</span>f1Score <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb354-3"><a href="#cb354-3"></a>    accuracyStats<span class="sc">$</span>f1Score,</span>
<span id="cb354-4"><a href="#cb354-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.22</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffMCC" class="level4" data-number="9.7.6.12"><h4 data-number="9.7.6.12" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffMCC">
<span class="header-section-number">9.7.6.12</span> Matthews Correlation Coefficient</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb356"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb356-2"><a href="#cb356-2"></a>  accuracyStats<span class="sc">$</span>mcc <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb356-3"><a href="#cb356-3"></a>    accuracyStats<span class="sc">$</span>mcc,</span>
<span id="cb356-4"><a href="#cb356-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.52</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffDOR" class="level4" data-number="9.7.6.13"><h4 data-number="9.7.6.13" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffDOR">
<span class="header-section-number">9.7.6.13</span> Diagnostic Odds Ratio</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb358"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb358-2"><a href="#cb358-2"></a>  accuracyStats<span class="sc">$</span>diagnosticOddsRatio <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb358-3"><a href="#cb358-3"></a>    accuracyStats<span class="sc">$</span>diagnosticOddsRatio,</span>
<span id="cb358-4"><a href="#cb358-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.49</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffPLR" class="level4" data-number="9.7.6.14"><h4 data-number="9.7.6.14" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffPLR">
<span class="header-section-number">9.7.6.14</span> Positive Likelihood Ratio</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb360"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb360-2"><a href="#cb360-2"></a>  accuracyStats<span class="sc">$</span>positiveLikelihoodRatio <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb360-3"><a href="#cb360-3"></a>    accuracyStats<span class="sc">$</span>positiveLikelihoodRatio,</span>
<span id="cb360-4"><a href="#cb360-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.49</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffNLR" class="level4" data-number="9.7.6.15"><h4 data-number="9.7.6.15" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffNLR">
<span class="header-section-number">9.7.6.15</span> Negative Likelihood Ratio</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb362"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb362-2"><a href="#cb362-2"></a>  accuracyStats<span class="sc">$</span>negativeLikelihoodRatio <span class="sc">==</span> <span class="fu">min</span>(</span>
<span id="cb362-3"><a href="#cb362-3"></a>    accuracyStats<span class="sc">$</span>negativeLikelihoodRatio,</span>
<span id="cb362-4"><a href="#cb362-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffDprime" class="level4" data-number="9.7.6.16"><h4 data-number="9.7.6.16" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffDprime">
<span class="header-section-number">9.7.6.16</span> <span class="math inline">\(d'\)</span> Sensitivity</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb364"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb364-2"><a href="#cb364-2"></a>  accuracyStats<span class="sc">$</span>dPrimeSDT <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb364-3"><a href="#cb364-3"></a>    accuracyStats<span class="sc">$</span>dPrimeSDT,</span>
<span id="cb364-4"><a href="#cb364-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.49</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffAsensitivity" class="level4" data-number="9.7.6.17"><h4 data-number="9.7.6.17" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffAsensitivity">
<span class="header-section-number">9.7.6.17</span> <span class="math inline">\(A\)</span> (Non-Parametric) Sensitivity</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb366"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb366-2"><a href="#cb366-2"></a>  accuracyStats<span class="sc">$</span>ASDT <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb366-3"><a href="#cb366-3"></a>    accuracyStats<span class="sc">$</span>ASDT,</span>
<span id="cb366-4"><a href="#cb366-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.22</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffBetaBias" class="level4" data-number="9.7.6.18"><h4 data-number="9.7.6.18" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffBetaBias">
<span class="header-section-number">9.7.6.18</span> <span class="math inline">\(\beta\)</span> Bias</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb368"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(<span class="fu">abs</span>(</span>
<span id="cb368-2"><a href="#cb368-2"></a>  accuracyStats<span class="sc">$</span>betaSDT) <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">abs</span>(</span>
<span id="cb368-3"><a href="#cb368-3"></a>    accuracyStats<span class="sc">$</span>betaSDT),</span>
<span id="cb368-4"><a href="#cb368-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffCbias" class="level4" data-number="9.7.6.19"><h4 data-number="9.7.6.19" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffCbias">
<span class="header-section-number">9.7.6.19</span> <span class="math inline">\(c\)</span> Bias</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb370"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(<span class="fu">abs</span>(</span>
<span id="cb370-2"><a href="#cb370-2"></a>  accuracyStats<span class="sc">$</span>cSDT) <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">abs</span>(</span>
<span id="cb370-3"><a href="#cb370-3"></a>    accuracyStats<span class="sc">$</span>cSDT),</span>
<span id="cb370-4"><a href="#cb370-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.16</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffBbias" class="level4" data-number="9.7.6.20"><h4 data-number="9.7.6.20" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffBbias">
<span class="header-section-number">9.7.6.20</span> <span class="math inline">\(b\)</span> (Non-Parametric) Bias</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb372"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(<span class="fu">abs</span>(</span>
<span id="cb372-2"><a href="#cb372-2"></a>  accuracyStats<span class="sc">$</span>bSDT) <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">abs</span>(</span>
<span id="cb372-3"><a href="#cb372-3"></a>    accuracyStats<span class="sc">$</span>bSDT),</span>
<span id="cb372-4"><a href="#cb372-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffMiscalibration" class="level4" data-number="9.7.6.21"><h4 data-number="9.7.6.21" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffMiscalibration">
<span class="header-section-number">9.7.6.21</span> Mean difference between predicted and observed values (Miscalibration)</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb374"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(<span class="fu">abs</span>(</span>
<span id="cb374-2"><a href="#cb374-2"></a>  accuracyStats<span class="sc">$</span>differenceBetweenPredictedAndObserved) <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">abs</span>(</span>
<span id="cb374-3"><a href="#cb374-3"></a>    accuracyStats<span class="sc">$</span>differenceBetweenPredictedAndObserved),</span>
<span id="cb374-4"><a href="#cb374-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.14 0.15 0.16</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffOverallUtility" class="level4" data-number="9.7.6.22"><h4 data-number="9.7.6.22" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffOverallUtility">
<span class="header-section-number">9.7.6.22</span> Overall Utility</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb376"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb376-2"><a href="#cb376-2"></a>  accuracyStats<span class="sc">$</span>overallUtility <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb376-3"><a href="#cb376-3"></a>    accuracyStats<span class="sc">$</span>overallUtility,</span>
<span id="cb376-4"><a href="#cb376-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.22</code></pre>
</div>
</div>
</section><section id="sec-allAccuracyStatistics-cutoffIgain" class="level4" data-number="9.7.6.23"><h4 data-number="9.7.6.23" class="anchored" data-anchor-id="sec-allAccuracyStatistics-cutoffIgain">
<span class="header-section-number">9.7.6.23</span> Information Gain</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb378"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1"></a>accuracyStats<span class="sc">$</span>cutoff[<span class="fu">which</span>(</span>
<span id="cb378-2"><a href="#cb378-2"></a>  accuracyStats<span class="sc">$</span>informationGain <span class="sc">==</span> <span class="fu">max</span>(</span>
<span id="cb378-3"><a href="#cb378-3"></a>    accuracyStats<span class="sc">$</span>informationGain,</span>
<span id="cb378-4"><a href="#cb378-4"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.22</code></pre>
</div>
</div>
</section></section></section><section id="sec-regression-prediction" class="level2" data-number="9.8"><h2 data-number="9.8" class="anchored" data-anchor-id="sec-regression-prediction">
<span class="header-section-number">9.8</span> Regression for Prediction of Continuous Outcomes</h2>
<p>When predicting a continuous outcome, regression is particularly relevant (or multiple regression, when dealing with multiple predictors). Regression takes the general form in <a href="#eq-regression" class="quarto-xref">Equation&nbsp;<span>9.75</span></a>:</p>
<p><span id="eq-regression"><span class="math display">\[
y = b_0 + b_1 \cdot x_1 + e
\tag{9.75}\]</span></span></p>
<p>where <span class="math inline">\(y\)</span> is the outcome, <span class="math inline">\(b_0\)</span> is the intercept, <span class="math inline">\(b_1\)</span> is the slope of the association between the predictor (<span class="math inline">\(x_1\)</span>) and outcome, and <span class="math inline">\(e\)</span> is the error term.</p>
<p>If the predictors reflect what causes the outcome, then the error term reflects what cannot be accounted for by the predictors. It has been argued that human freedom resides in the error term <span class="citation" data-cites="Kenny1979a">(<a href="references.html#ref-Kenny1979a" role="doc-biblioref">Kenny, 1979</a>)</span>.</p>
</section><section id="sec-pseudoPrediction" class="level2" data-number="9.9"><h2 data-number="9.9" class="anchored" data-anchor-id="sec-pseudoPrediction">
<span class="header-section-number">9.9</span> Pseudo-Prediction</h2>
<p>Consider the following example where you have one predictor and one outcome, as shown in <a href="#tbl-regression1" class="quarto-xref">Table&nbsp;<span>9.2</span></a>.</p>
<div class="cell">
<div id="tbl-regression1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-regression1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.2: Example Data of Predictor (x1) and Outcome (y) Used for Regression Model.
</figcaption><div aria-describedby="tbl-regression1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">y</th>
<th style="text-align: right;">x1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">29</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Using the data, the best fitting regression model is: <span class="math inline">\(y = 3.98 + 3.59 \cdot x_1\)</span>. In this example, the <span class="math inline">\(R^2\)</span> is <span class="math inline">\(0.98\)</span>. The equation is not a perfect prediction, but with a single predictor, it captures the majority of the variance in the outcome.</p>
<p>Now consider the following example where you add a second predictor to the data above, as shown in <a href="#tbl-regression2" class="quarto-xref">Table&nbsp;<span>9.3</span></a>.</p>
<div class="cell">
<div id="tbl-regression2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-regression2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.3: Example Data of Predictors (x1 and x2) and Outcome (y) Used for Regression Model.
</figcaption><div aria-describedby="tbl-regression2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">y</th>
<th style="text-align: right;">x1</th>
<th style="text-align: right;">x2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">29</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>With the second predictor, the best fitting regression model is: <span class="math inline">\(y = 0.00 + 4.00 \cdot x_1 + 1.00 \cdot x_2\)</span>. In this example, the <span class="math inline">\(R^2\)</span> is <span class="math inline">\(1.00\)</span>. The equation with the second predictor provides a perfect prediction of the outcome.</p>
<p>Providing perfect prediction with the right set of predictors is the dream of multiple regression. So, in psychology, we often add predictors to incrementally improve prediction. Knowing how much variance would be accounted for by random chance follows <a href="#eq-predictionByChance" class="quarto-xref">Equation&nbsp;<span>9.76</span></a>:</p>
<p><span id="eq-predictionByChance"><span class="math display">\[
E(R^2) = \frac{K}{n-1}
\tag{9.76}\]</span></span></p>
<p>where <span class="math inline">\(E(R^2)\)</span> is the expected value of <span class="math inline">\(R^2\)</span> (the proportion of variance explained), <span class="math inline">\(K\)</span> is the number of predictors, and <span class="math inline">\(n\)</span> is the sample size. The formula demonstrates that the more predictors in the regression model, the more variance will be accounted for by chance. With many predictors and a small sample, you can account for a large share of the variance merely by chance—this would be an example of pseudo-prediction.</p>
<p>As an example, consider that we have 13 predictors to predict behavior problems for 43 children. Assume that, with 13 predictors, we explain 38% of the variance (<span class="math inline">\(R^2 = .38; r = .62\)</span>). Explaining more than 20–30% of the variance can be a big deal in psychology. We explained a lot of the variance in the outcome, but it is important to consider how much variance could have been explained by random chance: <span class="math inline">\(E(R^2) = \frac{K}{n-1} = \frac{13}{43 - 1} = .31\)</span>. We expect to explain 31% of the variance, by chance, in the outcome. So, 82% of the variance explained was likely spurious. As the sample size increases, the spuriousness decreases. Adjusted <span class="math inline">\(R^2\)</span> accounts for the number of predictors in the model, based on how much would be expected to be accounted for by chance. But adjusted <span class="math inline">\(R^2\)</span> also has its problems.</p>
<section id="sec-multiCollinearity" class="level3" data-number="9.9.1"><h3 data-number="9.9.1" class="anchored" data-anchor-id="sec-multiCollinearity">
<span class="header-section-number">9.9.1</span> Multicollinearity</h3>
<p><em>Multicollinearity</em> occurs when two or more predictors in a regression model are highly correlated. The problem is that it makes it challenging to estimate the regression coefficients accurately.</p>
<p>Multicollinearity in multiple regression is depicted conceptually in <a href="#fig-multipleRegressionMulticollinearity" class="quarto-xref">Figure&nbsp;<span>9.35</span></a>.</p>
<div id="fig-multipleRegressionMulticollinearity" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Conceptual Depiction of Multicollinearity in Multiple Regression.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-multipleRegressionMulticollinearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/multipleRegressionMulticollinearity.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35" title="Figure&nbsp;9.35: Conceptual Depiction of Multicollinearity in Multiple Regression."><img src="images/multipleRegressionMulticollinearity.png" class="img-fluid figure-img" style="width:50.0%" alt="Conceptual Depiction of Multicollinearity in Multiple Regression."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-multipleRegressionMulticollinearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.35: Conceptual Depiction of Multicollinearity in Multiple Regression.
</figcaption></figure>
</div>
<p>Consider the following example where you have two predictors and one outcome, as shown in <a href="#tbl-regression3" class="quarto-xref">Table&nbsp;<span>9.4</span></a>.</p>
<div class="cell">
<div id="tbl-regression3" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-regression3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.4: Example Data of Predictors (x1 and x2) and Outcome (y) Used for Regression Model.
</figcaption><div aria-describedby="tbl-regression3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">y</th>
<th style="text-align: right;">x1</th>
<th style="text-align: right;">x2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The second measure is not very good—it is exactly twice the value of the first measure. This means that there are different prediction equation possibilities that are equally good—see <a href="#eq-multicollinearity" class="quarto-xref">Equation&nbsp;<span>9.77</span></a>:</p>
<p><span id="eq-multicollinearity"><span class="math display">\[
\begin{aligned}
  2x_2 &amp;= y \\
  0x_1 + 2x_2 &amp;= y \\
  4x_1 &amp;= y \\
  4x_1 + 0x_2 &amp;= y \\
  2x_1 + 1x_2 &amp;= y \\
  5x_1 - 0.5x_2 &amp;= y \\
  ...
&amp;= y
\end{aligned}
\tag{9.77}\]</span></span></p>
<p>Then, what are the regression coefficients? We do not know, and we could come up with arbitrary estimates with an enormous standard error around each estimate. Any predictors that have a correlation above ~ <span class="math inline">\(r = .30\)</span> with each other could have an impact on the confidence interval of the regression coefficient. As the correlations among the predictors increase, the chance of getting an arbitrary answer increases, sometimes called “bouncing betas.” So, it is important to examine a correlation matrix of the predictors before putting them in the same regression model. You can also examine indices such as variance inflation factor (VIF).</p>
<p>Generalized VIF (GVIF) values are estimated below using the <code>car</code> package <span class="citation" data-cites="R-car">(<a href="references.html#ref-R-car" role="doc-biblioref">Fox et al., 2022</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb380"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb380-2"><a href="#cb380-2"></a>mydataSDT<span class="sc">$</span>collinearPredictor <span class="ot">&lt;-</span> mydataSDT<span class="sc">$</span>ndka <span class="sc">+</span> </span>
<span id="cb380-3"><a href="#cb380-3"></a><span class="fu">rnorm</span>(<span class="fu">nrow</span>(mydataSDT), <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb380-4"><a href="#cb380-4"></a></span>
<span id="cb380-5"><a href="#cb380-5"></a>collinearRegression_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb380-6"><a href="#cb380-6"></a>  s100b <span class="sc">~</span> ndka <span class="sc">+</span> gender <span class="sc">+</span> age <span class="sc">+</span> wfns <span class="sc">+</span> collinearPredictor,</span>
<span id="cb380-7"><a href="#cb380-7"></a>  <span class="at">data =</span> mydataSDT)</span>
<span id="cb380-8"><a href="#cb380-8"></a></span>
<span id="cb380-9"><a href="#cb380-9"></a><span class="fu">vif</span>(collinearRegression_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                       GVIF Df GVIF^(1/(2*Df))
ndka               6.300087  1        2.509997
gender             1.149601  1        1.072194
age                1.127608  1        1.061889
wfns               1.207583  4        1.023858
collinearPredictor 6.405020  1        2.530814</code></pre>
</div>
</div>
<p>To address multicollinearity, you can drop a redundant predictor or you can also use <a href="factor-analysis-pca.html#sec-pca">principal component analysis</a> or <a href="factor-analysis-pca.html#sec-factorAnalysis">factor analysis</a> of the predictors to reduce the predictors down to a smaller number of meaningful predictors. For a meaningful answer in a regression framework that is precise and confident, you need a low level of intercorrelation among predictors, unless you have a very large sample size.</p>
<p>However, multicollinearity does not bias parameter estimates (i.e., multicollinearity does not lead to <a href="#sec-meanError">mean error</a>). Instead, <a href="https://janhove.github.io/analysis/2019/09/11/collinearity">multicollinearity increases the uncertainty (i.e., standard errors) around the parameter estimates</a> (archived at <a href="https://perma.cc/DJ7L-TCUK" class="uri">https://perma.cc/DJ7L-TCUK</a>), which makes it more challenging to detect an effect as statistically significant. <a href="https://statisticalhorizons.com/multicollinearity/">Some forms of multicollinearity are ignorable</a> (archived at <a href="https://perma.cc/2JV5-2QEZ" class="uri">https://perma.cc/2JV5-2QEZ</a>), including when the multicollinearity is among (a) the control variables rather than the variables of interest, (b) the powers (e.g., quadratic term) or products (e.g., interaction term) of other variables, or (c) dummy-coded categories. Ultimately, <a href="https://janhove.github.io/analysis/2019/09/11/collinearity">it is important to examine the question of interest, even if that means inclusion of predictors that are inter-correlated in a regression model</a> (archived at <a href="https://perma.cc/DJ7L-TCUK" class="uri">https://perma.cc/DJ7L-TCUK</a>). However, it would not make sense to include two predictors that are perfectly correlated, because they are redundant.</p>
</section></section><section id="sec-waysToImprovePredictionAccuracy" class="level2" data-number="9.10"><h2 data-number="9.10" class="anchored" data-anchor-id="sec-waysToImprovePredictionAccuracy">
<span class="header-section-number">9.10</span> Ways to Improve Prediction Accuracy</h2>
<p>On the whole, experts’ predictions are inaccurate. Experts’ predictions from many different domains tend to be inaccurate, including political scientists <span class="citation" data-cites="Tetlock2017">(<a href="references.html#ref-Tetlock2017" role="doc-biblioref">Tetlock, 2017</a>)</span>, physicians <span class="citation" data-cites="Koehler2002">(<a href="references.html#ref-Koehler2002" role="doc-biblioref">Koehler et al., 2002</a>)</span>, clinical psychologists <span class="citation" data-cites="Oskamp1965">(<a href="references.html#ref-Oskamp1965" role="doc-biblioref">Oskamp, 1965</a>)</span>, stock market traders and corporate financial officers <span class="citation" data-cites="Skala2008">(<a href="references.html#ref-Skala2008" role="doc-biblioref">Skala, 2008</a>)</span>, seismologists’ predictions of earthquakes <span class="citation" data-cites="Hough2016">(<a href="references.html#ref-Hough2016" role="doc-biblioref">Hough, 2016</a>)</span>, economists’ predictions about the economy <span class="citation" data-cites="Makridakis2009">(<a href="references.html#ref-Makridakis2009" role="doc-biblioref">Makridakis et al., 2009</a>)</span>, lawyers <span class="citation" data-cites="Koehler2002">(<a href="references.html#ref-Koehler2002" role="doc-biblioref">Koehler et al., 2002</a>)</span>, and business managers <span class="citation" data-cites="Russo1992">(<a href="references.html#ref-Russo1992" role="doc-biblioref">Russo &amp; Schoemaker, 1992</a>)</span>. The most common pattern of experts’ predictions is that they show overextremity, that is, their predictions have probability judgments that tend to be too extreme, as described in <a href="#sec-calibration" class="quarto-xref"><span>Section 9.4.3</span></a>. Overextremity of experts’ predictions likely reflects over-confidence. The degree of confidence of a person’s predictions is often not a good indicator of the accuracy of their predictions [and confidence and prediction accuracy are sometimes inversely associated; <span class="citation" data-cites="Silver2012">Silver (<a href="references.html#ref-Silver2012" role="doc-biblioref">2012</a>)</span>]. Cognitive biases including the anchoring bias <span class="citation" data-cites="Tversky1974">(<a href="references.html#ref-Tversky1974" role="doc-biblioref">Tversky &amp; Kahneman, 1974</a>)</span>, the confirmation bias <span class="citation" data-cites="Hoch1985 Koriat1980">(<a href="references.html#ref-Hoch1985" role="doc-biblioref">Hoch, 1985</a>; <a href="references.html#ref-Koriat1980" role="doc-biblioref">Koriat et al., 1980</a>)</span>, and <a href="#sec-baseRate">base rate</a> neglect <span class="citation" data-cites="Eddy1982 Koehler2002">(<a href="references.html#ref-Eddy1982" role="doc-biblioref">Eddy, 1982</a>; <a href="references.html#ref-Koehler2002" role="doc-biblioref">Koehler et al., 2002</a>)</span> could contribute to over-confidence of predictions. <a href="#sec-calibration">Poorly calibrated</a> predictions are especially likely when the <a href="#sec-baseRate">base rate</a> is very low (e.g., suicide), as is often the case in clinical psychology, or when the <a href="#sec-baseRate">base rate</a> is very high <span class="citation" data-cites="Koehler2002">(<a href="references.html#ref-Koehler2002" role="doc-biblioref">Koehler et al., 2002</a>)</span>.</p>
<p>Nevertheless, there are some domains that have shown greater predictive accuracy, from which we may learn what practices may lead to greater accuracy. For instance, experts have shown stronger predictive accuracy in weather forecasting <span class="citation" data-cites="Murphy1984">(<a href="references.html#ref-Murphy1984" role="doc-biblioref">Murphy &amp; Winkler, 1984</a>)</span>, horse race betting <span class="citation" data-cites="Johnson2001">(<a href="references.html#ref-Johnson2001" role="doc-biblioref">Johnson &amp; Bruce, 2001</a>)</span>, and playing the card game of bridge <span class="citation" data-cites="Keren1987">(<a href="references.html#ref-Keren1987" role="doc-biblioref">Keren, 1987</a>)</span>, but see <span class="citation" data-cites="Koehler2002">Koehler et al. (<a href="references.html#ref-Koehler2002" role="doc-biblioref">2002</a>)</span> for exceptions.</p>
<p>Here are some potential ways to improve the accuracy (and honesty) of predictions and judgments:</p>
<ul>
<li>Provide appropriate anchoring of your predictions to the <a href="#sec-baseRate">base rate</a> of the phenomenon you are predicting. To the extent that the <a href="#sec-baseRate">base rate</a> of the event you are predicting is low, more extreme evidence should be necessary to consistently and accurately predict that the event will occur. Applying <a href="#sec-bayesTheorem">Bayes’ theorem</a> and Bayesian approaches can help you appropriately weigh <a href="#sec-baseRate">base rate</a> and evidence.</li>
<li>Include multiple predictors, ideally from different measures and measurement methods. Include the predictors with the strongest validity based on theory of the causal process and based on <a href="validity.html#sec-criterionValidity">criterion-related validity</a>.</li>
<li>When possible, aggregate multiple perspectives of predictions, especially predictions made independently (from different people/methods/etc.). The “wisdom of the crowd” is often more accurate than individuals’ predictions, including predictions by so-called “experts” <span class="citation" data-cites="Silver2012">(<a href="references.html#ref-Silver2012" role="doc-biblioref">Silver, 2012</a>)</span>.</li>
<li>Instead of aggregating scores from multi-item scales, another option is to “unamalgamate” the predictors, that is, to use each item in the scale as a separate predictor, to maximize predictive power <span class="citation" data-cites="TrafimowInPress">(<a href="references.html#ref-TrafimowInPress" role="doc-biblioref">Trafimow et al., in press</a>)</span>.</li>
<li>A goal of prediction is to capture as much signal as possible and as little noise (error) as possible <span class="citation" data-cites="Silver2012">(<a href="references.html#ref-Silver2012" role="doc-biblioref">Silver, 2012</a>)</span>. Parsimony (i.e., not having too many predictors) can help reduce the amount of error variance captured by the prediction model. However, to accurately model complex systems like human behavior, the brain, etc., complex models may be necessary. Nevertheless, strong theory of the causal processes and dynamics may be necessary to develop accurate complex models.</li>
<li>Although incorporating theory can be helpful, provide more weight to empiricism than to theory, until our theories and measures are stronger. Ideally, we would use theory to design a model that mirrors the causal system, with accurate measures of each process in the system, so we could make accurate predictions. However, as described in <a href="validity.html#sec-theoryEmpiricism" class="quarto-xref"><span>Section 5.3.1.3.3</span></a>, our psychological theories of the causal processes that influence outcomes are not yet very strong. Until we have stronger theories that specify the causal process for a given outcome, and until we have accurate measures of those causal processes, <a href="clinical-actuarial-judgment.html#sec-actuarialPrediction">actuarial</a> approaches are likely to be most accurate, as discussed in <a href="clinical-actuarial-judgment.html" class="quarto-xref"><span>Chapter 10</span></a>. At the same time, keep in mind that measures in psychology, and their resulting data, are often noisy. As a result, theoretically (conceptually) informed empirical approaches may lead to more accuracy than empiricism alone.</li>
<li>Use an empirically validated and cross-validated <a href="clinical-actuarial-judgment.html">statistical algorithm</a> to combine information from the predictors in a formalized way. Give each predictor appropriate weight in the statistical algorithm, according to its strength of association with the outcome. Use measures with strong <a href="reliability.html">reliability</a> and <a href="validity.html">validity</a> for assessing these processes to be used in the algorithm. Cross-validation will help reduce the likelihood that your model is fitting to noise and will maximize the likelihood that the model predicts accurately when applied to new data (i.e., the model’s predictions accurately generalize), as described in <a href="clinical-actuarial-judgment.html#sec-modelAccuracy-actuarial" class="quarto-xref"><span>Section 10.4</span></a>.</li>
<li>When presenting your predictions, acknowledge what you do not know.</li>
<li>Express your predictions in terms of probabilistic estimates and present the uncertainty in your predictions with confidence intervals [even though bolder, more extreme predictions tend to receive stronger television ratings; <span class="citation" data-cites="Silver2012">Silver (<a href="references.html#ref-Silver2012" role="doc-biblioref">2012</a>)</span>].</li>
<li>Qualify your predictions by identifying and noting counter-examples that would not be well fit by your prediction model, such as extreme cases, edge cases, and “broken leg” <span class="citation" data-cites="Meehl1957">(<a href="references.html#ref-Meehl1957" role="doc-biblioref">Meehl, 1957</a>)</span> cases.</li>
<li>Provide clear, consistent, and timely feedback on the outcomes of the predictions to the people making the predictions <span class="citation" data-cites="Bolger2004">(<a href="references.html#ref-Bolger2004" role="doc-biblioref">Bolger &amp; Önkal-Atay, 2004</a>)</span>.</li>
<li>Be self-critical about your predictions. Update your judgments based on their accuracy, rather than trying to confirm your beliefs <span class="citation" data-cites="Atanasov2020">(<a href="references.html#ref-Atanasov2020" role="doc-biblioref">Atanasov et al., 2020</a>)</span>.</li>
<li>In addition to considering the accuracy of the prediction, consider the quality of the prediction <em>process</em>, especially when random chance is involved to a degree (such as in poker) <span class="citation" data-cites="Silver2012">(<a href="references.html#ref-Silver2012" role="doc-biblioref">Silver, 2012</a>)</span>.</li>
<li>Work to identify and mitigate potential blindspots; be aware of cognitive biases, such as confirmation bias and <a href="#sec-baseRate">base rate</a> neglect.</li>
<li>Evaluate for the possibility of <a href="test-bias.html">bias</a> in the predictions or in the tests from which the predictions are derived. Correct for any <a href="test-bias.html">test bias</a>.</li>
</ul></section><section id="sec-conclusion-prediction" class="level2" data-number="9.11"><h2 data-number="9.11" class="anchored" data-anchor-id="sec-conclusion-prediction">
<span class="header-section-number">9.11</span> Conclusion</h2>
<p>Human behavior is challenging to predict. People commonly make cognitive pseudo-prediction errors, such as the <a href="#sec-inverseFallacy">confusion of inverse probabilities</a>. People also tend to ignore <a href="#sec-baseRate">base rates</a> when making predictions. When the <a href="#sec-baseRate">base rate</a> of a behavior is very low or very high, you can be highly accurate in predicting the behavior by <a href="#sec-predictingFromBaseRate">predicting from the base rate</a>. Thus, you cannot judge how accurate your prediction is until you know how accurate your predictions would be by <a href="#sec-accuracyByChance">random chance</a>. Moreover, maximizing <a href="#sec-percentAccuracy">percent accuracy</a> may not be the ultimate goal because <a href="#sec-differentErrorsDifferentCosts">different errors have different costs</a>. Though there are many types of accuracy, there are two broad types: <a href="#sec-discrimination">discrimination</a> and <a href="#sec-calibration">calibration</a>—and they are orthogonal. <a href="#sec-discrimination">Discrimination</a> accuracy is frequently evaluated with the <a href="#sec-auc">area under the receiver operating characteristic curve</a>, or with <a href="#sec-sensitivity">sensitivity</a> and <a href="#sec-specificity">specificity</a>, or <a href="#sec-standardizedRegressionCoefficient">standardized regression coefficients</a>. <a href="#sec-calibration">Calibration</a> accuracy is frequently evaluated graphically and with various indices. <a href="#sec-sensitivity">Sensitivity</a> and <a href="#sec-specificity">specificity</a> <a href="#sec-accuracyCutoff">depend on the cutoff</a>. Therefore, the <a href="#sec-optimalCutoff">optimal cutoff</a> depends on the purposes of the assessment and how much one weights the various costs of the different types of errors: <a href="#sec-falseNegative">false negatives</a> and <a href="#sec-falsePositive">false positives</a>. It is important to evaluate both <a href="#sec-discrimination">discrimination</a> and <a href="#sec-calibration">calibration</a> when evaluating prediction accuracy.</p>
</section><section id="sec-readings-prediction" class="level2" data-number="9.12"><h2 data-number="9.12" class="anchored" data-anchor-id="sec-readings-prediction">
<span class="header-section-number">9.12</span> Suggested Readings</h2>
<p><span class="citation" data-cites="Steyerberg2010">Steyerberg et al. (<a href="references.html#ref-Steyerberg2010" role="doc-biblioref">2010</a>)</span>; <span class="citation" data-cites="Meehl1955">Meehl &amp; Rosen (<a href="references.html#ref-Meehl1955" role="doc-biblioref">1955</a>)</span>; <span class="citation" data-cites="Treat2023">Treat &amp; Viken (<a href="references.html#ref-Treat2023" role="doc-biblioref">2023</a>)</span>; <span class="citation" data-cites="Wiggins1973">Wiggins (<a href="references.html#ref-Wiggins1973" role="doc-biblioref">1973</a>)</span></p>
</section><section id="sec-exercises-prediction" class="level2" data-number="9.13"><h2 data-number="9.13" class="anchored" data-anchor-id="sec-exercises-prediction">
<span class="header-section-number">9.13</span> Exercises</h2>
<section id="sec-exercisesQuestions-prediction" class="level3" data-number="9.13.1"><h3 data-number="9.13.1" class="anchored" data-anchor-id="sec-exercisesQuestions-prediction">
<span class="header-section-number">9.13.1</span> Questions</h3>
<p>Note: Several of the following questions use data from the survivorship of the Titanic accident. The data are publicly available (<a href="https://hbiostat.org/data/" class="uri">https://hbiostat.org/data/</a>; archived at <a href="https://perma.cc/B4AV-YH4V" class="uri">https://perma.cc/B4AV-YH4V</a>). The Titanic data file for these exercises is located on the book’s page of the Open Science Framework (<a href="https://osf.io/3pwza" class="uri">https://osf.io/3pwza</a>) and in the GitHub repo (<a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/tree/main/Data" class="uri">https://github.com/isaactpetersen/Principles-Psychological-Assessment/tree/main/Data</a>). Every record in the data set represents a passenger—including the passenger’s age, sex, passenger class, number of siblings/spouses aboard (<code>sibsp</code>), number of parents/children aboard (<code>parch</code>) and, whether the passenger survived the accident. I used these variables to create a prediction model (based on a logistic regression model using Leave-10-out cross-validation) for whether the passenger survived the accident. The model’s prediction for the passenger’s likelihood of survival are in the variable called “prediction”.</p>
<ol type="1">
<li>What are the two main types of prediction accuracy? Define each. How can you quantify each? What is an example of an index that combines both main types of prediction accuracy?</li>
<li>Provide the following indexes of overall prediction accuracy for the prediction model in predicting whether a passenger survived the Titanic:
<ol type="a">
<li>Mean error (bias)</li>
<li>Mean absolute error (MAE)</li>
<li>Mean squared error (MSE)</li>
<li>Root mean squared error (RMSE)</li>
<li>Mean percentage error (MPE)</li>
<li>Mean absolute percentage error (MAPE)</li>
<li>Symmetric mean absolute percentage error (sMAPE)</li>
<li>Mean absolute scaled error (MASE)</li>
<li>Root mean squared log error (RMSLE)</li>
<li>Coefficient of determination (<span class="math inline">\(R^2\)</span>)</li>
<li>Adjusted <span class="math inline">\(R^2\)</span> (<span class="math inline">\(R^2_{adj}\)</span>)</li>
<li>Predictive <span class="math inline">\(R^2\)</span>
</li>
</ol>
</li>
<li>Based on the mean error for the prediction model you found in <code>2a</code>, what does this indicate?</li>
<li>Create two receiver operating characteristic (ROC) curves for the prediction model in predicting whether a passenger survived the Titanic: one empirical ROC curve and one smooth ROC curve.</li>
<li>What is the area under the ROC curve (AUC) for the prediction model in predicting whether a passenger survived the Titanic? What does this indicate?</li>
<li>Create a calibration plot. Are the predictions well-calibrated? Provide empirical evidence and support your inferences with interpretation of the calibration plot. If the predictions are miscalibrated, describe the type of miscalibration present.</li>
<li>You predict that a passenger survived the Titanic if their predicted probability of survival is .50 or greater. Create a confusion matrix (2x2 matrix of prediction accuracy) for Titanic survival using this threshold. Make sure to include the marginal cells. Label each cell. Enter the number and proportion in each cell.</li>
<li>Using the 2x2 prediction matrix, identify or calculate the following:
<ol type="a">
<li>Selection ratio</li>
<li>Base rate</li>
<li>Percent accuracy</li>
<li>Percent accuracy by chance</li>
<li>Percent accuracy predicting from the base rate</li>
<li>Relative improvement over chance (ROIC)</li>
<li>Relative improvement over predicting from the base rate</li>
<li>Sensitivity (true positive rate [TPR])</li>
<li>Specificity (true negative rate [TNR])</li>
<li>False negative rate (FNR)</li>
<li>False positive rate (FPR)</li>
<li>Positive predictive value (PPV)</li>
<li>Negative predictive value (NPV)</li>
<li>False discovery rate (FDR)</li>
<li>False omission rate (FOR)</li>
<li>Diagnostic odds ratio</li>
<li>Youden’s J statistic</li>
<li>Balanced accuracy</li>
<li>
<span class="math inline">\(F_1\)</span> score</li>
<li>Matthews correlation coefficient (MCC)</li>
<li>Positive likelihood ratio</li>
<li>Negative likelihood ratio</li>
<li>
<span class="math inline">\(d'\)</span> sensitivity</li>
<li>
<span class="math inline">\(A\)</span> (non-parametric) sensitivity</li>
<li>
<span class="math inline">\(\beta\)</span> bias</li>
<li>
<span class="math inline">\(c\)</span> bias<br>
aa. <span class="math inline">\(b\)</span> (non-parametric) bias<br>
ab. Miscalibration (mean difference between predicted and observed values; based on 10 groups)<br>
ac. Information gain</li>
</ol>
</li>
<li>In terms of percent accuracy, how much more accurate are the predictions compared to predicting from the base rate? What would happen to sensitivity and specificity if you raise the selection ratio? What would happen if you lower the selection ratio?</li>
<li>For your assessment goals, it is 4 times more important to identify survivors than to identify non-survivors. Consistent with these assessment goals, you specify the following utility for each of the four outcomes: hits: 1; misses: 0; correct rejections: 0.25; false alarms: 0. What is the utility ratio? What is the overall utility (<span class="math inline">\(U_\text{overall}\)</span>) of the current cutoff? What cutoff has the highest overall utility?</li>
<li>Find the optimal cutoff threshold that optimizes each of the following criteria:
<ol type="a">
<li>Youden’s J statistic</li>
<li>Closest to the top left of the ROC curve</li>
<li>Percent accuracy</li>
<li>Percent accuracy by chance</li>
<li>Relative improvement over chance (ROIC)</li>
<li>Relative improvement over predicting from the base rate</li>
<li>Sensitivity (true positive rate [TPR])</li>
<li>Specificity (true negative rate [TNR])</li>
<li>Positive predictive value (PPV)</li>
<li>Negative predictive value (NPV)</li>
<li>Diagnostic odds ratio</li>
<li>Balanced accuracy</li>
<li>
<span class="math inline">\(F_1\)</span> score</li>
<li>Matthews correlation coefficient (MCC)</li>
<li>Positive likelihood ratio</li>
<li>Negative likelihood ratio</li>
<li>
<span class="math inline">\(d'\)</span> sensitivity</li>
<li>
<span class="math inline">\(A\)</span> (non-parametric) sensitivity</li>
<li>
<span class="math inline">\(\beta\)</span> bias</li>
<li>
<span class="math inline">\(c\)</span> bias</li>
<li>
<span class="math inline">\(b\)</span> (non-parametric) bias</li>
<li>Miscalibration (mean difference between predicted and observed values; based on 10 groups)</li>
<li>Overall utility</li>
<li>Information gain</li>
</ol>
</li>
<li>A company develops a test that seeks to determine whether someone has been previously infected with a novel coronavirus (COVID-75) based on the presence of antibodies in their blood. You take the test and your test result is negative (i.e., the test says that you have not been infected). Your friend takes the test and their test result is positive for coronavirus (i.e., the test says that your friend has been infected). Assume the prevalence of the coronavirus is 5%, the sensitivity of the test is .90, and the specificity of the test is .95.
<ol type="a">
<li>What is the probability that you actually had the coronavirus?</li>
<li>What is the probability that your friend actually had the coronavirus?</li>
<li>Your friend thinks that, given their positive test, that they have the antibodies (and thus may have immunity). What is the problem with your friend’s logic?</li>
<li>What logical fallacy is your friend demonstrating?</li>
<li>Why is it challenging to interpret a positive test in this situation?</li>
</ol>
</li>
<li>You just took a screening test for a genetic disease. Your test result is positive (i.e., the tests says that you have the disease). Assume the probability of having the disease is 0.5%, the probability of a positive test is 2%, and the probability of a positive test if you have the disease is 99%. What is the probability that you have the genetic disease?</li>
<li>You just took a screening test (Test A) for a virus. Your test result is positive. Assume the base rate of the virus is .05%. Test A has a sensitivity of .95 and a specificity of .90.
<ol type="a">
<li>What is your probability of having the virus after testing positive on Test A?</li>
<li>After getting the results back from Test A, the physician wants greater confidence regarding whether you have the virus given its low base rate, so the physician orders a second test, Test B. You test positive on Test B. Test B has a sensitivity of .80 and a specificity of .95. Assuming the errors of the Tests A and B are independent, what is your updated probability of having the virus?</li>
</ol>
</li>
</ol></section><section id="sec-exercisesAnswers-prediction" class="level3" data-number="9.13.2"><h3 data-number="9.13.2" class="anchored" data-anchor-id="sec-exercisesAnswers-prediction">
<span class="header-section-number">9.13.2</span> Answers</h3>
<ol type="1">
<li>The two main types of prediction accuracy are discrimination and calibration. Discrimination refers to the ability of a prediction model to separate/differentiate data into classes (e.g., survived versus died). Calibration for a prediction model refers to how well the predicted probability of an event (e.g., survival) matches the true probability of an event. You can quantify discrimination with AUC; you can quantify various aspects of discrimination with sensitivity, specificity, positive predictive value, and negative predictive value. You can quantify degree of (poor) calibration with Spiegelhalter’s <span class="math inline">\(z\)</span>, though other metrics also exist (e.g., Brier scores and the Hosmer-Lemeshow goodness-of-fit statistic). <span class="math inline">\(R^2\)</span> is an overall index of accuracy that combines both discrimination and calibration.</li>
<li><ol type="a">
<li>Mean error (bias): <span class="math inline">\(0.0006\)</span>
</li>
<li>Mean absolute error (MAE): <span class="math inline">\(0.30\)</span>
</li>
<li>Mean squared error (MSE): <span class="math inline">\(0.15\)</span>
</li>
<li>Root mean squared error (RMSE): <span class="math inline">\(0.39\)</span>
</li>
<li>Mean percentage error (MPE): undefined, but when dropping undefined values: <span class="math inline">\(36.74\%\)</span>
</li>
<li>Mean absolute percentage error (MAPE): undefined, but when dropping undefined values: <span class="math inline">\(36.74\%\)</span>
</li>
<li>Symmetric mean absolute percentage error (sMAPE): <span class="math inline">\(70.16\%\)</span>
</li>
<li>Mean absolute scaled error (MASE): <span class="math inline">\(0.62\)</span>
</li>
<li>Root mean squared log error (RMSLE): <span class="math inline">\(0.27\)</span>
</li>
<li>Coefficient of determination (<span class="math inline">\(R^2\)</span>): <span class="math inline">\(.37\)</span>
</li>
<li>Adjusted <span class="math inline">\(R^2\)</span> (<span class="math inline">\(R^2_{adj}\)</span>): <span class="math inline">\(.37\)</span>
</li>
<li>Predictive <span class="math inline">\(R^2\)</span>: <span class="math inline">\(.37\)</span>
</li>
</ol></li>
<li>The small mean error/bias <span class="math inline">\((0.0006)\)</span> indicates that predictions did not consistently under- or over-estimate the actual values to a considerable degree.</li>
<li>Empirical ROC curve:</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div id="fig-exercise-empiricalROC" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Exercise 4: Empirical Receiver Operating Characteristic Curve.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-exercise-empiricalROC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-exercise-empiricalROC-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36" title="Figure&nbsp;9.36: Exercise 4: Empirical Receiver Operating Characteristic Curve."><img src="prediction_files/figure-html/fig-exercise-empiricalROC-1.png" class="img-fluid figure-img" alt="Exercise 4: Empirical Receiver Operating Characteristic Curve." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-exercise-empiricalROC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.36: Exercise 4: Empirical Receiver Operating Characteristic Curve.
</figcaption></figure>
</div>
</div>
</div>
<p>Smooth ROC curve:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-exercise-smoothROC" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Exercise 4: Smooth Receiver Operating Characteristic Curve.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-exercise-smoothROC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-exercise-smoothROC-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37" title="Figure&nbsp;9.37: Exercise 4: Smooth Receiver Operating Characteristic Curve."><img src="prediction_files/figure-html/fig-exercise-smoothROC-1.png" class="img-fluid figure-img" alt="Exercise 4: Smooth Receiver Operating Characteristic Curve." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-exercise-smoothROC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.37: Exercise 4: Smooth Receiver Operating Characteristic Curve.
</figcaption></figure>
</div>
</div>
</div>
<ol start="5" type="1">
<li>The AUC is <span class="math inline">\(.84\)</span>. AUC indicates the probability that a randomly selected case has a higher test result than a randomly selected control. Thus, the probability is <span class="math inline">\(84\%\)</span> that a randomly selected passenger who survived had a higher predicted probability of survival (based on the prediction model) than a randomly selected passenger who died. The AUC of <span class="math inline">\(.84\)</span> indicates that the prediction model was moderately accurate in terms of discrimination.</li>
<li>Calibration plot:</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div id="fig-exercise-calibration" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Exercise 5: Calibration Plot of Predicted Probability Versus Observed Probability.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-exercise-calibration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="prediction_files/figure-html/fig-exercise-calibration-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38" title="Figure&nbsp;9.38: Exercise 5: Calibration Plot of Predicted Probability Versus Observed Probability."><img src="prediction_files/figure-html/fig-exercise-calibration-1.png" class="img-fluid figure-img" alt="Exercise 5: Calibration Plot of Predicted Probability Versus Observed Probability." width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-exercise-calibration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.38: Exercise 5: Calibration Plot of Predicted Probability Versus Observed Probability.
</figcaption></figure>
</div>
</div>
</div>
<ol start="6" type="1">
<li><p>In general, the predictions are well-calibrated. There is not significant miscalibration according to Spiegehalter’s <span class="math inline">\(z\)</span> <span class="math inline">\((0.31, p = .76)\)</span>. This is verified graphically in the calibration plot, in which the predicted probabilities fall mostly near the actual/observed probabilities. However, based on the calibration plot, there does appear to be some miscalibration. When the predicted probability of survival was ~60%, the actual probability of survival was lower (~40%). This pattern of miscalibration is known as overprediction, as depicted in Figure 1 of <span class="citation" data-cites="Lindhiem2020">Lindhiem et al. (<a href="references.html#ref-Lindhiem2020" role="doc-biblioref">2020</a>)</span>.</p></li>
<li><p>The 2x2 prediction matrix is below:</p></li>
</ol>
<div id="fig-twoByTwoMatrix" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Exercise 6: 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-twoByTwoMatrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/2x2-Matrix.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39" title="Figure&nbsp;9.39: Exercise 6: 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio."><img src="images/2x2-Matrix.png" class="img-fluid figure-img" style="width:100.0%" alt="Exercise 6: 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoByTwoMatrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.39: Exercise 6: 2x2 Prediction Matrix. TP = true positives; TN = true negatives; FP = false positives; FN = false negatives; BR = base rate; SR = selection ratio.
</figcaption></figure>
</div>
<ol start="8" type="1">
<li><ol type="a">
<li>Selection ratio: <span class="math inline">\(.39\)</span>
</li>
<li>Base rate: <span class="math inline">\(.41\)</span>
</li>
<li>Percent accuracy: <span class="math inline">\(77\%\)</span>
</li>
<li>Percent accuracy by chance: <span class="math inline">\(52\%\)</span>
</li>
<li>Percent accuracy predicting from the base rate: <span class="math inline">\(59\%\)</span>
</li>
<li>Relative improvement over chance (ROIC): <span class="math inline">\(.51\)</span>
</li>
<li>Relative improvement over predicting from the base rate: <span class="math inline">\(.22\)</span>
</li>
<li>Sensitivity (true positive rate [TPR]): <span class="math inline">\(.70\)</span>
</li>
<li>Specificity (true negative rate [TNR]): <span class="math inline">\(.83\)</span>
</li>
<li>False negative rate (FNR): <span class="math inline">\(.30\)</span>
</li>
<li>False positive rate (FPR): <span class="math inline">\(.17\)</span>
</li>
<li>Positive predictive value (PPV): <span class="math inline">\(.73\)</span>
</li>
<li>Negative predictive value (NPV): <span class="math inline">\(.80\)</span>
</li>
<li>False discovery rate (FDR): <span class="math inline">\(.27\)</span>
</li>
<li>False omission rate (FOR): <span class="math inline">\(.20\)</span>
</li>
<li>Diagnostic odds ratio: <span class="math inline">\(11.05\)</span>
</li>
<li>Youden’s J statistic: <span class="math inline">\(.53\)</span>
</li>
<li>Balanced accuracy: <span class="math inline">\(.76\)</span>
</li>
<li>
<span class="math inline">\(F_1\)</span> score: <span class="math inline">\(0.72\)</span>
</li>
<li>Matthews correlation coefficient (MCC): <span class="math inline">\(.53\)</span>
</li>
<li>Positive likelihood ratio: <span class="math inline">\(4.01\)</span>
</li>
<li>Negative likelihood ratio: <span class="math inline">\(0.36\)</span>
</li>
<li>
<span class="math inline">\(d'\)</span> sensitivity: <span class="math inline">\(1.46\)</span>
</li>
<li>
<span class="math inline">\(A\)</span> (non-parametric) sensitivity: <span class="math inline">\(0.83\)</span>
</li>
<li>
<span class="math inline">\(\beta\)</span> bias: <span class="math inline">\(1.35\)</span>
</li>
<li>
<span class="math inline">\(c\)</span> bias: <span class="math inline">\(0.21\)</span> aa. <span class="math inline">\(b\)</span> (non-parametric) bias: <span class="math inline">\(1.30\)</span> ab. Miscalibration (mean difference between predicted and observed values): <span class="math inline">\(0.16\)</span> ac. Information gain: <span class="math inline">\(0.21\)</span>
</li>
</ol></li>
<li><p>Predicting from the base rate would have a percent accuracy of <span class="math inline">\(59\%\)</span>. So, the predictions increase the percent accuracy by <span class="math inline">\(18\%\)</span>. If you raise the selection ratio (i.e., predict more people survived) sensitivity will increase whereas specificity will decrease. If you lower the selection ratio, specificity will increase and sensitivity will decrease.</p></li>
<li><p>The utility ratio is <span class="math inline">\(0.25\)</span>. The overall utility (<span class="math inline">\(U_\text{overall}\)</span>) of the cutoff is <span class="math inline">\(0.41\)</span>. The cutoff with the highest overall utility is <span class="math inline">\(0.266\)</span>.</p></li>
<li>
<p>The cutoff that optimizes each of the following criteria:</p>
<ol type="a">
<li>Youden’s J statistic: <span class="math inline">\(0.556\)</span>
</li>
<li>Closest to the top left of the ROC curve: <span class="math inline">\(0.391\)</span>
</li>
<li>Percent accuracy: <span class="math inline">\(0.618\)</span>
</li>
<li>Percent accuracy by chance: 1 (i.e., predicting from the base rate—that nobody will survive)</li>
<li>Relative improvement over chance (ROIC): <span class="math inline">\(.017, .023, .027, .031, .032, .035, .035, .035, .038, .039\)</span>
</li>
<li>Relative improvement over predicting from the base rate: <span class="math inline">\(.618\)</span>
</li>
<li>Sensitivity (true positive rate [TPR]): 0 (i.e., predicting that everyone will survive will minimize false negatives)</li>
<li>Specificity: 1 (i.e., predicting that nobody will survive will minimize false positives)</li>
<li>Positive predictive value (PPP): <span class="math inline">\(0.875\)</span>
</li>
<li>Negative predictive value (NPV): <span class="math inline">\(0.017, 0.023, 0.027, 0.031, 0.032, 0.035, 0.035, 0.035, 0.038, 0.039\)</span>
</li>
<li>Diagnostic odds ratio: <span class="math inline">\(0.875\)</span>
</li>
<li>Balanced accuracy: <span class="math inline">\(0.556\)</span>
</li>
<li>
<span class="math inline">\(F_1\)</span> score: <span class="math inline">\(0.391\)</span>
</li>
<li>Matthews correlation coefficient (MCC): <span class="math inline">\(0.618\)</span>
</li>
<li>Positive likelihood ratio: <span class="math inline">\(0.875\)</span>
</li>
<li>Negative likelihood ratio: <span class="math inline">\(0.017, 0.023, 0.027, 0.031, 0.032, 0.035, 0.035, 0.035, 0.038, 0.039\)</span>
</li>
<li>Miscalibration (mean difference between predicted and observed values): <span class="math inline">\(0.017–0.085\)</span>
</li>
<li>
<span class="math inline">\(d'\)</span> sensitivity: <span class="math inline">\(0.833\)</span>
</li>
<li>
<span class="math inline">\(A\)</span> (non-parametric) sensitivity <span class="math inline">\(0.316\)</span>
</li>
<li>
<span class="math inline">\(\beta\)</span> bias <span class="math inline">\(0.017, 0.023, 0.027, 0.031, 0.032, 0.035, 0.035, 0.035, 0.038, 0.039, 0.979\)</span>
</li>
<li>
<span class="math inline">\(c\)</span> bias <span class="math inline">\(0.387\)</span>
</li>
<li>
<span class="math inline">\(b\)</span> (non-parametric) bias <span class="math inline">\(0.017\)</span>
</li>
<li>Overall utility: <span class="math inline">\(0.266\)</span>
</li>
<li>Information gain: <span class="math inline">\(0.631\)</span>
</li>
</ol>
</li>
<li><ol type="a">
<li>Based on negative predictive value (i.e., the probability of no disease given a negative test), the probability that you actually had the coronavirus is less than 1 in 100 <span class="math inline">\((.006)\)</span>.</li>
<li>Based on positive predictive value (i.e., the probability of disease given a positive test), the probability that your friend actually had the coronavirus is less than 50% <span class="math inline">\((.49)\)</span>.</li>
<li>The problem with your friend’s logic is that your friend is assuming they have the antibodies when chances are more likely that they do not.</li>
<li>Your friend is likely demonstrating the fallacy of base rate neglect.</li>
<li>A positive test on a screening device is hard to interpret in this situation because of the low base rate. “Even with a very accurate test, the fewer people in a population who have a condition, the more likely it is that an individual’s positive result is wrong.” For more info, see here: <a href="https://www.scientificamerican.com/article/coronavirus-antibody-tests-have-a-mathematical-pitfall/" class="uri">https://www.scientificamerican.com/article/coronavirus-antibody-tests-have-a-mathematical-pitfall/</a> (archived at <a href="https://perma.cc/GL9F-EVPH" class="uri">https://perma.cc/GL9F-EVPH</a>)</li>
</ol></li>
<li><p>According to Bayes’ theorem, the probability that you have the disease is <span class="math inline">\(24.75\%\)</span>. For more info, see here: <a href="https://www.scientificamerican.com/article/what-is-bayess-theorem-an/" class="uri">https://www.scientificamerican.com/article/what-is-bayess-theorem-an/</a> (archived at <a href="https://perma.cc/GM6B-5MEP" class="uri">https://perma.cc/GM6B-5MEP</a>)</p></li>
<li><ol type="a">
<li>According to Bayes’ theorem, the probability that you have the virus after testing positive on Test A is <span class="math inline">\(4.6\%\)</span>.</li>
<li>According to Bayes’ theorem, the updated probability that you have the virus after testing positive on both Tests A and B is <span class="math inline">\(43.3\%\)</span>.</li>
</ol></li>
</ol></section></section><section id="sec-sessionInfo-prediction" class="level2" data-number="9.14"><h2 data-number="9.14" class="anchored" data-anchor-id="sec-sessionInfo-prediction">
<span class="header-section-number">9.14</span> Session Info</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb382"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] knitr_1.50              rmarkdown_2.30          tinytex_0.58           
 [4] here_1.0.2              MOTE_1.2.2              caret_7.0-1            
 [7] lattice_0.22-7          ggrepel_0.9.6           car_3.1-3              
[10] carData_3.0-5           msir_1.3.3              ggpubr_0.6.2           
[13] gridExtra_2.3           uroc_0.1.0              PredictABEL_1.2-4      
[16] ResourceSelection_0.3-6 rms_8.1-0               Hmisc_5.2-4            
[19] ROCR_1.0-11             pROC_1.19.0.1           viridis_0.6.5          
[22] viridisLite_0.4.2       magrittr_2.0.4          lubridate_1.9.4        
[25] forcats_1.0.1           stringr_1.6.0           dplyr_1.1.4            
[28] purrr_1.2.0             readr_2.1.6             tidyr_1.3.2            
[31] tibble_3.3.0            ggplot2_4.0.1           tidyverse_2.0.0        
[34] petersenlab_1.2.2      

loaded via a namespace (and not attached):
  [1] RColorBrewer_1.1-3   rstudioapi_0.17.1    jsonlite_2.0.0      
  [4] TH.data_1.1-5        farver_2.1.2         nloptr_2.2.1        
  [7] vctrs_0.6.5          minqa_1.2.8          base64enc_0.1-3     
 [10] rstatix_0.7.3        polynom_1.4-1        htmltools_0.5.9     
 [13] polspline_1.1.25     broom_1.0.11         Formula_1.2-5       
 [16] parallelly_1.46.0    htmlwidgets_1.6.4    plyr_1.8.9          
 [19] sandwich_3.1-1       zoo_1.8-15           lifecycle_1.0.4     
 [22] iterators_1.0.14     pkgconfig_2.0.3      Matrix_1.7-4        
 [25] R6_2.6.1             fastmap_1.2.0        future_1.68.0       
 [28] rbibutils_2.4        PBSmodelling_2.70.2  digest_0.6.39       
 [31] colorspace_2.1-2     rprojroot_2.1.1      labeling_0.4.3      
 [34] timechange_0.3.0     mgcv_1.9-3           abind_1.4-8         
 [37] compiler_4.5.2       bit64_4.6.0-1        withr_3.0.2         
 [40] htmlTable_2.4.3      S7_0.2.1             backports_1.5.0     
 [43] DBI_1.2.3            psych_2.5.6          ggsignif_0.6.4      
 [46] animation_2.8        lava_1.8.2           MASS_7.3-65         
 [49] quantreg_6.1         ModelMetrics_1.2.2.2 tools_4.5.2         
 [52] pbivnorm_0.6.0       foreign_0.8-90       future.apply_1.20.1 
 [55] nnet_7.3-20          glue_1.8.0           quadprog_1.5-8      
 [58] nlme_3.1-168         checkmate_2.3.3      cluster_2.1.8.1     
 [61] reshape2_1.4.5       generics_0.1.4       recipes_1.3.1       
 [64] gtable_0.3.6         tzdb_0.5.0           class_7.3-23        
 [67] data.table_1.17.8    hms_1.1.4            foreach_1.5.2       
 [70] pillar_1.11.1        vroom_1.6.7          mitools_2.4         
 [73] splines_4.5.2        bit_4.6.0            survival_3.8-3      
 [76] SparseM_1.84-2       tidyselect_1.2.1     mix_1.0-13          
 [79] reformulas_0.4.3     stats4_4.5.2         xfun_0.55           
 [82] hardhat_1.4.2        timeDate_4051.111    stringi_1.8.7       
 [85] yaml_2.3.12          boot_1.3-32          evaluate_1.0.5      
 [88] codetools_0.2-20     tcltk_4.5.2          cli_3.6.5           
 [91] rpart_4.1.24         xtable_1.8-4         Rdpack_2.6.4        
 [94] lavaan_0.6-20        Rcpp_1.1.0           globals_0.18.0      
 [97] XML_3.99-0.20        parallel_4.5.2       MatrixModels_0.5-4  
[100] gower_1.0.2          mclust_6.1.2         listenv_0.10.0      
[103] lme4_1.1-38          mvtnorm_1.3-3        ipred_0.9-15        
[106] prodlim_2025.04.28   scales_1.4.0         crayon_1.5.3        
[109] rlang_1.1.6          multcomp_1.4-29      mnormt_2.1.1        </code></pre>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Atanasov2020" class="csl-entry" role="listitem">
Atanasov, P., Witkowski, J., Ungar, L., Mellers, B., &amp; Tetlock, P. (2020). Small steps to accuracy: Incremental belief updaters are better forecasters. <em>Organizational Behavior and Human Decision Processes</em>, <em>160</em>, 19–35. <a href="https://doi.org/10.1016/j.obhdp.2020.02.001">https://doi.org/10.1016/j.obhdp.2020.02.001</a>
</div>
<div id="ref-Austin2014" class="csl-entry" role="listitem">
Austin, P. C., &amp; Steyerberg, E. W. (2014). Graphical assessment of internal and external calibration of logistic regression models by using loess smoothers. <em>Statistics in Medicine</em>, <em>33</em>(3), 517–535. <a href="https://doi.org/10.1002/sim.5941">https://doi.org/10.1002/sim.5941</a>
</div>
<div id="ref-BallesterosPerez2018" class="csl-entry" role="listitem">
Ballesteros-Pérez, P., González-Cruz, M. C., &amp; Mora-Melià, D. (2018). Explaining the <span>Bayes’</span> theorem graphically. <em>Proceedings of the International Technology, Education and Development Conference</em>.
</div>
<div id="ref-Bickel2008" class="csl-entry" role="listitem">
Bickel, J. E., &amp; Kim, S. D. (2008). Verification of <span>T</span>he <span>W</span>eather <span>C</span>hannel probability of precipitation forecasts. <em>Monthly Weather Review</em>, <em>136</em>(12), 4867–4881. <a href="https://doi.org/10.1175/2008MWR2547.1">https://doi.org/10.1175/2008MWR2547.1</a>
</div>
<div id="ref-Bolger2004" class="csl-entry" role="listitem">
Bolger, F., &amp; Önkal-Atay, D. (2004). The effects of feedback on judgmental interval predictions. <em>International Journal of Forecasting</em>, <em>20</em>(1), 29–39. <a href="https://doi.org/10.1016/S0169-2070(03)00009-8">https://doi.org/10.1016/S0169-2070(03)00009-8</a>
</div>
<div id="ref-Charba1980" class="csl-entry" role="listitem">
Charba, J. P., &amp; Klein, W. H. (1980). Skill in precipitation forecasting in the <span>N</span>ational <span>W</span>eather <span>S</span>ervice. <em>Bulletin of the American Meteorological Society</em>, <em>61</em>(12), 1546–1555. <a href="https://doi.org/10.1175/1520-0477(1980)061<1546:SIPFIT>2.0.CO;2">https://doi.org/10.1175/1520-0477(1980)061&lt;1546:SIPFIT&gt;2.0.CO;2</a>
</div>
<div id="ref-Eddy1982" class="csl-entry" role="listitem">
Eddy, D. M. (1982). Probabilistic reasoning in clinical medicine: Problems and opportunities. In D. Kahneman, P. Slovic, &amp; A. Tversky (Eds.), <em>Judgment under uncertainty: Heuristics and biases</em> (pp. 249–267). Cambridge University Press.
</div>
<div id="ref-Farrington1989" class="csl-entry" role="listitem">
Farrington, D. P., &amp; Loeber, R. (1989). Relative improvement over chance (<span>RIOC</span>) and phi as measures of predictive efficiency and strength of association in 2×2 tables. <em>Journal of Quantitative Criminology</em>, <em>5</em>(3), 201–213. <a href="https://doi.org/10.1007/BF01062737">https://doi.org/10.1007/BF01062737</a>
</div>
<div id="ref-Farris2008" class="csl-entry" role="listitem">
Farris, C., Treat, T. A., Viken, R. J., &amp; McFall, R. M. (2008). Perceptual mechanisms that characterize gender differences in decoding women’s sexual intent. <em>Psychological Science</em>, <em>19</em>(4), 348–354. <a href="https://doi.org/10.1111/j.1467-9280.2008.02092.x">https://doi.org/10.1111/j.1467-9280.2008.02092.x</a>
</div>
<div id="ref-Farris2006" class="csl-entry" role="listitem">
Farris, C., Viken, R. J., Treat, T. A., &amp; McFall, R. M. (2006). Heterosocial perceptual organization: Application of the choice model to sexual coercion. <em>Psychological Science (0956-7976)</em>, <em>17</em>(10), 869–875. <a href="https://doi.org/10.1111/j.1467-9280.2006.01796.x">https://doi.org/10.1111/j.1467-9280.2006.01796.x</a>
</div>
<div id="ref-R-car" class="csl-entry" role="listitem">
Fox, J., Weisberg, S., &amp; Price, B. (2022). <em>Car: Companion to applied regression</em>. <a href="https://CRAN.R-project.org/package=car">https://CRAN.R-project.org/package=car</a>
</div>
<div id="ref-Gneiting2021" class="csl-entry" role="listitem">
Gneiting, T., &amp; Walz, E.-M. (2021). Receiver operating characteristic (ROC) movies, universal ROC (UROC) curves, and coefficient of predictive ability (CPA). <em>Machine Learning</em>. <a href="https://doi.org/10.1007/s10994-021-06114-3">https://doi.org/10.1007/s10994-021-06114-3</a>
</div>
<div id="ref-Harrell2015" class="csl-entry" role="listitem">
Harrell, F. (2015). <em>Regression modeling strategies: With applications to linear models, logistic and ordinal regression, and survival analysis</em>. Springer.
</div>
<div id="ref-R-rms" class="csl-entry" role="listitem">
Harrell, Jr., F. E. (2021). <em><span class="nocase">rms</span>: Regression modeling strategies</em>. <a href="https://CRAN.R-project.org/package=rms">https://CRAN.R-project.org/package=rms</a>
</div>
<div id="ref-Hoch1985" class="csl-entry" role="listitem">
Hoch, S. J. (1985). Counterfactual reasoning and accuracy in predicting personal events. <em>Journal of Experimental Psychology: Learning, Memory, and Cognition</em>, <em>11</em>(4), 719–731. <a href="https://doi.org/10.1037/0278-7393.11.1-4.719">https://doi.org/10.1037/0278-7393.11.1-4.719</a>
</div>
<div id="ref-Hough2016" class="csl-entry" role="listitem">
Hough, S. E. (2016). <em>Predicting the unpredictable: The tumultuous science of earthquake prediction</em>. Princeton University Press.
</div>
<div id="ref-Hyndman2018" class="csl-entry" role="listitem">
Hyndman, R. J., &amp; Athanasopoulos, G. (2018). <em>Forecasting: Principles and practice</em> (2nd ed.). OTexts.
</div>
<div id="ref-Johnson2001" class="csl-entry" role="listitem">
Johnson, J. E. V., &amp; Bruce, A. C. (2001). Calibration of subjective probability judgments in a naturalistic setting. <em>Organizational Behavior and Human Decision Processes</em>, <em>85</em>(2), 265–290. <a href="https://doi.org/10.1006/obhd.2000.2949">https://doi.org/10.1006/obhd.2000.2949</a>
</div>
<div id="ref-Kenny1979a" class="csl-entry" role="listitem">
Kenny, D. A. (1979). Correlation and causality. <em>New York: Wiley</em>.
</div>
<div id="ref-Keren1987" class="csl-entry" role="listitem">
Keren, G. (1987). Facing uncertainty in the game of bridge: A calibration study. <em>Organizational Behavior and Human Decision Processes</em>, <em>39</em>(1), 98–114. <a href="https://doi.org/10.1016/0749-5978(87)90047-1">https://doi.org/10.1016/0749-5978(87)90047-1</a>
</div>
<div id="ref-Kessler2020" class="csl-entry" role="listitem">
Kessler, R. C., Bossarte, R. M., Luedtke, A., Zaslavsky, A. M., &amp; Zubizarreta, J. R. (2020). Suicide prediction models: A critical review of recent research with recommendations for the way forward. <em>Molecular Psychiatry</em>, <em>25</em>(1), 168–179. <a href="https://doi.org/10.1038/s41380-019-0531-0">https://doi.org/10.1038/s41380-019-0531-0</a>
</div>
<div id="ref-Koehler2002" class="csl-entry" role="listitem">
Koehler, D. J., Brenner, L., &amp; Griffin, D. (2002). The calibration of expert judgment: Heuristics and biases beyond the laboratory. In T. Gilovich, D. Griffin, &amp; D. Kahneman (Eds.), <em>Heuristics and biases: The psychology of intuitive judgment</em>. Cambridge University Press.
</div>
<div id="ref-Koriat1980" class="csl-entry" role="listitem">
Koriat, A., Lichtenstein, S., &amp; Fischhoff, B. (1980). Reasons for confidence. <em>Journal of Experimental Psychology: Human Learning and Memory</em>, <em>6</em>(2), 107–118. <a href="https://doi.org/10.1037/0278-7393.6.2.107">https://doi.org/10.1037/0278-7393.6.2.107</a>
</div>
<div id="ref-R-caret" class="csl-entry" role="listitem">
Kuhn, M. (2022). <em><span class="nocase">caret</span>: Classification and regression training</em>. <a href="https://github.com/topepo/caret/">https://github.com/topepo/caret/</a>
</div>
<div id="ref-R-PredictABEL" class="csl-entry" role="listitem">
Kundu, S., Aulchenko, Y. S., &amp; Janssens, A. C. J. W. (2020). <em><span>PredictABEL</span>: Assessment of risk prediction models</em>. <a href="https://CRAN.R-project.org/package=PredictABEL">https://CRAN.R-project.org/package=PredictABEL</a>
</div>
<div id="ref-R-ResourceSelection" class="csl-entry" role="listitem">
Lele, S. R., Keim, J. L., &amp; Solymos, P. (2019). <em><span>ResourceSelection</span>: Resource selection (probability) functions for use-availability data</em>. <a href="https://github.com/psolymos/ResourceSelection">https://github.com/psolymos/ResourceSelection</a>
</div>
<div id="ref-Lindhiem2020" class="csl-entry" role="listitem">
Lindhiem, O., Petersen, I. T., Mentch, L. K., &amp; Youngstrom, E. A. (2020). The importance of calibration in clinical psychology. <em>Assessment</em>, <em>27</em>(4), 840–854. <a href="https://doi.org/10.1177/1073191117752055">https://doi.org/10.1177/1073191117752055</a>
</div>
<div id="ref-Makridakis2009" class="csl-entry" role="listitem">
Makridakis, S., Hogarth, R. M., &amp; Gaba, A. (2009). Forecasting and uncertainty in the economic and business world. <em>International Journal of Forecasting</em>, <em>25</em>(4), 794–812. <a href="https://doi.org/10.1016/j.ijforecast.2009.05.012">https://doi.org/10.1016/j.ijforecast.2009.05.012</a>
</div>
<div id="ref-Meehl1957" class="csl-entry" role="listitem">
Meehl, P. E. (1957). When shall we use our heads instead of the formula? <em>Journal of Counseling Psychology</em>, <em>4</em>(4), 268–273. <a href="https://doi.org/10.1037/h0047554">https://doi.org/10.1037/h0047554</a>
</div>
<div id="ref-Meehl1955" class="csl-entry" role="listitem">
Meehl, P. E., &amp; Rosen, A. (1955). Antecedent probability and the efficiency of psychometric signs, patterns, or cutting scores. <em>Psychological Bulletin</em>, <em>52</em>(3), 194–216. <a href="https://doi.org/10.1037/h0048070">https://doi.org/10.1037/h0048070</a>
</div>
<div id="ref-Metz1973" class="csl-entry" role="listitem">
Metz, C. E., Goodenough, D. J., &amp; Rossmann, K. (1973). Evaluation of receiver operating characteristic curve data in terms of information theory, with applications in radiography. <em>Radiology</em>, <em>109</em>(2), 297–303. <a href="https://doi.org/10.1148/109.2.297">https://doi.org/10.1148/109.2.297</a>
</div>
<div id="ref-Morley2018" class="csl-entry" role="listitem">
Morley, S. K., Brito, T. V., &amp; Welling, D. T. (2018). Measures of model performance based on the log accuracy ratio. <em>Space Weather</em>, <em>16</em>(1), 69–88. <a href="https://doi.org/10.1002/2017SW001669">https://doi.org/10.1002/2017SW001669</a>
</div>
<div id="ref-Murphy1984" class="csl-entry" role="listitem">
Murphy, A. H., &amp; Winkler, R. L. (1984). Probability forecasting in meterology. <em>Journal of the American Statistical Association</em>, <em>79</em>(387), 489–500. <a href="https://doi.org/10.2307/2288395">https://doi.org/10.2307/2288395</a>
</div>
<div id="ref-Oskamp1965" class="csl-entry" role="listitem">
Oskamp, S. (1965). Overconfidence in case-study judgments. <em>Journal of Consulting Psychology</em>, <em>29</em>(3), 261–265. <a href="https://doi.org/10.1037/h0022125">https://doi.org/10.1037/h0022125</a>
</div>
<div id="ref-R-petersenlab" class="csl-entry" role="listitem">
Petersen, I. T. (2025). <em><span class="nocase">petersenlab</span>: A collection of <span>R</span> functions by the <span>Petersen Lab</span></em>. <a href="https://doi.org/10.32614/CRAN.package.petersenlab">https://doi.org/10.32614/CRAN.package.petersenlab</a>
</div>
<div id="ref-R-pROC" class="csl-entry" role="listitem">
Robin, X., Turck, N., Hainard, A., Tiberti, N., Lisacek, F., Sanchez, J.-C., &amp; Müller, M. (2021). <em><span class="nocase">pROC</span>: Display and analyze <span>ROC</span> curves</em>. <a href="http://expasy.org/tools/pROC/">http://expasy.org/tools/pROC/</a>
</div>
<div id="ref-Russo1992" class="csl-entry" role="listitem">
Russo, J. E., &amp; Schoemaker, P. J. (1992). Managing overconfidence. <em>Sloan Management Review</em>, <em>33</em>(2), 7.
</div>
<div id="ref-Silver2012" class="csl-entry" role="listitem">
Silver, N. (2012). <em>The signal and the noise: Why so many predictions fail–but some don’t</em>. Penguin.
</div>
<div id="ref-Skala2008" class="csl-entry" role="listitem">
Skala, D. (2008). Overconfidence in psychology and finance–an interdisciplinary literature review. <em>Bank i Kredyt</em>, <em>4</em>, 33–50.
</div>
<div id="ref-Somoza1989" class="csl-entry" role="listitem">
Somoza, E., Soutullo-Esperon, L., &amp; Mossman, D. (1989). Evaluation and optimization of diagnostic tests using receiver operating characteristic analysis and information theory. <em>International Journal of Bio-Medical Computing</em>, <em>24</em>(3), 153–189. <a href="https://doi.org/10.1016/0020-7101(89)90029-9">https://doi.org/10.1016/0020-7101(89)90029-9</a>
</div>
<div id="ref-Stanislaw1999" class="csl-entry" role="listitem">
Stanislaw, H., &amp; Todorov, N. (1999). Calculation of signal detection theory measures. <em>Behavior Research Methods, Instruments, &amp; Computers</em>, <em>31</em>(1), 137–149. <a href="https://doi.org/10.3758/bf03207704">https://doi.org/10.3758/bf03207704</a>
</div>
<div id="ref-Stevens2020" class="csl-entry" role="listitem">
Stevens, R. J., &amp; Poppe, K. K. (2020). Validation of clinical prediction models: What does the <span>“calibration slope”</span> really measure? <em>Journal of Clinical Epidemiology</em>, <em>118</em>, 93–99. <a href="https://doi.org/10.1016/j.jclinepi.2019.09.016">https://doi.org/10.1016/j.jclinepi.2019.09.016</a>
</div>
<div id="ref-Steyerberg2014" class="csl-entry" role="listitem">
Steyerberg, E. W., &amp; Vergouwe, Y. (2014). Towards better clinical prediction models: Seven steps for development and an ABCD for validation. <em>European Heart Journal</em>, <em>35</em>(29), 1925–1931. <a href="https://doi.org/10.1093/eurheartj/ehu207">https://doi.org/10.1093/eurheartj/ehu207</a>
</div>
<div id="ref-Steyerberg2010" class="csl-entry" role="listitem">
Steyerberg, E. W., Vickers, A. J., Cook, N. R., Gerds, T., Gonen, M., Obuchowski, N., Pencina, M. J., &amp; Kattan, M. W. (2010). Assessing the performance of prediction models: A framework for traditional and novel measures. <em>Epidemiology</em>, <em>21</em>(1), 128–138. <a href="https://doi.org/10.1097/EDE.0b013e3181c30fb2">https://doi.org/10.1097/EDE.0b013e3181c30fb2</a>
</div>
<div id="ref-Swets2000" class="csl-entry" role="listitem">
Swets, J. A., Dawes, R. M., &amp; Monahan, J. (2000). Psychological science can improve diagnostic decisions. <em>Psychological Science in the Public Interest</em>, <em>1</em>, 1–26. <a href="https://doi.org/10.1111/1529-1006.001">https://doi.org/10.1111/1529-1006.001</a>
</div>
<div id="ref-Tetlock2017" class="csl-entry" role="listitem">
Tetlock, P. E. (2017). <em>Expert political judgment: How good is it? How can we know? - <span>N</span>ew edition</em>. Princeton University Press.
</div>
<div id="ref-Tofallis2015" class="csl-entry" role="listitem">
Tofallis, C. (2015). A better measure of relative prediction accuracy for model selection and model estimation. <em>Journal of the Operational Research Society</em>, <em>66</em>(8), 1352–1362. <a href="https://doi.org/10.1057/jors.2014.103">https://doi.org/10.1057/jors.2014.103</a>
</div>
<div id="ref-TrafimowInPress" class="csl-entry" role="listitem">
Trafimow, D., Hyman, M. R., &amp; Kostyk, A. (in press). Enhancing predictive power by unamalgamating multi-item scales. <em>Psychological Methods</em>. <a href="https://doi.org/10.1037/met0000599">https://doi.org/10.1037/met0000599</a>
</div>
<div id="ref-Treat2023" class="csl-entry" role="listitem">
Treat, T. A., &amp; Viken, R. J. (2023). Measuring test performance with signal detection theory techniques. In H. Cooper, M. N. Coutanche, L. M. McMullen, A. T. Panter, D. Rindskopf, &amp; K. J. Sher (Eds.), <em>APA handbook of research methods in psychology: Foundations, planning, measures, and psychometrics</em> (2nd ed., Vol. 1, pp. 837–858). American Psychological Association.
</div>
<div id="ref-Tversky1974" class="csl-entry" role="listitem">
Tversky, A., &amp; Kahneman, D. (1974). Judgment under uncertainty: Heuristics and biases. <em>Science</em>, <em>185</em>(4157), 1124–1131. <a href="https://doi.org/10.1126/science.185.4157.1124">https://doi.org/10.1126/science.185.4157.1124</a>
</div>
<div id="ref-Wiggins1973" class="csl-entry" role="listitem">
Wiggins, J. S. (1973). <em>Personality and prediction: Principles of personality assessment</em>. Addison-Wesley.
</div>
<div id="ref-Zhang2005" class="csl-entry" role="listitem">
Zhang, J., &amp; Mueller, S. T. (2005). A note on <span>ROC</span> analysis and non-parametric estimate of sensitivity. <em>Psychometrika</em>, <em>70</em>(1), 203–212. <a href="https://doi.org/10.1007/s11336-003-1119-8">https://doi.org/10.1007/s11336-003-1119-8</a>
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Please note that the areas in the figure are not drawn to scale; otherwise, some regions would be too small to include text.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><h2>Feedback</h2>

<div class="feedback">
    Please consider providing feedback about this textbook, so that I can make it as helpful as possible. You can provide feedback at the following link:
    
    <a href="https://forms.gle/95iW4p47cuaphTek6">https://forms.gle/95iW4p47cuaphTek6</a>
</div>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/isaactpetersen\.github\.io\/Principles-Psychological-Assessment");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      if (authorPrefersDark) {
          [baseTheme, altTheme] = [altTheme, baseTheme];
      }
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "isaactpetersen/Principles-Psychological-Assessment";
    script.dataset.repoId = "MDEwOlJlcG9zaXRvcnkzNzIwMjExNjg=";
    script.dataset.category = "Chapter Comments";
    script.dataset.categoryId = "DIC_kwDOFiyXsM4CzZAv";
    script.dataset.mapping = "pathname";
    script.dataset.reactionsEnabled = "0";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./item-response-theory.html" class="pagination-link" aria-label="Item Response Theory">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Item Response Theory</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./clinical-actuarial-judgment.html" class="pagination-link" aria-label="Clinical Judgment Versus Algorithmic Prediction">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Clinical Judgment Versus Algorithmic Prediction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>“Principles of Psychological Assessment: With Applied Examples in R” was written by <a href="https://psychology.uiowa.edu/people/isaac-petersen">Isaac T. Petersen</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/edit/main/prediction.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/blob/main/prediction.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>