<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Isaac T. Petersen">
<meta name="dcterms.date" content="today">
<title>16&nbsp; Test Bias – Principles of Psychological Assessment: With Applied Examples in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./interview-dsm.html" rel="next">
<link href="./intellectual-assessment.html" rel="prev">
<link href="./images/logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-b754b9fd3853d7e56faef54c29c5d52b.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-de8274a4d1ecc1e6aaeaf6e5564b5074.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-b754b9fd3853d7e56faef54c29c5d52b.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-130090a4f67d5a48627557ac2cc26c52.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-1618a58ca6f78f2fb92914a64c678f15.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-130090a4f67d5a48627557ac2cc26c52.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-WZJ45RB1K4"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-WZJ45RB1K4', { 'anonymize_ip': true});
</script><script type="application/json" class="js-hypothesis-config">
{
  "theme": "classic",
  "openSidebar": false,
  "showHighlights": "whenSidebarOpen"
}
</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="16&nbsp; Test Bias – Principles of Psychological Assessment: With Applied Examples in R">
<meta property="og:description" content="">
<meta property="og:image" content="https://isaactpetersen.github.io/Principles-Psychological-Assessment/images/JobSelection.png">
<meta property="og:site_name" content="Principles of Psychological Assessment: With Applied Examples in R">
<meta property="og:image:alt" content="2x2 Confusion Matrix for Job Selection. TP = true positive; TN = true negative; FP = false positive; FN = false negative.">
<meta property="og:image:height" content="215">
<meta property="og:image:width" content="1174">
<meta name="twitter:title" content="16&nbsp; Test Bias – Principles of Psychological Assessment: With Applied Examples in R">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://isaactpetersen.github.io/Principles-Psychological-Assessment/images/JobSelection.png">
<meta name="twitter:image:alt" content="2x2 Confusion Matrix for Job Selection. TP = true positive; TN = true negative; FP = false positive; FN = false negative.">
<meta name="twitter:image-height" content="215">
<meta name="twitter:image-width" content="1174">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./test-bias.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Test Bias</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Principles of Psychological Assessment: With Applied Examples in R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Part I</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scores-scales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Scores and Scales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./constructs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Constructs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reliability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reliability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./validity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Validity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalizability-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalizability Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structural-equation-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Structural Equation Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./item-response-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Item Response Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Prediction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clinical-actuarial-judgment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Clinical Judgment Versus Algorithmic Prediction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clinical-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">General Issues in Clinical Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evidence-based-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Evidence-Based Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ethical Issues in Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factor-analysis-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Factor Analysis and Principal Component Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Part II</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intellectual-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Intellectual Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test-bias.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Test Bias</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interview-dsm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">The Interview and the DSM</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./objective-personality-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Objective Personality Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./projective-personality-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Projective Personality Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./psychophysiological-measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Psychophysiological and Ambulatory Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./computerized-adaptive-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Computers and Adaptive Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./behavioral-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Behavioral Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repeated-assessments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Repeated Assessments Across Time</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cognitive-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Assessment of Cognition</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Cultural and Individual Diversity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-overview-bias" id="toc-sec-overview-bias" class="nav-link active" data-scroll-target="#sec-overview-bias"><span class="header-section-number">16.1</span> Overview of Bias</a></li>
  <li>
<a href="#sec-detectBias" id="toc-sec-detectBias" class="nav-link" data-scroll-target="#sec-detectBias"><span class="header-section-number">16.2</span> Ways to Investigate/Detect Test Bias</a>
  <ul>
<li>
<a href="#sec-predictiveBias" id="toc-sec-predictiveBias" class="nav-link" data-scroll-target="#sec-predictiveBias"><span class="header-section-number">16.2.1</span> Predictive Bias</a>
  <ul>
<li>
<a href="#sec-typesPredictiveBias" id="toc-sec-typesPredictiveBias" class="nav-link" data-scroll-target="#sec-typesPredictiveBias"><span class="header-section-number">16.2.1.1</span> Types of Predictive Bias</a>
  <ul class="collapse">
<li><a href="#sec-differentSlopes" id="toc-sec-differentSlopes" class="nav-link" data-scroll-target="#sec-differentSlopes"><span class="header-section-number">16.2.1.1.1</span> Different Slopes</a></li>
  <li><a href="#sec-differentIntercepts" id="toc-sec-differentIntercepts" class="nav-link" data-scroll-target="#sec-differentIntercepts"><span class="header-section-number">16.2.1.1.2</span> Different Intercepts</a></li>
  <li><a href="#sec-differentInterceptsAndSlopes" id="toc-sec-differentInterceptsAndSlopes" class="nav-link" data-scroll-target="#sec-differentInterceptsAndSlopes"><span class="header-section-number">16.2.1.1.3</span> Different Intercepts and Slopes</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#sec-testStructureBias" id="toc-sec-testStructureBias" class="nav-link" data-scroll-target="#sec-testStructureBias"><span class="header-section-number">16.2.2</span> Test Structure Bias</a>
  <ul>
<li>
<a href="#sec-testStructureBiasEmpirical" id="toc-sec-testStructureBiasEmpirical" class="nav-link" data-scroll-target="#sec-testStructureBiasEmpirical"><span class="header-section-number">16.2.2.1</span> Empirical Approaches to Identification</a>
  <ul class="collapse">
<li><a href="#sec-itemXgroupTests-bias" id="toc-sec-itemXgroupTests-bias" class="nav-link" data-scroll-target="#sec-itemXgroupTests-bias"><span class="header-section-number">16.2.2.1.1</span> Item <span class="math inline">\(\times\)</span> Group tests (ANOVA)</a></li>
  <li><a href="#sec-irt-bias" id="toc-sec-irt-bias" class="nav-link" data-scroll-target="#sec-irt-bias"><span class="header-section-number">16.2.2.1.2</span> Item Response Theory</a></li>
  <li><a href="#sec-cfa-bias" id="toc-sec-cfa-bias" class="nav-link" data-scroll-target="#sec-cfa-bias"><span class="header-section-number">16.2.2.1.3</span> Confirmatory Factor Analysis</a></li>
  <li><a href="#sec-sem-bias" id="toc-sec-sem-bias" class="nav-link" data-scroll-target="#sec-sem-bias"><span class="header-section-number">16.2.2.1.4</span> Structural Equation Modeling</a></li>
  <li><a href="#sec-sdt-bias" id="toc-sec-sdt-bias" class="nav-link" data-scroll-target="#sec-sdt-bias"><span class="header-section-number">16.2.2.1.5</span> Signal Detection Theory</a></li>
  <li><a href="#sec-evidenceTestStructureBias" id="toc-sec-evidenceTestStructureBias" class="nav-link" data-scroll-target="#sec-evidenceTestStructureBias"><span class="header-section-number">16.2.2.1.6</span> Empirical Evidence of Test Structure Bias</a></li>
  </ul>
</li>
  <li>
<a href="#sec-testStructureBiasTheoretical" id="toc-sec-testStructureBiasTheoretical" class="nav-link" data-scroll-target="#sec-testStructureBiasTheoretical"><span class="header-section-number">16.2.2.2</span> Theoretical/Judgmental Approaches to Identification</a>
  <ul class="collapse">
<li><a href="#sec-facialValidityBias" id="toc-sec-facialValidityBias" class="nav-link" data-scroll-target="#sec-facialValidityBias"><span class="header-section-number">16.2.2.2.1</span> Facial Validity Bias</a></li>
  <li><a href="#sec-contentValidityBias" id="toc-sec-contentValidityBias" class="nav-link" data-scroll-target="#sec-contentValidityBias"><span class="header-section-number">16.2.2.2.2</span> Content Validity Bias</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#sec-biasExamples" id="toc-sec-biasExamples" class="nav-link" data-scroll-target="#sec-biasExamples"><span class="header-section-number">16.3</span> Examples of Bias</a></li>
  <li>
<a href="#sec-fairness" id="toc-sec-fairness" class="nav-link" data-scroll-target="#sec-fairness"><span class="header-section-number">16.4</span> Test Fairness</a>
  <ul>
<li><a href="#sec-adverseImpact" id="toc-sec-adverseImpact" class="nav-link" data-scroll-target="#sec-adverseImpact"><span class="header-section-number">16.4.1</span> Adverse Impact</a></li>
  <li><a href="#sec-biasVsFairness" id="toc-sec-biasVsFairness" class="nav-link" data-scroll-target="#sec-biasVsFairness"><span class="header-section-number">16.4.2</span> Bias Versus Fairness</a></li>
  <li><a href="#sec-operationalizingFairness" id="toc-sec-operationalizingFairness" class="nav-link" data-scroll-target="#sec-operationalizingFairness"><span class="header-section-number">16.4.3</span> Operationalizing Fairness</a></li>
  </ul>
</li>
  <li>
<a href="#sec-correctForBias" id="toc-sec-correctForBias" class="nav-link" data-scroll-target="#sec-correctForBias"><span class="header-section-number">16.5</span> Correcting For Bias</a>
  <ul>
<li><a href="#sec-whenDetectingBias" id="toc-sec-whenDetectingBias" class="nav-link" data-scroll-target="#sec-whenDetectingBias"><span class="header-section-number">16.5.1</span> What to Do When Detecting Bias</a></li>
  <li>
<a href="#sec-scoreAdjustment" id="toc-sec-scoreAdjustment" class="nav-link" data-scroll-target="#sec-scoreAdjustment"><span class="header-section-number">16.5.2</span> Score Adjustment to Correct for Bias</a>
  <ul>
<li><a href="#sec-whyAdjustScores" id="toc-sec-whyAdjustScores" class="nav-link" data-scroll-target="#sec-whyAdjustScores"><span class="header-section-number">16.5.2.1</span> Why Adjust Scores?</a></li>
  <li>
<a href="#sec-typesOfScoreAdjustment" id="toc-sec-typesOfScoreAdjustment" class="nav-link" data-scroll-target="#sec-typesOfScoreAdjustment"><span class="header-section-number">16.5.2.2</span> Types of Score Adjustment</a>
  <ul class="collapse">
<li><a href="#sec-bonusPoints" id="toc-sec-bonusPoints" class="nav-link" data-scroll-target="#sec-bonusPoints"><span class="header-section-number">16.5.2.2.1</span> Bonus Points</a></li>
  <li><a href="#sec-withinGroupNorming" id="toc-sec-withinGroupNorming" class="nav-link" data-scroll-target="#sec-withinGroupNorming"><span class="header-section-number">16.5.2.2.2</span> Within-Group Norming</a></li>
  <li><a href="#sec-separateCutoffs" id="toc-sec-separateCutoffs" class="nav-link" data-scroll-target="#sec-separateCutoffs"><span class="header-section-number">16.5.2.2.3</span> Separate Cutoffs</a></li>
  <li><a href="#sec-topDownSelection" id="toc-sec-topDownSelection" class="nav-link" data-scroll-target="#sec-topDownSelection"><span class="header-section-number">16.5.2.2.4</span> Top-Down Selection from Different Lists</a></li>
  <li><a href="#sec-banding" id="toc-sec-banding" class="nav-link" data-scroll-target="#sec-banding"><span class="header-section-number">16.5.2.2.5</span> Banding</a></li>
  <li><a href="#sec-bandingBonusPoints" id="toc-sec-bandingBonusPoints" class="nav-link" data-scroll-target="#sec-bandingBonusPoints"><span class="header-section-number">16.5.2.2.6</span> Banding with Bonus Points</a></li>
  <li><a href="#sec-slidingBand" id="toc-sec-slidingBand" class="nav-link" data-scroll-target="#sec-slidingBand"><span class="header-section-number">16.5.2.2.7</span> Sliding Band</a></li>
  <li><a href="#sec-separateTests" id="toc-sec-separateTests" class="nav-link" data-scroll-target="#sec-separateTests"><span class="header-section-number">16.5.2.2.8</span> Separate Tests</a></li>
  <li><a href="#sec-itemElimination" id="toc-sec-itemElimination" class="nav-link" data-scroll-target="#sec-itemElimination"><span class="header-section-number">16.5.2.2.9</span> Item Elimination based on Group Differences</a></li>
  </ul>
</li>
  <li><a href="#sec-useOfScoreAdjustment" id="toc-sec-useOfScoreAdjustment" class="nav-link" data-scroll-target="#sec-useOfScoreAdjustment"><span class="header-section-number">16.5.2.3</span> Use of Score Adjustment</a></li>
  </ul>
</li>
  <li>
<a href="#sec-otherBiasCorrections" id="toc-sec-otherBiasCorrections" class="nav-link" data-scroll-target="#sec-otherBiasCorrections"><span class="header-section-number">16.5.3</span> Other Ways to Correct for Bias</a>
  <ul>
<li><a href="#sec-useMultiplePredictors" id="toc-sec-useMultiplePredictors" class="nav-link" data-scroll-target="#sec-useMultiplePredictors"><span class="header-section-number">16.5.3.1</span> Use Multiple Predictors</a></li>
  <li><a href="#sec-changeCriterion" id="toc-sec-changeCriterion" class="nav-link" data-scroll-target="#sec-changeCriterion"><span class="header-section-number">16.5.3.2</span> Change the Criterion</a></li>
  <li><a href="#sec-removeBiasedItems" id="toc-sec-removeBiasedItems" class="nav-link" data-scroll-target="#sec-removeBiasedItems"><span class="header-section-number">16.5.3.3</span> Remove Biased Items</a></li>
  <li><a href="#sec-resolveBiasedItems" id="toc-sec-resolveBiasedItems" class="nav-link" data-scroll-target="#sec-resolveBiasedItems"><span class="header-section-number">16.5.3.4</span> Resolve Biased Items</a></li>
  <li><a href="#sec-alternativeTestingModes" id="toc-sec-alternativeTestingModes" class="nav-link" data-scroll-target="#sec-alternativeTestingModes"><span class="header-section-number">16.5.3.5</span> Use Alternative Modes of Testing</a></li>
  <li><a href="#sec-workRecords" id="toc-sec-workRecords" class="nav-link" data-scroll-target="#sec-workRecords"><span class="header-section-number">16.5.3.6</span> Use Work Records</a></li>
  <li><a href="#sec-increaseTimeLimit" id="toc-sec-increaseTimeLimit" class="nav-link" data-scroll-target="#sec-increaseTimeLimit"><span class="header-section-number">16.5.3.7</span> Increase Time Limit</a></li>
  <li><a href="#sec-motivationSets" id="toc-sec-motivationSets" class="nav-link" data-scroll-target="#sec-motivationSets"><span class="header-section-number">16.5.3.8</span> Use Motivation Sets</a></li>
  <li><a href="#sec-instructionalSets" id="toc-sec-instructionalSets" class="nav-link" data-scroll-target="#sec-instructionalSets"><span class="header-section-number">16.5.3.9</span> Use Instructional Sets</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#sec-gettingStarted-bias" id="toc-sec-gettingStarted-bias" class="nav-link" data-scroll-target="#sec-gettingStarted-bias"><span class="header-section-number">16.6</span> Getting Started</a>
  <ul>
<li><a href="#sec-loadLibraries-bias" id="toc-sec-loadLibraries-bias" class="nav-link" data-scroll-target="#sec-loadLibraries-bias"><span class="header-section-number">16.6.1</span> Load Libraries</a></li>
  <li>
<a href="#sec-prepareData-bias" id="toc-sec-prepareData-bias" class="nav-link" data-scroll-target="#sec-prepareData-bias"><span class="header-section-number">16.6.2</span> Prepare Data</a>
  <ul>
<li><a href="#sec-loadData-bias" id="toc-sec-loadData-bias" class="nav-link" data-scroll-target="#sec-loadData-bias"><span class="header-section-number">16.6.2.1</span> Load Data</a></li>
  <li><a href="#sec-simulateData-bias" id="toc-sec-simulateData-bias" class="nav-link" data-scroll-target="#sec-simulateData-bias"><span class="header-section-number">16.6.2.2</span> Simulate Data</a></li>
  <li><a href="#sec-addMissingData-bias" id="toc-sec-addMissingData-bias" class="nav-link" data-scroll-target="#sec-addMissingData-bias"><span class="header-section-number">16.6.2.3</span> Add Missing Data</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#sec-examplesUnbiasedTests" id="toc-sec-examplesUnbiasedTests" class="nav-link" data-scroll-target="#sec-examplesUnbiasedTests"><span class="header-section-number">16.7</span> Examples of Unbiased Tests (in Terms of Predictive Bias)</a>
  <ul>
<li><a href="#sec-unbiasedTestsEqualMeans" id="toc-sec-unbiasedTestsEqualMeans" class="nav-link" data-scroll-target="#sec-unbiasedTestsEqualMeans"><span class="header-section-number">16.7.1</span> Unbiased test where males and females have equal means on predictor and criterion</a></li>
  <li><a href="#sec-unbiasedTestsFemalesHigherMeans" id="toc-sec-unbiasedTestsFemalesHigherMeans" class="nav-link" data-scroll-target="#sec-unbiasedTestsFemalesHigherMeans"><span class="header-section-number">16.7.2</span> Unbiased test where females have higher means than males on predictor and criterion</a></li>
  <li><a href="#sec-unbiasedTestsMalesHigherMeans" id="toc-sec-unbiasedTestsMalesHigherMeans" class="nav-link" data-scroll-target="#sec-unbiasedTestsMalesHigherMeans"><span class="header-section-number">16.7.3</span> Unbiased test where males have higher means than females on predictor and criterion</a></li>
  </ul>
</li>
  <li>
<a href="#sec-predictiveBiasExamples" id="toc-sec-predictiveBiasExamples" class="nav-link" data-scroll-target="#sec-predictiveBiasExamples"><span class="header-section-number">16.8</span> Predictive Bias: Different Regression Lines</a>
  <ul>
<li><a href="#sec-unbiasedPrediction" id="toc-sec-unbiasedPrediction" class="nav-link" data-scroll-target="#sec-unbiasedPrediction"><span class="header-section-number">16.8.1</span> Example of unbiased prediction (no differences in intercepts or slopes)</a></li>
  <li><a href="#sec-interceptBias" id="toc-sec-interceptBias" class="nav-link" data-scroll-target="#sec-interceptBias"><span class="header-section-number">16.8.2</span> Example of intercept bias</a></li>
  <li><a href="#sec-slopeBias" id="toc-sec-slopeBias" class="nav-link" data-scroll-target="#sec-slopeBias"><span class="header-section-number">16.8.3</span> Example of slope bias</a></li>
  <li><a href="#sec-interceptSlopeBias" id="toc-sec-interceptSlopeBias" class="nav-link" data-scroll-target="#sec-interceptSlopeBias"><span class="header-section-number">16.8.4</span> Example of intercept and slope bias</a></li>
  <li><a href="#sec-differentialReliability" id="toc-sec-differentialReliability" class="nav-link" data-scroll-target="#sec-differentialReliability"><span class="header-section-number">16.8.5</span> Example of different measurement reliability/error across groups</a></li>
  </ul>
</li>
  <li>
<a href="#sec-dif" id="toc-sec-dif" class="nav-link" data-scroll-target="#sec-dif"><span class="header-section-number">16.9</span> Differential Item Functioning (DIF)</a>
  <ul>
<li><a href="#sec-descriptiveStats-bias" id="toc-sec-descriptiveStats-bias" class="nav-link" data-scroll-target="#sec-descriptiveStats-bias"><span class="header-section-number">16.9.1</span> Item Descriptive Statistics</a></li>
  <li>
<a href="#sec-difUnconstrained" id="toc-sec-difUnconstrained" class="nav-link" data-scroll-target="#sec-difUnconstrained"><span class="header-section-number">16.9.2</span> Unconstrained Model</a>
  <ul>
<li><a href="#sec-difUnconstrainedFit" id="toc-sec-difUnconstrainedFit" class="nav-link" data-scroll-target="#sec-difUnconstrainedFit"><span class="header-section-number">16.9.2.1</span> Fit Model</a></li>
  <li><a href="#sec-difUnconstrainedSummary" id="toc-sec-difUnconstrainedSummary" class="nav-link" data-scroll-target="#sec-difUnconstrainedSummary"><span class="header-section-number">16.9.2.2</span> Model Summary</a></li>
  </ul>
</li>
  <li>
<a href="#sec-difConstrained" id="toc-sec-difConstrained" class="nav-link" data-scroll-target="#sec-difConstrained"><span class="header-section-number">16.9.3</span> Constrained Model</a>
  <ul>
<li><a href="#sec-difConstrainedFit" id="toc-sec-difConstrainedFit" class="nav-link" data-scroll-target="#sec-difConstrainedFit"><span class="header-section-number">16.9.3.1</span> Fit Model</a></li>
  <li><a href="#sec-difConstrainedSummary" id="toc-sec-difConstrainedSummary" class="nav-link" data-scroll-target="#sec-difConstrainedSummary"><span class="header-section-number">16.9.3.2</span> Model Summary</a></li>
  </ul>
</li>
  <li><a href="#sec-difCompareConstrainedUnconstrained" id="toc-sec-difCompareConstrainedUnconstrained" class="nav-link" data-scroll-target="#sec-difCompareConstrainedUnconstrained"><span class="header-section-number">16.9.4</span> Compare model fit of constrained model to unconstrained model</a></li>
  <li>
<a href="#sec-difRemoveConstraints" id="toc-sec-difRemoveConstraints" class="nav-link" data-scroll-target="#sec-difRemoveConstraints"><span class="header-section-number">16.9.5</span> Identify DIF by iteratively removing constraints from fully constrained model</a>
  <ul>
<li><a href="#sec-difRemoveConstraintsDiscriminationSeverity" id="toc-sec-difRemoveConstraintsDiscriminationSeverity" class="nav-link" data-scroll-target="#sec-difRemoveConstraintsDiscriminationSeverity"><span class="header-section-number">16.9.5.1</span> Items that differ in discrimination and/or severity</a></li>
  <li><a href="#sec-difRemoveConstraintsDiscrimination" id="toc-sec-difRemoveConstraintsDiscrimination" class="nav-link" data-scroll-target="#sec-difRemoveConstraintsDiscrimination"><span class="header-section-number">16.9.5.2</span> Items that differ in discrimination</a></li>
  <li><a href="#sec-difRemoveConstraintsSeverity" id="toc-sec-difRemoveConstraintsSeverity" class="nav-link" data-scroll-target="#sec-difRemoveConstraintsSeverity"><span class="header-section-number">16.9.5.3</span> Items that differ in severity</a></li>
  </ul>
</li>
  <li>
<a href="#sec-difAddConstraints" id="toc-sec-difAddConstraints" class="nav-link" data-scroll-target="#sec-difAddConstraints"><span class="header-section-number">16.9.6</span> Identify DIF by iteratively adding constraints to unconstrained model</a>
  <ul>
<li><a href="#sec-difAddConstraintsDiscriminationSeverity" id="toc-sec-difAddConstraintsDiscriminationSeverity" class="nav-link" data-scroll-target="#sec-difAddConstraintsDiscriminationSeverity"><span class="header-section-number">16.9.6.1</span> Items that differ in discrimination and/or severity</a></li>
  <li><a href="#sec-difAddConstraintsDiscrimination" id="toc-sec-difAddConstraintsDiscrimination" class="nav-link" data-scroll-target="#sec-difAddConstraintsDiscrimination"><span class="header-section-number">16.9.6.2</span> Items that differ in discrimination</a></li>
  <li><a href="#sec-difAddConstraintsSeverity" id="toc-sec-difAddConstraintsSeverity" class="nav-link" data-scroll-target="#sec-difAddConstraintsSeverity"><span class="header-section-number">16.9.6.3</span> Items that differ in severity</a></li>
  </ul>
</li>
  <li>
<a href="#sec-difEffectSize" id="toc-sec-difEffectSize" class="nav-link" data-scroll-target="#sec-difEffectSize"><span class="header-section-number">16.9.7</span> Compute effect size of DIF</a>
  <ul>
<li><a href="#sec-difTestLevel" id="toc-sec-difTestLevel" class="nav-link" data-scroll-target="#sec-difTestLevel"><span class="header-section-number">16.9.7.1</span> Test-level DIF</a></li>
  <li><a href="#sec-difItemLevel" id="toc-sec-difItemLevel" class="nav-link" data-scroll-target="#sec-difItemLevel"><span class="header-section-number">16.9.7.2</span> Item-level DIF</a></li>
  </ul>
</li>
  <li><a href="#sec-difItemPlots" id="toc-sec-difItemPlots" class="nav-link" data-scroll-target="#sec-difItemPlots"><span class="header-section-number">16.9.8</span> Item plots</a></li>
  <li>
<a href="#sec-addressingDIF" id="toc-sec-addressingDIF" class="nav-link" data-scroll-target="#sec-addressingDIF"><span class="header-section-number">16.9.9</span> Addressing DIF</a>
  <ul>
<li><a href="#sec-dropItemForBothGroups" id="toc-sec-dropItemForBothGroups" class="nav-link" data-scroll-target="#sec-dropItemForBothGroups"><span class="header-section-number">16.9.9.1</span> Drop item for both groups</a></li>
  <li><a href="#sec-dropItemForOneGroup" id="toc-sec-dropItemForOneGroup" class="nav-link" data-scroll-target="#sec-dropItemForOneGroup"><span class="header-section-number">16.9.9.2</span> Drop item for one group but not another group</a></li>
  <li><a href="#sec-resolveItemAcrossGroups" id="toc-sec-resolveItemAcrossGroups" class="nav-link" data-scroll-target="#sec-resolveItemAcrossGroups"><span class="header-section-number">16.9.9.3</span> Freely estimate item to have different parameters across groups</a></li>
  <li><a href="#sec-difResolveItemsCompareModels" id="toc-sec-difResolveItemsCompareModels" class="nav-link" data-scroll-target="#sec-difResolveItemsCompareModels"><span class="header-section-number">16.9.9.4</span> Compare model fit</a></li>
  <li><a href="#sec-difNextSteps" id="toc-sec-difNextSteps" class="nav-link" data-scroll-target="#sec-difNextSteps"><span class="header-section-number">16.9.9.5</span> Next steps</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#sec-measurementInvariance" id="toc-sec-measurementInvariance" class="nav-link" data-scroll-target="#sec-measurementInvariance"><span class="header-section-number">16.10</span> Measurement/Factorial Invariance</a>
  <ul>
<li><a href="#sec-measurementNonInvarianceEffectSize" id="toc-sec-measurementNonInvarianceEffectSize" class="nav-link" data-scroll-target="#sec-measurementNonInvarianceEffectSize"><span class="header-section-number">16.10.1</span> Effect Size of Measurement Non-Invariance</a></li>
  <li>
<a href="#sec-measurementInvarianceModels" id="toc-sec-measurementInvarianceModels" class="nav-link" data-scroll-target="#sec-measurementInvarianceModels"><span class="header-section-number">16.10.2</span> Specify Models</a>
  <ul>
<li><a href="#sec-measurementInvarianceNullModelSyntax" id="toc-sec-measurementInvarianceNullModelSyntax" class="nav-link" data-scroll-target="#sec-measurementInvarianceNullModelSyntax"><span class="header-section-number">16.10.2.1</span> Null Model</a></li>
  <li><a href="#sec-measurementInvarianceCFAsyntax" id="toc-sec-measurementInvarianceCFAsyntax" class="nav-link" data-scroll-target="#sec-measurementInvarianceCFAsyntax"><span class="header-section-number">16.10.2.2</span> CFA Model</a></li>
  <li><a href="#sec-measurementInvarianceConfiguralSyntax" id="toc-sec-measurementInvarianceConfiguralSyntax" class="nav-link" data-scroll-target="#sec-measurementInvarianceConfiguralSyntax"><span class="header-section-number">16.10.2.3</span> Configural Invariance</a></li>
  <li><a href="#sec-measurementInvarianceMetricSyntax" id="toc-sec-measurementInvarianceMetricSyntax" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricSyntax"><span class="header-section-number">16.10.2.4</span> Metric (“Weak Factorial”) Invariance</a></li>
  <li><a href="#sec-measurementInvarianceScalarSyntax" id="toc-sec-measurementInvarianceScalarSyntax" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarSyntax"><span class="header-section-number">16.10.2.5</span> Scalar (“Strong Factorial”) Invariance</a></li>
  <li><a href="#sec-measurementInvarianceResidualSyntax" id="toc-sec-measurementInvarianceResidualSyntax" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualSyntax"><span class="header-section-number">16.10.2.6</span> Residual (“Strict Factorial”) Invariance</a></li>
  </ul>
</li>
  <li><a href="#sec-measurementInvarianceFitIndices" id="toc-sec-measurementInvarianceFitIndices" class="nav-link" data-scroll-target="#sec-measurementInvarianceFitIndices"><span class="header-section-number">16.10.3</span> Specify the Fit Indices of Interest</a></li>
  <li>
<a href="#sec-measurementInvarianceNullModel" id="toc-sec-measurementInvarianceNullModel" class="nav-link" data-scroll-target="#sec-measurementInvarianceNullModel"><span class="header-section-number">16.10.4</span> Null Model</a>
  <ul>
<li><a href="#sec-measurementInvarianceNullModelFit" id="toc-sec-measurementInvarianceNullModelFit" class="nav-link" data-scroll-target="#sec-measurementInvarianceNullModelFit"><span class="header-section-number">16.10.4.1</span> Fit the Model</a></li>
  <li><a href="#sec-measurementInvarianceNullModelSummary" id="toc-sec-measurementInvarianceNullModelSummary" class="nav-link" data-scroll-target="#sec-measurementInvarianceNullModelSummary"><span class="header-section-number">16.10.4.2</span> Model Summary</a></li>
  </ul>
</li>
  <li>
<a href="#sec-measurementInvarianceConfigural" id="toc-sec-measurementInvarianceConfigural" class="nav-link" data-scroll-target="#sec-measurementInvarianceConfigural"><span class="header-section-number">16.10.5</span> Configural Invariance</a>
  <ul>
<li>
<a href="#sec-measurementInvarianceConfiguralModelSyntax" id="toc-sec-measurementInvarianceConfiguralModelSyntax" class="nav-link" data-scroll-target="#sec-measurementInvarianceConfiguralModelSyntax"><span class="header-section-number">16.10.5.1</span> Model Syntax</a>
  <ul class="collapse">
<li><a href="#sec-measurementInvarianceConfiguralModelFeatures" id="toc-sec-measurementInvarianceConfiguralModelFeatures" class="nav-link" data-scroll-target="#sec-measurementInvarianceConfiguralModelFeatures"><span class="header-section-number">16.10.5.1.1</span> Summary of Model Features</a></li>
  <li><a href="#sec-measurementInvarianceConfiguralModelTabular" id="toc-sec-measurementInvarianceConfiguralModelTabular" class="nav-link" data-scroll-target="#sec-measurementInvarianceConfiguralModelTabular"><span class="header-section-number">16.10.5.1.2</span> Model Syntax in Table Form</a></li>
  </ul>
</li>
  <li><a href="#sec-measurementInvarianceConfiguralModelFit" id="toc-sec-measurementInvarianceConfiguralModelFit" class="nav-link" data-scroll-target="#sec-measurementInvarianceConfiguralModelFit"><span class="header-section-number">16.10.5.2</span> Fit the Model</a></li>
  <li><a href="#sec-measurementInvarianceConfiguralModelSummary" id="toc-sec-measurementInvarianceConfiguralModelSummary" class="nav-link" data-scroll-target="#sec-measurementInvarianceConfiguralModelSummary"><span class="header-section-number">16.10.5.3</span> Model Summary</a></li>
  <li><a href="#sec-measurementInvarianceConfiguralModelFitCriteria" id="toc-sec-measurementInvarianceConfiguralModelFitCriteria" class="nav-link" data-scroll-target="#sec-measurementInvarianceConfiguralModelFitCriteria"><span class="header-section-number">16.10.5.4</span> Model Fit</a></li>
  <li><a href="#sec-measurementInvarianceConfiguralModelEffectSize" id="toc-sec-measurementInvarianceConfiguralModelEffectSize" class="nav-link" data-scroll-target="#sec-measurementInvarianceConfiguralModelEffectSize"><span class="header-section-number">16.10.5.5</span> Effect Size of Non-Invariancee</a></li>
  <li><a href="#sec-measurementInvarianceConfiguralModelEquivalenceTest" id="toc-sec-measurementInvarianceConfiguralModelEquivalenceTest" class="nav-link" data-scroll-target="#sec-measurementInvarianceConfiguralModelEquivalenceTest"><span class="header-section-number">16.10.5.6</span> Equivalence Test</a></li>
  <li><a href="#sec-measurementInvarianceConfiguralModelPermutationTest" id="toc-sec-measurementInvarianceConfiguralModelPermutationTest" class="nav-link" data-scroll-target="#sec-measurementInvarianceConfiguralModelPermutationTest"><span class="header-section-number">16.10.5.7</span> Permutation Test</a></li>
  <li><a href="#sec-measurementInvarianceReliability" id="toc-sec-measurementInvarianceReliability" class="nav-link" data-scroll-target="#sec-measurementInvarianceReliability"><span class="header-section-number">16.10.5.8</span> Internal Consistency Reliability</a></li>
  <li><a href="#sec-measurementInvariancePathDiagram" id="toc-sec-measurementInvariancePathDiagram" class="nav-link" data-scroll-target="#sec-measurementInvariancePathDiagram"><span class="header-section-number">16.10.5.9</span> Path Diagram</a></li>
  </ul>
</li>
  <li>
<a href="#sec-measurementInvarianceMetricModel" id="toc-sec-measurementInvarianceMetricModel" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModel"><span class="header-section-number">16.10.6</span> Metric (“Weak Factorial”) Invariance Model</a>
  <ul>
<li>
<a href="#sec-measurementInvarianceMetricModelSyntax" id="toc-sec-measurementInvarianceMetricModelSyntax" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelSyntax"><span class="header-section-number">16.10.6.1</span> Model Syntax</a>
  <ul class="collapse">
<li><a href="#sec-measurementInvarianceMetricModelFeatures" id="toc-sec-measurementInvarianceMetricModelFeatures" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelFeatures"><span class="header-section-number">16.10.6.1.1</span> Summary of Model Features</a></li>
  </ul>
</li>
  <li><a href="#sec-measurementInvarianceMetricModelTabular" id="toc-sec-measurementInvarianceMetricModelTabular" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelTabular"><span class="header-section-number">16.10.6.2</span> Model Syntax in Table Form</a></li>
  <li><a href="#sec-measurementInvarianceMetricModelFit" id="toc-sec-measurementInvarianceMetricModelFit" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelFit"><span class="header-section-number">16.10.6.3</span> Fit the Model</a></li>
  <li><a href="#sec-measurementInvarianceMetricModelOutput" id="toc-sec-measurementInvarianceMetricModelOutput" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelOutput"><span class="header-section-number">16.10.6.4</span> Model Summary</a></li>
  <li><a href="#sec-measurementInvarianceMetricModelFitCriteria" id="toc-sec-measurementInvarianceMetricModelFitCriteria" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelFitCriteria"><span class="header-section-number">16.10.6.5</span> Model Fit</a></li>
  <li>
<a href="#sec-measurementInvarianceMetricModelCompare" id="toc-sec-measurementInvarianceMetricModelCompare" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelCompare"><span class="header-section-number">16.10.6.6</span> Compare Model Fit</a>
  <ul class="collapse">
<li><a href="#sec-measurementInvarianceMetricModelNestedModelComparison" id="toc-sec-measurementInvarianceMetricModelNestedModelComparison" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelNestedModelComparison"><span class="header-section-number">16.10.6.6.1</span> Nested Model (<span class="math inline">\(\chi^2\)</span>) Difference Test</a></li>
  <li><a href="#sec-measurementInvarianceMetricModelCompareFitCriteria" id="toc-sec-measurementInvarianceMetricModelCompareFitCriteria" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelCompareFitCriteria"><span class="header-section-number">16.10.6.6.2</span> Compare Other Fit Criteria</a></li>
  <li><a href="#sec-measurementInvarianceMetricModelScoreBasedTest" id="toc-sec-measurementInvarianceMetricModelScoreBasedTest" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelScoreBasedTest"><span class="header-section-number">16.10.6.6.3</span> Score-Based Test</a></li>
  <li><a href="#sec-measurementInvarianceMetricModelEffectSize" id="toc-sec-measurementInvarianceMetricModelEffectSize" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelEffectSize"><span class="header-section-number">16.10.6.6.4</span> Effect Size of Non-Invariance</a></li>
  <li><a href="#sec-measurementInvarianceMetricModelEquivalenceTest" id="toc-sec-measurementInvarianceMetricModelEquivalenceTest" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelEquivalenceTest"><span class="header-section-number">16.10.6.6.5</span> Equivalence Test</a></li>
  <li><a href="#sec-measurementInvarianceMetricModelPermutationTest" id="toc-sec-measurementInvarianceMetricModelPermutationTest" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelPermutationTest"><span class="header-section-number">16.10.6.6.6</span> Permutation Test</a></li>
  </ul>
</li>
  <li><a href="#sec-measurementInvarianceMetricModelReliability" id="toc-sec-measurementInvarianceMetricModelReliability" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelReliability"><span class="header-section-number">16.10.6.7</span> Internal Consistency Reliability</a></li>
  <li><a href="#sec-measurementInvarianceMetricModelPathDiagram" id="toc-sec-measurementInvarianceMetricModelPathDiagram" class="nav-link" data-scroll-target="#sec-measurementInvarianceMetricModelPathDiagram"><span class="header-section-number">16.10.6.8</span> Path Diagram</a></li>
  </ul>
</li>
  <li>
<a href="#sec-measurementInvarianceScalarModel" id="toc-sec-measurementInvarianceScalarModel" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModel"><span class="header-section-number">16.10.7</span> Scalar (“Strong Factorial”) Invariance Model</a>
  <ul>
<li>
<a href="#sec-measurementInvarianceScalarModelSyntax" id="toc-sec-measurementInvarianceScalarModelSyntax" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelSyntax"><span class="header-section-number">16.10.7.1</span> Model Syntax</a>
  <ul class="collapse">
<li><a href="#sec-measurementInvarianceScalarModelFeatures" id="toc-sec-measurementInvarianceScalarModelFeatures" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelFeatures"><span class="header-section-number">16.10.7.1.1</span> Summary of Model Features</a></li>
  </ul>
</li>
  <li><a href="#sec-measurementInvarianceScalarModelTabular" id="toc-sec-measurementInvarianceScalarModelTabular" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelTabular"><span class="header-section-number">16.10.7.2</span> Model Syntax in Table Form</a></li>
  <li><a href="#sec-measurementInvarianceScalarModelFit" id="toc-sec-measurementInvarianceScalarModelFit" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelFit"><span class="header-section-number">16.10.7.3</span> Fit the Model</a></li>
  <li><a href="#sec-measurementInvarianceScalarModelOutput" id="toc-sec-measurementInvarianceScalarModelOutput" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelOutput"><span class="header-section-number">16.10.7.4</span> Model Summary</a></li>
  <li><a href="#sec-measurementInvarianceScalarModelFitCriteria" id="toc-sec-measurementInvarianceScalarModelFitCriteria" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelFitCriteria"><span class="header-section-number">16.10.7.5</span> Model Fit</a></li>
  <li>
<a href="#sec-measurementInvarianceScalarModelCompare" id="toc-sec-measurementInvarianceScalarModelCompare" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelCompare"><span class="header-section-number">16.10.7.6</span> Compare Model Fit</a>
  <ul class="collapse">
<li><a href="#sec-measurementInvarianceScalarModelNestedModelComparison" id="toc-sec-measurementInvarianceScalarModelNestedModelComparison" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelNestedModelComparison"><span class="header-section-number">16.10.7.6.1</span> Nested Model (<span class="math inline">\(\chi^2\)</span>) Difference Test</a></li>
  <li><a href="#sec-measurementInvarianceScalarModelCompareFitCriteria" id="toc-sec-measurementInvarianceScalarModelCompareFitCriteria" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelCompareFitCriteria"><span class="header-section-number">16.10.7.6.2</span> Compare Other Fit Criteria</a></li>
  <li><a href="#sec-measurementInvarianceScalarScoreBasedTest" id="toc-sec-measurementInvarianceScalarScoreBasedTest" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarScoreBasedTest"><span class="header-section-number">16.10.7.6.3</span> Score-Based Test</a></li>
  <li><a href="#sec-measurementInvarianceScalarModelEffectSize" id="toc-sec-measurementInvarianceScalarModelEffectSize" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelEffectSize"><span class="header-section-number">16.10.7.6.4</span> Effect Size of Non-Invariance</a></li>
  <li><a href="#sec-measurementInvarianceScalarModelEquivalenceTest" id="toc-sec-measurementInvarianceScalarModelEquivalenceTest" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelEquivalenceTest"><span class="header-section-number">16.10.7.6.5</span> Equivalence Test</a></li>
  <li><a href="#sec-measurementInvarianceScalarModelPermutationTest" id="toc-sec-measurementInvarianceScalarModelPermutationTest" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelPermutationTest"><span class="header-section-number">16.10.7.6.6</span> Permutation Test</a></li>
  </ul>
</li>
  <li><a href="#sec-measurementInvarianceScalarModelReliability" id="toc-sec-measurementInvarianceScalarModelReliability" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelReliability"><span class="header-section-number">16.10.7.7</span> Internal Consistency Reliability</a></li>
  <li><a href="#sec-measurementInvarianceScalarModelPathDiagram" id="toc-sec-measurementInvarianceScalarModelPathDiagram" class="nav-link" data-scroll-target="#sec-measurementInvarianceScalarModelPathDiagram"><span class="header-section-number">16.10.7.8</span> Path Diagram</a></li>
  </ul>
</li>
  <li>
<a href="#sec-measurementInvarianceResidualModel" id="toc-sec-measurementInvarianceResidualModel" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModel"><span class="header-section-number">16.10.8</span> Residual (“Strict Factorial”) Invariance Model</a>
  <ul>
<li>
<a href="#sec-measurementInvarianceResidualModelSyntax" id="toc-sec-measurementInvarianceResidualModelSyntax" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelSyntax"><span class="header-section-number">16.10.8.1</span> Model Syntax</a>
  <ul class="collapse">
<li><a href="#sec-measurementInvarianceResidualModelFeatures" id="toc-sec-measurementInvarianceResidualModelFeatures" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelFeatures"><span class="header-section-number">16.10.8.1.1</span> Summary of Model Features</a></li>
  </ul>
</li>
  <li><a href="#sec-measurementInvarianceResidualModelTabular" id="toc-sec-measurementInvarianceResidualModelTabular" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelTabular"><span class="header-section-number">16.10.8.2</span> Model Syntax in Table Form</a></li>
  <li><a href="#sec-measurementInvarianceResidualModelFit" id="toc-sec-measurementInvarianceResidualModelFit" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelFit"><span class="header-section-number">16.10.8.3</span> Fit the Model</a></li>
  <li><a href="#sec-measurementInvarianceResidualModelOutput" id="toc-sec-measurementInvarianceResidualModelOutput" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelOutput"><span class="header-section-number">16.10.8.4</span> Model Summary</a></li>
  <li><a href="#sec-measurementInvarianceResidualModelFitCriteria" id="toc-sec-measurementInvarianceResidualModelFitCriteria" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelFitCriteria"><span class="header-section-number">16.10.8.5</span> Model Fit</a></li>
  <li>
<a href="#sec-measurementInvarianceResidualModelCompare" id="toc-sec-measurementInvarianceResidualModelCompare" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelCompare"><span class="header-section-number">16.10.8.6</span> Compare Model Fit</a>
  <ul class="collapse">
<li><a href="#sec-measurementInvarianceResidualModelNestedModelComparison" id="toc-sec-measurementInvarianceResidualModelNestedModelComparison" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelNestedModelComparison"><span class="header-section-number">16.10.8.6.1</span> Nested Model (<span class="math inline">\(\chi^2\)</span>) Difference Test</a></li>
  <li><a href="#sec-measurementInvarianceResidualModelCompareFitCriteria" id="toc-sec-measurementInvarianceResidualModelCompareFitCriteria" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelCompareFitCriteria"><span class="header-section-number">16.10.8.6.2</span> Compare Other Fit Criteria</a></li>
  <li><a href="#sec-measurementInvarianceResidualModelScoreBasedTest" id="toc-sec-measurementInvarianceResidualModelScoreBasedTest" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelScoreBasedTest"><span class="header-section-number">16.10.8.6.3</span> Score-Based Test</a></li>
  <li><a href="#sec-measurementInvarianceResidualModelEffectSize" id="toc-sec-measurementInvarianceResidualModelEffectSize" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelEffectSize"><span class="header-section-number">16.10.8.6.4</span> Effect Size of Non-Invariance</a></li>
  <li><a href="#sec-measurementInvarianceResidualModelEquivalenceTest" id="toc-sec-measurementInvarianceResidualModelEquivalenceTest" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelEquivalenceTest"><span class="header-section-number">16.10.8.6.5</span> Equivalence Test</a></li>
  <li><a href="#sec-measurementInvarianceResidualModelPermutationTest" id="toc-sec-measurementInvarianceResidualModelPermutationTest" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelPermutationTest"><span class="header-section-number">16.10.8.6.6</span> Permutation Test</a></li>
  </ul>
</li>
  <li><a href="#sec-measurementInvarianceResidualModelReliability" id="toc-sec-measurementInvarianceResidualModelReliability" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelReliability"><span class="header-section-number">16.10.8.7</span> Internal Consistency Reliability</a></li>
  <li><a href="#sec-measurementInvarianceResidualModelPathDiagram" id="toc-sec-measurementInvarianceResidualModelPathDiagram" class="nav-link" data-scroll-target="#sec-measurementInvarianceResidualModelPathDiagram"><span class="header-section-number">16.10.8.8</span> Path Diagram</a></li>
  </ul>
</li>
  <li>
<a href="#sec-addressingMeasurementNonInvariance" id="toc-sec-addressingMeasurementNonInvariance" class="nav-link" data-scroll-target="#sec-addressingMeasurementNonInvariance"><span class="header-section-number">16.10.9</span> Addressing Measurement Non-Invariance</a>
  <ul>
<li>
<a href="#sec-measurementInvarianceAddConstraints" id="toc-sec-measurementInvarianceAddConstraints" class="nav-link" data-scroll-target="#sec-measurementInvarianceAddConstraints"><span class="header-section-number">16.10.9.1</span> Iteratively add constraints to identify measurement non-invariance</a>
  <ul class="collapse">
<li><a href="#sec-measurementInvarianceAddConstraintsVariable1" id="toc-sec-measurementInvarianceAddConstraintsVariable1" class="nav-link" data-scroll-target="#sec-measurementInvarianceAddConstraintsVariable1"><span class="header-section-number">16.10.9.1.1</span> Variable 1</a></li>
  <li><a href="#sec-measurementInvarianceAddConstraintsVariable2" id="toc-sec-measurementInvarianceAddConstraintsVariable2" class="nav-link" data-scroll-target="#sec-measurementInvarianceAddConstraintsVariable2"><span class="header-section-number">16.10.9.1.2</span> Variable 2</a></li>
  <li><a href="#sec-measurementInvarianceAddConstraintsVariable3" id="toc-sec-measurementInvarianceAddConstraintsVariable3" class="nav-link" data-scroll-target="#sec-measurementInvarianceAddConstraintsVariable3"><span class="header-section-number">16.10.9.1.3</span> Variable 3</a></li>
  <li><a href="#sec-measurementInvarianceAddConstraintsVariable4" id="toc-sec-measurementInvarianceAddConstraintsVariable4" class="nav-link" data-scroll-target="#sec-measurementInvarianceAddConstraintsVariable4"><span class="header-section-number">16.10.9.1.4</span> Variable 4</a></li>
  <li><a href="#sec-measurementInvarianceAddConstraintsVariable5" id="toc-sec-measurementInvarianceAddConstraintsVariable5" class="nav-link" data-scroll-target="#sec-measurementInvarianceAddConstraintsVariable5"><span class="header-section-number">16.10.9.1.5</span> Variable 5</a></li>
  <li><a href="#sec-measurementInvarianceAddConstraintsVariable6" id="toc-sec-measurementInvarianceAddConstraintsVariable6" class="nav-link" data-scroll-target="#sec-measurementInvarianceAddConstraintsVariable6"><span class="header-section-number">16.10.9.1.6</span> Variable 6</a></li>
  <li><a href="#sec-measurementInvarianceAddConstraintsVariable7" id="toc-sec-measurementInvarianceAddConstraintsVariable7" class="nav-link" data-scroll-target="#sec-measurementInvarianceAddConstraintsVariable7"><span class="header-section-number">16.10.9.1.7</span> Variable 7</a></li>
  <li><a href="#sec-measurementInvarianceAddConstraintsVariable8" id="toc-sec-measurementInvarianceAddConstraintsVariable8" class="nav-link" data-scroll-target="#sec-measurementInvarianceAddConstraintsVariable8"><span class="header-section-number">16.10.9.1.8</span> Variable 8</a></li>
  <li><a href="#sec-measurementInvarianceAddConstraintsVariable9" id="toc-sec-measurementInvarianceAddConstraintsVariable9" class="nav-link" data-scroll-target="#sec-measurementInvarianceAddConstraintsVariable9"><span class="header-section-number">16.10.9.1.9</span> Variable 9</a></li>
  <li><a href="#sec-measurementInvarianceAddConstraintsSummary" id="toc-sec-measurementInvarianceAddConstraintsSummary" class="nav-link" data-scroll-target="#sec-measurementInvarianceAddConstraintsSummary"><span class="header-section-number">16.10.9.1.10</span> Summary</a></li>
  </ul>
</li>
  <li>
<a href="#sec-measurementInvarianceDropConstraints" id="toc-sec-measurementInvarianceDropConstraints" class="nav-link" data-scroll-target="#sec-measurementInvarianceDropConstraints"><span class="header-section-number">16.10.9.2</span> Iteratively drop constraints to identify measurement non-invariance</a>
  <ul class="collapse">
<li><a href="#sec-measurementInvarianceDropConstraintsVariable1" id="toc-sec-measurementInvarianceDropConstraintsVariable1" class="nav-link" data-scroll-target="#sec-measurementInvarianceDropConstraintsVariable1"><span class="header-section-number">16.10.9.2.1</span> Variable 1</a></li>
  <li><a href="#sec-measurementInvarianceDropConstraintsVariable2" id="toc-sec-measurementInvarianceDropConstraintsVariable2" class="nav-link" data-scroll-target="#sec-measurementInvarianceDropConstraintsVariable2"><span class="header-section-number">16.10.9.2.2</span> Variable 2</a></li>
  <li><a href="#sec-measurementInvarianceDropConstraintsVariable3" id="toc-sec-measurementInvarianceDropConstraintsVariable3" class="nav-link" data-scroll-target="#sec-measurementInvarianceDropConstraintsVariable3"><span class="header-section-number">16.10.9.2.3</span> Variable 3</a></li>
  <li><a href="#sec-measurementInvarianceDropConstraintsVariable4" id="toc-sec-measurementInvarianceDropConstraintsVariable4" class="nav-link" data-scroll-target="#sec-measurementInvarianceDropConstraintsVariable4"><span class="header-section-number">16.10.9.2.4</span> Variable 4</a></li>
  <li><a href="#sec-measurementInvarianceDropConstraintsVariable5" id="toc-sec-measurementInvarianceDropConstraintsVariable5" class="nav-link" data-scroll-target="#sec-measurementInvarianceDropConstraintsVariable5"><span class="header-section-number">16.10.9.2.5</span> Variable 5</a></li>
  <li><a href="#sec-measurementInvarianceDropConstraintsVariable6" id="toc-sec-measurementInvarianceDropConstraintsVariable6" class="nav-link" data-scroll-target="#sec-measurementInvarianceDropConstraintsVariable6"><span class="header-section-number">16.10.9.2.6</span> Variable 6</a></li>
  <li><a href="#sec-measurementInvarianceDropConstraintsVariable7" id="toc-sec-measurementInvarianceDropConstraintsVariable7" class="nav-link" data-scroll-target="#sec-measurementInvarianceDropConstraintsVariable7"><span class="header-section-number">16.10.9.2.7</span> Variable 7</a></li>
  <li><a href="#sec-measurementInvarianceDropConstraintsVariable8" id="toc-sec-measurementInvarianceDropConstraintsVariable8" class="nav-link" data-scroll-target="#sec-measurementInvarianceDropConstraintsVariable8"><span class="header-section-number">16.10.9.2.8</span> Variable 8</a></li>
  <li><a href="#sec-measurementInvarianceDropConstraintsVariable9" id="toc-sec-measurementInvarianceDropConstraintsVariable9" class="nav-link" data-scroll-target="#sec-measurementInvarianceDropConstraintsVariable9"><span class="header-section-number">16.10.9.2.9</span> Variable 9</a></li>
  <li><a href="#sec-measurementInvarianceDropConstraintsSummary" id="toc-sec-measurementInvarianceDropConstraintsSummary" class="nav-link" data-scroll-target="#sec-measurementInvarianceDropConstraintsSummary"><span class="header-section-number">16.10.9.2.10</span> Summary</a></li>
  </ul>
</li>
  <li><a href="#sec-measurementInvarianceNextSteps" id="toc-sec-measurementInvarianceNextSteps" class="nav-link" data-scroll-target="#sec-measurementInvarianceNextSteps"><span class="header-section-number">16.10.9.3</span> Next Steps</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#sec-conclusion-bias" id="toc-sec-conclusion-bias" class="nav-link" data-scroll-target="#sec-conclusion-bias"><span class="header-section-number">16.11</span> Conclusion</a></li>
  <li><a href="#sec-readings-bias" id="toc-sec-readings-bias" class="nav-link" data-scroll-target="#sec-readings-bias"><span class="header-section-number">16.12</span> Suggested Readings</a></li>
  <li>
<a href="#sec-exercises-bias" id="toc-sec-exercises-bias" class="nav-link" data-scroll-target="#sec-exercises-bias"><span class="header-section-number">16.13</span> Exercises</a>
  <ul>
<li><a href="#sec-exercisesQuestions-bias" id="toc-sec-exercisesQuestions-bias" class="nav-link" data-scroll-target="#sec-exercisesQuestions-bias"><span class="header-section-number">16.13.1</span> Questions</a></li>
  <li><a href="#sec-exercisesAnswers-bias" id="toc-sec-exercisesAnswers-bias" class="nav-link" data-scroll-target="#sec-exercisesAnswers-bias"><span class="header-section-number">16.13.2</span> Answers</a></li>
  </ul>
</li>
  <li><a href="#sec-sessionInfo-bias" id="toc-sec-sessionInfo-bias" class="nav-link" data-scroll-target="#sec-sessionInfo-bias"><span class="header-section-number">16.14</span> Session Info</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/edit/main/test-bias.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/blob/main/test-bias.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><div class="alert alert-info hints-alert">
  <div class="hints-icon">
    <i class="fa fa-comments-o"></i>
  </div>
  <div class="hints-container">
    <b>I need your help!</b>
    <p>
    I want your feedback to make the book better for you and other readers. If you find typos, errors, or places where the text may be improved, please let me know.
    The best ways to provide feedback are by <a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment">GitHub</a> or <a href="https://hypothes.is">hypothes.is</a> annotations.
    </p>

    <p>
      <i class="fa fa-github"></i>
      <a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/issues">Opening an issue</a> or <a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/pulls">submitting a pull request</a> on GitHub: <a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment">https://github.com/isaactpetersen/Principles-Psychological-Assessment</a>
    </p>
    <p>
      <img style="display: inline;" src="https://hypothes.is/organizations/__default__/logo" alt="Hypothesis">
      Adding an annotation using <a href="https://hypothes.is">hypothes.is</a>.
      To add an annotation, <span style="background-color: #3297FD; color: white">select some text</span> and then click the
      <span class="svg-icon--inline"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 16 16" class="annotator-adder-actions__icon"><path fill="currentColor" fill-rule="nonzero" d="M15 0c.27 0 .505.099.703.297A.961.961 0 0116 1v15l-4-3H1a.974.974 0 01-.703-.29A.953.953 0 010 12V1C0 .719.096.482.29.29A.966.966 0 011 0h14zM7 3l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C4.156 5.229 4 6 4 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188C4.729 8.854 5.082 9 5.5 9c.417 0 .77-.146 1.063-.438C6.854 8.271 7 7.918 7 7.5c0-.417-.146-.77-.438-1.063A1.447 1.447 0 005.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L7 4V3zm5 0l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C9.156 5.229 9 6 9 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188c.291.291.645.437 1.062.437.417 0 .77-.146 1.063-.438.291-.291.437-.645.437-1.062 0-.417-.146-.77-.438-1.063A1.447 1.447 0 0010.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L12 4V3z"></path></svg></span>
      symbol on the pop-up menu.
      To see the annotations of others, click the
      <span class="svg-icon--inline"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 16 16" class=""><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 12L6 8l4-4"></path></g></svg></span>
      symbol in the upper right-hand corner of the page.
    </p>
  </div>
</div>

<header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-bias" class="quarto-section-identifier"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Test Bias</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="sec-overview-bias" class="level2" data-number="16.1"><h2 data-number="16.1" class="anchored" data-anchor-id="sec-overview-bias">
<span class="header-section-number">16.1</span> Overview of Bias</h2>
<p>There are multiple definitions of the term “bias” depending on the context. In general, bias is a <a href="reliability.html#sec-systematicError">systematic error</a> <span class="citation" data-cites="Reynolds2012">(<a href="references.html#ref-Reynolds2012" role="doc-biblioref">Reynolds &amp; Suzuki, 2012</a>)</span>. <a href="prediction.html#sec-meanError">Mean error</a> is an example of <a href="reliability.html#sec-systematicError">systematic error</a>, and is sometimes called bias. Cognitive biases are systematic errors in thinking, including confirmation bias and hindsight bias. <a href="reliability.html#sec-methodBias">Method biases</a> are a form of <a href="reliability.html#sec-systematicError">systematic error</a> that involve the influence of measurement on a person’s score that is not due to the person’s level on the construct. <a href="reliability.html#sec-methodBias">Method biases</a> include response biases or response styles, including acquiescence and social desirability bias. Attentional bias refers to the tendency to process some types of stimuli more than others.</p>
<p>Sometimes bias is used to refer in particular to <a href="reliability.html#sec-systematicError">systematic error</a> (in measurement, prediction, etc.) as a function of group membership, where test bias refers to the same score having different meaning for different groups. Under this meaning, a test is unbiased if a given test score has the same meaning regardless of group membership. For example, a test is biased if there is differential <a href="validity.html">validity</a> of test scores for groups (e.g., age, education, culture, race, sex). Test bias would exist, for instance, if a test is a less <a href="validity.html">valid</a> predictor for racial minorities or linguistic minorities. Test bias would also exist if scores on the Scholastic Aptitude Test (SAT) under-estimate women’s grades in college, for instance.</p>
<p>There are some known instances of test bias, as described in <a href="#sec-biasExamples" class="quarto-xref"><span>Section 16.3</span></a>. Research has not produced much empirical evidence of test bias <span class="citation" data-cites="Brown1999 Hall1999 Jensen1980 Kuncel2010a Reynolds2012 Reynolds2021 Sackett1994 Sackett2008">(<a href="references.html#ref-Brown1999" role="doc-biblioref">Brown et al., 1999</a>; <a href="references.html#ref-Hall1999" role="doc-biblioref">Hall et al., 1999</a>; <a href="references.html#ref-Jensen1980" role="doc-biblioref">Jensen, 1980</a>; <a href="references.html#ref-Kuncel2010a" role="doc-biblioref">Kuncel &amp; Hezlett, 2010</a>; <a href="references.html#ref-Reynolds2021" role="doc-biblioref">Reynolds et al., 2021</a>; <a href="references.html#ref-Reynolds2012" role="doc-biblioref">Reynolds &amp; Suzuki, 2012</a>; <a href="references.html#ref-Sackett2008" role="doc-biblioref">Sackett et al., 2008</a>; <a href="references.html#ref-Sackett1994" role="doc-biblioref">Sackett &amp; Wilk, 1994</a>)</span>, though some item-level bias is not uncommon. Moreover, where test bias has been observed, it is often small, unclear, and does not always generalize <span class="citation" data-cites="Cole1981">(<a href="references.html#ref-Cole1981" role="doc-biblioref">N. S. Cole, 1981</a>)</span>. However, just because there is not much empirical evidence of test bias does not mean that test bias does not exist. Moreover, just because a test does not show bias does not mean that it should be used. Furthermore, just because a test does not show bias does not mean that there are not race-, social class-, and gender-related <a href="diversity.html#sec-biasClinicalJudgment">biases in clinical judgment</a> during the assessment process.</p>
<p>It is also worth pointing out that group differences in scores do not necessarily indicate bias. Group differences in scores could reflect true group differences in the construct. For instance, women have better verbal abilities, on average, compared to men. So, if women’s scores on a verbal ability test are higher on average than men’s scores, this would not be sufficient evidence for bias.</p>
<p>There are two broad categories of test bias:</p>
<ol type="1">
<li><a href="#sec-predictiveBias">predictive bias</a></li>
<li><a href="#sec-testStructureBias">test structure bias</a></li>
</ol>
<p><a href="#sec-predictiveBias">Predictive bias</a> refers to differences between groups in the relation between the test and criterion. As with all <a href="validity.html#sec-criterionValidity">criterion-related validity</a> tests, the findings depend on the strength and quality of the criterion. <a href="#sec-testStructureBias">Test structure bias</a> refers to differences in the internal test characteristics across groups.</p>
</section><section id="sec-detectBias" class="level2" data-number="16.2"><h2 data-number="16.2" class="anchored" data-anchor-id="sec-detectBias">
<span class="header-section-number">16.2</span> Ways to Investigate/Detect Test Bias</h2>
<section id="sec-predictiveBias" class="level3" data-number="16.2.1"><h3 data-number="16.2.1" class="anchored" data-anchor-id="sec-predictiveBias">
<span class="header-section-number">16.2.1</span> Predictive Bias</h3>
<p>Predictive bias exists when differences emerge between groups in terms of <a href="validity.html#sec-predictiveValidity">predictive validity</a> to a criterion. It is assessed by using a regression line looking at the association between test score and job performance. For instance, consider a <a href="prediction.html#sec-confusionMatrix">2x2 confusion matrix</a> used for the standard prediction problem. A <a href="prediction.html#sec-confusionMatrix">confusion matrix</a> for whom to select for a job is depicted in <a href="#fig-jobSelection" class="quarto-xref">Figure&nbsp;<span>16.1</span></a>.</p>
<div id="fig-jobSelection" class="quarto-float quarto-figure quarto-figure-center anchored" alt="2x2 Confusion Matrix for Job Selection. TP = true positive; TN = true negative; FP = false positive; FN = false negative.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-jobSelection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/JobSelection.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;16.1: 2x2 Confusion Matrix for Job Selection. TP = true positive; TN = true negative; FP = false positive; FN = false negative."><img src="images/JobSelection.png" class="img-fluid figure-img" style="width:100.0%" alt="2x2 Confusion Matrix for Job Selection. TP = true positive; TN = true negative; FP = false positive; FN = false negative."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jobSelection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.1: 2x2 Confusion Matrix for Job Selection. TP = true positive; TN = true negative; FP = false positive; FN = false negative.
</figcaption></figure>
</div>
<p>We can also visualize the <a href="prediction.html#sec-confusionMatrix">confusion matrix</a> in terms of a scatterplot of the test scores (i.e., predicted job performance) and the “truth” scores (i.e., actual job performance), as depicted in <a href="#fig-jobSelection2" class="quarto-xref">Figure&nbsp;<span>16.2</span></a>. The predictor (test score) is on the x-axis. The criterion (job performance) is on the y-axis. The quadrants reflect the cutoffs (i.e., thresholds) imposed from the 2x2 confusion matrix. The vertical line reflects the cutoff for selecting someone for a job. The horizontal line reflects the cutoff for good job performance (i.e., people who should have been selected for the job).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">plot.window</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Bad"</span>, <span class="st">"Good"</span>), <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">pos =</span> <span class="dv">0</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Bad"</span>, <span class="st">"Good"</span>), <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">pos =</span> <span class="dv">0</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="st">"Test Score"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">y =</span> <span class="fl">2.5</span>, <span class="st">"Job Performance"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">srt =</span> <span class="dv">90</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="st">"TP"</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="st">"TN"</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="st">"FP"</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="st">"FN"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-jobSelection2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="2x2 Confusion Matrix for Job Selection in the Form of a Graph With Predicted Performance on the x-Axis and Actual Job Performance on the y-Axis. TP = true positive; TN = true negative; FP = false positive; FN = false negative." data-fig-scap="2x2 Confusion Matrix for Job Selection in the Form of a Graph.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-jobSelection2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-jobSelection2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;16.2: 2x2 Confusion Matrix for Job Selection in the Form of a Graph With Predicted Performance on the x-Axis and Actual Job Performance on the y-Axis. TP = true positive; TN = true negative; FP = false positive; FN = false negative."><img src="test-bias_files/figure-html/fig-jobSelection2-1.png" class="img-fluid figure-img" data-fig-scap="2x2 Confusion Matrix for Job Selection in the Form of a Graph." alt="2x2 Confusion Matrix for Job Selection in the Form of a Graph With Predicted Performance on the x-Axis and Actual Job Performance on the y-Axis. TP = true positive; TN = true negative; FP = false positive; FN = false negative." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jobSelection2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.2: 2x2 Confusion Matrix for Job Selection in the Form of a Graph With Predicted Performance on the x-Axis and Actual Job Performance on the y-Axis. TP = true positive; TN = true negative; FP = false positive; FN = false negative.
</figcaption></figure>
</div>
</div>
</div>
<p>The data points in the top right quadrant are <a href="prediction.html#sec-truePositive">true positives</a>: people who the test predicted would do a good job and who did a good job. The data points in the bottom left quadrant are <a href="prediction.html#sec-trueNegative">true negatives</a>: people who the test predicted would do a poor job and who would have done a poor job. The data points in the bottom right quadrant are <a href="prediction.html#sec-falsePositive">false positives</a>: people who the test predicted would do a good job and who did a poor job. The data points in the top left quadrant are <a href="prediction.html#sec-falseNegative">false negatives</a>: people who the test predicted would do a poor job and who would have done a good job.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>predictor <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">max =</span> <span class="dv">4</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>outcomeGoodPredictor <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>predictor <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a>outcomeBadPredictor <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fl">0.1</span><span class="sc">*</span>predictor <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><a href="#fig-jobSelection3" class="quarto-xref">Figure&nbsp;<span>16.3</span></a> depicts a strong predictor. The best-fit regression line has a steep slope where there are lots of data points that are <a href="prediction.html#sec-truePositive">true positives</a> and <a href="prediction.html#sec-trueNegative">true negatives</a>, with relatively few <a href="prediction.html#sec-falsePositive">false positives</a> and <a href="prediction.html#sec-falseNegative">false negatives</a>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">plot.window</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">points</span>(<span class="at">x =</span> predictor, <span class="at">y =</span> outcomeGoodPredictor)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">abline</span>(<span class="fu">lm</span>(outcomeGoodPredictor <span class="sc">~</span> predictor))</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Bad"</span>, <span class="st">"Good"</span>), <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">pos =</span> <span class="dv">0</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Bad"</span>, <span class="st">"Good"</span>), <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">pos =</span> <span class="dv">0</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="st">"Test Score"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">y =</span> <span class="fl">2.5</span>, <span class="st">"Job Performance"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">srt =</span> <span class="dv">90</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="st">"TP"</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="st">"TN"</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="st">"FP"</span>)</span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="st">"FN"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-jobSelection3" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Example of a Strong Predictor. TP = true positive; TN = true negative; FP = false positive; FN = false negative." data-fig-scap="Example of a Strong Predictor.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-jobSelection3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-jobSelection3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;16.3: Example of a Strong Predictor. TP = true positive; TN = true negative; FP = false positive; FN = false negative."><img src="test-bias_files/figure-html/fig-jobSelection3-1.png" class="img-fluid figure-img" data-fig-scap="Example of a Strong Predictor." alt="Example of a Strong Predictor. TP = true positive; TN = true negative; FP = false positive; FN = false negative." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jobSelection3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.3: Example of a Strong Predictor. TP = true positive; TN = true negative; FP = false positive; FN = false negative.
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-jobSelection4" class="quarto-xref">Figure&nbsp;<span>16.4</span></a> depicts a poor predictor. The best-fit regression line has a shallow slope where there are just as many data points that are in the false cells (<a href="prediction.html#sec-falsePositive">false positives</a> and <a href="prediction.html#sec-falseNegative">false negatives</a>) as there are in the true cells (<a href="prediction.html#sec-truePositive">true positives</a> and <a href="prediction.html#sec-trueNegative">true negatives</a>). In general, the steeper the slope, the better the predictor.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">plot.window</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="fu">points</span>(<span class="at">x =</span> predictor, <span class="at">y =</span> outcomeBadPredictor)</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="fu">abline</span>(<span class="fu">lm</span>(outcomeBadPredictor <span class="sc">~</span> predictor))</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Bad"</span>, <span class="st">"Good"</span>), <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">pos =</span> <span class="dv">0</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Bad"</span>, <span class="st">"Good"</span>), <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">pos =</span> <span class="dv">0</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="st">"Test Score"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">y =</span> <span class="fl">2.5</span>, <span class="st">"Job Performance"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">srt =</span> <span class="dv">90</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="st">"TP"</span>)</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="st">"TN"</span>)</span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="st">"FP"</span>)</span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="st">"FN"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-jobSelection4" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Example of a Poor Predictor. TP = true positive; TN = true negative; FP = false positive; FN = false negative." data-fig-scap="Example of a Poor Predictor.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-jobSelection4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-jobSelection4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;16.4: Example of a Poor Predictor. TP = true positive; TN = true negative; FP = false positive; FN = false negative."><img src="test-bias_files/figure-html/fig-jobSelection4-1.png" class="img-fluid figure-img" data-fig-scap="Example of a Poor Predictor." alt="Example of a Poor Predictor. TP = true positive; TN = true negative; FP = false positive; FN = false negative." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jobSelection4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.4: Example of a Poor Predictor. TP = true positive; TN = true negative; FP = false positive; FN = false negative.
</figcaption></figure>
</div>
</div>
</div>
<p>We can evaluate predictive bias using a best-fit regression line between the predictor and criterion for each group.</p>
<section id="sec-typesPredictiveBias" class="level4" data-number="16.2.1.1"><h4 data-number="16.2.1.1" class="anchored" data-anchor-id="sec-typesPredictiveBias">
<span class="header-section-number">16.2.1.1</span> Types of Predictive Bias</h4>
<p>There are three types of predictive bias:</p>
<ol type="1">
<li><a href="#sec-differentSlopes">Different slopes</a></li>
<li><a href="#sec-differentIntercepts">Different intercepts</a></li>
<li><a href="#sec-differentInterceptsAndSlopes">Different intercepts and slopes</a></li>
</ol>
<p>The slope of the regression line is the steepness of the line. The intercept of the regression line is the y-value of the point where the line crosses the y-axis (i.e., when <span class="math inline">\(x = 0\)</span>). If a measure shows predictive test bias, when looking at the regression line for each group, the groups’ regression lines differ in either slopes and/or intercepts.</p>
<section id="sec-differentSlopes" class="level5" data-number="16.2.1.1.1"><h5 data-number="16.2.1.1.1" class="anchored" data-anchor-id="sec-differentSlopes">
<span class="header-section-number">16.2.1.1.1</span> Different Slopes</h5>
<p>Predictive bias in terms of different slopes exists when there are differences in the slope of the regression line between minority and majority groups. The slope describes the <em>direction</em> and <em>steepness</em> of the regression line. The slope of a regression line is the amount of change in <span class="math inline">\(y\)</span> for every unit change in <span class="math inline">\(x\)</span> (i.e., rise over run). Differing slopes indicate differential <a href="validity.html#sec-predictiveValidity">predictive validity</a>, in which the test is a more effective predictor of performance in one group over the other. Different slopes predictive bias is depicted in <a href="#fig-testBias1" class="quarto-xref">Figure&nbsp;<span>16.5</span></a>. In the figure, the predictor performs well in the majority group. However, the slope is close to zero in the minority group, indicating that there is no association between the predictor and the criterion for the minority group.</p>
<div id="fig-testBias1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Test Bias: Different Slopes. TP = true positive; TN = true negative; FP = false positive; FN = false negative.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-testBias1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/testBias-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;16.5: Test Bias: Different Slopes. TP = true positive; TN = true negative; FP = false positive; FN = false negative."><img src="images/testBias-01.png" class="img-fluid figure-img" style="width:100.0%" alt="Test Bias: Different Slopes. TP = true positive; TN = true negative; FP = false positive; FN = false negative."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-testBias1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.5: Test Bias: Different Slopes. TP = true positive; TN = true negative; FP = false positive; FN = false negative.
</figcaption></figure>
</div>
<p>Different slopes can especially occur if we develop our measure and criterion based on the normative majority group. Not much evidence has found empirical evidence of different slopes across groups. However, samples often do not have the power to detect differing slopes <span class="citation" data-cites="Aguinis2010a">(<a href="references.html#ref-Aguinis2010a" role="doc-biblioref">Aguinis et al., 2010</a>)</span>. Theoretically, to fix biases related to different slopes, you should find another measure that is more predictive for the minority group. If the predictor is a strong predictor in both groups but shows slight differences in the slope, <a href="#sec-withinGroupNorming">within-group norming</a> could be used.</p>
</section><section id="sec-differentIntercepts" class="level5" data-number="16.2.1.1.2"><h5 data-number="16.2.1.1.2" class="anchored" data-anchor-id="sec-differentIntercepts">
<span class="header-section-number">16.2.1.1.2</span> Different Intercepts</h5>
<p>Predictive bias in terms of different intercepts exists when there are differences in the intercept of the regression line between minority and majority groups. The <span class="math inline">\(y\)</span>-intercept describes the point on the <span class="math inline">\(y\)</span>-axis that the line intersects with the <span class="math inline">\(y\)</span>-axis (when <span class="math inline">\(x = 0\)</span>). When the distributions have similar slopes, intercept differences suggest that the measure systematically under- or over-estimates group performance relative to the person’s ability. The same test score leads to systematically different predictions for the majority and minority groups. In other words, minority group members get different tests scores than majority group members with the same ability. Different intercepts predictive bias is depicted in <a href="#fig-testBias2" class="quarto-xref">Figure&nbsp;<span>16.6</span></a>.</p>
<div id="fig-testBias2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Test Bias: Different Intercepts. TP = true positive; TN = true negative; FP = false positive; FN = false negative.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-testBias2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/testBias-02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;16.6: Test Bias: Different Intercepts. TP = true positive; TN = true negative; FP = false positive; FN = false negative."><img src="images/testBias-02.png" class="img-fluid figure-img" style="width:100.0%" alt="Test Bias: Different Intercepts. TP = true positive; TN = true negative; FP = false positive; FN = false negative."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-testBias2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.6: Test Bias: Different Intercepts. TP = true positive; TN = true negative; FP = false positive; FN = false negative.
</figcaption></figure>
</div>
<p>A higher intercept (relative to zero) indicates that the measure <em>under</em>-estimates a person’s ability (at that test score)—i.e., the person’s job performance is better than what the test score would suggest. A lower intercept (relative to zero) indicates that the measure <em>over</em>-estimates a person’s ability (at that test score)—i.e., the person’s job performance is worse than what the test score would suggest. <a href="#fig-testBias2" class="quarto-xref">Figure&nbsp;<span>16.6</span></a> indicates that the measure systematically under-estimates the job performance of the minority group.</p>
<p>Performance among members of a minority group could be under- or over-estimated. For example, historically, women’s grades in math and engineering classes tended to be under-estimated by the Scholastic Aptitude Test [SAT; <span class="citation" data-cites="Clark1984">Clark &amp; Grandy (<a href="references.html#ref-Clark1984" role="doc-biblioref">1984</a>)</span>]. However, where intercept differences have been observed, measures often show small <em>over</em>-estimation of school and job performance among minority groups <span class="citation" data-cites="Reynolds2012">(<a href="references.html#ref-Reynolds2012" role="doc-biblioref">Reynolds &amp; Suzuki, 2012</a>)</span>. For example, women’s physical strength and endurance is over-estimated based on physical ability tests <span class="citation" data-cites="Sackett1994">(<a href="references.html#ref-Sackett1994" role="doc-biblioref">Sackett &amp; Wilk, 1994</a>)</span>. In addition, over-estimation of African Americans’ and Hispanics’ school and job performance has been observed based on cognitive ability tests <span class="citation" data-cites="Cole1981 Reynolds2012 Sackett1994 Sackett2008">(<a href="references.html#ref-Cole1981" role="doc-biblioref">N. S. Cole, 1981</a>; <a href="references.html#ref-Reynolds2012" role="doc-biblioref">Reynolds &amp; Suzuki, 2012</a>; <a href="references.html#ref-Sackett2008" role="doc-biblioref">Sackett et al., 2008</a>; <a href="references.html#ref-Sackett1994" role="doc-biblioref">Sackett &amp; Wilk, 1994</a>)</span>. At the same time, the Black–White difference in job performance is less than the Black–White difference in test performance.</p>
<p>The over-prediction of lower-scoring groups is likely mostly an artifact of <a href="reliability.html#sec-measurementError">measurement error</a> <span class="citation" data-cites="Gottfredson1994">(<a href="references.html#ref-Gottfredson1994" role="doc-biblioref">L. S. Gottfredson, 1994</a>)</span>. The over-estimation of African Americans’ and Hispanics’ school and job performance may be due to <a href="reliability.html#sec-measurementError">measurement error</a> in the tests. Moreover, test scores explain only a portion of the variation in job performance. Black people are far less disadvantaged on the noncognitive determinants of job performance than on the cognitive ones. Nevertheless, the over-estimation that has been often observed is <em>on average</em>—the performance is not over-estimated for all individuals of the groups even if there is an average over-estimation effect. In addition, simulation findings indicate that lower intercepts (i.e., over-estimation) among minority groups compared to majority groups could be observed if there are different slopes but not different intercepts in the population, because different slopes are likely to go undetected due to low power <span class="citation" data-cites="Aguinis2010a">(<a href="references.html#ref-Aguinis2010a" role="doc-biblioref">Aguinis et al., 2010</a>)</span>. That is, if a test shows weaker <a href="validity.html">validity</a> for a minority group than the majority group, it could appear as different intercepts that favor the minority group when, in fact, it reflects shallower slopes of the minority group that go undetected.</p>
<p>Predictive biases in intercepts could especially occur if we develop tests that are based on the majority group, and the items assess constructs other than the construct of interest which are systematically biased in favor of the majority group or against the minority group. Arguments about reduced power to detect differences are less relevant for intercepts and means than for slopes.</p>
<p>To correct for a bias in intercepts, we could add <a href="#sec-bonusPoints">bonus points</a> to the scores for the minority group to correct for the amount of the <a href="reliability.html#sec-systematicError">systematic error</a>, and to result in the same regression line. But if the minority group is over-predicted (as has often been the case where intercept differences have been observed), we would not want to use <a href="#sec-scoreAdjustment">score adjustment</a> to lower the minority group’s scores.</p>
</section><section id="sec-differentInterceptsAndSlopes" class="level5" data-number="16.2.1.1.3"><h5 data-number="16.2.1.1.3" class="anchored" data-anchor-id="sec-differentInterceptsAndSlopes">
<span class="header-section-number">16.2.1.1.3</span> Different Intercepts and Slopes</h5>
<p>Predictive bias in terms of different intercepts and slopes exists when there are differences in the intercept and slope of the regression line between minority and majority groups. In cases of different intercepts and slopes, there is both differential <a href="validity.html">validity</a> (because the regression lines have different slopes), as well as varying under- and over-estimation of groups’ performance at particular scores. Different intercepts and slopes predictive bias is depicted in <a href="#fig-testBias3" class="quarto-xref">Figure&nbsp;<span>16.7</span></a>.</p>
<div id="fig-testBias3" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Test Bias: Different Intercepts and Slopes. TP = true positive; TN = true negative; FP = false positive; FN = false negative.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-testBias3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/testBias-03.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;16.7: Test Bias: Different Intercepts and Slopes. TP = true positive; TN = true negative; FP = false positive; FN = false negative."><img src="images/testBias-03.png" class="img-fluid figure-img" style="width:100.0%" alt="Test Bias: Different Intercepts and Slopes. TP = true positive; TN = true negative; FP = false positive; FN = false negative."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-testBias3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.7: Test Bias: Different Intercepts and Slopes. TP = true positive; TN = true negative; FP = false positive; FN = false negative.
</figcaption></figure>
</div>
<p>In instances of different intercepts and slopes predictive bias, a measure can simultaneously over-estimate and under-estimate a person’s ability at different test scores. For instance, a measure can under-estimate a person’s ability at higher test scores and can over-estimate a person’s ability at lower test scores.</p>
<p>Different intercepts and slopes across groups is possibly more realistic than just different intercepts or just different slopes. However, different intercepts and slopes predictive bias is more complicated to study, represent, and resolve. It is difficult to examine because of complexity, and it is not easy to fix. Currently, we have nothing to address different intercepts and slopes predictive bias. We would need to use a different measure or measures for each group.</p>
</section></section></section><section id="sec-testStructureBias" class="level3" data-number="16.2.2"><h3 data-number="16.2.2" class="anchored" data-anchor-id="sec-testStructureBias">
<span class="header-section-number">16.2.2</span> Test Structure Bias</h3>
<p>In addition to predictive bias, another type of test bias is test structure bias. Test structure bias involves differences in internal test characteristics across groups. Examining test structure bias is different from examining the total score, as is used when examining predictive bias. Test structure bias can be identified empirically or based on theory/judgment.</p>
<p>Empirically, test structure bias can be examined in multiple ways.</p>
<section id="sec-testStructureBiasEmpirical" class="level4" data-number="16.2.2.1"><h4 data-number="16.2.2.1" class="anchored" data-anchor-id="sec-testStructureBiasEmpirical">
<span class="header-section-number">16.2.2.1</span> Empirical Approaches to Identification</h4>
<p>In general, it is important to ensure that scores are on the same number line—and are thus able to be meaningfully compared—across groups. To empirically ensure that scores are on the same number line across groups, we must ensure two things:</p>
<ul>
<li>the scores have the same <em>scale</em> across groups—scale refers to how much the score changes per unit on the construct (number line)—that is, if scores have the same scale across groups, movement along the number line is equivalent.</li>
<li>the scores have the same <em>location</em> across groups—location refers to the origin or zero point on the number line—that is, if scores have the same location across groups, the number lines have the same origin.</li>
</ul>
<p>Two measures with different scales are depicted in <a href="#fig-rulerDifferentScale" class="quarto-xref">Figure&nbsp;<span>16.8</span></a>.</p>
<div id="fig-rulerDifferentScale" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Two Measures (i.e., Rulers) With Different Scales.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-rulerDifferentScale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/rulerDifferentScale.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;16.8: Two Measures (i.e., Rulers) With Different Scales."><img src="images/rulerDifferentScale.png" class="img-fluid figure-img" style="width:100.0%" alt="Two Measures (i.e., Rulers) With Different Scales."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rulerDifferentScale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.8: Two Measures (i.e., Rulers) With Different Scales.
</figcaption></figure>
</div>
<p>Two measures with different locations are depicted in <a href="#fig-rulerDifferentLocation" class="quarto-xref">Figure&nbsp;<span>16.9</span></a>.</p>
<div id="fig-rulerDifferentLocation" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Two Measures (i.e., Rulers) With Different Locations.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-rulerDifferentLocation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/rulerDifferentLocation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;16.9: Two Measures (i.e., Rulers) With Different Locations."><img src="images/rulerDifferentLocation.png" class="img-fluid figure-img" style="width:100.0%" alt="Two Measures (i.e., Rulers) With Different Locations."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rulerDifferentLocation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.9: Two Measures (i.e., Rulers) With Different Locations.
</figcaption></figure>
</div>
<p>The concepts of location and scale for various model types are provided in <a href="#tbl-testBiasLocationScale" class="quarto-xref">Table&nbsp;<span>16.1</span></a>.</p>
<div id="tbl-testBiasLocationScale" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-testBiasLocationScale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16.1: Concepts of Location and Scale in Various Model Types.
</figcaption><div aria-describedby="tbl-testBiasLocationScale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead><tr class="header">
<th><strong>Model</strong></th>
<th><strong>Location</strong></th>
<th><strong>Scale</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Regression</td>
<td>intercept</td>
<td>slope</td>
</tr>
<tr class="even">
<td>Confirmatory Factor Analysis</td>
<td>intercept/threshold</td>
<td>factor loading</td>
</tr>
<tr class="odd">
<td>Item Response Theory</td>
<td>difficulty/severity</td>
<td>discrimination</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<section id="sec-itemXgroupTests-bias" class="level5" data-number="16.2.2.1.1"><h5 data-number="16.2.2.1.1" class="anchored" data-anchor-id="sec-itemXgroupTests-bias">
<span class="header-section-number">16.2.2.1.1</span> Item <span class="math inline">\(\times\)</span> Group tests (ANOVA)</h5>
<p>Item <span class="math inline">\(\times\)</span> Group tests in analysis of variance (ANOVA) examine whether the difference between groups on the overall score match comparisons among smaller items sets between groups. Item <span class="math inline">\(\times\)</span> Group tests are used to rule out that items are operating in different ways in different groups. If the items operate in different ways in different groups, they do not have the same meaning across groups. For example, if we are going to use a measure for multiple groups, we would expect its items to operate similarly across groups. So, if women show higher scores on a depression measure compared to men, would also expect them to show similar elevations on each item (e.g., sleep loss).</p>
</section><section id="sec-irt-bias" class="level5" data-number="16.2.2.1.2"><h5 data-number="16.2.2.1.2" class="anchored" data-anchor-id="sec-irt-bias">
<span class="header-section-number">16.2.2.1.2</span> Item Response Theory</h5>
<p>Using <a href="item-response-theory.html">item response theory</a>, we can examine <a href="#sec-dif">differential item functioning</a> (DIF). Evidence of <a href="#sec-dif">DIF</a>, indicates that there are differences between group in terms of <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> and/or <a href="item-response-theory.html#sec-itemDifficulty">difficulty/severity</a> of items. Differences between groups in terms of the <a href="item-response-theory.html#sec-icc">item characteristic curve</a> (which combines the item’s <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> and <a href="item-response-theory.html#sec-itemDifficulty">severity</a>) would be evidence against <a href="validity.html#sec-constructValidity">construct validity</a> invariance between the groups and would provide evidence of bias. <a href="#sec-dif">DIF</a> examines stretching and compression of different groups. As an example, consider the item “bites others” in relation to externalizing problems. The item would be expected to show a weaker <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> and higher <a href="item-response-theory.html#sec-itemDifficulty">severity</a> in adults compared to children. <a href="#sec-dif">DIF</a> is discussed in <a href="#sec-dif" class="quarto-xref"><span>Section 16.9</span></a>.</p>
</section><section id="sec-cfa-bias" class="level5" data-number="16.2.2.1.3"><h5 data-number="16.2.2.1.3" class="anchored" data-anchor-id="sec-cfa-bias">
<span class="header-section-number">16.2.2.1.3</span> Confirmatory Factor Analysis</h5>
<p><a href="structural-equation-modeling.html#sec-cfa-sem">Confirmatory factor analysis</a> allows tests of <a href="#sec-measurementInvariance">measurement invariance</a> (also called factorial invariance). <a href="#sec-measurementInvariance">Measurement invariance</a> examines whether the factor structure of the underlying latent variables in the test is consistent across groups. It also examines whether the manifestation of the construct differs between groups. <a href="#sec-measurementInvariance">Measurement invariance</a> is discussed in <a href="#sec-measurementInvariance" class="quarto-xref"><span>Section 16.10</span></a>.</p>
<p>Even if you find the same slope and intercepts across groups in a prediction model, the measure would still be assessing different constructs across groups if the measure has a different factor structure between the groups. A different factor structure across groups is depicted in <a href="#fig-testBias4" class="quarto-xref">Figure&nbsp;<span>16.10</span></a>.</p>
<div id="fig-testBias4" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Different Factor Structure Across Groups.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-testBias4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/testBias-04.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;16.10: Different Factor Structure Across Groups."><img src="images/testBias-04.png" class="img-fluid figure-img" style="width:100.0%" alt="Different Factor Structure Across Groups."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-testBias4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.10: Different Factor Structure Across Groups.
</figcaption></figure>
</div>
<p>An example of a different factor structure across groups is the differentiation of executive functions from two factors to three factors (inhibition, working memory, cognitive flexibility) across childhood <span class="citation" data-cites="Lee2013">(<a href="references.html#ref-Lee2013" role="doc-biblioref">Lee et al., 2013</a>)</span>.</p>
<p>There are different degrees of measurement invariance <span class="citation" data-cites="Putnick2016">(for a review, see <a href="references.html#ref-Putnick2016" role="doc-biblioref">Putnick &amp; Bornstein, 2016</a>)</span>:</p>
<ul>
<li>Configural invariance: same number of factors in each group, and which indicators load on which factors are the same in each group (i.e., the same pattern of significant loadings in each group).</li>
<li>Metric (“weak factorial”) invariance: items have the same factor loadings (<a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a>) in each group.</li>
<li>Scalar (“strong factorial”) invariance: items have the same intercepts (<a href="item-response-theory.html#sec-itemDifficulty">difficulty/severity</a>) in each group.</li>
<li>Residual (“strict factorial”) invariance: items have the same residual/unique variances in each group.</li>
</ul></section><section id="sec-sem-bias" class="level5" data-number="16.2.2.1.4"><h5 data-number="16.2.2.1.4" class="anchored" data-anchor-id="sec-sem-bias">
<span class="header-section-number">16.2.2.1.4</span> Structural Equation Modeling</h5>
<p><a href="structural-equation-modeling.html">Structural equation modeling</a> is a <a href="factor-analysis-pca.html#sec-cfa">confirmatory factor analysis</a> (CFA) model that incorporates prediction. Structural equation modeling allows examining differences in the underlying structure with differences in prediction in the same model.</p>
</section><section id="sec-sdt-bias" class="level5" data-number="16.2.2.1.5"><h5 data-number="16.2.2.1.5" class="anchored" data-anchor-id="sec-sdt-bias">
<span class="header-section-number">16.2.2.1.5</span> Signal Detection Theory</h5>
<p><a href="prediction.html#sec-sdt">Signal detection theory</a> is a dynamic measure of bias. It allows examining the overall bias in selection systems, including both accuracy and errors at various cutoffs (<a href="prediction.html#sec-sensitivity">sensitivity</a>, <a href="prediction.html#sec-specificity">specificity</a>, <a href="prediction.html#sec-ppv">positive predictive value</a>, and <a href="prediction.html#sec-npv">negative predictive value</a>), as well as accuracy across all possible cutoffs (the <a href="prediction.html#sec-auc">area under the receiver operating characteristic curve</a>). While there may be similar <a href="validity.html#sec-predictiveValidity">predictive validity</a> between groups, the type of errors we are making across groups might differ. It is important to decide which types of error to emphasize depending on the fairness goals and examining <a href="prediction.html#sec-sensitivity">sensitivity</a>/<a href="prediction.html#sec-specificity">specificity</a> to adjust cutoffs.</p>
</section><section id="sec-evidenceTestStructureBias" class="level5" data-number="16.2.2.1.6"><h5 data-number="16.2.2.1.6" class="anchored" data-anchor-id="sec-evidenceTestStructureBias">
<span class="header-section-number">16.2.2.1.6</span> Empirical Evidence of Test Structure Bias</h5>
<p>It is not uncommon to find items that show differences across groups in <a href="item-response-theory.html#sec-itemDifficulty">severity</a> (intercepts) and/or <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> (factor loadings). However, cross-group differences in item functioning tend to be small and not consistent across studies, suggesting that some of the differences may reflect Type I errors that result from sampling error and multiple testing. That said, some instances of cross-group differences in item parameters could reflect test structure bias that is real and important to address.</p>
</section></section><section id="sec-testStructureBiasTheoretical" class="level4" data-number="16.2.2.2"><h4 data-number="16.2.2.2" class="anchored" data-anchor-id="sec-testStructureBiasTheoretical">
<span class="header-section-number">16.2.2.2</span> Theoretical/Judgmental Approaches to Identification</h4>
<section id="sec-facialValidityBias" class="level5" data-number="16.2.2.2.1"><h5 data-number="16.2.2.2.1" class="anchored" data-anchor-id="sec-facialValidityBias">
<span class="header-section-number">16.2.2.2.1</span> Facial Validity Bias</h5>
<p><a href="validity.html#sec-faceValidity">Facial validity</a> bias considers the extent to which an average person thinks that an item is biased—i.e., the item has differing <a href="validity.html">validity</a> between minority and majority groups. If so, the item should be reconsidered. Does an item disfavor certain groups? Is the language specific to a particular group? Is it offensive to some people? This type of judgment moves into the realm of whether or not an item should be used.</p>
</section><section id="sec-contentValidityBias" class="level5" data-number="16.2.2.2.2"><h5 data-number="16.2.2.2.2" class="anchored" data-anchor-id="sec-contentValidityBias">
<span class="header-section-number">16.2.2.2.2</span> Content Validity Bias</h5>
<p><a href="validity.html#sec-contentValidity">Content validity</a> bias is determined by judgments of construct experts who look for items that do not do an adequate job assessing the construct between groups. A construct may include some content facets in one group, but may include different content facets in another group, as depicted in <a href="#fig-testBias5" class="quarto-xref">Figure&nbsp;<span>16.11</span></a>.</p>
<div id="fig-testBias5" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Different Content Facets in a Given Construct for Two Groups.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-testBias5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/testBias-05.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;16.11: Different Content Facets in a Given Construct for Two Groups."><img src="images/testBias-05.png" class="img-fluid figure-img" style="width:100.0%" alt="Different Content Facets in a Given Construct for Two Groups."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-testBias5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.11: Different Content Facets in a Given Construct for Two Groups.
</figcaption></figure>
</div>
<p>Examples include information questions and vocabulary questions on the Wechsler Adult Intelligence Scale. If an item is linguistically complicated, grammatically complex or convoluted, or a double negative, it may be less <a href="validity.html">valid</a> or predictive for rural populations and those with less education.</p>
<p>Also, stereotype threat may contribute to <a href="validity.html#sec-contentValidity">content validity</a> bias. Stereotype threat occurs when people are or feel at risk of conforming themselves to stereotypes about their social group, thus leading them to show poorer performance in ways that are consistent with the stereotype. Stereotype threat may partially explain why some women may perform more poorly on some math items than some men.</p>
<p>Another example of <a href="validity.html#sec-contentValidity">content validity</a> bias is when the same measure is used to assess a construct across ages even though the construct shows heterotypic continuity. Heterotypic continuity occurs when a construct changes in its behavioral manifestation with development <span class="citation" data-cites="Petersen2020">(<a href="references.html#ref-Petersen2020" role="doc-biblioref">Petersen et al., 2020</a>)</span>. That is, the same construct may look different at different points in development. An example of a construct that shows heterotypic continuity is externalizing problems. In early childhood, externalizing problems often manifest in overt forms, including physical aggression (e.g., biting) and temper tantrums. By contrast, in adolescence and adulthood, externalizing problems more often manifest in covert ways, including relational aggression and substance use. <a href="validity.html#sec-contentValidity">Content validity</a> and <a href="validity.html#sec-faceValidity">facial validity</a> bias judgments are often related, but not always.</p>
</section></section></section></section><section id="sec-biasExamples" class="level2" data-number="16.3"><h2 data-number="16.3" class="anchored" data-anchor-id="sec-biasExamples">
<span class="header-section-number">16.3</span> Examples of Bias</h2>
<p>As described in the overview in <a href="#sec-overview-bias" class="quarto-xref"><span>Section 16.1</span></a>, there is not much empirical evidence of test bias <span class="citation" data-cites="Brown1999 Hall1999 Jensen1980 Kuncel2010a Reynolds2012 Reynolds2021 Sackett1994 Sackett2008">(<a href="references.html#ref-Brown1999" role="doc-biblioref">Brown et al., 1999</a>; <a href="references.html#ref-Hall1999" role="doc-biblioref">Hall et al., 1999</a>; <a href="references.html#ref-Jensen1980" role="doc-biblioref">Jensen, 1980</a>; <a href="references.html#ref-Kuncel2010a" role="doc-biblioref">Kuncel &amp; Hezlett, 2010</a>; <a href="references.html#ref-Reynolds2021" role="doc-biblioref">Reynolds et al., 2021</a>; <a href="references.html#ref-Reynolds2012" role="doc-biblioref">Reynolds &amp; Suzuki, 2012</a>; <a href="references.html#ref-Sackett2008" role="doc-biblioref">Sackett et al., 2008</a>; <a href="references.html#ref-Sackett1994" role="doc-biblioref">Sackett &amp; Wilk, 1994</a>)</span>. That said, some item-level bias is not uncommon. One instance of test bias is that, historically, women’s grades in math and engineering classes tended to be under-estimated by the Scholastic Aptitude Test [SAT; <span class="citation" data-cites="Clark1984">Clark &amp; Grandy (<a href="references.html#ref-Clark1984" role="doc-biblioref">1984</a>)</span>]. <span class="citation" data-cites="Fernandez2018">Fernández &amp; Abe (<a href="references.html#ref-Fernandez2018" role="doc-biblioref">2018</a>)</span> review the evidence on other instances of test and item bias. For instance, test bias can occur if a subgroup is less familiar with the language, the stimulus material, or the response procedures, or if they have different <a href="reliability.html#sec-methodBias-types">response styles</a>. In addition to test bias, there are known patterns of <a href="diversity.html#sec-biasClinicalJudgment">bias in clinical judgment</a>, as described in <a href="diversity.html#sec-biasClinicalJudgment" class="quarto-xref"><span>Section 25.3.11</span></a>.</p>
</section><section id="sec-fairness" class="level2" data-number="16.4"><h2 data-number="16.4" class="anchored" data-anchor-id="sec-fairness">
<span class="header-section-number">16.4</span> Test Fairness</h2>
<p>There is interest in examining more than just the accuracy of measures. It is also important to examine the <em>errors</em> being made and differentiate the weight or value of different kinds of errors (and correct decisions). Consider an example of an unbiased test, as depicted in <a href="#fig-testBias6" class="quarto-xref">Figure&nbsp;<span>16.12</span></a>, adapted from <span class="citation" data-cites="Gottfredson1994">L. S. Gottfredson (<a href="references.html#ref-Gottfredson1994" role="doc-biblioref">1994</a>)</span>. Although the example is of a White group and a Black group, we could substitute any two groups into the example (e.g., males versus females).</p>
<div id="fig-testBias6" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Potential Unfairness in Testing. The ovals represent the distributions of individuals' performance both on a test and a job performance criterion. TP = true positive; TN = true negative; FP = false positive; FN = false negative. (Adapted from @Gottfredson1994, Figure 1, p. 958. Gottfredson, L. S. (1994). The science and politics of race-norming. *American Psychologist*, *49*(11), 955–963. <https://doi.org/10.1037/0003-066X.49.11.955>) ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-testBias6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/testBias-06.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;16.12: Potential Unfairness in Testing. The ovals represent the distributions of individuals’ performance both on a test and a job performance criterion. TP = true positive; TN = true negative; FP = false positive; FN = false negative. (Adapted from @Gottfredson1994, Figure 1, p.&nbsp;958. Gottfredson, L. S. (1994). The science and politics of race-norming. American Psychologist, 49(11), 955–963. https://doi.org/10.1037/0003-066X.49.11.955)"><img src="images/testBias-06.png" class="img-fluid figure-img" style="width:100.0%" alt="Potential Unfairness in Testing. The ovals represent the distributions of individuals' performance both on a test and a job performance criterion. TP = true positive; TN = true negative; FP = false positive; FN = false negative. (Adapted from @Gottfredson1994, Figure 1, p. 958. Gottfredson, L. S. (1994). The science and politics of race-norming. *American Psychologist*, *49*(11), 955–963. <https://doi.org/10.1037/0003-066X.49.11.955>) "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-testBias6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.12: Potential Unfairness in Testing. The ovals represent the distributions of individuals’ performance both on a test and a job performance criterion. TP = true positive; TN = true negative; FP = false positive; FN = false negative. (Adapted from <span class="citation" data-cites="Gottfredson1994">L. S. Gottfredson (<a href="references.html#ref-Gottfredson1994" role="doc-biblioref">1994</a>)</span>, Figure 1, p.&nbsp;958. Gottfredson, L. S. (1994). The science and politics of race-norming. <em>American Psychologist</em>, <em>49</em>(11), 955–963. <a href="https://doi.org/10.1037/0003-066X.49.11.955" class="uri">https://doi.org/10.1037/0003-066X.49.11.955</a>)
</figcaption></figure>
</div>
<p>The example is of an unbiased test between White and Black job applicants. There are no differences between the two groups in terms of slope. If we drew a regression line, the line would go through the centroid of both ovals. Thus, the measure is equally predictive in both groups even though that the Black group failed the test at a higher rate than the White group. Moreover, there is no difference between the groups in terms of intercept. Thus, the performance of one group is not over-estimated relative to the performance of the other group. To demonstrate what a different intercept would look like, Group X shows a different intercept. In sum, there is no <a href="validity.html#sec-predictiveValidity">predictive validity</a> bias between the two groups. But just because the test predicts just as well in both groups does not mean that the selection procedures are <em>fair</em>.</p>
<p>Although the test is unbiased, there are differences in the <em>quality</em> of prediction: there are more <a href="prediction.html#sec-falseNegative">false negatives</a> in the Black group compared to the White group. This gives the White group an advantage and the Black group additional disadvantages. If the measure showed the same quality of prediction, we would say the test is fair. The point of the example is that just because a test is unbiased does not mean that the test is fair.</p>
<p>There are two kinds of errors: <a href="prediction.html#sec-falseNegative">false negatives</a> and <a href="prediction.html#sec-falsePositive">false positives</a>. Each error type has very different implications. <a href="prediction.html#sec-falseNegative">False negatives</a> would be when the test predicts that an applicant would perform poorly and we do not give them the job even though they would have performed well. <a href="prediction.html#sec-falseNegative">False negatives</a> have a negative effect on the applicant. And, in this example, there are more <a href="prediction.html#sec-falseNegative">false negatives</a> in the Black group. By contrast, <a href="prediction.html#sec-falsePositive">false positives</a> would be when we predict that an applicant would do well, and we give them the job but they perform poorly. <a href="prediction.html#sec-falsePositive">False positives</a> are a benefit to the applicant but have a negative effect on the employer. In this example, there are more <a href="prediction.html#sec-falsePositive">false positives</a> in the White group, which is an undeserved benefit based on the <a href="prediction.html#sec-selectionRatio">selection ratio</a>; therefore, the White group benefits.</p>
<p>In sum, equal accuracy of prediction (i.e., equal total number of errors) does not necessarily mean the test is fair; we must examine the types of errors. Merely ensuring accuracy does not ensure fairness!</p>
<section id="sec-adverseImpact" class="level3" data-number="16.4.1"><h3 data-number="16.4.1" class="anchored" data-anchor-id="sec-adverseImpact">
<span class="header-section-number">16.4.1</span> Adverse Impact</h3>
<p>Adverse impact is defined as rejecting members of one group at a higher rate than another group. Adverse impact is different from test <a href="validity.html">validity</a>. According to federal guidelines, adverse impact is present if the <a href="prediction.html#sec-selectionRatio">selection rate</a> of one group is less than four-fifths (80%) the <a href="prediction.html#sec-selectionRatio">selection rate</a> of the group with the highest <a href="prediction.html#sec-selectionRatio">selection rate</a>.</p>
<p>There is much more evidence of adverse impact than test bias. Indeed, disparate impact of tests on personnel selection across groups is the norm rather than the exception, even when using <a href="validity.html">valid</a> tests that are unbiased, which in part reflect group-related differences in job-related skills <span class="citation" data-cites="Gottfredson1994">(<a href="references.html#ref-Gottfredson1994" role="doc-biblioref">L. S. Gottfredson, 1994</a>)</span>. Examples of adverse impact include:</p>
<ul>
<li>physical ability tests, which produce substantial adverse impact against women (despite over-estimation of women’s performance),</li>
<li>cognitive ability tests, which produce substantial impact against some ethnic minority groups, especially Black and Hispanic people (despite over-estimation of Black and Hispanic people’s performance), even though cognitive ability tests tend to be among the strongest predictors of job performance <span class="citation" data-cites="Sackett2008 Schmidt1981">(<a href="references.html#ref-Sackett2008" role="doc-biblioref">Sackett et al., 2008</a>; <a href="references.html#ref-Schmidt1981" role="doc-biblioref">Schmidt &amp; Hunter, 1981</a>)</span>, and</li>
<li>personality tests, which produce higher estimates of dominance among men than women; it is unclear whether this has <a href="#sec-predictiveBias">predictive bias</a>.</li>
</ul></section><section id="sec-biasVsFairness" class="level3" data-number="16.4.2"><h3 data-number="16.4.2" class="anchored" data-anchor-id="sec-biasVsFairness">
<span class="header-section-number">16.4.2</span> Bias Versus Fairness</h3>
<p>Whether a measure is accurate or shows test bias is a scientific question. By contrast, whether a test is fair and thus should be used for a given purpose is not just a scientific question; it is also an <a href="ethics.html">ethical</a> question. It involves the consideration of the potential consequences of testing in terms of social values and <a href="validity.html#sec-consequentialValidity">consequential validity</a>.</p>
</section><section id="sec-operationalizingFairness" class="level3" data-number="16.4.3"><h3 data-number="16.4.3" class="anchored" data-anchor-id="sec-operationalizingFairness">
<span class="header-section-number">16.4.3</span> Operationalizing Fairness</h3>
<p>There are many perspectives to what should be considered when evaluating test fairness <span class="citation" data-cites="AERA2014 Camilli2013 Dorans2017 GeneralAptitudeTestBattery1989 Fletcher2021 Gipps2009 Helms2006 Jonson2022 Melikyan2019 Sackett2008 Thorndike1971 Zieky2006 Zieky2013">(<a href="references.html#ref-AERA2014" role="doc-biblioref">American Educational Research Association et al., 2014</a>; <a href="references.html#ref-Camilli2013" role="doc-biblioref">Camilli, 2013</a>; <a href="references.html#ref-GeneralAptitudeTestBattery1989" role="doc-biblioref">Committee on the General Aptitude Test Battery et al., 1989</a>; <a href="references.html#ref-Dorans2017" role="doc-biblioref">Dorans, 2017</a>; <a href="references.html#ref-Fletcher2021" role="doc-biblioref">Fletcher et al., 2021</a>; <a href="references.html#ref-Gipps2009" role="doc-biblioref">Gipps &amp; Stobart, 2009</a>; <a href="references.html#ref-Helms2006" role="doc-biblioref">Helms, 2006</a>; <a href="references.html#ref-Jonson2022" role="doc-biblioref">Jonson &amp; Geisinger, 2022</a>; <a href="references.html#ref-Melikyan2019" role="doc-biblioref">Melikyan et al., 2019</a>; <a href="references.html#ref-Sackett2008" role="doc-biblioref">Sackett et al., 2008</a>; <a href="references.html#ref-Thorndike1971" role="doc-biblioref">Thorndike, 1971</a>; <a href="references.html#ref-Zieky2006" role="doc-biblioref">Zieky, 2006</a>, <a href="references.html#ref-Zieky2013" role="doc-biblioref">2013</a>)</span>. As described in <span class="citation" data-cites="Fletcher2021">Fletcher et al. (<a href="references.html#ref-Fletcher2021" role="doc-biblioref">2021</a>)</span>, there are three primary ways of operationalizing fairness:</p>
<ol type="1">
<li>Equal outcomes: the <a href="prediction.html#sec-selectionRatio">selection rate</a> is the same across groups.</li>
<li>Equal opportunity: the <a href="prediction.html#sec-sensitivity">sensitivity</a> (<a href="prediction.html#sec-sensitivity">true positive rate</a>; 1 <span class="math inline">\(-\)</span> <a href="prediction.html#sec-falseNegativeRate">false negative rate</a>) is the same across groups.</li>
<li>Equal odds: the <a href="prediction.html#sec-sensitivity">sensitivity</a> is the same across groups and the <a href="prediction.html#sec-specificity">specificity</a> (<a href="prediction.html#sec-specificity">true negative rate</a>; 1 <span class="math inline">\(-\)</span> <a href="prediction.html#sec-falsePositiveRate">false positive rate</a>) is the same across groups.</li>
</ol>
<p>For example, the job selection procedure shows <em>equal outcomes</em> if the proportion of men selected is equal to the proportion of women selected. The job selection procedure shows <em>equal opportunity</em> if, among those who show strong job performance, the proportion of classification errors (<a href="prediction.html#sec-falseNegative">false negatives</a>) is the same for men and women. <a href="prediction.html#sec-roc">Receiver operating characteristic (ROC) curves</a> are depicted for two groups in <a href="#fig-testBias-ROC" class="quarto-xref">Figure&nbsp;<span>16.13</span></a>. A cutoff that represents equal opportunity is depicted with a horizontal line (i.e., the same <a href="prediction.html#sec-sensitivity">sensitivity</a>) in <a href="#fig-testBias-ROC" class="quarto-xref">Figure&nbsp;<span>16.13</span></a>. The job selection procedure shows <em>equal odds</em> if (a), among those who show strong job performance, the proportion of classification errors (<a href="prediction.html#sec-falseNegative">false negatives</a>) is the same for men and women, and (b), among those who show poor job performance, the proportion of classification errors (<a href="prediction.html#sec-falsePositive">false positives</a>) is the same for men and women. A cutoff that represents equal odds is depicted where the <a href="prediction.html#sec-roc">ROC curve</a> for Group A intersects with the <a href="prediction.html#sec-roc">ROC curve</a> from Group B in <a href="#fig-testBias-ROC" class="quarto-xref">Figure&nbsp;<span>16.13</span></a>. The equal odds approach to fairness is consistent with a National Academy of Sciences committee on fairness <span class="citation" data-cites="GeneralAptitudeTestBattery1989 Gottfredson1994">(<a href="references.html#ref-GeneralAptitudeTestBattery1989" role="doc-biblioref">Committee on the General Aptitude Test Battery et al., 1989</a>; <a href="references.html#ref-Gottfredson1994" role="doc-biblioref">L. S. Gottfredson, 1994</a>)</span>. Approaches to operationalizing fairness in the context of prediction models are described by <span class="citation" data-cites="Paulus2020">Paulus &amp; Kent (<a href="references.html#ref-Paulus2020" role="doc-biblioref">2020</a>)</span>.</p>
<div id="fig-testBias-ROC" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Receiver Operating Characteristic (ROC) Curves for Two Groups. (Figure reprinted from @Fletcher2021, Figure 2, p. 3. Fletcher, R. R., Nakeshimana, A., &amp; Olubeko, O. (2021). Addressing fairness, bias, and appropriate use of artificial intelligence and machine learning in global health. *Frontiers in Artificial Intelligence*, *3*(116). <https://doi.org/10.3389/frai.2020.561802>)">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-testBias-ROC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/testBias-ROC.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;16.13: Receiver Operating Characteristic (ROC) Curves for Two Groups. (Figure reprinted from @Fletcher2021, Figure 2, p.&nbsp;3. Fletcher, R. R., Nakeshimana, A., &amp; Olubeko, O. (2021). Addressing fairness, bias, and appropriate use of artificial intelligence and machine learning in global health. Frontiers in Artificial Intelligence, 3(116). https://doi.org/10.3389/frai.2020.561802)"><img src="images/testBias-ROC.png" class="img-fluid figure-img" style="width:100.0%" alt="Receiver Operating Characteristic (ROC) Curves for Two Groups. (Figure reprinted from @Fletcher2021, Figure 2, p. 3. Fletcher, R. R., Nakeshimana, A., &amp; Olubeko, O. (2021). Addressing fairness, bias, and appropriate use of artificial intelligence and machine learning in global health. *Frontiers in Artificial Intelligence*, *3*(116). <https://doi.org/10.3389/frai.2020.561802>)"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-testBias-ROC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.13: Receiver Operating Characteristic (ROC) Curves for Two Groups. (Figure reprinted from <span class="citation" data-cites="Fletcher2021">Fletcher et al. (<a href="references.html#ref-Fletcher2021" role="doc-biblioref">2021</a>)</span>, Figure 2, p.&nbsp;3. Fletcher, R. R., Nakeshimana, A., &amp; Olubeko, O. (2021). Addressing fairness, bias, and appropriate use of artificial intelligence and machine learning in global health. <em>Frontiers in Artificial Intelligence</em>, <em>3</em>(116). <a href="https://doi.org/10.3389/frai.2020.561802" class="uri">https://doi.org/10.3389/frai.2020.561802</a>)
</figcaption></figure>
</div>
<p>It is not possible to meet all three types of fairness simultaneously (i.e., equal <a href="prediction.html#sec-selectionRatio">selection rates</a>, <a href="prediction.html#sec-sensitivity">sensitivity</a>, and <a href="prediction.html#sec-specificity">specificity</a> across groups) unless the <a href="prediction.html#sec-baseRate">base rates</a> are the same across groups or the selection is perfectly accurate <span class="citation" data-cites="Fletcher2021">(<a href="references.html#ref-Fletcher2021" role="doc-biblioref">Fletcher et al., 2021</a>)</span>. In the medical context, equal odds is the most common approach to fairness. However, using the cutoff associated with equal odds typically reduces overall classification accuracy. And, changing the cutoff for specific groups can lead to negative consequences. In the case that equal odds results in a classification accuracy that is too low, it may be worth considering using separate assessment procedures/tests for each group. In general, it is best to follow one of these approaches to fairness. It is difficult to get right, so try to minimize negative impact. Many fairness supporters argue for simpler rules. In the 1991 Civil Rights Act, <a href="#sec-scoreAdjustment">score adjustments</a> based on race, gender, and ethnicity (e.g., within-race <a href="scores-scales.html#sec-norm">norming</a> or race-conscious score adjustments) were made illegal in personnel selection <span class="citation" data-cites="Gottfredson1994">(<a href="references.html#ref-Gottfredson1994" role="doc-biblioref">L. S. Gottfredson, 1994</a>)</span>.</p>
<p>Another perspective to fairness is that selection procedures should predict job performance and if they are correlated with any group membership (e.g., race, socioeconomic status, or gender), the test should not be used <span class="citation" data-cites="Helms2006">(<a href="references.html#ref-Helms2006" role="doc-biblioref">Helms, 2006</a>)</span>. That is, according to Helms, we should not use any test that assesses anything other than the construct of interest (job performance). Unfortunately, however, no measures like this exist. Every measure assesses multiple things, and factors such as poverty can have long-lasting impacts across many domains.</p>
<p>Another perspective to fairness is to make the selection procedures equal the number of successes within each group <span class="citation" data-cites="Thorndike1971">(<a href="references.html#ref-Thorndike1971" role="doc-biblioref">Thorndike, 1971</a>)</span>. According to this perspective, if you want to do selection, you should hire all people, then look at job performance. If among successful employees, 60% are White and 40% are Black, then set this selection rate for each group (i.e., hiring 80% White individuals and 20% Black individuals is not okay). According to this perspective, a selection system is only fair if the majority–minority differences on the selection device used are equal in magnitude to majority–minority differences in job performance. Selection criteria should be made based on prior distributions of success rates. However, you likely will not ever really know the true <a href="prediction.html#sec-baseRate">base rate</a> in these situations. No one uses this approach because you would have a period where you have to accept everyone to find the percent that works. Also, this would only work in a narrow window of time because the selection pool changes over time.</p>
<p>There are lots of groups and subgroups. Ensuring fairness is very complex, and there is no way to accomplish the goal of being equally fair to all people. Therefore, do the best you can and try to minimize negative impact.</p>
</section></section><section id="sec-correctForBias" class="level2" data-number="16.5"><h2 data-number="16.5" class="anchored" data-anchor-id="sec-correctForBias">
<span class="header-section-number">16.5</span> Correcting For Bias</h2>
<section id="sec-whenDetectingBias" class="level3" data-number="16.5.1"><h3 data-number="16.5.1" class="anchored" data-anchor-id="sec-whenDetectingBias">
<span class="header-section-number">16.5.1</span> What to Do When Detecting Bias</h3>
<p>When examining item bias (using <a href="#sec-dif">differential item functioning</a>/DIF or <a href="#sec-measurementInvariance">measurement non-invariance</a>) with many items (or measures) across many groups, there can be many tests, which will make it likely that <a href="#sec-dif">DIF</a>/<a href="#sec-measurementInvariance">non-invariance</a> will be detected, especially with a large sample. Some detected <a href="#sec-dif">DIF</a> may be artificial or trivial, but other <a href="#sec-dif">DIF</a> may be real and important to address. It is important to consider how you will proceed when detecting <a href="#sec-dif">DIF</a>/<a href="#sec-measurementInvariance">non-invariance</a>. Considerations of effect size and theory can be important for evaluating the <a href="#sec-dif">DIF</a>/<a href="#sec-measurementInvariance">non-invariance</a> and whether it is negligible or important to address.</p>
<p>When detecting bias, there are several steps to take. First, consider what the bias indicates. Does the bias present <a href="#sec-adverseImpact">adverse impact</a> for a minority group? For what reasons might the bias exist? Second, examine the effect size of the bias. If the effects are small, if the bias does not present <a href="#sec-adverseImpact">adverse impact</a> for a minority group, and if there is no compelling theoretical reason for the bias, the bias might not be sufficient to scrap the instrument for the population. Some detected bias may be artificial, but other bias may be real. Gender and cultural differences have shown a number of statistically significant effects for a number of different assessment purposes, but many of the observed effects are quite small and likely trivial, and they do not present compelling reasons to change the assessment <span class="citation" data-cites="Youngstrom2016">(<a href="references.html#ref-Youngstrom2016" role="doc-biblioref">Youngstrom &amp; Van Meter, 2016</a>)</span>.</p>
<p>However, if you find bias, correct for it! There are a number of <a href="#sec-scoreAdjustment">score adjustment</a> and <a href="#sec-otherBiasCorrections">non-score adjustment</a> approaches to correct for bias, as described in Sections <a href="#sec-scoreAdjustment" class="quarto-xref"><span>16.5.2</span></a> and <a href="#sec-otherBiasCorrections" class="quarto-xref"><span>16.5.3</span></a>. If the bias occurs at the item level (e.g., <a href="#sec-testStructureBias">test structure bias</a>), it is generally recommended to <a href="#sec-removeBiasedItems">remove</a> or <a href="#sec-resolveBiasedItems">resolve</a> items that show non-negligible bias. There are three primary options: (1) drop the item for both groups, (2) drop the item for one group but keep it for the other group, or (3) freely estimate the parameters for the item across groups. Addressing items that show larger bias can also reduce artificial bias in other items <span class="citation" data-cites="Hagquist2017">(<a href="references.html#ref-Hagquist2017" role="doc-biblioref">Hagquist &amp; Andrich, 2017</a>)</span>. Thus, researchers are encouraged to handle item bias sequentially from high to low in magnitude. If the bias occurs at the test score level (e.g., <a href="#sec-predictiveBias">predictive bias</a>), <a href="#sec-scoreAdjustment">score adjustments</a> may be considered.</p>
<p>There are situations measurement invariance across time may not be expected (and may thus be problematic to require). For instance, if there is a treatment that occurs between two measurement occasions, the factor structure might change due to the treatment rather than due to the mere passage of time. Thus, it would be helpful to know whether the instrument shows measurement invariance across a similar timeframe when no treatment is occurring. Another situation where measurement invariance across time may not be expected is when the construct shows heterotypic continuity <span class="citation" data-cites="Petersen2020">(<a href="references.html#ref-Petersen2020" role="doc-biblioref">Petersen et al., 2020</a>)</span>. If the construct changes in its behavioral manifestation with development, then measurement invariance may not be expected across wide spans of time.</p>
<p>If you do not correct for bias, consider the impact of the test, procedure, and selection procedure when interpreting scores. Interpret scores with caution and provide necessary caveats in resulting papers or reports regarding the interpretations in question. In sum, it is important to examine the possibility of bias—it is important to consider how much “erroneous junk” you are introducing into your research.</p>
</section><section id="sec-scoreAdjustment" class="level3" data-number="16.5.2"><h3 data-number="16.5.2" class="anchored" data-anchor-id="sec-scoreAdjustment">
<span class="header-section-number">16.5.2</span> Score Adjustment to Correct for Bias</h3>
<p>Score adjustment involves adjusting scores for a particular group or groups.</p>
<section id="sec-whyAdjustScores" class="level4" data-number="16.5.2.1"><h4 data-number="16.5.2.1" class="anchored" data-anchor-id="sec-whyAdjustScores">
<span class="header-section-number">16.5.2.1</span> Why Adjust Scores?</h4>
<p>There may be several reasons to adjust scores for various groups in a given situation. First, there may be social goals to adjust scores. For example, we may want our selection device to yield personnel that better represent the nation or region, including diversity of genders, races, majors, social classes, etc. Score adjustments are typically discussed with respect to racial minority differences due to historical and systemic inequities. Our society aims to provide equal opportunity, including the opportunity to gain a fair share (i.e., proportional representation) of jobs. A diversity of perspectives in a job is a strength; a diversity of perspectives can lead to greater creativity and improved problem-solving. A second potential reason that we may want to apply score adjustment is to correct for bias. A third potential reason that we may want to apply score adjustment is to improve the <a href="#sec-fairness">fairness</a> of a test.</p>
</section><section id="sec-typesOfScoreAdjustment" class="level4" data-number="16.5.2.2"><h4 data-number="16.5.2.2" class="anchored" data-anchor-id="sec-typesOfScoreAdjustment">
<span class="header-section-number">16.5.2.2</span> Types of Score Adjustment</h4>
<p>There are a number of potential techniques that have been used in attempts to correct for bias, i.e., to reduce negative impact of the test on an under-represented group. What is considered an under-represented group may depend on the context. For instance, men are under-represented compared to women as nurses, preschool teachers, and college students. However, men may not face the same systemic challenges compared to women, so even though men may show under-representation in some domains, it is arguable whether scores should be adjusted to increase their representation. Techniques for score adjustment include:</p>
<ul>
<li><a href="#sec-bonusPoints">Bonus points</a></li>
<li><a href="#sec-withinGroupNorming">Within-group norming</a></li>
<li><a href="#sec-separateCutoffs">Separate cutoffs</a></li>
<li><a href="#sec-topDownSelection">Top-down selection from different lists</a></li>
<li><a href="#sec-banding">Banding</a></li>
<li><a href="#sec-bandingBonusPoints">Banding with bonus points</a></li>
<li><a href="#sec-slidingBand">Sliding band</a></li>
<li><a href="#sec-separateTests">Separate tests</a></li>
<li><a href="#sec-itemElimination">Item elimination based on group differences</a></li>
</ul>
<section id="sec-bonusPoints" class="level5" data-number="16.5.2.2.1"><h5 data-number="16.5.2.2.1" class="anchored" data-anchor-id="sec-bonusPoints">
<span class="header-section-number">16.5.2.2.1</span> Bonus Points</h5>
<p>Providing bonus points involves adding a constant number of points to the scores of all individuals who are members of a particular group with the goal of eliminating or reducing group differences. Bonus points is used to correct for <a href="#sec-predictiveBias">predictive bias</a> <a href="#sec-differentIntercepts">differences in intercepts</a> between groups. An example of bonus points is military veterans in placement for civil service jobs—points are added to the initial score for all veterans (e.g., add 5 points to test scores of all veterans). An example of using bonus points as a score adjustment is depicted in <a href="#fig-bonusPoints" class="quarto-xref">Figure&nbsp;<span>16.14</span></a>.</p>
<div id="fig-bonusPoints" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Using Bonus Points as a Scoring Adjustment.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bonusPoints-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/adjustment_bonusPoints.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;16.14: Using Bonus Points as a Scoring Adjustment."><img src="images/adjustment_bonusPoints.png" class="img-fluid figure-img" style="width:100.0%" alt="Using Bonus Points as a Scoring Adjustment."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bonusPoints-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.14: Using Bonus Points as a Scoring Adjustment.
</figcaption></figure>
</div>
<p>There are several pros of bonus points. If the distribution of each group is the same, this will effectively reduce group differences. Moreover, it is a simple way of impacting test selection and procedure without changing the test, which is therefore a great advantage. There are several cons of bonus points. If there are differences in group standard deviations, adding bonus points may not actually correct for bias. The use of bonus points also obscures what is actually being done to scores, so other methods like using <a href="#sec-separateCutoffs">separate cutoffs</a> may be more explicit. In addition, the simplicity of bonus points is also a great disadvantage because it is easily understood and often not viewed as “fair” because some people are getting extra points that others do not.</p>
</section><section id="sec-withinGroupNorming" class="level5" data-number="16.5.2.2.2"><h5 data-number="16.5.2.2.2" class="anchored" data-anchor-id="sec-withinGroupNorming">
<span class="header-section-number">16.5.2.2.2</span> Within-Group Norming</h5>
<p>A <a href="scores-scales.html#sec-norm">norm</a> is the standard of performance that a person’s performance can be compared to. Within-group norming treats the person’s group in the sample as the <a href="scores-scales.html#sec-norm">norm</a>. Within-group norming converts an individual’s score to <a href="scores-scales.html#sec-standardizedScores">standardized scores</a> (e.g., T scores) or percentiles within one’s own group. Then, the people are selected based on the highest standard scores across groups. Withing-group norming is used to correct for <a href="#sec-predictiveBias">predictive bias</a> <a href="#sec-differentSlopes">differences in slopes</a> between groups. An example of using within-group norming as a score adjustment is depicted in <a href="#fig-withinGroupNorming" class="quarto-xref">Figure&nbsp;<span>16.15</span></a>.</p>
<div id="fig-withinGroupNorming" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Using Within-Group Norming as a Scoring Adjustment.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-withinGroupNorming-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/adjustment_withinGroupNorming.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure&nbsp;16.15: Using Within-Group Norming as a Scoring Adjustment."><img src="images/adjustment_withinGroupNorming.png" class="img-fluid figure-img" style="width:100.0%" alt="Using Within-Group Norming as a Scoring Adjustment."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-withinGroupNorming-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.15: Using Within-Group Norming as a Scoring Adjustment.
</figcaption></figure>
</div>
<p>There are several pros of within-group norming. First, it accounts for differences in group standard deviations and means, so it does not have the same problem as <a href="#sec-bonusPoints">bonus points</a> and is generally more effective at eliminating <a href="#sec-adverseImpact">adverse impact</a> compared to <a href="#sec-bonusPoints">bonus points</a>. Second, some general (non-group-specific) <a href="scores-scales.html#sec-norm">norms</a> are clearly irrelevant for characterizing a person’s functioning. Group-specific <a href="scores-scales.html#sec-norm">norms</a> aim to describe a person’s performance relative to people with a similar background, thus potentially reducing cultural <a href="#sec-bias">bias</a>. Third, group-specific <a href="scores-scales.html#sec-norm">norms</a> may better reflect cultural, educational, socioeconomic, and other factors that may influence a person’s score <span class="citation" data-cites="Burlew2019">(<a href="references.html#ref-Burlew2019" role="doc-biblioref">Burlew et al., 2019</a>)</span>. Fourth, group-specific <a href="scores-scales.html#sec-norm">norms</a> may increase <a href="prediction.html#sec-specificity">specificity</a>, and reduce over-pathologizing by preventing giving a diagnosis to people who might not show a condition <span class="citation" data-cites="Manly2007">(<a href="references.html#ref-Manly2007" role="doc-biblioref">Manly &amp; Echemendia, 2007</a>)</span>.</p>
<p>There are several cons of within-group norming. First, group differences could be maintained if one decides to norm based on a reference sample or, when scores are skewed, a local sample, especially when using standardized scores. However, percentile scores will consistently eliminate <a href="#sec-adverseImpact">adverse impact</a>. Second, using group-specific <a href="scores-scales.html#sec-norm">norms</a> may obscure background variables that explain underlying reasons for group-related differences in test performance <span class="citation" data-cites="Manly2005 Manly2007">(<a href="references.html#ref-Manly2005" role="doc-biblioref">Manly, 2005</a>; <a href="references.html#ref-Manly2007" role="doc-biblioref">Manly &amp; Echemendia, 2007</a>)</span>. Third, group-specific <a href="scores-scales.html#sec-norm">norms</a> do not address the problem if the measure shows test <a href="#sec-bias">bias</a> <span class="citation" data-cites="Burlew2019">(<a href="references.html#ref-Burlew2019" role="doc-biblioref">Burlew et al., 2019</a>)</span>. Fourth, group-specific <a href="scores-scales.html#sec-norm">norms</a> may reduce <a href="prediction.html#sec-sensitivity">sensitivity</a> to detect conditions <span class="citation" data-cites="Manly2007">(<a href="references.html#ref-Manly2007" role="doc-biblioref">Manly &amp; Echemendia, 2007</a>)</span>. For instance, they may prevent people from getting treatment who would benefit. It is worth noting that within-group norming on the basis of sex, gender, and ethnicity is illegal for the basis of personnel selection according to the 1991 Civil Rights Act.</p>
<p>As an example of within-group norming, the National Football League used to use race-norming for identification of concussions. The effect of race-norming, however, was that it lowered Black players’ concussion risk scores, which prevented many Black players from being identified as having sustained a concussion and from receiving needed treatment. Race-norming compared the Black football players cognitive test scores to group-specific <a href="scores-scales.html#sec-norm">norms</a>: the cognitive test scores of Black people in the general population (not to common <a href="scores-scales.html#sec-norm">norms</a>). Using Black-specific <a href="scores-scales.html#sec-norm">norms</a> assumed that Black football players showed lower cognitive ability than other groups, so a low cognitive ability score for a Black player was less likely to be flagged as concerning. Thus, the race-specific <a href="scores-scales.html#sec-norm">norms</a> led to lower identified rates of concussions among Black football players compared to White football players. Due to the <a href="#sec-adverseImpact">adverse impact</a>, Black players sued the National Football League, and the league stopped the controversial practice of race-norming for identification of concussion (<a href="https://www.washingtonpost.com/sports/2021/06/03/nfl-concussion-settlement-race-norming/" class="uri">https://www.washingtonpost.com/sports/2021/06/03/nfl-concussion-settlement-race-norming/</a>; archived at <a href="https://perma.cc/KN3L-5Z7R" class="uri">https://perma.cc/KN3L-5Z7R</a>).</p>
<p>A common question is whether to use group-specific <a href="scores-scales.html#sec-norm">norms</a> or common <a href="scores-scales.html#sec-norm">norms</a>. Group-specific <a href="scores-scales.html#sec-norm">norms</a> are a controversial practice, and the answer depends. If you are interested in a person’s absolute functioning (e.g., for determining whether someone is concussed or whether they are suitable to drive), recommendations are to use common <a href="scores-scales.html#sec-norm">norms</a>, not group-specific <a href="scores-scales.html#sec-norm">norms</a> <span class="citation" data-cites="Barrash2010 Silverberg2009">(<a href="references.html#ref-Barrash2010" role="doc-biblioref">Barrash et al., 2010</a>; <a href="references.html#ref-Silverberg2009" role="doc-biblioref">Silverberg &amp; Millis, 2009</a>)</span>. If, by contrast, you are interested in a person’s <em>relative</em> functioning compared to a specific group, within-group norming could make sense if there is an appropriate reference group. The question about which <a href="scores-scales.html#sec-norm">norms</a> to use are complex, and psychologists should evaluate the cost and benefit of each <a href="scores-scales.html#sec-norm">norm</a>, and use the <a href="scores-scales.html#sec-norm">norm</a> with the greatest benefit and the least cost for the client <span class="citation" data-cites="Manly2007">(<a href="references.html#ref-Manly2007" role="doc-biblioref">Manly &amp; Echemendia, 2007</a>)</span>.</p>
</section><section id="sec-separateCutoffs" class="level5" data-number="16.5.2.2.3"><h5 data-number="16.5.2.2.3" class="anchored" data-anchor-id="sec-separateCutoffs">
<span class="header-section-number">16.5.2.2.3</span> Separate Cutoffs</h5>
<p>Using separate cutoffs involves using a separate cutoff score per group and selecting the top number from each group. That is, using separate cutoffs involves using different criteria for each group. Using separate cutoffs functions the same as adding <a href="#sec-bonusPoints">bonus points</a>, but it has greater transparency—i.e., you are lowering the standard for one group compared to another group. An example of using separate cutoffs as a score adjustment is depicted in <a href="#fig-separateCutoffs" class="quarto-xref">Figure&nbsp;<span>16.16</span></a>.</p>
<div id="fig-separateCutoffs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-separateCutoffs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/adjustment_separateCutoffs.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure&nbsp;16.16: Using Separate Cutoffs as a Scoring Adjustment. In this example, the cutoff for the majority group is 128; the cutoff for the minority group is 123.”, fig.scap = “Using Separate Cutoffs as a Scoring Adjustment."><img src="images/adjustment_separateCutoffs.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-separateCutoffs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.16: Using Separate Cutoffs as a Scoring Adjustment. In this example, the cutoff for the majority group is 128; the cutoff for the minority group is 123.”, fig.scap = “Using Separate Cutoffs as a Scoring Adjustment.
</figcaption></figure>
</div>
</section><section id="sec-topDownSelection" class="level5" data-number="16.5.2.2.4"><h5 data-number="16.5.2.2.4" class="anchored" data-anchor-id="sec-topDownSelection">
<span class="header-section-number">16.5.2.2.4</span> Top-Down Selection from Different Lists</h5>
<p>Top-down selection from different lists involves taking the best from two different lists according to a preset rule as to how many to select from each group. Top-down selection from different lists functions the same as <a href="#sec-withinGroupNorming">within-group norming</a>. An example of using top-down selection from different lists as a score adjustment is depicted in <a href="#fig-topDownSelectionDifferentLists" class="quarto-xref">Figure&nbsp;<span>16.17</span></a>.</p>
<div id="fig-topDownSelectionDifferentLists" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Using Top-Down Selection From Different Lists as a Scoring Adjustment. In this example, the top three candidates are selected from each group.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-topDownSelectionDifferentLists-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/adjustment_separateLists.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure&nbsp;16.17: Using Top-Down Selection From Different Lists as a Scoring Adjustment. In this example, the top three candidates are selected from each group."><img src="images/adjustment_separateLists.png" class="img-fluid figure-img" style="width:100.0%" alt="Using Top-Down Selection From Different Lists as a Scoring Adjustment. In this example, the top three candidates are selected from each group."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-topDownSelectionDifferentLists-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.17: Using Top-Down Selection From Different Lists as a Scoring Adjustment. In this example, the top three candidates are selected from each group.
</figcaption></figure>
</div>
</section><section id="sec-banding" class="level5" data-number="16.5.2.2.5"><h5 data-number="16.5.2.2.5" class="anchored" data-anchor-id="sec-banding">
<span class="header-section-number">16.5.2.2.5</span> Banding</h5>
<p>Banding uses a tier system that is based on the assumption that individuals within a specific score range are regarded as having equivalent scores. So that we do not over-estimate small score differences, scores within the same band are seen as equivalent—and the order of selection within the band can be modified depending on selection goals. The <a href="reliability.html#sec-standardErrorOfMeasurement">standard error of measurement (SEM)</a> is used to estimate the precision (<a href="reliability.html">reliability</a>) of the test scores, and it is used as the width of the band.</p>
<p>Consider an example: if a person received a score with confidence interval of 18–22, then scores between 18 to 22 are not necessarily different due to random fluctuation (<a href="reliability.html#sec-measurementError">measurement error</a>). Therefore, scores in that range are considered the same, and we take a band of scores. However, banding by itself may not result in increased selection of lower scoring groups. The band provides a subsample of applicants so that we can use other criteria (other than the test) to select a candidate. Giving “minority preference” involves selecting members of minority group in a given band before selecting members of the majority group. An example of using banding as a score adjustment is depicted in <a href="#fig-banding" class="quarto-xref">Figure&nbsp;<span>16.18</span></a>.</p>
<div id="fig-banding" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Using Banding as a Scoring Adjustment.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-banding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/adjustment_banding.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figure&nbsp;16.18: Using Banding as a Scoring Adjustment."><img src="images/adjustment_banding.png" class="img-fluid figure-img" style="width:100.0%" alt="Using Banding as a Scoring Adjustment."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-banding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.18: Using Banding as a Scoring Adjustment.
</figcaption></figure>
</div>
<p>The problem with banding is that bands are set by the <a href="reliability.html#sec-standardErrorOfMeasurement">standard error of measurement</a>: you can select the first group from the first band, but then whom do you select after the first band? There is no rationale where to “stop” the band because there are indistinguishable scores on the edges of each band to the next band. That is, 17 is indistinguishable from 18 (in terms of its confidence interval), 16 is indistinguishable from 17, and so on. Therefore, banding works okay for the top scores, but if you are going to hire a lot of candidates, it is a problem. A solution to this problem with banding is to use a <a href="#sec-slidingBand">sliding band</a>, as described later.</p>
</section><section id="sec-bandingBonusPoints" class="level5" data-number="16.5.2.2.6"><h5 data-number="16.5.2.2.6" class="anchored" data-anchor-id="sec-bandingBonusPoints">
<span class="header-section-number">16.5.2.2.6</span> Banding with Bonus Points</h5>
<p><a href="#sec-banding">Banding</a> is often used with <a href="#sec-bonusPoints">bonus points</a> to reduce the negative impact for minority groups. An example of using <a href="#sec-banding">banding</a> with <a href="#sec-bonusPoints">bonus points</a> as a score adjustment is depicted in <a href="#fig-bandingBonusPoints" class="quarto-xref">Figure&nbsp;<span>16.19</span></a>.</p>
<div id="fig-bandingBonusPoints" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Using Banding With Bonus Points as a Scoring Adjustment.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bandingBonusPoints-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/adjustment_bandingBonusPoints.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Figure&nbsp;16.19: Using Banding With Bonus Points as a Scoring Adjustment."><img src="images/adjustment_bandingBonusPoints.png" class="img-fluid figure-img" style="width:100.0%" alt="Using Banding With Bonus Points as a Scoring Adjustment."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bandingBonusPoints-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.19: Using Banding With Bonus Points as a Scoring Adjustment.
</figcaption></figure>
</div>
</section><section id="sec-slidingBand" class="level5" data-number="16.5.2.2.7"><h5 data-number="16.5.2.2.7" class="anchored" data-anchor-id="sec-slidingBand">
<span class="header-section-number">16.5.2.2.7</span> Sliding Band</h5>
<p>Using a sliding band is a solution to the problem of which bands to use when using <a href="#sec-banding">banding</a>. Using a sliding band can help increase the number of minorities selected. Using the top band, you select all members of a minority group in the top band, then select members of the majority group with the top score of the band, then slide the band down (based on <a href="reliability.html#sec-standardErrorOfMeasurement">SEM</a>), and repeat. You work your way down with bands though groups that are indistinguishable based on <a href="reliability.html#sec-standardErrorOfMeasurement">SEM</a>, until getting a cell needed to select a relevant candidate.</p>
<p>For instance, if the top score is 22 and the <a href="reliability.html#sec-standardErrorOfMeasurement">SEM</a> is 4 points, the first band would be: [18, 22]. Here is how you would proceed:</p>
<ol type="1">
<li>Select the minority group members who have a score between 18 to 22.</li>
<li>Select the majority group members who have a score of 22.</li>
<li>Slide the band down based on the SEM to the next highest score: [17, 21].</li>
<li>Select the minority group members who have a score between 17 to 21.</li>
<li>Select the majority group members who have a score of 21.</li>
<li>Slide the band down based on the SEM to the next highest score: [16, 20].</li>
<li>…</li>
<li>And so on</li>
</ol>
<p>An example of using a sliding band as a score adjustment is depicted in <a href="#fig-slidingBand" class="quarto-xref">Figure&nbsp;<span>16.20</span></a>.</p>
<div id="fig-slidingBand" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Using a Sliding Band as a Scoring Adjustment.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-slidingBand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/adjustment_slidingBand.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Figure&nbsp;16.20: Using a Sliding Band as a Scoring Adjustment."><img src="images/adjustment_slidingBand.png" class="img-fluid figure-img" style="width:100.0%" alt="Using a Sliding Band as a Scoring Adjustment."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-slidingBand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.20: Using a Sliding Band as a Scoring Adjustment.
</figcaption></figure>
</div>
<p>In sum, using a sliding band, scores that are not significantly lower than the highest remaining score should not be treated as different. Using a sliding band has the same effects on decisions as <a href="#sec-bonusPoints">bonus points</a> that are the width of the band. For example, if the <a href="reliability.html#sec-standardErrorOfMeasurement">SEM</a> is 3, it has the same decisions as <a href="#sec-bonusPoints">bonus points</a> of 3; therefore, any scores within 3 of the highest score are now considered equal.</p>
<p>A sliding band is popular because of its scientific and statistical rationale. Also, it is more confusing and, therefore, preferred by some because it may be less likely to be sued. However, a sliding band may not always eliminate <a href="#sec-adverseImpact">adverse impact</a>. A sliding band has never been overturned in court (or at least, not yet).</p>
</section><section id="sec-separateTests" class="level5" data-number="16.5.2.2.8"><h5 data-number="16.5.2.2.8" class="anchored" data-anchor-id="sec-separateTests">
<span class="header-section-number">16.5.2.2.8</span> Separate Tests</h5>
<p>Using separate tests for each group is another option to reduce bias. For instance, you might use one test for the majority group and a different test for the minority group, making sure that each test is <a href="validity.html">valid</a> for the relevant group. Using separate tests is an extreme version of <a href="#sec-topDownSelection">top-down selection</a> and <a href="#sec-withinGroupNorming">within-group norming</a>. Using separate tests would be an option if a measure shows <a href="#sec-differentSlopes">different slopes</a> <a href="#sec-predictiveBias">predictive bias</a>.</p>
<p>One way of developing separate tests is to use empirical keying by group: different items for each group are selected based on each item’s association with the criterion in each group. Empirical keying is an example of <a href="validity.html#sec-theoryEmpiricism">dustbowl empiricism</a> (i.e., relying on empiricism rather than theory). However, theory can also inform the item selection.</p>
</section><section id="sec-itemElimination" class="level5" data-number="16.5.2.2.9"><h5 data-number="16.5.2.2.9" class="anchored" data-anchor-id="sec-itemElimination">
<span class="header-section-number">16.5.2.2.9</span> Item Elimination based on Group Differences</h5>
<p>Items that show large group differences in scores can be eliminated from the test. If you remove enough items showing differences between groups, you can get similar scores between groups and can get equal group selection. A problem of item elimination based on group differences is that if you get rid of predictive items, then two goals, equal selection and predictive power, are not met. If you use this method, you often have to be willing for the measure to show decreases in predictive power.</p>
</section></section><section id="sec-useOfScoreAdjustment" class="level4" data-number="16.5.2.3"><h4 data-number="16.5.2.3" class="anchored" data-anchor-id="sec-useOfScoreAdjustment">
<span class="header-section-number">16.5.2.3</span> Use of Score Adjustment</h4>
<p>Score adjustment can be used in a number of different domains, including tests of aptitude and intelligence. Score adjustment also comes up in other areas. For example, the number of drinks it takes to be considered binge drinking differs between men (five) and women (four). Although the list of score adjustment options is long, they all really reduce to two ways:</p>
<ol type="1">
<li><a href="#sec-bonusPoints">Bonus points</a></li>
<li><a href="#sec-withinGroupNorming">Within-group norming</a></li>
</ol>
<p><a href="#sec-bonusPoints">Bonus points</a> and <a href="#sec-withinGroupNorming">within-group norming</a> are the techniques that are most often used in the real world. These techniques differ in their degree of obscurity—i.e., confusion that is caused not for scientific reasons, but for social, political, and dissemination and implementation reasons. Often procedures that are hard to understand are preferred because it is hard to argue against, critique, or game the system. Basically, you have two options for score adjustment. One option is to adjust scores by raising scores in one group or lowering the criterion in one group. The second primary option is to renorm or change the scores. In sum, you can change the scores, or you can change the decisions you make based on the scores.</p>
</section></section><section id="sec-otherBiasCorrections" class="level3" data-number="16.5.3"><h3 data-number="16.5.3" class="anchored" data-anchor-id="sec-otherBiasCorrections">
<span class="header-section-number">16.5.3</span> Other Ways to Correct for Bias</h3>
<p>Because score adjustment is controversial, it is also important to consider other potential ways to correct for bias that do not involve score adjustment. Strategies other than score adjustment to correct for bias are described by <span class="citation" data-cites="Sackett2001">Sackett et al. (<a href="references.html#ref-Sackett2001" role="doc-biblioref">2001</a>)</span>.</p>
<section id="sec-useMultiplePredictors" class="level4" data-number="16.5.3.1"><h4 data-number="16.5.3.1" class="anchored" data-anchor-id="sec-useMultiplePredictors">
<span class="header-section-number">16.5.3.1</span> Use Multiple Predictors</h4>
<p>In general, high-stakes decisions should not be made based on the results from one test. So, for instance, do not make hiring decisions based just on aptitude assessments. For example, college admissions decisions are not made just based on SAT scores, but also one’s grades, personal statement, extracurricular activities, letters of recommendation, etc. Using multiple predictors works best when the predictors are not correlated with the assessment that has <a href="#sec-adverseImpact">adverse impact</a>, which is difficult to achieve.</p>
<p>There are larger majority–minority subgroup differences in verbal and cognitive ability tests than in noncognitive skills (e.g., motivation, personality, and interpersonal skills). So, it is important to include assessment of relevant noncognitive skills. Include as many relevant aspects of the construct as possible for <a href="validity.html#sec-contentValidity">content validity</a>. For a job, consider as many factors as possible that are relevant for success, e.g., cognitive and noncognitive abilities.</p>
</section><section id="sec-changeCriterion" class="level4" data-number="16.5.3.2"><h4 data-number="16.5.3.2" class="anchored" data-anchor-id="sec-changeCriterion">
<span class="header-section-number">16.5.3.2</span> Change the Criterion</h4>
<p>Another option is to change the criterion so that the <a href="validity.html#sec-predictiveValidity">predictive validity</a> of tests is less skewed. It may be that the selection instrument is not biased but the way in which we are thinking about selection procedures is biased. For example, for judging the quality of universities, there are many different criteria we could use. It could be valuable to examine the various criteria, and you might find what is driving adverse effects.</p>
</section><section id="sec-removeBiasedItems" class="level4" data-number="16.5.3.3"><h4 data-number="16.5.3.3" class="anchored" data-anchor-id="sec-removeBiasedItems">
<span class="header-section-number">16.5.3.3</span> Remove Biased Items</h4>
<p>Using <a href="item-response-theory.html">item response theory</a> or <a href="factor-analysis-pca.html#sec-cfa">confirmatory factor analysis</a>, you can identify items that function differently across groups (i.e., <a href="#sec-dif">differential item functioning</a>/<a href="#sec-dif">DIF</a> or <a href="#sec-measurementInvariance">measurement non-invariance</a>). For instance, you can identify items that show different <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a>/factor loadings or <a href="item-response-theory.html#sec-itemDifficulty">difficulty</a>/intercepts by group. You do not just want to remove items that show mean-level differences in scores (or different rates of endorsement) for one group than another, because there may be true group differences in their level on particular items. If an item is clearly <a href="validity.html">invalid</a> in one group but <a href="validity.html">valid</a> in another group, another option is to keep the item in one group, and to remove it in another group.</p>
<p>Be careful when removing items because removing items can lead to poorer <a href="validity.html#sec-contentValidity">content validity</a>—i.e., items may no longer be a representative set of the content of the construct. Removing items also reduces a measure’s <a href="reliability.html">reliability</a> and ability to detect individual differences <span class="citation" data-cites="Hagquist2017 Hagquist2019">(<a href="references.html#ref-Hagquist2019" role="doc-biblioref">Hagquist, 2019</a>; <a href="references.html#ref-Hagquist2017" role="doc-biblioref">Hagquist &amp; Andrich, 2017</a>)</span>. <a href="#sec-dif">DIF</a> effects tend to be small and inconsistent; removing items showing <a href="#sec-dif">DIF</a> may not have a big impact.</p>
</section><section id="sec-resolveBiasedItems" class="level4" data-number="16.5.3.4"><h4 data-number="16.5.3.4" class="anchored" data-anchor-id="sec-resolveBiasedItems">
<span class="header-section-number">16.5.3.4</span> Resolve Biased Items</h4>
<p>Another option, for items identified that show <a href="#sec-dif">differential item functioning</a> using <a href="item-response-theory.html">IRT</a> or <a href="#sec-measurementInvariance">measurement non-invariance</a> using <a href="factor-analysis-pca.html#sec-cfa">CFA</a>, is to resolve instead of <a href="#sec-removeBiasedItems">remove</a> items. Resolving items involves allowing an item to have a different <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a>/factor loading and/or <a href="item-response-theory.html#sec-itemDifficulty">difficulty</a>/intercept parameter for each group. Allowing item parameters to differ across groups has a very small effect on <a href="reliability.html">reliability</a> and person separation, so it can be preferable to <a href="#sec-removeBiasedItems">removing items</a> <span class="citation" data-cites="Hagquist2017 Hagquist2019">(<a href="references.html#ref-Hagquist2019" role="doc-biblioref">Hagquist, 2019</a>; <a href="references.html#ref-Hagquist2017" role="doc-biblioref">Hagquist &amp; Andrich, 2017</a>)</span>.</p>
</section><section id="sec-alternativeTestingModes" class="level4" data-number="16.5.3.5"><h4 data-number="16.5.3.5" class="anchored" data-anchor-id="sec-alternativeTestingModes">
<span class="header-section-number">16.5.3.5</span> Use Alternative Modes of Testing</h4>
<p>Another option is to use alternative modes of testing. For example, you could use audio or video to present test items, rather than requiring a person to read the items, or write answers. Typical testing and computerized exams are oriented toward the upper-middle class, which is therefore a procedure problem! McClelland’s <span class="citation" data-cites="McClelland1973">(<a href="references.html#ref-McClelland1973" role="doc-biblioref">1973</a>)</span> argument is that we need more real-life testing. Real-life testing could help address stereotype threats and the effects of learning disabilities. However, testing in different modalities could change the construct(s) being assessed.</p>
</section><section id="sec-workRecords" class="level4" data-number="16.5.3.6"><h4 data-number="16.5.3.6" class="anchored" data-anchor-id="sec-workRecords">
<span class="header-section-number">16.5.3.6</span> Use Work Records</h4>
<p>Using work records is based on McClelland’s <span class="citation" data-cites="McClelland1973">(<a href="references.html#ref-McClelland1973" role="doc-biblioref">1973</a>)</span> argument to use more realistic and authentic assessments of job-relevant abilities. Evidence on the value of work records for personnel selection is mixed. In some cases, use of work records can actually increase <a href="#sec-adverseImpact">adverse impact</a> on under-represented groups because the primary group typically already has an idea of how to get into the relevant job or is already in the relevant job; therefore, they have a leg up. It would be acceptable to use work records if you trained people first and then tested, but no one spends the time to do this.</p>
</section><section id="sec-increaseTimeLimit" class="level4" data-number="16.5.3.7"><h4 data-number="16.5.3.7" class="anchored" data-anchor-id="sec-increaseTimeLimit">
<span class="header-section-number">16.5.3.7</span> Increase Time Limit</h4>
<p>Another option is to allot people more testing time, as long as doing so does not change the construct. Time limits often lead to greater <a href="reliability.html#sec-measurementError">measurement error</a> because scores conflate pace and quality of work. Increasing time limits requires convincing stakeholders that job performance is typically not “how fast you do things” but “how well you do them”—i.e., that time does not correlate with outcome of interest. The utility of increasing time limits depends on the domain. In some domains, efficiency is crucial (e.g., medicine, pilot). Increasing time limits is not that effective in reducing group differences, and it may actually increase group differences.</p>
</section><section id="sec-motivationSets" class="level4" data-number="16.5.3.8"><h4 data-number="16.5.3.8" class="anchored" data-anchor-id="sec-motivationSets">
<span class="header-section-number">16.5.3.8</span> Use Motivation Sets</h4>
<p>Using motivation sets involves finding ways to increase testing motivation for minority groups. It is probably an error to think that a test assesses just aptitude; therefore, we should also consider an individual’s motivation to test. Thus, part of the score has to do with ability and some of the score has to do with motivation. You should try to maximize each examinee’s motivation, so that the person’s score on the measure better captures their true ability score. Motivation sets could include, for example, using more realistic test stimuli that are clearly applicable to the school or job requirements (i.e., that have <a href="validity.html#sec-faceValidity">face validity</a>) to motivate all test takers.</p>
</section><section id="sec-instructionalSets" class="level4" data-number="16.5.3.9"><h4 data-number="16.5.3.9" class="anchored" data-anchor-id="sec-instructionalSets">
<span class="header-section-number">16.5.3.9</span> Use Instructional Sets</h4>
<p>Using instructional sets involves coaching and training. For instance, you could inform examinees about the test content, provide study materials, and recommend test-taking strategies. This could narrow the gap between groups because there is an implicit assumption that the primary group already has “light” training. Using instructional sets aims to reduce error variance due to test anxiety, unfamiliar test format, and poor test-taking skills.</p>
<p>Giving minority groups better access to test preparation is based on the assumption that group differences emerge because of different access to test preparation materials. This could theoretically help to systematically reduce test score differences across groups. Standardized tests like the SAT/GRE/LSAT/GMAT/MCAT, etc. embrace coaching/training. For instance, the organization ETS gives training materials for free. After training, scores on standardized tests show some but minimal improvement. In general, training yields some improvement on quantitative subscales but minimal change on verbal subscales. However, the improvements tend to apply across groups, and they do not seem to lessen group differences in scores.</p>
</section></section></section><section id="sec-gettingStarted-bias" class="level2" data-number="16.6"><h2 data-number="16.6" class="anchored" data-anchor-id="sec-gettingStarted-bias">
<span class="header-section-number">16.6</span> Getting Started</h2>
<section id="sec-loadLibraries-bias" class="level3" data-number="16.6.1"><h3 data-number="16.6.1" class="anchored" data-anchor-id="sec-loadLibraries-bias">
<span class="header-section-number">16.6.1</span> Load Libraries</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(<span class="st">"petersenlab"</span>) <span class="co">#to install: install.packages("remotes"); remotes::install_github("DevPsyLab/petersenlab")</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">library</span>(<span class="st">"lavaan"</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="fu">library</span>(<span class="st">"semTools"</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="fu">library</span>(<span class="st">"semPlot"</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="fu">library</span>(<span class="st">"mirt"</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="fu">library</span>(<span class="st">"dmacs"</span>) <span class="co">#to install: install.packages("remotes"); remotes::install_github("ddueber/dmacs")</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="fu">library</span>(<span class="st">"strucchange"</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="fu">library</span>(<span class="st">"MOTE"</span>)</span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="fu">library</span>(<span class="st">"here"</span>)</span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="fu">library</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="fu">library</span>(<span class="st">"knitr"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-prepareData-bias" class="level3" data-number="16.6.2"><h3 data-number="16.6.2" class="anchored" data-anchor-id="sec-prepareData-bias">
<span class="header-section-number">16.6.2</span> Prepare Data</h3>
<section id="sec-loadData-bias" class="level4" data-number="16.6.2.1"><h4 data-number="16.6.2.1" class="anchored" data-anchor-id="sec-loadData-bias">
<span class="header-section-number">16.6.2.1</span> Load Data</h4>
<p><code>cnlsy</code> is a subset of a data set from the Children of the National Longitudinal Survey of Youth Survey (CNLSY). The CNLSY is a publicly available longitudinal data set provided by the Bureau of Labor Statistics (<a href="https://perma.cc/EH38-HDRN" class="uri">https://perma.cc/EH38-HDRN</a>). The CNLSY data file for these examples is located on the book’s page of the Open Science Framework (<a href="https://osf.io/3pwza" class="uri">https://osf.io/3pwza</a>).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>cnlsy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"cnlsy.csv"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-simulateData-bias" class="level4" data-number="16.6.2.2"><h4 data-number="16.6.2.2" class="anchored" data-anchor-id="sec-simulateData-bias">
<span class="header-section-number">16.6.2.2</span> Simulate Data</h4>
<p>For reproducibility, I set the seed below. Using the same seed will yield the same answer every time. There is nothing special about this particular seed.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>sampleSize <span class="ot">&lt;-</span> <span class="dv">4000</span></span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a>mydataBias <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span>sampleSize,</span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"male"</span>,<span class="st">"female"</span>),</span>
<span id="cb7-8"><a href="#cb7-8"></a>                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"male"</span>,<span class="st">"female"</span>)),</span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="at">unbiasedPredictor1 =</span> <span class="cn">NA</span>,</span>
<span id="cb7-10"><a href="#cb7-10"></a>  <span class="at">unbiasedPredictor2 =</span> <span class="cn">NA</span>,</span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="at">unbiasedPredictor3 =</span> <span class="cn">NA</span>,</span>
<span id="cb7-12"><a href="#cb7-12"></a>  <span class="at">unbiasedCriterion1 =</span> <span class="cn">NA</span>,</span>
<span id="cb7-13"><a href="#cb7-13"></a>  <span class="at">unbiasedCriterion2 =</span> <span class="cn">NA</span>,</span>
<span id="cb7-14"><a href="#cb7-14"></a>  <span class="at">unbiasedCriterion3 =</span> <span class="cn">NA</span>,</span>
<span id="cb7-15"><a href="#cb7-15"></a>  <span class="at">predictor =</span> <span class="fu">rnorm</span>(sampleSize, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>),</span>
<span id="cb7-16"><a href="#cb7-16"></a>  <span class="at">criterion1 =</span> <span class="cn">NA</span>,</span>
<span id="cb7-17"><a href="#cb7-17"></a>  <span class="at">criterion2 =</span> <span class="cn">NA</span>,</span>
<span id="cb7-18"><a href="#cb7-18"></a>  <span class="at">criterion3 =</span> <span class="cn">NA</span>,</span>
<span id="cb7-19"><a href="#cb7-19"></a>  <span class="at">criterion4 =</span> <span class="cn">NA</span>,</span>
<span id="cb7-20"><a href="#cb7-20"></a>  <span class="at">criterion5 =</span> <span class="cn">NA</span>)</span>
<span id="cb7-21"><a href="#cb7-21"></a></span>
<span id="cb7-22"><a href="#cb7-22"></a>mydataBias<span class="sc">$</span>unbiasedPredictor1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(sampleSize, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb7-23"><a href="#cb7-23"></a>mydataBias<span class="sc">$</span>unbiasedPredictor2[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-24"><a href="#cb7-24"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)), <span class="at">mean =</span> <span class="dv">70</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb7-25"><a href="#cb7-25"></a>mydataBias<span class="sc">$</span>unbiasedPredictor2[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-26"><a href="#cb7-26"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)), <span class="at">mean =</span> <span class="dv">130</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb7-27"><a href="#cb7-27"></a>mydataBias<span class="sc">$</span>unbiasedPredictor3[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-28"><a href="#cb7-28"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)), <span class="at">mean =</span> <span class="dv">130</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb7-29"><a href="#cb7-29"></a>mydataBias<span class="sc">$</span>unbiasedPredictor3[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-30"><a href="#cb7-30"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)), <span class="at">mean =</span> <span class="dv">70</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb7-31"><a href="#cb7-31"></a></span>
<span id="cb7-32"><a href="#cb7-32"></a>mydataBias<span class="sc">$</span>unbiasedCriterion1 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>unbiasedPredictor1 <span class="sc">+</span> </span>
<span id="cb7-33"><a href="#cb7-33"></a>  <span class="fu">rnorm</span>(sampleSize, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb7-34"><a href="#cb7-34"></a>mydataBias<span class="sc">$</span>unbiasedCriterion2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>unbiasedPredictor2 <span class="sc">+</span> </span>
<span id="cb7-35"><a href="#cb7-35"></a>  <span class="fu">rnorm</span>(sampleSize, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb7-36"><a href="#cb7-36"></a>mydataBias<span class="sc">$</span>unbiasedCriterion3 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>unbiasedPredictor3 <span class="sc">+</span> </span>
<span id="cb7-37"><a href="#cb7-37"></a>  <span class="fu">rnorm</span>(sampleSize, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb7-38"><a href="#cb7-38"></a></span>
<span id="cb7-39"><a href="#cb7-39"></a>mydataBias<span class="sc">$</span>criterion1[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-40"><a href="#cb7-40"></a>  .<span class="dv">7</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)] <span class="sc">+</span> </span>
<span id="cb7-41"><a href="#cb7-41"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb7-42"><a href="#cb7-42"></a>mydataBias<span class="sc">$</span>criterion1[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-43"><a href="#cb7-43"></a>  .<span class="dv">7</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)] <span class="sc">+</span> </span>
<span id="cb7-44"><a href="#cb7-44"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb7-45"><a href="#cb7-45"></a>mydataBias<span class="sc">$</span>criterion2[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-46"><a href="#cb7-46"></a>  .<span class="dv">7</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)] <span class="sc">+</span> </span>
<span id="cb7-47"><a href="#cb7-47"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)), <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb7-48"><a href="#cb7-48"></a>mydataBias<span class="sc">$</span>criterion2[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-49"><a href="#cb7-49"></a>  .<span class="dv">7</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)] <span class="sc">+</span> </span>
<span id="cb7-50"><a href="#cb7-50"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb7-51"><a href="#cb7-51"></a>mydataBias<span class="sc">$</span>criterion3[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-52"><a href="#cb7-52"></a>  .<span class="dv">7</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)] <span class="sc">+</span> </span>
<span id="cb7-53"><a href="#cb7-53"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb7-54"><a href="#cb7-54"></a>mydataBias<span class="sc">$</span>criterion3[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-55"><a href="#cb7-55"></a>  .<span class="dv">3</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)] <span class="sc">+</span> </span>
<span id="cb7-56"><a href="#cb7-56"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb7-57"><a href="#cb7-57"></a>mydataBias<span class="sc">$</span>criterion4[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-58"><a href="#cb7-58"></a>  .<span class="dv">7</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)] <span class="sc">+</span> </span>
<span id="cb7-59"><a href="#cb7-59"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb7-60"><a href="#cb7-60"></a>mydataBias<span class="sc">$</span>criterion4[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-61"><a href="#cb7-61"></a>  .<span class="dv">3</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)] <span class="sc">+</span> </span>
<span id="cb7-62"><a href="#cb7-62"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)), <span class="at">mean =</span> <span class="dv">30</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb7-63"><a href="#cb7-63"></a>mydataBias<span class="sc">$</span>criterion5[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-64"><a href="#cb7-64"></a>  .<span class="dv">7</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)] <span class="sc">+</span> </span>
<span id="cb7-65"><a href="#cb7-65"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">30</span>)</span>
<span id="cb7-66"><a href="#cb7-66"></a>mydataBias<span class="sc">$</span>criterion5[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)] <span class="ot">&lt;-</span> </span>
<span id="cb7-67"><a href="#cb7-67"></a>  .<span class="dv">7</span> <span class="sc">*</span> mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)] <span class="sc">+</span> </span>
<span id="cb7-68"><a href="#cb7-68"></a>  <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-addMissingData-bias" class="level4" data-number="16.6.2.3"><h4 data-number="16.6.2.3" class="anchored" data-anchor-id="sec-addMissingData-bias">
<span class="header-section-number">16.6.2.3</span> Add Missing Data</h4>
<p>Adding missing data to dataframes helps make examples more realistic to real-life data and helps you get in the habit of programming to account for missing data.</p>
<p><code>HolzingerSwineford1939</code> is a data set from the <code>lavaan</code> package <span class="citation" data-cites="R-lavaan">(<a href="references.html#ref-R-lavaan" role="doc-biblioref">Rosseel et al., 2022</a>)</span> that contains mental ability test scores (<code>x1</code>–<code>x9</code>) for seventh- and eighth-grade children.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>varNames <span class="ot">&lt;-</span> <span class="fu">names</span>(mydataBias)</span>
<span id="cb8-2"><a href="#cb8-2"></a>dimensionsDf <span class="ot">&lt;-</span> <span class="fu">dim</span>(mydataBias[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)])</span>
<span id="cb8-3"><a href="#cb8-3"></a>unlistedDf <span class="ot">&lt;-</span> <span class="fu">unlist</span>(mydataBias[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)])</span>
<span id="cb8-4"><a href="#cb8-4"></a>unlistedDf[<span class="fu">sample</span>(</span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(unlistedDf),</span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="at">size =</span> .<span class="dv">01</span> <span class="sc">*</span> <span class="fu">length</span>(unlistedDf))] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>mydataBias <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb8-8"><a href="#cb8-8"></a>  mydataBias[,<span class="fu">c</span>(<span class="st">"ID"</span>,<span class="st">"group"</span>)],</span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="fu">matrix</span>(</span>
<span id="cb8-11"><a href="#cb8-11"></a>      unlistedDf,</span>
<span id="cb8-12"><a href="#cb8-12"></a>      <span class="at">ncol =</span> dimensionsDf[<span class="dv">2</span>])))</span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="fu">names</span>(mydataBias) <span class="ot">&lt;-</span> varNames</span>
<span id="cb8-14"><a href="#cb8-14"></a></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="fu">data</span>(<span class="st">"HolzingerSwineford1939"</span>)</span>
<span id="cb8-16"><a href="#cb8-16"></a>varNames <span class="ot">&lt;-</span> <span class="fu">names</span>(HolzingerSwineford1939)</span>
<span id="cb8-17"><a href="#cb8-17"></a>dimensionsDf <span class="ot">&lt;-</span> <span class="fu">dim</span>(HolzingerSwineford1939[,<span class="fu">paste</span>(<span class="st">"x"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">sep =</span> <span class="st">""</span>)])</span>
<span id="cb8-18"><a href="#cb8-18"></a>unlistedDf <span class="ot">&lt;-</span> <span class="fu">unlist</span>(HolzingerSwineford1939[,<span class="fu">paste</span>(<span class="st">"x"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">sep =</span> <span class="st">""</span>)])</span>
<span id="cb8-19"><a href="#cb8-19"></a>unlistedDf[<span class="fu">sample</span>(</span>
<span id="cb8-20"><a href="#cb8-20"></a>  <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(unlistedDf),</span>
<span id="cb8-21"><a href="#cb8-21"></a>  <span class="at">size =</span> .<span class="dv">01</span> <span class="sc">*</span> <span class="fu">length</span>(unlistedDf))] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>HolzingerSwineford1939 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb8-23"><a href="#cb8-23"></a>  HolzingerSwineford1939[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>],</span>
<span id="cb8-24"><a href="#cb8-24"></a>  <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(</span>
<span id="cb8-25"><a href="#cb8-25"></a>    unlistedDf,</span>
<span id="cb8-26"><a href="#cb8-26"></a>    <span class="at">ncol =</span> dimensionsDf[<span class="dv">2</span>])))</span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="fu">names</span>(HolzingerSwineford1939) <span class="ot">&lt;-</span> varNames</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section></section><section id="sec-examplesUnbiasedTests" class="level2" data-number="16.7"><h2 data-number="16.7" class="anchored" data-anchor-id="sec-examplesUnbiasedTests">
<span class="header-section-number">16.7</span> Examples of Unbiased Tests (in Terms of Predictive Bias)</h2>
<section id="sec-unbiasedTestsEqualMeans" class="level3" data-number="16.7.1"><h3 data-number="16.7.1" class="anchored" data-anchor-id="sec-unbiasedTestsEqualMeans">
<span class="header-section-number">16.7.1</span> Unbiased test where males and females have equal means on predictor and criterion</h3>
<p><a href="#fig-unbiasedEqualMeans" class="quarto-xref">Figure&nbsp;<span>16.21</span></a> depicts an example of an unbiased test where males and females have equal means on the predictor and criterion. The test is unbiased because there are no significant differences in the regression lines (of <code>predictor</code> predicting <code>criterion</code>) between males and females.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(</span>
<span id="cb9-2"><a href="#cb9-2"></a>  unbiasedCriterion1 <span class="sc">~</span> unbiasedPredictor1 <span class="sc">+</span> group <span class="sc">+</span> unbiasedPredictor1<span class="sc">:</span>group,</span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="at">data =</span> mydataBias))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = unbiasedCriterion1 ~ unbiasedPredictor1 + group + 
    unbiasedPredictor1:group, data = mydataBias)

Residuals:
    Min      1Q  Median      3Q     Max 
-54.623 -10.050  -0.025  10.373  66.811 

Coefficients:
                                Estimate Std. Error t value            Pr(&gt;|t|)
(Intercept)                     0.930697   2.295058   0.406               0.685
unbiasedPredictor1              0.996976   0.022624  44.066 &lt;0.0000000000000002
groupfemale                    -1.165200   3.250481  -0.358               0.720
unbiasedPredictor1:groupfemale -0.004397   0.032115  -0.137               0.891
                                  
(Intercept)                       
unbiasedPredictor1             ***
groupfemale                       
unbiasedPredictor1:groupfemale    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.13 on 3913 degrees of freedom
  (83 observations deleted due to missingness)
Multiple R-squared:  0.4963,    Adjusted R-squared:  0.496 
F-statistic:  1285 on 3 and 3913 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">plot</span>(</span>
<span id="cb11-2"><a href="#cb11-2"></a>  unbiasedCriterion1 <span class="sc">~</span> unbiasedPredictor1,</span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="at">data =</span> mydataBias,</span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(</span>
<span id="cb11-5"><a href="#cb11-5"></a>    <span class="dv">0</span>, </span>
<span id="cb11-6"><a href="#cb11-6"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb11-7"><a href="#cb11-7"></a>      mydataBias<span class="sc">$</span>unbiasedCriterion1,</span>
<span id="cb11-8"><a href="#cb11-8"></a>      mydataBias<span class="sc">$</span>unbiasedPredictor1),</span>
<span id="cb11-9"><a href="#cb11-9"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(</span>
<span id="cb11-11"><a href="#cb11-11"></a>    <span class="dv">0</span>, </span>
<span id="cb11-12"><a href="#cb11-12"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb11-13"><a href="#cb11-13"></a>      mydataBias<span class="sc">$</span>criterion1,</span>
<span id="cb11-14"><a href="#cb11-14"></a>      mydataBias<span class="sc">$</span>predictor),</span>
<span id="cb11-15"><a href="#cb11-15"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb11-16"><a href="#cb11-16"></a>  <span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb11-17"><a href="#cb11-17"></a>  <span class="at">xlab =</span> <span class="st">"predictor"</span>,</span>
<span id="cb11-18"><a href="#cb11-18"></a>  <span class="at">ylab =</span> <span class="st">"criterion"</span>)</span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="fu">points</span>(</span>
<span id="cb11-20"><a href="#cb11-20"></a>  mydataBias<span class="sc">$</span>unbiasedPredictor1[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb11-21"><a href="#cb11-21"></a>  mydataBias<span class="sc">$</span>unbiasedCriterion1[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb11-22"><a href="#cb11-22"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb11-23"><a href="#cb11-23"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="fu">points</span>(mydataBias<span class="sc">$</span>unbiasedPredictor1[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb11-25"><a href="#cb11-25"></a>       mydataBias<span class="sc">$</span>unbiasedCriterion1[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb11-26"><a href="#cb11-26"></a>       <span class="at">pch =</span> <span class="dv">1</span>,</span>
<span id="cb11-27"><a href="#cb11-27"></a>       <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb11-28"><a href="#cb11-28"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb11-29"><a href="#cb11-29"></a>  unbiasedCriterion1 <span class="sc">~</span> unbiasedPredictor1,</span>
<span id="cb11-30"><a href="#cb11-30"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>),]),</span>
<span id="cb11-31"><a href="#cb11-31"></a>  <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb11-32"><a href="#cb11-32"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb11-33"><a href="#cb11-33"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb11-34"><a href="#cb11-34"></a>  unbiasedCriterion1 <span class="sc">~</span> unbiasedPredictor1,</span>
<span id="cb11-35"><a href="#cb11-35"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>),]),</span>
<span id="cb11-36"><a href="#cb11-36"></a>  <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb11-37"><a href="#cb11-37"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb11-38"><a href="#cb11-38"></a><span class="fu">legend</span>(</span>
<span id="cb11-39"><a href="#cb11-39"></a>  <span class="st">"bottomright"</span>,</span>
<span id="cb11-40"><a href="#cb11-40"></a>  <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>),</span>
<span id="cb11-41"><a href="#cb11-41"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb11-42"><a href="#cb11-42"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>),</span>
<span id="cb11-43"><a href="#cb11-43"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-unbiasedEqualMeans" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Unbiased Test Where Males and Females Have Equal Means on Predictor and Criterion.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-unbiasedEqualMeans-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-unbiasedEqualMeans-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Figure&nbsp;16.21: Unbiased Test Where Males and Females Have Equal Means on Predictor and Criterion."><img src="test-bias_files/figure-html/fig-unbiasedEqualMeans-1.png" class="img-fluid figure-img" alt="Unbiased Test Where Males and Females Have Equal Means on Predictor and Criterion." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-unbiasedEqualMeans-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.21: Unbiased Test Where Males and Females Have Equal Means on Predictor and Criterion.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-unbiasedTestsFemalesHigherMeans" class="level3" data-number="16.7.2"><h3 data-number="16.7.2" class="anchored" data-anchor-id="sec-unbiasedTestsFemalesHigherMeans">
<span class="header-section-number">16.7.2</span> Unbiased test where females have higher means than males on predictor and criterion</h3>
<p><a href="#fig-unbiasedFemaleHigher" class="quarto-xref">Figure&nbsp;<span>16.22</span></a> depicts an example of an unbiased test where females have higher means than males on the predictor and criterion. The test is unbiased because there are no differences in the regression lines (of <code>predictor</code> predicting <code>criterion</code>) between males and females.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(</span>
<span id="cb12-2"><a href="#cb12-2"></a>  unbiasedCriterion2 <span class="sc">~</span> unbiasedPredictor2 <span class="sc">+</span> group <span class="sc">+</span> unbiasedPredictor2<span class="sc">:</span>group,</span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="at">data =</span> mydataBias))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = unbiasedCriterion2 ~ unbiasedPredictor2 + group + 
    unbiasedPredictor2:group, data = mydataBias)

Residuals:
    Min      1Q  Median      3Q     Max 
-47.302  -9.989   0.010   9.860  53.791 

Coefficients:
                               Estimate Std. Error t value            Pr(&gt;|t|)
(Intercept)                    -1.29332    1.57773  -0.820               0.412
unbiasedPredictor2              1.02006    0.02218  46.000 &lt;0.0000000000000002
groupfemale                     1.21294    3.28319   0.369               0.712
unbiasedPredictor2:groupfemale -0.01501    0.03125  -0.480               0.631
                                  
(Intercept)                       
unbiasedPredictor2             ***
groupfemale                       
unbiasedPredictor2:groupfemale    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.81 on 3919 degrees of freedom
  (77 observations deleted due to missingness)
Multiple R-squared:  0.8412,    Adjusted R-squared:  0.8411 
F-statistic:  6921 on 3 and 3919 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">plot</span>(</span>
<span id="cb14-2"><a href="#cb14-2"></a>  unbiasedCriterion2 <span class="sc">~</span> unbiasedPredictor2,</span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="at">data =</span> mydataBias,</span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(</span>
<span id="cb14-5"><a href="#cb14-5"></a>    <span class="dv">0</span>, </span>
<span id="cb14-6"><a href="#cb14-6"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb14-7"><a href="#cb14-7"></a>      mydataBias<span class="sc">$</span>unbiasedCriterion2,</span>
<span id="cb14-8"><a href="#cb14-8"></a>      mydataBias<span class="sc">$</span>unbiasedPredictor2),</span>
<span id="cb14-9"><a href="#cb14-9"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb14-10"><a href="#cb14-10"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(</span>
<span id="cb14-11"><a href="#cb14-11"></a>    <span class="dv">0</span>, </span>
<span id="cb14-12"><a href="#cb14-12"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb14-13"><a href="#cb14-13"></a>      mydataBias<span class="sc">$</span>criterion1,</span>
<span id="cb14-14"><a href="#cb14-14"></a>      mydataBias<span class="sc">$</span>predictor),</span>
<span id="cb14-15"><a href="#cb14-15"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb14-16"><a href="#cb14-16"></a>  <span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb14-17"><a href="#cb14-17"></a>  <span class="at">xlab =</span> <span class="st">"predictor"</span>,</span>
<span id="cb14-18"><a href="#cb14-18"></a>  <span class="at">ylab =</span> <span class="st">"criterion"</span>)</span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="fu">points</span>(</span>
<span id="cb14-20"><a href="#cb14-20"></a>  mydataBias<span class="sc">$</span>unbiasedPredictor2[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb14-21"><a href="#cb14-21"></a>  mydataBias<span class="sc">$</span>unbiasedCriterion2[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb14-22"><a href="#cb14-22"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb14-23"><a href="#cb14-23"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb14-24"><a href="#cb14-24"></a><span class="fu">points</span>(</span>
<span id="cb14-25"><a href="#cb14-25"></a>  mydataBias<span class="sc">$</span>unbiasedPredictor2[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb14-26"><a href="#cb14-26"></a>  mydataBias<span class="sc">$</span>unbiasedCriterion2[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb14-27"><a href="#cb14-27"></a>  <span class="at">pch =</span> <span class="dv">1</span>,</span>
<span id="cb14-28"><a href="#cb14-28"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb14-29"><a href="#cb14-29"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb14-30"><a href="#cb14-30"></a>  unbiasedCriterion2 <span class="sc">~</span> unbiasedPredictor2,</span>
<span id="cb14-31"><a href="#cb14-31"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>),]),</span>
<span id="cb14-32"><a href="#cb14-32"></a>  <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb14-33"><a href="#cb14-33"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb14-34"><a href="#cb14-34"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb14-35"><a href="#cb14-35"></a>  unbiasedCriterion2 <span class="sc">~</span> unbiasedPredictor2,</span>
<span id="cb14-36"><a href="#cb14-36"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>),]),</span>
<span id="cb14-37"><a href="#cb14-37"></a>  <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb14-38"><a href="#cb14-38"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb14-39"><a href="#cb14-39"></a><span class="fu">legend</span>(</span>
<span id="cb14-40"><a href="#cb14-40"></a>  <span class="st">"bottomright"</span>,</span>
<span id="cb14-41"><a href="#cb14-41"></a>  <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>),</span>
<span id="cb14-42"><a href="#cb14-42"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb14-43"><a href="#cb14-43"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>),</span>
<span id="cb14-44"><a href="#cb14-44"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-unbiasedFemaleHigher" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Unbiased Test Where Females Have Higher Means Than Males on Predictor and Criterion.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-unbiasedFemaleHigher-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-unbiasedFemaleHigher-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Figure&nbsp;16.22: Unbiased Test Where Females Have Higher Means Than Males on Predictor and Criterion."><img src="test-bias_files/figure-html/fig-unbiasedFemaleHigher-1.png" class="img-fluid figure-img" alt="Unbiased Test Where Females Have Higher Means Than Males on Predictor and Criterion." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-unbiasedFemaleHigher-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.22: Unbiased Test Where Females Have Higher Means Than Males on Predictor and Criterion.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-unbiasedTestsMalesHigherMeans" class="level3" data-number="16.7.3"><h3 data-number="16.7.3" class="anchored" data-anchor-id="sec-unbiasedTestsMalesHigherMeans">
<span class="header-section-number">16.7.3</span> Unbiased test where males have higher means than females on predictor and criterion</h3>
<p><a href="#fig-unbiasedMaleHigher" class="quarto-xref">Figure&nbsp;<span>16.23</span></a> depicts an example of an unbiased test where males have higher means than females on the predictor and criterion. The test is unbiased because there are no differences in the regression lines (of <code>predictor</code> predicting <code>criterion</code>) between males and females.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(</span>
<span id="cb15-2"><a href="#cb15-2"></a>  unbiasedCriterion3 <span class="sc">~</span> unbiasedPredictor3 <span class="sc">+</span> group <span class="sc">+</span> unbiasedPredictor3<span class="sc">:</span>group,</span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="at">data =</span> mydataBias))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = unbiasedCriterion3 ~ unbiasedPredictor3 + group + 
    unbiasedPredictor3:group, data = mydataBias)

Residuals:
    Min      1Q  Median      3Q     Max 
-48.613 -10.115  -0.068   9.598  57.126 

Coefficients:
                               Estimate Std. Error t value            Pr(&gt;|t|)
(Intercept)                    -1.68352    2.84985  -0.591               0.555
unbiasedPredictor3              1.01072    0.02179  46.375 &lt;0.0000000000000002
groupfemale                     1.42842    3.26227   0.438               0.662
unbiasedPredictor3:groupfemale -0.01187    0.03109  -0.382               0.703
                                  
(Intercept)                       
unbiasedPredictor3             ***
groupfemale                       
unbiasedPredictor3:groupfemale    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.82 on 3916 degrees of freedom
  (80 observations deleted due to missingness)
Multiple R-squared:  0.8376,    Adjusted R-squared:  0.8375 
F-statistic:  6732 on 3 and 3916 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">plot</span>(</span>
<span id="cb17-2"><a href="#cb17-2"></a>  unbiasedCriterion3 <span class="sc">~</span> unbiasedPredictor3,</span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="at">data =</span> mydataBias,</span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(</span>
<span id="cb17-5"><a href="#cb17-5"></a>    <span class="dv">0</span>,</span>
<span id="cb17-6"><a href="#cb17-6"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb17-7"><a href="#cb17-7"></a>      mydataBias<span class="sc">$</span>unbiasedCriterion3,</span>
<span id="cb17-8"><a href="#cb17-8"></a>      mydataBias<span class="sc">$</span>unbiasedPredictor3),</span>
<span id="cb17-9"><a href="#cb17-9"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb17-11"><a href="#cb17-11"></a>    mydataBias<span class="sc">$</span>criterion1,</span>
<span id="cb17-12"><a href="#cb17-12"></a>    mydataBias<span class="sc">$</span>predictor),</span>
<span id="cb17-13"><a href="#cb17-13"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb17-14"><a href="#cb17-14"></a>  <span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb17-15"><a href="#cb17-15"></a>  <span class="at">xlab =</span> <span class="st">"predictor"</span>,</span>
<span id="cb17-16"><a href="#cb17-16"></a>  <span class="at">ylab =</span> <span class="st">"criterion"</span>)</span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="fu">points</span>(</span>
<span id="cb17-18"><a href="#cb17-18"></a>  mydataBias<span class="sc">$</span>unbiasedPredictor3[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb17-19"><a href="#cb17-19"></a>  mydataBias<span class="sc">$</span>unbiasedCriterion3[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb17-20"><a href="#cb17-20"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb17-21"><a href="#cb17-21"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="fu">points</span>(</span>
<span id="cb17-23"><a href="#cb17-23"></a>  mydataBias<span class="sc">$</span>unbiasedPredictor3[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb17-24"><a href="#cb17-24"></a>  mydataBias<span class="sc">$</span>unbiasedCriterion3[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb17-25"><a href="#cb17-25"></a>  <span class="at">pch =</span> <span class="dv">1</span>,</span>
<span id="cb17-26"><a href="#cb17-26"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb17-27"><a href="#cb17-27"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb17-28"><a href="#cb17-28"></a>  unbiasedCriterion3 <span class="sc">~</span> unbiasedPredictor3,</span>
<span id="cb17-29"><a href="#cb17-29"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>),]),</span>
<span id="cb17-30"><a href="#cb17-30"></a>  <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb17-31"><a href="#cb17-31"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb17-33"><a href="#cb17-33"></a>  unbiasedCriterion3 <span class="sc">~</span> unbiasedPredictor3,</span>
<span id="cb17-34"><a href="#cb17-34"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>),]),</span>
<span id="cb17-35"><a href="#cb17-35"></a>  <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb17-36"><a href="#cb17-36"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb17-37"><a href="#cb17-37"></a><span class="fu">legend</span>(</span>
<span id="cb17-38"><a href="#cb17-38"></a>  <span class="st">"bottomright"</span>,</span>
<span id="cb17-39"><a href="#cb17-39"></a>  <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>),</span>
<span id="cb17-40"><a href="#cb17-40"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb17-41"><a href="#cb17-41"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>),</span>
<span id="cb17-42"><a href="#cb17-42"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-unbiasedMaleHigher" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Unbiased Test Where Males Have Higher Means Than Females on Predictor and Criterion.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-unbiasedMaleHigher-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-unbiasedMaleHigher-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Figure&nbsp;16.23: Unbiased Test Where Males Have Higher Means Than Females on Predictor and Criterion."><img src="test-bias_files/figure-html/fig-unbiasedMaleHigher-1.png" class="img-fluid figure-img" alt="Unbiased Test Where Males Have Higher Means Than Females on Predictor and Criterion." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-unbiasedMaleHigher-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.23: Unbiased Test Where Males Have Higher Means Than Females on Predictor and Criterion.
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-predictiveBiasExamples" class="level2" data-number="16.8"><h2 data-number="16.8" class="anchored" data-anchor-id="sec-predictiveBiasExamples">
<span class="header-section-number">16.8</span> Predictive Bias: Different Regression Lines</h2>
<section id="sec-unbiasedPrediction" class="level3" data-number="16.8.1"><h3 data-number="16.8.1" class="anchored" data-anchor-id="sec-unbiasedPrediction">
<span class="header-section-number">16.8.1</span> Example of unbiased prediction (no differences in intercepts or slopes)</h3>
<p><a href="#fig-unbiased2" class="quarto-xref">Figure&nbsp;<span>16.24</span></a> depicts an example of an unbiased test where males and females have equal means on the predictor and criterion. The test is unbiased because there are no differences in the regression lines (of <code>predictor</code> predicting <code>criterion1</code>) between males and females.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(</span>
<span id="cb18-2"><a href="#cb18-2"></a>  criterion1 <span class="sc">~</span> predictor <span class="sc">+</span> group <span class="sc">+</span> predictor<span class="sc">:</span>group,</span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="at">data =</span> mydataBias))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = criterion1 ~ predictor + group + predictor:group, 
    data = mydataBias)

Residuals:
    Min      1Q  Median      3Q     Max 
-18.831  -3.338   0.004   3.330  19.335 

Coefficients:
                       Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)           -0.264357   0.747269  -0.354               0.724    
predictor              0.701726   0.007370  95.207 &lt;0.0000000000000002 ***
groupfemale           -0.515860   1.059267  -0.487               0.626    
predictor:groupfemale  0.006002   0.010476   0.573               0.567    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.952 on 3908 degrees of freedom
  (88 observations deleted due to missingness)
Multiple R-squared:  0.8225,    Adjusted R-squared:  0.8223 
F-statistic:  6035 on 3 and 3908 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">plot</span>(</span>
<span id="cb20-2"><a href="#cb20-2"></a>  criterion1 <span class="sc">~</span> predictor,</span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="at">data =</span> mydataBias,</span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(</span>
<span id="cb20-5"><a href="#cb20-5"></a>    <span class="dv">0</span>,</span>
<span id="cb20-6"><a href="#cb20-6"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb20-7"><a href="#cb20-7"></a>      mydataBias<span class="sc">$</span>criterion1,</span>
<span id="cb20-8"><a href="#cb20-8"></a>      mydataBias<span class="sc">$</span>predictor),</span>
<span id="cb20-9"><a href="#cb20-9"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb20-10"><a href="#cb20-10"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(</span>
<span id="cb20-11"><a href="#cb20-11"></a>    <span class="dv">0</span>, </span>
<span id="cb20-12"><a href="#cb20-12"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb20-13"><a href="#cb20-13"></a>      mydataBias<span class="sc">$</span>criterion1,</span>
<span id="cb20-14"><a href="#cb20-14"></a>      mydataBias<span class="sc">$</span>predictor),</span>
<span id="cb20-15"><a href="#cb20-15"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb20-16"><a href="#cb20-16"></a>  <span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb20-17"><a href="#cb20-17"></a>  <span class="at">xlab =</span> <span class="st">"predictor"</span>,</span>
<span id="cb20-18"><a href="#cb20-18"></a>  <span class="at">ylab =</span> <span class="st">"criterion"</span>)</span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="fu">points</span>(</span>
<span id="cb20-20"><a href="#cb20-20"></a>  mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb20-21"><a href="#cb20-21"></a>  mydataBias<span class="sc">$</span>criterion1[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb20-22"><a href="#cb20-22"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb20-23"><a href="#cb20-23"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb20-24"><a href="#cb20-24"></a><span class="fu">points</span>(</span>
<span id="cb20-25"><a href="#cb20-25"></a>  mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb20-26"><a href="#cb20-26"></a>  mydataBias<span class="sc">$</span>criterion1[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb20-27"><a href="#cb20-27"></a>  <span class="at">pch =</span> <span class="dv">1</span>,</span>
<span id="cb20-28"><a href="#cb20-28"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb20-29"><a href="#cb20-29"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb20-30"><a href="#cb20-30"></a>  criterion1 <span class="sc">~</span> predictor,</span>
<span id="cb20-31"><a href="#cb20-31"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>),]),</span>
<span id="cb20-32"><a href="#cb20-32"></a>  <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb20-33"><a href="#cb20-33"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb20-34"><a href="#cb20-34"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb20-35"><a href="#cb20-35"></a>  criterion1 <span class="sc">~</span> predictor,</span>
<span id="cb20-36"><a href="#cb20-36"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>),]),</span>
<span id="cb20-37"><a href="#cb20-37"></a>  <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb20-38"><a href="#cb20-38"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb20-39"><a href="#cb20-39"></a><span class="fu">legend</span>(</span>
<span id="cb20-40"><a href="#cb20-40"></a>  <span class="st">"bottomright"</span>,</span>
<span id="cb20-41"><a href="#cb20-41"></a>  <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>),</span>
<span id="cb20-42"><a href="#cb20-42"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb20-43"><a href="#cb20-43"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>),</span>
<span id="cb20-44"><a href="#cb20-44"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-unbiased2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Example of Unbiased Prediction (No Differences in Intercepts or Slopes Between Males and Females).">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-unbiased2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-unbiased2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Figure&nbsp;16.24: Example of Unbiased Prediction (No Differences in Intercepts or Slopes Between Males and Females)."><img src="test-bias_files/figure-html/fig-unbiased2-1.png" class="img-fluid figure-img" alt="Example of Unbiased Prediction (No Differences in Intercepts or Slopes Between Males and Females)." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-unbiased2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.24: Example of Unbiased Prediction (No Differences in Intercepts or Slopes Between Males and Females).
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-interceptBias" class="level3" data-number="16.8.2"><h3 data-number="16.8.2" class="anchored" data-anchor-id="sec-interceptBias">
<span class="header-section-number">16.8.2</span> Example of intercept bias</h3>
<p><a href="#fig-interceptBias" class="quarto-xref">Figure&nbsp;<span>16.25</span></a> depicts an example of a biased test due to intercept bias. There are differences in the intercepts of the regression lines (of <code>predictor</code> predicting <code>criterion2</code>) between males and females: males have a higher intercept than females. That is, the same score on the predictor results in higher predictions for males than females.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(</span>
<span id="cb21-2"><a href="#cb21-2"></a>  criterion2 <span class="sc">~</span> predictor <span class="sc">+</span> group <span class="sc">+</span> predictor<span class="sc">:</span>group,</span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="at">data =</span> mydataBias))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = criterion2 ~ predictor + group + predictor:group, 
    data = mydataBias)

Residuals:
     Min       1Q   Median       3Q      Max 
-18.6853  -3.4153  -0.0385   3.3979  18.0864 

Coefficients:
                        Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)            10.054048   0.760084  13.228 &lt;0.0000000000000002 ***
predictor               0.697987   0.007499  93.075 &lt;0.0000000000000002 ***
groupfemale           -10.288893   1.074168  -9.578 &lt;0.0000000000000002 ***
predictor:groupfemale   0.004748   0.010625   0.447               0.655    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.037 on 3913 degrees of freedom
  (83 observations deleted due to missingness)
Multiple R-squared:  0.8452,    Adjusted R-squared:  0.8451 
F-statistic:  7124 on 3 and 3913 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">plot</span>(</span>
<span id="cb23-2"><a href="#cb23-2"></a>  criterion2 <span class="sc">~</span> predictor,</span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="at">data =</span> mydataBias,</span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(</span>
<span id="cb23-5"><a href="#cb23-5"></a>    <span class="dv">0</span>,</span>
<span id="cb23-6"><a href="#cb23-6"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb23-7"><a href="#cb23-7"></a>      mydataBias<span class="sc">$</span>criterion2,</span>
<span id="cb23-8"><a href="#cb23-8"></a>      mydataBias<span class="sc">$</span>predictor), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(</span>
<span id="cb23-10"><a href="#cb23-10"></a>    <span class="dv">0</span>,</span>
<span id="cb23-11"><a href="#cb23-11"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb23-12"><a href="#cb23-12"></a>      mydataBias<span class="sc">$</span>criterion2,</span>
<span id="cb23-13"><a href="#cb23-13"></a>      mydataBias<span class="sc">$</span>predictor),</span>
<span id="cb23-14"><a href="#cb23-14"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb23-15"><a href="#cb23-15"></a>  <span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb23-16"><a href="#cb23-16"></a>  <span class="at">xlab =</span> <span class="st">"predictor"</span>,</span>
<span id="cb23-17"><a href="#cb23-17"></a>  <span class="at">ylab =</span> <span class="st">"criterion"</span>)</span>
<span id="cb23-18"><a href="#cb23-18"></a><span class="fu">points</span>(</span>
<span id="cb23-19"><a href="#cb23-19"></a>  mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb23-20"><a href="#cb23-20"></a>  mydataBias<span class="sc">$</span>criterion2[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb23-21"><a href="#cb23-21"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb23-22"><a href="#cb23-22"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb23-23"><a href="#cb23-23"></a><span class="fu">points</span>(</span>
<span id="cb23-24"><a href="#cb23-24"></a>  mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb23-25"><a href="#cb23-25"></a>  mydataBias<span class="sc">$</span>criterion2[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb23-26"><a href="#cb23-26"></a>  <span class="at">pch =</span> <span class="dv">1</span>,</span>
<span id="cb23-27"><a href="#cb23-27"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb23-28"><a href="#cb23-28"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb23-29"><a href="#cb23-29"></a>  criterion2 <span class="sc">~</span> predictor,</span>
<span id="cb23-30"><a href="#cb23-30"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>),]),</span>
<span id="cb23-31"><a href="#cb23-31"></a>  <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb23-32"><a href="#cb23-32"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb23-33"><a href="#cb23-33"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb23-34"><a href="#cb23-34"></a>  criterion2 <span class="sc">~</span> predictor,</span>
<span id="cb23-35"><a href="#cb23-35"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>),]),</span>
<span id="cb23-36"><a href="#cb23-36"></a>  <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb23-37"><a href="#cb23-37"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb23-38"><a href="#cb23-38"></a><span class="fu">legend</span>(</span>
<span id="cb23-39"><a href="#cb23-39"></a>  <span class="st">"bottomright"</span>,</span>
<span id="cb23-40"><a href="#cb23-40"></a>  <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>),</span>
<span id="cb23-41"><a href="#cb23-41"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb23-42"><a href="#cb23-42"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>),</span>
<span id="cb23-43"><a href="#cb23-43"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-interceptBias" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Example of Intercept Bias in Prediction (Different Intercepts Between Males and Females).">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-interceptBias-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-interceptBias-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Figure&nbsp;16.25: Example of Intercept Bias in Prediction (Different Intercepts Between Males and Females)."><img src="test-bias_files/figure-html/fig-interceptBias-1.png" class="img-fluid figure-img" alt="Example of Intercept Bias in Prediction (Different Intercepts Between Males and Females)." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interceptBias-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.25: Example of Intercept Bias in Prediction (Different Intercepts Between Males and Females).
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-slopeBias" class="level3" data-number="16.8.3"><h3 data-number="16.8.3" class="anchored" data-anchor-id="sec-slopeBias">
<span class="header-section-number">16.8.3</span> Example of slope bias</h3>
<p><a href="#fig-slopeBias" class="quarto-xref">Figure&nbsp;<span>16.26</span></a> depicts an example of a biased test due to slope bias. There are differences in the slopes of the regression lines (of <code>predictor</code> predicting <code>criterion3</code>) between males and females: males have a higher slope than females. That is, scores have stronger <a href="validity.html#sec-predictiveValidity">predictive validity</a> for males than females.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(</span>
<span id="cb24-2"><a href="#cb24-2"></a>  criterion3 <span class="sc">~</span> predictor <span class="sc">+</span> group <span class="sc">+</span> predictor<span class="sc">:</span>group,</span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="at">data =</span> mydataBias))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = criterion3 ~ predictor + group + predictor:group, 
    data = mydataBias)

Residuals:
     Min       1Q   Median       3Q      Max 
-18.3183  -3.3715   0.0256   3.3844  19.3484 

Coefficients:
                       Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)           -1.041940   0.757914  -1.375               0.169    
predictor              0.708670   0.007475  94.804 &lt;0.0000000000000002 ***
groupfemale            1.478534   1.074064   1.377               0.169    
predictor:groupfemale -0.413233   0.010621 -38.907 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.031 on 3927 degrees of freedom
  (69 observations deleted due to missingness)
Multiple R-squared:  0.9489,    Adjusted R-squared:  0.9489 
F-statistic: 2.432e+04 on 3 and 3927 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">plot</span>(</span>
<span id="cb26-2"><a href="#cb26-2"></a>  criterion3 <span class="sc">~</span> predictor,</span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="at">data =</span> mydataBias,</span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(</span>
<span id="cb26-5"><a href="#cb26-5"></a>    <span class="dv">0</span>,</span>
<span id="cb26-6"><a href="#cb26-6"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb26-7"><a href="#cb26-7"></a>      mydataBias<span class="sc">$</span>criterion3,</span>
<span id="cb26-8"><a href="#cb26-8"></a>      mydataBias<span class="sc">$</span>predictor),</span>
<span id="cb26-9"><a href="#cb26-9"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb26-10"><a href="#cb26-10"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(</span>
<span id="cb26-11"><a href="#cb26-11"></a>    <span class="dv">0</span>,</span>
<span id="cb26-12"><a href="#cb26-12"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb26-13"><a href="#cb26-13"></a>      mydataBias<span class="sc">$</span>criterion3,</span>
<span id="cb26-14"><a href="#cb26-14"></a>      mydataBias<span class="sc">$</span>predictor),</span>
<span id="cb26-15"><a href="#cb26-15"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb26-16"><a href="#cb26-16"></a>  <span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb26-17"><a href="#cb26-17"></a>  <span class="at">xlab =</span> <span class="st">"predictor"</span>,</span>
<span id="cb26-18"><a href="#cb26-18"></a>  <span class="at">ylab =</span> <span class="st">"criterion"</span>)</span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="fu">points</span>(</span>
<span id="cb26-20"><a href="#cb26-20"></a>  mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb26-21"><a href="#cb26-21"></a>  mydataBias<span class="sc">$</span>criterion3[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb26-22"><a href="#cb26-22"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb26-23"><a href="#cb26-23"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb26-24"><a href="#cb26-24"></a><span class="fu">points</span>(</span>
<span id="cb26-25"><a href="#cb26-25"></a>  mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb26-26"><a href="#cb26-26"></a>  mydataBias<span class="sc">$</span>criterion3[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb26-27"><a href="#cb26-27"></a>  <span class="at">pch =</span> <span class="dv">1</span>,</span>
<span id="cb26-28"><a href="#cb26-28"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb26-29"><a href="#cb26-29"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb26-30"><a href="#cb26-30"></a>  criterion3 <span class="sc">~</span> predictor,</span>
<span id="cb26-31"><a href="#cb26-31"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>),]),</span>
<span id="cb26-32"><a href="#cb26-32"></a>  <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb26-33"><a href="#cb26-33"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb26-34"><a href="#cb26-34"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb26-35"><a href="#cb26-35"></a>  criterion3 <span class="sc">~</span> predictor,</span>
<span id="cb26-36"><a href="#cb26-36"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>),]),</span>
<span id="cb26-37"><a href="#cb26-37"></a>  <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb26-38"><a href="#cb26-38"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb26-39"><a href="#cb26-39"></a><span class="fu">legend</span>(</span>
<span id="cb26-40"><a href="#cb26-40"></a>  <span class="st">"bottomright"</span>,</span>
<span id="cb26-41"><a href="#cb26-41"></a>  <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>),</span>
<span id="cb26-42"><a href="#cb26-42"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb26-43"><a href="#cb26-43"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>),</span>
<span id="cb26-44"><a href="#cb26-44"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-slopeBias" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Example of Slope Bias in Prediction (Different Slopes Between Males And Females).">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-slopeBias-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-slopeBias-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="Figure&nbsp;16.26: Example of Slope Bias in Prediction (Different Slopes Between Males And Females)."><img src="test-bias_files/figure-html/fig-slopeBias-1.png" class="img-fluid figure-img" alt="Example of Slope Bias in Prediction (Different Slopes Between Males And Females)." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-slopeBias-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.26: Example of Slope Bias in Prediction (Different Slopes Between Males And Females).
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-interceptSlopeBias" class="level3" data-number="16.8.4"><h3 data-number="16.8.4" class="anchored" data-anchor-id="sec-interceptSlopeBias">
<span class="header-section-number">16.8.4</span> Example of intercept and slope bias</h3>
<p><a href="#fig-interceptSlopeBias" class="quarto-xref">Figure&nbsp;<span>16.27</span></a> depicts an example of a biased test due to intercept and slope bias. There are differences in the intercepts and slopes of the regression lines (of <code>predictor</code> predicting <code>criterion4</code>) between males and females: males have a higher slope than females. That is, scores have stronger <a href="validity.html#sec-predictiveValidity">predictive validity</a> for males than females. Females have a higher intercept than males. That is, at lower scores, the same score on the predictor results in higher predictions for females than males; at higher scores on the predictor, the same score results in higher predictions for males than females.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(</span>
<span id="cb27-2"><a href="#cb27-2"></a>  criterion4 <span class="sc">~</span> predictor <span class="sc">+</span> group <span class="sc">+</span> predictor<span class="sc">:</span>group,</span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="at">data =</span> mydataBias))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = criterion4 ~ predictor + group + predictor:group, 
    data = mydataBias)

Residuals:
     Min       1Q   Median       3Q      Max 
-18.2805  -3.4400   0.0269   3.3199  17.8824 

Coefficients:
                       Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)           -0.276228   0.767080   -0.36               0.719    
predictor              0.702178   0.007565   92.81 &lt;0.0000000000000002 ***
groupfemale           29.156167   1.086254   26.84 &lt;0.0000000000000002 ***
predictor:groupfemale -0.392016   0.010743  -36.49 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.099 on 3930 degrees of freedom
  (66 observations deleted due to missingness)
Multiple R-squared:  0.7843,    Adjusted R-squared:  0.7842 
F-statistic:  4764 on 3 and 3930 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">plot</span>(</span>
<span id="cb29-2"><a href="#cb29-2"></a>  criterion4 <span class="sc">~</span> predictor,</span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="at">data =</span> mydataBias,</span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(</span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="dv">0</span>,</span>
<span id="cb29-6"><a href="#cb29-6"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb29-7"><a href="#cb29-7"></a>      mydataBias<span class="sc">$</span>criterion4,</span>
<span id="cb29-8"><a href="#cb29-8"></a>      mydataBias<span class="sc">$</span>predictor),</span>
<span id="cb29-9"><a href="#cb29-9"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb29-10"><a href="#cb29-10"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(</span>
<span id="cb29-11"><a href="#cb29-11"></a>    <span class="dv">0</span>,</span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb29-13"><a href="#cb29-13"></a>      mydataBias<span class="sc">$</span>criterion4,</span>
<span id="cb29-14"><a href="#cb29-14"></a>      mydataBias<span class="sc">$</span>predictor),</span>
<span id="cb29-15"><a href="#cb29-15"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb29-16"><a href="#cb29-16"></a>  <span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb29-17"><a href="#cb29-17"></a>  <span class="at">xlab =</span> <span class="st">"predictor"</span>,</span>
<span id="cb29-18"><a href="#cb29-18"></a>  <span class="at">ylab =</span> <span class="st">"criterion"</span>)</span>
<span id="cb29-19"><a href="#cb29-19"></a><span class="fu">points</span>(</span>
<span id="cb29-20"><a href="#cb29-20"></a>  mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb29-21"><a href="#cb29-21"></a>  mydataBias<span class="sc">$</span>criterion4[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb29-22"><a href="#cb29-22"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb29-23"><a href="#cb29-23"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb29-24"><a href="#cb29-24"></a><span class="fu">points</span>(</span>
<span id="cb29-25"><a href="#cb29-25"></a>  mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb29-26"><a href="#cb29-26"></a>  mydataBias<span class="sc">$</span>criterion4[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb29-27"><a href="#cb29-27"></a>  <span class="at">pch =</span> <span class="dv">1</span>,</span>
<span id="cb29-28"><a href="#cb29-28"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb29-29"><a href="#cb29-29"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb29-30"><a href="#cb29-30"></a>  criterion4 <span class="sc">~</span> predictor,</span>
<span id="cb29-31"><a href="#cb29-31"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>),]),</span>
<span id="cb29-32"><a href="#cb29-32"></a>  <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb29-33"><a href="#cb29-33"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb29-34"><a href="#cb29-34"></a><span class="fu">abline</span>(<span class="fu">lm</span>(</span>
<span id="cb29-35"><a href="#cb29-35"></a>  criterion4 <span class="sc">~</span> predictor,</span>
<span id="cb29-36"><a href="#cb29-36"></a>  <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>),]),</span>
<span id="cb29-37"><a href="#cb29-37"></a>  <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb29-38"><a href="#cb29-38"></a>  <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb29-39"><a href="#cb29-39"></a><span class="fu">legend</span>(</span>
<span id="cb29-40"><a href="#cb29-40"></a>  <span class="st">"bottomright"</span>,</span>
<span id="cb29-41"><a href="#cb29-41"></a>  <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>),</span>
<span id="cb29-42"><a href="#cb29-42"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb29-43"><a href="#cb29-43"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>),</span>
<span id="cb29-44"><a href="#cb29-44"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-interceptSlopeBias" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Example of Intercept And Slope Bias in Prediction (Different Intercepts and Slopes Between Males and Females).">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-interceptSlopeBias-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-interceptSlopeBias-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Figure&nbsp;16.27: Example of Intercept And Slope Bias in Prediction (Different Intercepts and Slopes Between Males and Females)."><img src="test-bias_files/figure-html/fig-interceptSlopeBias-1.png" class="img-fluid figure-img" alt="Example of Intercept And Slope Bias in Prediction (Different Intercepts and Slopes Between Males and Females)." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interceptSlopeBias-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.27: Example of Intercept And Slope Bias in Prediction (Different Intercepts and Slopes Between Males and Females).
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-differentialReliability" class="level3" data-number="16.8.5"><h3 data-number="16.8.5" class="anchored" data-anchor-id="sec-differentialReliability">
<span class="header-section-number">16.8.5</span> Example of different measurement reliability/error across groups</h3>
<p>In the example depicted in <a href="#fig-differentMeasurementError" class="quarto-xref">Figure&nbsp;<span>16.28</span></a>, there are differences in the measurement <a href="reliability.html">reliability</a>/<a href="reliability.html#sec-measurementError">error</a> on the criterion between males and females: males’ scores have a lower <a href="reliability.html">reliability</a> (higher <a href="reliability.html#sec-measurementError">measurement error</a>) on the criterion than females’ scores. That is, we are more confident about a female’s level on the criterion given a particular score on the predictor than we are about a male’s level on the criterion given a particular score on the predictor.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(</span>
<span id="cb30-2"><a href="#cb30-2"></a>  criterion5 <span class="sc">~</span> predictor <span class="sc">+</span> group <span class="sc">+</span> predictor<span class="sc">:</span>group,</span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="at">data =</span> mydataBias))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = criterion5 ~ predictor + group + predictor:group, 
    data = mydataBias)

Residuals:
     Min       1Q   Median       3Q      Max 
-109.295   -7.065    0.077    6.836  108.428 

Coefficients:
                      Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)           -9.28386    3.32617  -2.791              0.00528 ** 
predictor              0.79172    0.03280  24.136 &lt; 0.0000000000000002 ***
groupfemale            9.12452    4.70470   1.939              0.05252 .  
predictor:groupfemale -0.09083    0.04654  -1.952              0.05102 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 22.03 on 3920 degrees of freedom
  (76 observations deleted due to missingness)
Multiple R-squared:  0.2087,    Adjusted R-squared:  0.2081 
F-statistic: 344.6 on 3 and 3920 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">plot</span>(</span>
<span id="cb32-2"><a href="#cb32-2"></a>  criterion5 <span class="sc">~</span> predictor,</span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="at">data =</span> mydataBias,</span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(</span>
<span id="cb32-5"><a href="#cb32-5"></a>    <span class="dv">0</span>,</span>
<span id="cb32-6"><a href="#cb32-6"></a>    <span class="fu">max</span>(<span class="fu">c</span>(mydataBias<span class="sc">$</span>criterion5,</span>
<span id="cb32-7"><a href="#cb32-7"></a>          mydataBias<span class="sc">$</span>predictor),</span>
<span id="cb32-8"><a href="#cb32-8"></a>        <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb32-9"><a href="#cb32-9"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(</span>
<span id="cb32-10"><a href="#cb32-10"></a>    <span class="dv">0</span>, </span>
<span id="cb32-11"><a href="#cb32-11"></a>    <span class="fu">max</span>(<span class="fu">c</span>(</span>
<span id="cb32-12"><a href="#cb32-12"></a>      mydataBias<span class="sc">$</span>criterion5,</span>
<span id="cb32-13"><a href="#cb32-13"></a>      mydataBias<span class="sc">$</span>predictor),</span>
<span id="cb32-14"><a href="#cb32-14"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb32-15"><a href="#cb32-15"></a>  <span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb32-16"><a href="#cb32-16"></a>  <span class="at">xlab =</span> <span class="st">"predictor"</span>,</span>
<span id="cb32-17"><a href="#cb32-17"></a>  <span class="at">ylab =</span> <span class="st">"criterion"</span>)</span>
<span id="cb32-18"><a href="#cb32-18"></a><span class="fu">points</span>(</span>
<span id="cb32-19"><a href="#cb32-19"></a>  mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb32-20"><a href="#cb32-20"></a>  mydataBias<span class="sc">$</span>criterion5[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>)],</span>
<span id="cb32-21"><a href="#cb32-21"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb32-22"><a href="#cb32-22"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb32-23"><a href="#cb32-23"></a><span class="fu">points</span>(mydataBias<span class="sc">$</span>predictor[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb32-24"><a href="#cb32-24"></a>       mydataBias<span class="sc">$</span>criterion5[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>)],</span>
<span id="cb32-25"><a href="#cb32-25"></a>       <span class="at">pch =</span> <span class="dv">1</span>,</span>
<span id="cb32-26"><a href="#cb32-26"></a>       <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb32-27"><a href="#cb32-27"></a><span class="fu">abline</span>(<span class="fu">lm</span>(criterion5 <span class="sc">~</span> predictor,</span>
<span id="cb32-28"><a href="#cb32-28"></a>          <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"male"</span>),]),</span>
<span id="cb32-29"><a href="#cb32-29"></a>       <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb32-30"><a href="#cb32-30"></a>       <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb32-31"><a href="#cb32-31"></a><span class="fu">abline</span>(<span class="fu">lm</span>(criterion5 <span class="sc">~</span> predictor,</span>
<span id="cb32-32"><a href="#cb32-32"></a>          <span class="at">data =</span> mydataBias[<span class="fu">which</span>(mydataBias<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"female"</span>),]),</span>
<span id="cb32-33"><a href="#cb32-33"></a>       <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb32-34"><a href="#cb32-34"></a>       <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb32-35"><a href="#cb32-35"></a><span class="fu">legend</span>(</span>
<span id="cb32-36"><a href="#cb32-36"></a>  <span class="st">"bottomright"</span>,</span>
<span id="cb32-37"><a href="#cb32-37"></a>  <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>),</span>
<span id="cb32-38"><a href="#cb32-38"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb32-39"><a href="#cb32-39"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>),</span>
<span id="cb32-40"><a href="#cb32-40"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-differentMeasurementError" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Example of Different Measurement Reliability/Error Across Groups.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-differentMeasurementError-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-differentMeasurementError-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Figure&nbsp;16.28: Example of Different Measurement Reliability/Error Across Groups."><img src="test-bias_files/figure-html/fig-differentMeasurementError-1.png" class="img-fluid figure-img" alt="Example of Different Measurement Reliability/Error Across Groups." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-differentMeasurementError-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.28: Example of Different Measurement Reliability/Error Across Groups.
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-dif" class="level2" data-number="16.9"><h2 data-number="16.9" class="anchored" data-anchor-id="sec-dif">
<span class="header-section-number">16.9</span> Differential Item Functioning (DIF)</h2>
<p>Differential item functioning (DIF) indicates that one or more items functions differently across groups. That is, one or more of the item parameters for an item differs across groups. For instance, the <a href="item-response-theory.html#sec-itemDifficulty">severity</a> or <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> of an item could be higher in one group compared to another group. If an item functions differently across groups, it can lead to biased scores for particular groups. Thus, when observing group differences in level on the measure or group differences in the measure’s association with other measures, it is unclear whether the observed group differences reflect true group differences or differences in the functioning of the measure across groups.</p>
<p>For instance, consider an item such as “disobedience to authority”, which is thought to reflect externalizing behavior in childhood. However, in adulthood, disobedience to authority could reflect prosocial functions, such as protesting against societally unjust actions, and may show weaker <a href="validity.html#sec-constructValidity">construct validity</a> with respect to externalizing problems, as operationalized by a weaker <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> coefficient in adulthood than in childhood. Tests of differential item functioning are equivalent to tests of <a href="#sec-measurementInvariance">measurement invariance</a>.</p>
<p>Approaches to addressing DIF are described in <a href="#sec-whenDetectingBias" class="quarto-xref"><span>Section 16.5.1</span></a>. If we identify that an item shows non-negligible DIF, we have three primary options (described above): (1) drop the item for both groups, (2) drop the item for one group but keep it for the other group, or (3) freely estimate the parameters (<a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> and <a href="item-response-theory.html#sec-itemDifficulty">difficulty</a>) for the item across groups.</p>
<p>Tests of DIF were conducted using the <code>mirt</code> package <span class="citation" data-cites="R-mirt">(<a href="references.html#ref-R-mirt" role="doc-biblioref">Chalmers, 2020</a>)</span>.</p>
<section id="sec-descriptiveStats-bias" class="level3" data-number="16.9.1"><h3 data-number="16.9.1" class="anchored" data-anchor-id="sec-descriptiveStats-bias">
<span class="header-section-number">16.9.1</span> Item Descriptive Statistics</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">itemstats</span>(</span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="at">data =</span> cnlsy[,<span class="fu">c</span>(</span>
<span id="cb33-3"><a href="#cb33-3"></a>    <span class="st">"bpi_antisocialT1_1"</span>,<span class="st">"bpi_antisocialT1_2"</span>,<span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb33-4"><a href="#cb33-4"></a>    <span class="st">"bpi_antisocialT1_4"</span>,<span class="st">"bpi_antisocialT1_5"</span>,<span class="st">"bpi_antisocialT1_6"</span>,</span>
<span id="cb33-5"><a href="#cb33-5"></a>    <span class="st">"bpi_antisocialT1_7"</span>)],</span>
<span id="cb33-6"><a href="#cb33-6"></a>  <span class="at">group =</span> cnlsy<span class="sc">$</span>sex,</span>
<span id="cb33-7"><a href="#cb33-7"></a>  <span class="at">ts.tables =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$female
$female$overall
 N.complete    N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha
       1620 5641            2.554          2.132 0.255 0.083 0.681     1.203

$female$itemstats
                      N K  mean    sd total.r total.r_if_rm alpha_if_rm
bpi_antisocialT1_1 1928 3 0.538 0.587   0.665         0.455       0.626
bpi_antisocialT1_2 1925 3 0.278 0.510   0.647         0.465       0.624
bpi_antisocialT1_3 1925 3 0.456 0.654   0.618         0.359       0.657
bpi_antisocialT1_4 1933 3 0.113 0.355   0.514         0.371       0.654
bpi_antisocialT1_5 1649 3 0.186 0.431   0.587         0.429       0.637
bpi_antisocialT1_6 1658 3 0.103 0.345   0.571         0.446       0.643
bpi_antisocialT1_7 1944 3 0.834 0.639   0.563         0.294       0.683

$female$proportions
                       0     1     2  &lt;NA&gt;
bpi_antisocialT1_1 0.174 0.151 0.016 0.658
bpi_antisocialT1_2 0.257 0.075 0.010 0.659
bpi_antisocialT1_3 0.216 0.094 0.031 0.659
bpi_antisocialT1_4 0.308 0.030 0.004 0.657
bpi_antisocialT1_5 0.243 0.044 0.005 0.708
bpi_antisocialT1_6 0.268 0.023 0.004 0.706
bpi_antisocialT1_7 0.104 0.194 0.046 0.655

$female$total.score_frequency
       0   1   2   3   4  5  6  7  8  9 10 11 12 13
Freq 217 364 349 283 166 91 67 38 12 10 11  4  4  4

$female$total.score_means
                          0        1        2
bpi_antisocialT1_1 1.354919 3.339237 7.216867
bpi_antisocialT1_2 1.846343 4.173789 8.192308
bpi_antisocialT1_3 1.593417 3.846682 5.406667
bpi_antisocialT1_4 2.204952 5.090278 9.045455
bpi_antisocialT1_5 2.010386 4.946721 7.892857
bpi_antisocialT1_6 2.189959 5.701613 9.227273
bpi_antisocialT1_7 1.004357 2.778970 4.746725

$female$total.score_sds
                          0        1        2
bpi_antisocialT1_1 1.262270 1.668474 2.763209
bpi_antisocialT1_2 1.480206 1.809814 2.664498
bpi_antisocialT1_3 1.329902 1.837884 2.783211
bpi_antisocialT1_4 1.743521 2.280698 2.802673
bpi_antisocialT1_5 1.566126 2.196431 3.258485
bpi_antisocialT1_6 1.684322 2.215906 2.844072
bpi_antisocialT1_7 1.232733 1.798814 2.475591


$male
$male$overall
 N.complete    N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha
       1645 5891             3.16          2.385 0.266 0.081 0.703       1.3

$male$itemstats
                      N K  mean    sd total.r total.r_if_rm alpha_if_rm
bpi_antisocialT1_1 1948 3 0.615 0.585   0.639         0.451       0.660
bpi_antisocialT1_2 1947 3 0.372 0.559   0.664         0.494       0.650
bpi_antisocialT1_3 1949 3 0.520 0.668   0.593         0.358       0.692
bpi_antisocialT1_4 1948 3 0.233 0.486   0.594         0.434       0.666
bpi_antisocialT1_5 1676 3 0.367 0.547   0.629         0.457       0.662
bpi_antisocialT1_6 1688 3 0.177 0.446   0.549         0.398       0.675
bpi_antisocialT1_7 1962 3 0.834 0.646   0.587         0.360       0.687

$male$proportions
                       0     1     2  &lt;NA&gt;
bpi_antisocialT1_1 0.145 0.168 0.017 0.669
bpi_antisocialT1_2 0.220 0.097 0.013 0.669
bpi_antisocialT1_3 0.191 0.107 0.033 0.669
bpi_antisocialT1_4 0.263 0.058 0.010 0.669
bpi_antisocialT1_5 0.190 0.085 0.010 0.715
bpi_antisocialT1_6 0.243 0.035 0.008 0.713
bpi_antisocialT1_7 0.102 0.185 0.046 0.667

$male$total.score_frequency
       0   1   2   3   4   5   6  7  8  9 10 11 12 13 14
Freq 163 294 310 259 208 144 104 74 40 25  9  7  5  1  2

$male$total.score_means
                          0        1        2
bpi_antisocialT1_1 1.622478 3.944056 7.397849
bpi_antisocialT1_2 2.134191 4.767821 8.106061
bpi_antisocialT1_3 2.016754 4.400763 5.819277
bpi_antisocialT1_4 2.484091 5.539286 8.177778
bpi_antisocialT1_5 2.174111 4.817073 7.910714
bpi_antisocialT1_6 2.616762 5.810680 8.093023
bpi_antisocialT1_7 1.412500 3.375679 5.782787

$male$total.score_sds
                          0        1        2
bpi_antisocialT1_1 1.515237 1.982218 2.454542
bpi_antisocialT1_2 1.678482 1.955386 2.437709
bpi_antisocialT1_3 1.654589 2.069463 2.774973
bpi_antisocialT1_4 1.845772 2.119687 2.534210
bpi_antisocialT1_5 1.709715 2.047072 2.725481
bpi_antisocialT1_6 1.911288 2.181537 2.982600
bpi_antisocialT1_7 1.522500 1.906515 2.652344</code></pre>
</div>
</div>
</section><section id="sec-difUnconstrained" class="level3" data-number="16.9.2"><h3 data-number="16.9.2" class="anchored" data-anchor-id="sec-difUnconstrained">
<span class="header-section-number">16.9.2</span> Unconstrained Model</h3>
<section id="sec-difUnconstrainedFit" class="level4" data-number="16.9.2.1"><h4 data-number="16.9.2.1" class="anchored" data-anchor-id="sec-difUnconstrainedFit">
<span class="header-section-number">16.9.2.1</span> Fit Model</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>unconstrainedModel <span class="ot">&lt;-</span> <span class="fu">multipleGroup</span>(</span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="at">data =</span> cnlsy[,<span class="fu">c</span>(</span>
<span id="cb35-3"><a href="#cb35-3"></a>    <span class="st">"bpi_antisocialT1_1"</span>,<span class="st">"bpi_antisocialT1_2"</span>,<span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb35-4"><a href="#cb35-4"></a>    <span class="st">"bpi_antisocialT1_4"</span>,<span class="st">"bpi_antisocialT1_5"</span>,<span class="st">"bpi_antisocialT1_6"</span>,</span>
<span id="cb35-5"><a href="#cb35-5"></a>    <span class="st">"bpi_antisocialT1_7"</span>)],</span>
<span id="cb35-6"><a href="#cb35-6"></a>  <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb35-7"><a href="#cb35-7"></a>  <span class="at">group =</span> cnlsy<span class="sc">$</span>sex,</span>
<span id="cb35-8"><a href="#cb35-8"></a>  <span class="at">SE =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-difUnconstrainedSummary" class="level4" data-number="16.9.2.2"><h4 data-number="16.9.2.2" class="anchored" data-anchor-id="sec-difUnconstrainedSummary">
<span class="header-section-number">16.9.2.2</span> Model Summary</h4>
<p>Items that appear to differ:</p>
<ul>
<li>items 5 and 6 are more discriminating (<span class="math inline">\(a\)</span> parameter) among females than males</li>
<li>item 4 has higher <a href="item-response-theory.html#sec-itemDifficulty">difficulty/severity</a> (<span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> parameters) among females than males</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">summary</span>(unconstrainedModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
----------
GROUP: female 
        F1    h2
[1,] 0.698 0.487
[2,] 0.706 0.499
[3,] 0.532 0.283
[4,] 0.683 0.466
[5,] 0.763 0.582
[6,] 0.838 0.702
[7,] 0.429 0.184

SS loadings:  3.202 
Proportion Var:  0.457 

Factor correlations: 

   F1
F1  1

----------
GROUP: male 
        F1    h2
[1,] 0.663 0.440
[2,] 0.736 0.542
[3,] 0.531 0.282
[4,] 0.713 0.508
[5,] 0.691 0.477
[6,] 0.702 0.492
[7,] 0.507 0.257

SS loadings:  2.999 
Proportion Var:  0.428 

Factor correlations: 

   F1
F1  1</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">coef</span>(unconstrainedModel,</span>
<span id="cb38-2"><a href="#cb38-2"></a>     <span class="at">simplify =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-3"><a href="#cb38-3"></a>     <span class="at">IRTpars =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$female
$items
                       a     b1    b2
bpi_antisocialT1_1 1.657  0.029 2.451
bpi_antisocialT1_2 1.697  0.953 2.763
bpi_antisocialT1_3 1.069  0.650 2.585
bpi_antisocialT1_4 1.590  1.895 3.465
bpi_antisocialT1_5 2.008  1.281 2.936
bpi_antisocialT1_6 2.614  1.625 2.770
bpi_antisocialT1_7 0.807 -1.184 2.583

$means
F1 
 0 

$cov
   F1
F1  1


$male
$items
                       a     b1    b2
bpi_antisocialT1_1 1.507 -0.238 2.505
bpi_antisocialT1_2 1.853  0.582 2.455
bpi_antisocialT1_3 1.067  0.384 2.480
bpi_antisocialT1_4 1.729  1.165 2.765
bpi_antisocialT1_5 1.625  0.635 2.757
bpi_antisocialT1_6 1.677  1.494 2.873
bpi_antisocialT1_7 1.002 -0.986 2.143

$means
F1 
 0 

$cov
   F1
F1  1</code></pre>
</div>
</div>
</section></section><section id="sec-difConstrained" class="level3" data-number="16.9.3"><h3 data-number="16.9.3" class="anchored" data-anchor-id="sec-difConstrained">
<span class="header-section-number">16.9.3</span> Constrained Model</h3>
<p>Constrain item parameters to be equal across groups (to use as baseline model for identifying <a href="#sec-dif">DIF</a>).</p>
<section id="sec-difConstrainedFit" class="level4" data-number="16.9.3.1"><h4 data-number="16.9.3.1" class="anchored" data-anchor-id="sec-difConstrainedFit">
<span class="header-section-number">16.9.3.1</span> Fit Model</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>constrainedModel <span class="ot">&lt;-</span> <span class="fu">multipleGroup</span>(</span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="at">data =</span> cnlsy[,<span class="fu">c</span>(</span>
<span id="cb40-3"><a href="#cb40-3"></a>    <span class="st">"bpi_antisocialT1_1"</span>,<span class="st">"bpi_antisocialT1_2"</span>,<span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb40-4"><a href="#cb40-4"></a>    <span class="st">"bpi_antisocialT1_4"</span>,<span class="st">"bpi_antisocialT1_5"</span>,<span class="st">"bpi_antisocialT1_6"</span>,</span>
<span id="cb40-5"><a href="#cb40-5"></a>    <span class="st">"bpi_antisocialT1_7"</span>)],</span>
<span id="cb40-6"><a href="#cb40-6"></a>  <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb40-7"><a href="#cb40-7"></a>  <span class="at">group =</span> cnlsy<span class="sc">$</span>sex,</span>
<span id="cb40-8"><a href="#cb40-8"></a>  <span class="at">invariance =</span> <span class="fu">c</span>(<span class="fu">c</span>(</span>
<span id="cb40-9"><a href="#cb40-9"></a>    <span class="st">"bpi_antisocialT1_1"</span>,<span class="st">"bpi_antisocialT1_2"</span>,<span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb40-10"><a href="#cb40-10"></a>    <span class="st">"bpi_antisocialT1_4"</span>,<span class="st">"bpi_antisocialT1_5"</span>,<span class="st">"bpi_antisocialT1_6"</span>,</span>
<span id="cb40-11"><a href="#cb40-11"></a>    <span class="st">"bpi_antisocialT1_7"</span>),</span>
<span id="cb40-12"><a href="#cb40-12"></a>    <span class="st">"free_means"</span>, <span class="st">"free_var"</span>),</span>
<span id="cb40-13"><a href="#cb40-13"></a>  <span class="at">SE =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-difConstrainedSummary" class="level4" data-number="16.9.3.2"><h4 data-number="16.9.3.2" class="anchored" data-anchor-id="sec-difConstrainedSummary">
<span class="header-section-number">16.9.3.2</span> Model Summary</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">summary</span>(constrainedModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
----------
GROUP: female 
        F1    h2
[1,] 0.657 0.431
[2,] 0.707 0.500
[3,] 0.512 0.262
[4,] 0.701 0.491
[5,] 0.733 0.538
[6,] 0.765 0.585
[7,] 0.440 0.193

SS loadings:  3 
Proportion Var:  0.429 

Factor correlations: 

   F1
F1  1

----------
GROUP: male 
        F1    h2
[1,] 0.672 0.452
[2,] 0.722 0.521
[3,] 0.527 0.278
[4,] 0.716 0.512
[5,] 0.747 0.559
[6,] 0.778 0.605
[7,] 0.455 0.207

SS loadings:  3.134 
Proportion Var:  0.448 

Factor correlations: 

   F1
F1  1</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">coef</span>(</span>
<span id="cb43-2"><a href="#cb43-2"></a>  constrainedModel,</span>
<span id="cb43-3"><a href="#cb43-3"></a>  <span class="at">simplify =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-4"><a href="#cb43-4"></a>  <span class="at">IRTpars =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$female
$items
                       a     b1    b2
bpi_antisocialT1_1 1.482  0.078 2.798
bpi_antisocialT1_2 1.701  0.973 2.892
bpi_antisocialT1_3 1.013  0.726 2.844
bpi_antisocialT1_4 1.673  1.688 3.278
bpi_antisocialT1_5 1.836  1.135 3.028
bpi_antisocialT1_6 2.020  1.782 3.048
bpi_antisocialT1_7 0.834 -0.967 2.697

$means
F1 
 0 

$cov
   F1
F1  1


$male
$items
                       a     b1    b2
bpi_antisocialT1_1 1.482  0.078 2.798
bpi_antisocialT1_2 1.701  0.973 2.892
bpi_antisocialT1_3 1.013  0.726 2.844
bpi_antisocialT1_4 1.673  1.688 3.278
bpi_antisocialT1_5 1.836  1.135 3.028
bpi_antisocialT1_6 2.020  1.782 3.048
bpi_antisocialT1_7 0.834 -0.967 2.697

$means
  F1 
0.37 

$cov
      F1
F1 1.088</code></pre>
</div>
</div>
</section></section><section id="sec-difCompareConstrainedUnconstrained" class="level3" data-number="16.9.4"><h3 data-number="16.9.4" class="anchored" data-anchor-id="sec-difCompareConstrainedUnconstrained">
<span class="header-section-number">16.9.4</span> Compare model fit of constrained model to unconstrained model</h3>
<p>The constrained model and the unconstrained model are considered “nested” models. The constrained model is nested within the unconstrained model because the unconstrained model includes all of the terms of the constrained model along with additional terms. Model fit of nested models can be compared with a chi-square difference test.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">anova</span>(constrainedModel, unconstrainedModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["AIC"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SABIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["HQ"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"34331.52","2":"34402.71","3":"34382.72","4":"34475.80","5":"-17142.76","6":"NA","7":"NA","8":"NA","_rn_":"constrainedModel"},{"1":"34247.21","2":"34377.22","3":"34340.70","4":"34510.68","5":"-17081.61","6":"122.3052","7":"19","8":"0","_rn_":"unconstrainedModel"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The constrained model fits significantly worse than the unconstrained model, which suggests that item parameters differ between males and females.</p>
</section><section id="sec-difRemoveConstraints" class="level3" data-number="16.9.5"><h3 data-number="16.9.5" class="anchored" data-anchor-id="sec-difRemoveConstraints">
<span class="header-section-number">16.9.5</span> Identify DIF by iteratively removing constraints from fully constrained model</h3>
<p>One way to identify DIF is to iteratively remove constraints from a model in which all parameters are constrained to be the same across groups. Removing constraints allows individual items to have different item parameters across groups, to identify which items yield a significant improvement in model fit when allowing their <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> and/or <a href="item-response-theory.html#sec-itemDifficulty">severity</a> to differ across groups. Items 1, 3, 4, 5, 6, and 7 showed <a href="#sec-dif">DIF</a> in <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> and/or <a href="item-response-theory.html#sec-itemDifficulty">severity</a>, based on a significant chi-square difference test.</p>
<section id="sec-difRemoveConstraintsDiscriminationSeverity" class="level4" data-number="16.9.5.1"><h4 data-number="16.9.5.1" class="anchored" data-anchor-id="sec-difRemoveConstraintsDiscriminationSeverity">
<span class="header-section-number">16.9.5.1</span> Items that differ in discrimination and/or severity</h4>
<p></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>difDropItems <span class="ot">&lt;-</span> <span class="fu">DIF</span>(</span>
<span id="cb46-2"><a href="#cb46-2"></a>  constrainedModel,</span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="fu">c</span>(<span class="st">"a1"</span>,<span class="st">"d1"</span>,<span class="st">"d2"</span>),</span>
<span id="cb46-4"><a href="#cb46-4"></a>  <span class="at">scheme =</span> <span class="st">"drop"</span>,</span>
<span id="cb46-5"><a href="#cb46-5"></a>  <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-6"><a href="#cb46-6"></a></span>
<span id="cb46-7"><a href="#cb46-7"></a>difDropItems</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["groups"],"name":[1],"type":["chr"],"align":["left"]},{"label":["converged"],"name":[2],"type":["lgl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SABIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["HQ"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"female,male","2":"TRUE","3":"-12.009453","4":"-2.722839","5":"-5.331411","6":"6.809791","7":"18.009453","8":"3","9":"0.0004378795019520","_rn_":"bpi_antisocialT1_1"},{"1":"female,male","2":"TRUE","3":"1.837879","4":"11.124493","5":"8.515922","6":"20.657123","7":"4.162121","8":"3","9":"0.2444818039143499","_rn_":"bpi_antisocialT1_2"},{"1":"female,male","2":"TRUE","3":"-1.820107","4":"7.466507","5":"4.857935","6":"16.999137","7":"7.820107","8":"3","9":"0.0498796041902867","_rn_":"bpi_antisocialT1_3"},{"1":"female,male","2":"TRUE","3":"-14.245749","4":"-4.959135","5":"-7.567707","6":"4.573495","7":"20.245749","8":"3","9":"0.0001509550927007","_rn_":"bpi_antisocialT1_4"},{"1":"female,male","2":"TRUE","3":"-40.238487","4":"-30.951873","5":"-33.560445","6":"-21.419243","7":"46.238487","8":"3","9":"0.0000000005046464","_rn_":"bpi_antisocialT1_5"},{"1":"female,male","2":"TRUE","3":"-4.364028","4":"4.922586","5":"2.314014","6":"14.455216","7":"10.364028","8":"3","9":"0.0157122172532030","_rn_":"bpi_antisocialT1_6"},{"1":"female,male","2":"TRUE","3":"-24.727410","4":"-15.440796","5":"-18.049367","6":"-5.908166","7":"30.727410","8":"3","9":"0.0000009701334985","_rn_":"bpi_antisocialT1_7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-difRemoveConstraintsDiscrimination" class="level4" data-number="16.9.5.2"><h4 data-number="16.9.5.2" class="anchored" data-anchor-id="sec-difRemoveConstraintsDiscrimination">
<span class="header-section-number">16.9.5.2</span> Items that differ in discrimination</h4>
<p>Items 1, 3, 4, and 5 showed <a href="#sec-dif">DIF</a> in <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a>, based on a significant chi-square difference test.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>difDropItemsDiscrimination <span class="ot">&lt;-</span> <span class="fu">DIF</span>(</span>
<span id="cb47-2"><a href="#cb47-2"></a>  constrainedModel,</span>
<span id="cb47-3"><a href="#cb47-3"></a>  <span class="fu">c</span>(<span class="st">"a1"</span>),</span>
<span id="cb47-4"><a href="#cb47-4"></a>  <span class="at">scheme =</span> <span class="st">"drop"</span>,</span>
<span id="cb47-5"><a href="#cb47-5"></a>  <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-6"><a href="#cb47-6"></a></span>
<span id="cb47-7"><a href="#cb47-7"></a>difDropItemsDiscrimination</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["groups"],"name":[1],"type":["chr"],"align":["left"]},{"label":["converged"],"name":[2],"type":["lgl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SABIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["HQ"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"female,male","2":"TRUE","3":"-13.1370197","4":"-10.0414818","5":"-10.9110057","6":"-6.863938","7":"15.13701974","8":"1","9":"0.00009998334","_rn_":"bpi_antisocialT1_1"},{"1":"female,male","2":"TRUE","3":"-1.4195676","4":"1.6759704","5":"0.8064464","6":"4.853514","7":"3.41956761","8":"1","9":"0.06442788600","_rn_":"bpi_antisocialT1_2"},{"1":"female,male","2":"TRUE","3":"-3.5683333","4":"-0.4727953","5":"-1.3423193","6":"2.704748","7":"5.56833331","8":"1","9":"0.01828816038","_rn_":"bpi_antisocialT1_3"},{"1":"female,male","2":"TRUE","3":"-12.0421738","4":"-8.9466359","5":"-9.8161598","6":"-5.769092","7":"14.04217383","8":"1","9":"0.00017875619","_rn_":"bpi_antisocialT1_4"},{"1":"female,male","2":"TRUE","3":"-14.2566881","4":"-11.1611501","5":"-12.0306740","6":"-7.983607","7":"16.25668806","8":"1","9":"0.00005531399","_rn_":"bpi_antisocialT1_5"},{"1":"female,male","2":"TRUE","3":"0.8132294","4":"3.9087674","5":"3.0392435","6":"7.086311","7":"1.18677061","8":"1","9":"0.27598193211","_rn_":"bpi_antisocialT1_6"},{"1":"female,male","2":"TRUE","3":"1.9620909","4":"5.0576288","5":"4.1881049","6":"8.235172","7":"0.03790914","8":"1","9":"0.84562570959","_rn_":"bpi_antisocialT1_7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-difRemoveConstraintsSeverity" class="level4" data-number="16.9.5.3"><h4 data-number="16.9.5.3" class="anchored" data-anchor-id="sec-difRemoveConstraintsSeverity">
<span class="header-section-number">16.9.5.3</span> Items that differ in severity</h4>
<p>Items 1, 3, 4, 5, and 7 showed <a href="#sec-dif">DIF</a> in <a href="item-response-theory.html#sec-itemDifficulty">difficulty/severity</a>, based on a significant chi-square difference test.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>difDropItemsSeverity <span class="ot">&lt;-</span> <span class="fu">DIF</span>(</span>
<span id="cb48-2"><a href="#cb48-2"></a>  constrainedModel,</span>
<span id="cb48-3"><a href="#cb48-3"></a>  <span class="fu">c</span>(<span class="st">"d1"</span>,<span class="st">"d2"</span>),</span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="at">scheme =</span> <span class="st">"drop"</span>,</span>
<span id="cb48-5"><a href="#cb48-5"></a>  <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-6"><a href="#cb48-6"></a></span>
<span id="cb48-7"><a href="#cb48-7"></a>difDropItemsSeverity</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["groups"],"name":[1],"type":["chr"],"align":["left"]},{"label":["converged"],"name":[2],"type":["lgl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SABIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["HQ"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"female,male","2":"TRUE","3":"-10.10127703","4":"-3.910201","5":"-5.649249","6":"2.444886","7":"14.1012770","8":"2","9":"0.0008668552802652","_rn_":"bpi_antisocialT1_1"},{"1":"female,male","2":"TRUE","3":"0.08143904","4":"6.272515","5":"4.533467","6":"12.627602","7":"3.9185610","8":"2","9":"0.1409598076942624","_rn_":"bpi_antisocialT1_2"},{"1":"female,male","2":"TRUE","3":"-3.05560405","4":"3.135472","5":"1.396424","6":"9.490559","7":"7.0556041","8":"2","9":"0.0293693981456453","_rn_":"bpi_antisocialT1_3"},{"1":"female,male","2":"TRUE","3":"-16.11820767","4":"-9.927132","5":"-11.666180","6":"-3.572045","7":"20.1182077","8":"2","9":"0.0000427943773905","_rn_":"bpi_antisocialT1_4"},{"1":"female,male","2":"TRUE","3":"-40.86248189","4":"-34.671406","5":"-36.410454","6":"-28.316319","7":"44.8624819","8":"2","9":"0.0000000001812324","_rn_":"bpi_antisocialT1_5"},{"1":"female,male","2":"TRUE","3":"3.62091906","4":"9.811995","5":"8.072947","6":"16.167082","7":"0.3790809","8":"2","9":"0.8273392353987088","_rn_":"bpi_antisocialT1_6"},{"1":"female,male","2":"TRUE","3":"-23.57170973","4":"-17.380634","5":"-19.119682","6":"-11.025547","7":"27.5717097","8":"2","9":"0.0000010300998022","_rn_":"bpi_antisocialT1_7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="sec-difAddConstraints" class="level3" data-number="16.9.6"><h3 data-number="16.9.6" class="anchored" data-anchor-id="sec-difAddConstraints">
<span class="header-section-number">16.9.6</span> Identify DIF by iteratively adding constraints to unconstrained model</h3>
<section id="sec-difAddConstraintsDiscriminationSeverity" class="level4" data-number="16.9.6.1"><h4 data-number="16.9.6.1" class="anchored" data-anchor-id="sec-difAddConstraintsDiscriminationSeverity">
<span class="header-section-number">16.9.6.1</span> Items that differ in discrimination and/or severity</h4>
<p>Another way to identify DIF is to iteratively add constraints to a model in which all parameters are allowed to differ across groups. Adding constraints forces individual items to have the same item parameters across groups, to identify which items yield a significant worsening in model fit when constraining their <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> and/or <a href="item-response-theory.html#sec-itemDifficulty">severity</a> to be the same across groups. Items 1, 2, 3, 4, 5, and 6 showed <a href="#sec-dif">DIF</a> in <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> and/or <a href="item-response-theory.html#sec-itemDifficulty">severity</a>, based on a significant chi-square difference test. The <a href="#sec-dif">DIF</a> in <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> and/or <a href="item-response-theory.html#sec-itemDifficulty">severity</a> is depicted in <span class="quarto-unresolved-ref">?fig-difAddDiscriminationSeverity</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>difAddItems <span class="ot">&lt;-</span> <span class="fu">DIF</span>(</span>
<span id="cb49-2"><a href="#cb49-2"></a>  unconstrainedModel,</span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="fu">c</span>(<span class="st">"a1"</span>,<span class="st">"d1"</span>,<span class="st">"d2"</span>),</span>
<span id="cb49-4"><a href="#cb49-4"></a>  <span class="at">scheme =</span> <span class="st">"add"</span>,</span>
<span id="cb49-5"><a href="#cb49-5"></a>  <span class="at">simplify =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-6"><a href="#cb49-6"></a>  <span class="at">plotdif =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-7"><a href="#cb49-7"></a></span>
<span id="cb49-8"><a href="#cb49-8"></a>difAddItems</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div id="fig-difAddDiscriminationSeverity-1" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-difAddDiscriminationSeverity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div data-pagedtable="false">
<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["groups"],"name":[1],"type":["chr"],"align":["left"]},{"label":["converged"],"name":[2],"type":["lgl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SABIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["HQ"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"female,male","2":"TRUE","3":"-14.559887","4":"-5.273273","5":"-7.8818446","6":"4.259357","7":"20.559887","8":"3","9":"0.000129924025293","_rn_":"bpi_antisocialT1_1"},{"1":"female,male","2":"TRUE","3":"-27.694420","4":"-18.407806","5":"-21.0163775","6":"-8.875176","7":"33.694420","8":"3","9":"0.000000229841137","_rn_":"bpi_antisocialT1_2"},{"1":"female,male","2":"TRUE","3":"-6.872892","4":"2.413722","5":"-0.1948493","6":"11.946352","7":"12.872892","8":"3","9":"0.004919705491399","_rn_":"bpi_antisocialT1_3"},{"1":"female,male","2":"TRUE","3":"-75.769683","4":"-66.483069","5":"-69.0916411","6":"-56.950439","7":"81.769683","8":"3","9":"0.000000000000000","_rn_":"bpi_antisocialT1_4"},{"1":"female,male","2":"TRUE","3":"-124.659951","4":"-115.373337","5":"-117.9819087","6":"-105.840707","7":"130.659951","8":"3","9":"0.000000000000000","_rn_":"bpi_antisocialT1_5"},{"1":"female,male","2":"TRUE","3":"-38.409279","4":"-29.122665","5":"-31.7312370","6":"-19.590035","7":"44.409279","8":"3","9":"0.000000001235359","_rn_":"bpi_antisocialT1_6"},{"1":"female,male","2":"TRUE","3":"1.962134","4":"11.248748","5":"8.6401765","6":"20.781378","7":"4.037866","8":"3","9":"0.257404237495106","_rn_":"bpi_antisocialT1_7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-difAddDiscriminationSeverity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.29: Item Probability Functions for Examining Differential Item Functioning in Terms of Discrimination and/or Severity.
</figcaption></figure>
</div>
<div class="cell-output-display">
<div id="fig-difAddDiscriminationSeverity-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Probability Functions for Examining Differential Item Functioning in Terms of Discrimination and/or Severity.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-difAddDiscriminationSeverity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-difAddDiscriminationSeverity-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29" title="Figure&nbsp;16.30: Item Probability Functions for Examining Differential Item Functioning in Terms of Discrimination and/or Severity."><img src="test-bias_files/figure-html/fig-difAddDiscriminationSeverity-1.png" class="img-fluid figure-img" alt="Item Probability Functions for Examining Differential Item Functioning in Terms of Discrimination and/or Severity." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-difAddDiscriminationSeverity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.30: Item Probability Functions for Examining Differential Item Functioning in Terms of Discrimination and/or Severity.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-difAddConstraintsDiscrimination" class="level4" data-number="16.9.6.2"><h4 data-number="16.9.6.2" class="anchored" data-anchor-id="sec-difAddConstraintsDiscrimination">
<span class="header-section-number">16.9.6.2</span> Items that differ in discrimination</h4>
<p>Items 6 and 7 showed <a href="#sec-dif">DIF</a> in <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a>, based on a significant chi-square difference test. The <a href="#sec-dif">DIF</a> in <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> is depicted in <span class="quarto-unresolved-ref">?fig-difAddDiscrimination</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>difAddItemsDiscrimination <span class="ot">&lt;-</span> <span class="fu">DIF</span>(</span>
<span id="cb50-2"><a href="#cb50-2"></a>  unconstrainedModel,</span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="fu">c</span>(<span class="st">"a1"</span>),</span>
<span id="cb50-4"><a href="#cb50-4"></a>  <span class="at">scheme =</span> <span class="st">"add"</span>,</span>
<span id="cb50-5"><a href="#cb50-5"></a>  <span class="at">simplify =</span> <span class="cn">TRUE</span>,</span>
<span id="cb50-6"><a href="#cb50-6"></a>  <span class="at">plotdif =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-7"><a href="#cb50-7"></a></span>
<span id="cb50-8"><a href="#cb50-8"></a>difAddItemsDiscrimination</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div id="fig-difAddDiscrimination-1" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-difAddDiscrimination-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div data-pagedtable="false">
<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["groups"],"name":[1],"type":["chr"],"align":["left"]},{"label":["converged"],"name":[2],"type":["lgl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SABIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["HQ"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"female,male","2":"TRUE","3":"1.041531","4":"4.137069","5":"3.2675450","6":"7.314612","7":"0.958469037","8":"1","9":"0.327572904","_rn_":"bpi_antisocialT1_1"},{"1":"female,male","2":"TRUE","3":"1.283788","4":"4.379326","5":"3.5098020","6":"7.556869","7":"0.716212030","8":"1","9":"0.397389250","_rn_":"bpi_antisocialT1_2"},{"1":"female,male","2":"TRUE","3":"1.999766","4":"5.095304","5":"4.2257802","6":"8.272848","7":"0.000233829","8":"1","9":"0.987799649","_rn_":"bpi_antisocialT1_3"},{"1":"female,male","2":"TRUE","3":"1.493041","4":"4.588579","5":"3.7190555","6":"7.766123","7":"0.506958611","8":"1","9":"0.476458422","_rn_":"bpi_antisocialT1_4"},{"1":"female,male","2":"TRUE","3":"-1.231954","4":"1.863584","5":"0.9940598","6":"5.041127","7":"3.231954273","8":"1","9":"0.072214464","_rn_":"bpi_antisocialT1_5"},{"1":"female,male","2":"TRUE","3":"-8.463940","4":"-5.368402","5":"-6.2379255","6":"-2.190858","7":"10.463939561","8":"1","9":"0.001217274","_rn_":"bpi_antisocialT1_6"},{"1":"female,male","2":"TRUE","3":"-1.878169","4":"1.217369","5":"0.3478452","6":"4.394913","7":"3.878168817","8":"1","9":"0.048917884","_rn_":"bpi_antisocialT1_7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-difAddDiscrimination-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.31: Item Probability Functions for Examining Differential Item Functioning in Terms of Discrimination.
</figcaption></figure>
</div>
<div class="cell-output-display">
<div id="fig-difAddDiscrimination-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Probability Functions for Examining Differential Item Functioning in Terms of Discrimination.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-difAddDiscrimination-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-difAddDiscrimination-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Figure&nbsp;16.32: Item Probability Functions for Examining Differential Item Functioning in Terms of Discrimination."><img src="test-bias_files/figure-html/fig-difAddDiscrimination-1.png" class="img-fluid figure-img" alt="Item Probability Functions for Examining Differential Item Functioning in Terms of Discrimination." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-difAddDiscrimination-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.32: Item Probability Functions for Examining Differential Item Functioning in Terms of Discrimination.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-difAddConstraintsSeverity" class="level4" data-number="16.9.6.3"><h4 data-number="16.9.6.3" class="anchored" data-anchor-id="sec-difAddConstraintsSeverity">
<span class="header-section-number">16.9.6.3</span> Items that differ in severity</h4>
<p>Items 1, 2, 3, 4, 5, and 6 showed <a href="#sec-dif">DIF</a> in <a href="item-response-theory.html#sec-itemDifficulty">difficulty/severity</a>, based on a significant chi-square difference test. The <a href="#sec-dif">DIF</a> in <a href="item-response-theory.html#sec-itemDifficulty">difficulty/severity</a> is depicted in <span class="quarto-unresolved-ref">?fig-difAddSeverity</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>difAddItemsSeverity <span class="ot">&lt;-</span> <span class="fu">DIF</span>(</span>
<span id="cb51-2"><a href="#cb51-2"></a>  unconstrainedModel,</span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="fu">c</span>(<span class="st">"d1"</span>,<span class="st">"d2"</span>),</span>
<span id="cb51-4"><a href="#cb51-4"></a>  <span class="at">scheme =</span> <span class="st">"add"</span>,</span>
<span id="cb51-5"><a href="#cb51-5"></a>  <span class="at">simplify =</span> <span class="cn">TRUE</span>,</span>
<span id="cb51-6"><a href="#cb51-6"></a>  <span class="at">plotdif =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-7"><a href="#cb51-7"></a></span>
<span id="cb51-8"><a href="#cb51-8"></a>difAddItemsSeverity</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div id="fig-difAddSeverity-1" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-difAddSeverity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div data-pagedtable="false">
<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["groups"],"name":[1],"type":["chr"],"align":["left"]},{"label":["converged"],"name":[2],"type":["lgl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SABIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["HQ"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"female,male","2":"TRUE","3":"-15.561637","4":"-9.370562","5":"-11.109609","6":"-3.015475","7":"19.5616375","8":"2","9":"0.00005652549755","_rn_":"bpi_antisocialT1_1"},{"1":"female,male","2":"TRUE","3":"-19.151480","4":"-12.960404","5":"-14.699452","6":"-6.605317","7":"23.1514799","8":"2","9":"0.00000939117672","_rn_":"bpi_antisocialT1_2"},{"1":"female,male","2":"TRUE","3":"-8.534472","4":"-2.343396","5":"-4.082444","6":"4.011691","7":"12.5344718","8":"2","9":"0.00189746614505","_rn_":"bpi_antisocialT1_3"},{"1":"female,male","2":"TRUE","3":"-28.940130","4":"-22.749054","5":"-24.488102","6":"-16.393968","7":"32.9401304","8":"2","9":"0.00000007033015","_rn_":"bpi_antisocialT1_4"},{"1":"female,male","2":"TRUE","3":"-92.484733","4":"-86.293657","5":"-88.032705","6":"-79.938570","7":"96.4847331","8":"2","9":"0.00000000000000","_rn_":"bpi_antisocialT1_5"},{"1":"female,male","2":"TRUE","3":"-28.929213","4":"-22.738137","5":"-24.477185","6":"-16.383050","7":"32.9292131","8":"2","9":"0.00000007071511","_rn_":"bpi_antisocialT1_6"},{"1":"female,male","2":"TRUE","3":"3.488790","4":"9.679866","5":"7.940819","6":"16.034953","7":"0.5112096","8":"2","9":"0.77444797322511","_rn_":"bpi_antisocialT1_7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-difAddSeverity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.33: Item Probability Functions for Examining Differential Item Functioning in Terms of Severity.
</figcaption></figure>
</div>
<div class="cell-output-display">
<div id="fig-difAddSeverity-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Probability Functions for Examining Differential Item Functioning in Terms of Severity.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-difAddSeverity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-difAddSeverity-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Figure&nbsp;16.34: Item Probability Functions for Examining Differential Item Functioning in Terms of Severity."><img src="test-bias_files/figure-html/fig-difAddSeverity-1.png" class="img-fluid figure-img" alt="Item Probability Functions for Examining Differential Item Functioning in Terms of Severity." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-difAddSeverity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.34: Item Probability Functions for Examining Differential Item Functioning in Terms of Severity.
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-difEffectSize" class="level3" data-number="16.9.7"><h3 data-number="16.9.7" class="anchored" data-anchor-id="sec-difEffectSize">
<span class="header-section-number">16.9.7</span> Compute effect size of DIF</h3>
<p>Effect size measures of <a href="#sec-dif">DIF</a> were computed based on expected scores <span class="citation" data-cites="Meade2010">(<a href="references.html#ref-Meade2010" role="doc-biblioref">Meade, 2010</a>)</span> using the <code>mirt</code> package <span class="citation" data-cites="R-mirt">(<a href="references.html#ref-R-mirt" role="doc-biblioref">Chalmers, 2020</a>)</span>. Some researchers recommend using a simulation-based procedure to examine the impact of <a href="#sec-dif">DIF</a> on screening accuracy <span class="citation" data-cites="Gonzalez2021">(<a href="references.html#ref-Gonzalez2021" role="doc-biblioref">Gonzalez &amp; Pelham, 2021</a>)</span>.</p>
<section id="sec-difTestLevel" class="level4" data-number="16.9.7.1"><h4 data-number="16.9.7.1" class="anchored" data-anchor-id="sec-difTestLevel">
<span class="header-section-number">16.9.7.1</span> Test-level DIF</h4>
<p>In addition to consideration of <a href="#sec-dif">differential test functioning</a>, we can also consider whether the test as a whole (i.e., the collection of items) differs in its functioning by group—called differential test functioning. Differential test functioning is depicted in <a href="#fig-dtf" class="quarto-xref">Figure&nbsp;<span>16.35</span></a>. Estimates of differential test functioning are in <a href="#tbl-testLevelDIF" class="quarto-xref">Table&nbsp;<span>16.2</span></a>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">empirical_ES</span>(</span>
<span id="cb52-2"><a href="#cb52-2"></a>  unconstrainedModel,</span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="at">DIF =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div id="tbl-testLevelDIF" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-testLevelDIF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16.2: Estimates of Differential Test Functioning.
</figcaption><div aria-describedby="tbl-testLevelDIF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Effect Size"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"STDS","2":"0.6052089"},{"1":"UTDS","2":"0.6413932"},{"1":"UETSDS","2":"0.6052089"},{"1":"ETSSD","2":"0.3652185"},{"1":"Starks.DTFR","2":"0.6085074"},{"1":"UDTFR","2":"0.6487743"},{"1":"UETSDN","2":"0.6102540"},{"1":"theta.of.max.test.D","2":"1.2157431"},{"1":"Test.Dmax","2":"1.1263941"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>In general, the measure showed greater <a href="item-response-theory.html#sec-itemDifficulty">difficulty</a> for females than for males. That is, at a given construct level, males were more likely than females to endorse the items. Otherwise said, it takes a higher construct level for females to obtain the same score on the measure as males.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">empirical_ES</span>(</span>
<span id="cb53-2"><a href="#cb53-2"></a>  unconstrainedModel,</span>
<span id="cb53-3"><a href="#cb53-3"></a>  <span class="at">DIF =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-4"><a href="#cb53-4"></a>  <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-dtf" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Differential Test Functioning by Sex.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-dtf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-dtf-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="Figure&nbsp;16.35: Differential Test Functioning by Sex."><img src="test-bias_files/figure-html/fig-dtf-1.png" class="img-fluid figure-img" alt="Differential Test Functioning by Sex." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dtf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.35: Differential Test Functioning by Sex.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-difItemLevel" class="level4" data-number="16.9.7.2"><h4 data-number="16.9.7.2" class="anchored" data-anchor-id="sec-difItemLevel">
<span class="header-section-number">16.9.7.2</span> Item-level DIF</h4>
<p><a href="#sec-dif">Differential item functioning</a> is depicted in <a href="#fig-dif" class="quarto-xref">Figure&nbsp;<span>16.36</span></a>. Estimates of <a href="#sec-dif">differential item functioning</a> are in <a href="#tbl-itemLevelDIF" class="quarto-xref">Table&nbsp;<span>16.3</span></a>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">empirical_ES</span>(</span>
<span id="cb54-2"><a href="#cb54-2"></a>  unconstrainedModel,</span>
<span id="cb54-3"><a href="#cb54-3"></a>  <span class="at">DIF =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4"></a>  <span class="fu">round</span>(., <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div id="tbl-itemLevelDIF" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-itemLevelDIF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16.3: Estimates of Differential Item Functioning.
</figcaption><div aria-describedby="tbl-itemLevelDIF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["SIDS"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["UIDS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SIDN"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["UIDN"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["ESSD"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["theta.of.max.D"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["max.D"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["mean.ES.foc"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["mean.ES.ref"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.08","2":"0.08","3":"0.08","4":"0.08","5":"0.27","6":"-0.34","7":"0.11","8":"0.61","9":"0.52","_rn_":"bpi_antisocialT1_1"},{"1":"0.09","2":"0.09","3":"0.09","4":"0.09","5":"0.32","6":"1.05","7":"0.18","8":"0.35","9":"0.26","_rn_":"bpi_antisocialT1_2"},{"1":"0.07","2":"0.07","3":"0.06","4":"0.06","5":"0.25","6":"0.76","7":"0.08","8":"0.50","9":"0.43","_rn_":"bpi_antisocialT1_3"},{"1":"0.11","2":"0.11","3":"0.12","4":"0.12","5":"0.57","6":"2.55","7":"0.40","8":"0.21","9":"0.10","_rn_":"bpi_antisocialT1_4"},{"1":"0.18","2":"0.18","3":"0.18","4":"0.18","5":"0.73","6":"0.88","7":"0.32","8":"0.34","9":"0.16","_rn_":"bpi_antisocialT1_5"},{"1":"0.07","2":"0.08","3":"0.07","4":"0.08","5":"0.40","6":"1.10","7":"0.17","8":"0.15","9":"0.08","_rn_":"bpi_antisocialT1_6"},{"1":"0.00","2":"0.03","3":"0.00","4":"0.04","5":"0.00","6":"3.22","7":"0.13","8":"0.83","9":"0.83","_rn_":"bpi_antisocialT1_7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>The measure-level differences in functioning appear to be largely driven by greater <a href="item-response-theory.html#sec-itemDifficulty">difficulty</a> of items 4 and 5 for females than males. That is, at a given construct level, males were more likely than females to endorse items 4 and 5, in particular. Otherwise said, it takes a higher construct level for females than males to endorse items 4 and 5.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">empirical_ES</span>(</span>
<span id="cb55-2"><a href="#cb55-2"></a>  unconstrainedModel,</span>
<span id="cb55-3"><a href="#cb55-3"></a>  <span class="at">DIF =</span> <span class="cn">TRUE</span>,</span>
<span id="cb55-4"><a href="#cb55-4"></a>  <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-dif" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Differential Item Functioning by Sex.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-dif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-dif-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33" title="Figure&nbsp;16.36: Differential Item Functioning by Sex."><img src="test-bias_files/figure-html/fig-dif-1.png" class="img-fluid figure-img" alt="Differential Item Functioning by Sex." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.36: Differential Item Functioning by Sex.
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-difItemPlots" class="level3" data-number="16.9.8"><h3 data-number="16.9.8" class="anchored" data-anchor-id="sec-difItemPlots">
<span class="header-section-number">16.9.8</span> Item plots</h3>
<p>Plots of item response category characteristic curves by sex are in Figures <a href="#fig-ircSex1" class="quarto-xref"><span>16.37</span></a>–<a href="#fig-ircSex7" class="quarto-xref"><span>16.43</span></a> below.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb56-2"><a href="#cb56-2"></a>  unconstrainedModel,</span>
<span id="cb56-3"><a href="#cb56-3"></a>  <span class="st">"bpi_antisocialT1_1"</span>,</span>
<span id="cb56-4"><a href="#cb56-4"></a>  <span class="at">type =</span> <span class="st">"trace"</span>,</span>
<span id="cb56-5"><a href="#cb56-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-ircSex1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Response Category Characteristic Curves by Sex: Item 1.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ircSex1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-ircSex1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Figure&nbsp;16.37: Item Response Category Characteristic Curves by Sex: Item 1."><img src="test-bias_files/figure-html/fig-ircSex1-1.png" class="img-fluid figure-img" alt="Item Response Category Characteristic Curves by Sex: Item 1." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ircSex1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.37: Item Response Category Characteristic Curves by Sex: Item 1.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb57-2"><a href="#cb57-2"></a>  unconstrainedModel,</span>
<span id="cb57-3"><a href="#cb57-3"></a>  <span class="st">"bpi_antisocialT1_2"</span>,</span>
<span id="cb57-4"><a href="#cb57-4"></a>  <span class="at">type =</span> <span class="st">"trace"</span>,</span>
<span id="cb57-5"><a href="#cb57-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-ircSex2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Response Category Characteristic Curves by Sex: Item 2.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ircSex2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-ircSex2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35" title="Figure&nbsp;16.38: Item Response Category Characteristic Curves by Sex: Item 2."><img src="test-bias_files/figure-html/fig-ircSex2-1.png" class="img-fluid figure-img" alt="Item Response Category Characteristic Curves by Sex: Item 2." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ircSex2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.38: Item Response Category Characteristic Curves by Sex: Item 2.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb58-2"><a href="#cb58-2"></a>  unconstrainedModel,</span>
<span id="cb58-3"><a href="#cb58-3"></a>  <span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb58-4"><a href="#cb58-4"></a>  <span class="at">type =</span> <span class="st">"trace"</span>,</span>
<span id="cb58-5"><a href="#cb58-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-ircSex3" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Response Category Characteristic Curves by Sex: Item 3.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ircSex3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-ircSex3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36" title="Figure&nbsp;16.39: Item Response Category Characteristic Curves by Sex: Item 3."><img src="test-bias_files/figure-html/fig-ircSex3-1.png" class="img-fluid figure-img" alt="Item Response Category Characteristic Curves by Sex: Item 3." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ircSex3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.39: Item Response Category Characteristic Curves by Sex: Item 3.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb59-2"><a href="#cb59-2"></a>  unconstrainedModel,</span>
<span id="cb59-3"><a href="#cb59-3"></a>  <span class="st">"bpi_antisocialT1_4"</span>,</span>
<span id="cb59-4"><a href="#cb59-4"></a>  <span class="at">type =</span> <span class="st">"trace"</span>,</span>
<span id="cb59-5"><a href="#cb59-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-ircSex4" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Response Category Characteristic Curves by Sex: Item 4.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ircSex4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-ircSex4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37" title="Figure&nbsp;16.40: Item Response Category Characteristic Curves by Sex: Item 4."><img src="test-bias_files/figure-html/fig-ircSex4-1.png" class="img-fluid figure-img" alt="Item Response Category Characteristic Curves by Sex: Item 4." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ircSex4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.40: Item Response Category Characteristic Curves by Sex: Item 4.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb60-2"><a href="#cb60-2"></a>  unconstrainedModel,</span>
<span id="cb60-3"><a href="#cb60-3"></a>  <span class="st">"bpi_antisocialT1_5"</span>,</span>
<span id="cb60-4"><a href="#cb60-4"></a>  <span class="at">type =</span> <span class="st">"trace"</span>,</span>
<span id="cb60-5"><a href="#cb60-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-ircSex5" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Response Category Characteristic Curves by Sex: Item 5.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ircSex5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-ircSex5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38" title="Figure&nbsp;16.41: Item Response Category Characteristic Curves by Sex: Item 5."><img src="test-bias_files/figure-html/fig-ircSex5-1.png" class="img-fluid figure-img" alt="Item Response Category Characteristic Curves by Sex: Item 5." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ircSex5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.41: Item Response Category Characteristic Curves by Sex: Item 5.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb61-2"><a href="#cb61-2"></a>  unconstrainedModel,</span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="st">"bpi_antisocialT1_6"</span>,</span>
<span id="cb61-4"><a href="#cb61-4"></a>  <span class="at">type =</span> <span class="st">"trace"</span>,</span>
<span id="cb61-5"><a href="#cb61-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-ircSex6" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Response Category Characteristic Curves by Sex: Item 6.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ircSex6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-ircSex6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39" title="Figure&nbsp;16.42: Item Response Category Characteristic Curves by Sex: Item 6."><img src="test-bias_files/figure-html/fig-ircSex6-1.png" class="img-fluid figure-img" alt="Item Response Category Characteristic Curves by Sex: Item 6." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ircSex6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.42: Item Response Category Characteristic Curves by Sex: Item 6.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb62-2"><a href="#cb62-2"></a>  unconstrainedModel,</span>
<span id="cb62-3"><a href="#cb62-3"></a>  <span class="st">"bpi_antisocialT1_7"</span>,</span>
<span id="cb62-4"><a href="#cb62-4"></a>  <span class="at">type =</span> <span class="st">"trace"</span>,</span>
<span id="cb62-5"><a href="#cb62-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-ircSex7" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Response Category Characteristic Curves by Sex: Item 7.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ircSex7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-ircSex7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40" title="Figure&nbsp;16.43: Item Response Category Characteristic Curves by Sex: Item 7."><img src="test-bias_files/figure-html/fig-ircSex7-1.png" class="img-fluid figure-img" alt="Item Response Category Characteristic Curves by Sex: Item 7." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ircSex7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.43: Item Response Category Characteristic Curves by Sex: Item 7.
</figcaption></figure>
</div>
</div>
</div>
<p>Plots of item <a href="item-response-theory.html#sec-irtReliability">information</a> functions by sex are in Figures <a href="#fig-itemInfo1" class="quarto-xref"><span>16.44</span></a>–<a href="#fig-itemInfo7" class="quarto-xref"><span>16.50</span></a> below. Items 1, 5, and 6 showed greater <a href="item-response-theory.html#sec-irtReliability">information</a> for females than for males. Items 2, 4, and 7 showed greater <a href="item-response-theory.html#sec-irtReliability">information</a> for females than for males.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb63-2"><a href="#cb63-2"></a>  unconstrainedModel,</span>
<span id="cb63-3"><a href="#cb63-3"></a>  <span class="st">"bpi_antisocialT1_1"</span>,</span>
<span id="cb63-4"><a href="#cb63-4"></a>  <span class="at">type =</span> <span class="st">"info"</span>,</span>
<span id="cb63-5"><a href="#cb63-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemInfo1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Information Curves by Sex: Item 1.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemInfo1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemInfo1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41" title="Figure&nbsp;16.44: Item Information Curves by Sex: Item 1."><img src="test-bias_files/figure-html/fig-itemInfo1-1.png" class="img-fluid figure-img" alt="Item Information Curves by Sex: Item 1." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemInfo1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.44: Item Information Curves by Sex: Item 1.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb64-2"><a href="#cb64-2"></a>  unconstrainedModel,</span>
<span id="cb64-3"><a href="#cb64-3"></a>  <span class="st">"bpi_antisocialT1_2"</span>,</span>
<span id="cb64-4"><a href="#cb64-4"></a>  <span class="at">type =</span> <span class="st">"info"</span>,</span>
<span id="cb64-5"><a href="#cb64-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemInfo2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Information Curves by Sex: Item 2.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemInfo2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemInfo2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42" title="Figure&nbsp;16.45: Item Information Curves by Sex: Item 2."><img src="test-bias_files/figure-html/fig-itemInfo2-1.png" class="img-fluid figure-img" alt="Item Information Curves by Sex: Item 2." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemInfo2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.45: Item Information Curves by Sex: Item 2.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb65-2"><a href="#cb65-2"></a>  unconstrainedModel,</span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb65-4"><a href="#cb65-4"></a>  <span class="at">type =</span> <span class="st">"info"</span>,</span>
<span id="cb65-5"><a href="#cb65-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemInfo3" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Information Curves by Sex: Item 3.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemInfo3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemInfo3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43" title="Figure&nbsp;16.46: Item Information Curves by Sex: Item 3."><img src="test-bias_files/figure-html/fig-itemInfo3-1.png" class="img-fluid figure-img" alt="Item Information Curves by Sex: Item 3." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemInfo3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.46: Item Information Curves by Sex: Item 3.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb66-2"><a href="#cb66-2"></a>  unconstrainedModel,</span>
<span id="cb66-3"><a href="#cb66-3"></a>  <span class="st">"bpi_antisocialT1_4"</span>,</span>
<span id="cb66-4"><a href="#cb66-4"></a>  <span class="at">type =</span> <span class="st">"info"</span>,</span>
<span id="cb66-5"><a href="#cb66-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemInfo4" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Information Curves by Sex: Item 4.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemInfo4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemInfo4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44" title="Figure&nbsp;16.47: Item Information Curves by Sex: Item 4."><img src="test-bias_files/figure-html/fig-itemInfo4-1.png" class="img-fluid figure-img" alt="Item Information Curves by Sex: Item 4." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemInfo4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.47: Item Information Curves by Sex: Item 4.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb67-2"><a href="#cb67-2"></a>  unconstrainedModel,</span>
<span id="cb67-3"><a href="#cb67-3"></a>  <span class="st">"bpi_antisocialT1_5"</span>,</span>
<span id="cb67-4"><a href="#cb67-4"></a>  <span class="at">type =</span> <span class="st">"info"</span>,</span>
<span id="cb67-5"><a href="#cb67-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemInfo5" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Information Curves by Sex: Item 5.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemInfo5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemInfo5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45" title="Figure&nbsp;16.48: Item Information Curves by Sex: Item 5."><img src="test-bias_files/figure-html/fig-itemInfo5-1.png" class="img-fluid figure-img" alt="Item Information Curves by Sex: Item 5." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemInfo5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.48: Item Information Curves by Sex: Item 5.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb68-2"><a href="#cb68-2"></a>  unconstrainedModel,</span>
<span id="cb68-3"><a href="#cb68-3"></a>  <span class="st">"bpi_antisocialT1_6"</span>,</span>
<span id="cb68-4"><a href="#cb68-4"></a>  <span class="at">type =</span> <span class="st">"info"</span>,</span>
<span id="cb68-5"><a href="#cb68-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemInfo6" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Information Curves by Sex: Item 6.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemInfo6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemInfo6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46" title="Figure&nbsp;16.49: Item Information Curves by Sex: Item 6."><img src="test-bias_files/figure-html/fig-itemInfo6-1.png" class="img-fluid figure-img" alt="Item Information Curves by Sex: Item 6." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemInfo6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.49: Item Information Curves by Sex: Item 6.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb69-2"><a href="#cb69-2"></a>  unconstrainedModel,</span>
<span id="cb69-3"><a href="#cb69-3"></a>  <span class="st">"bpi_antisocialT1_7"</span>,</span>
<span id="cb69-4"><a href="#cb69-4"></a>  <span class="at">type =</span> <span class="st">"info"</span>,</span>
<span id="cb69-5"><a href="#cb69-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemInfo7" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Item Information Curves by Sex: Item 7.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemInfo7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemInfo7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-47" title="Figure&nbsp;16.50: Item Information Curves by Sex: Item 7."><img src="test-bias_files/figure-html/fig-itemInfo7-1.png" class="img-fluid figure-img" alt="Item Information Curves by Sex: Item 7." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemInfo7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.50: Item Information Curves by Sex: Item 7.
</figcaption></figure>
</div>
</div>
</div>
<p>Plots of expected item scores by sex are are in Figures <a href="#fig-itemScore1" class="quarto-xref"><span>16.51</span></a>–<a href="#fig-itemScore7" class="quarto-xref"><span>16.57</span></a> below.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb70-2"><a href="#cb70-2"></a>  unconstrainedModel,</span>
<span id="cb70-3"><a href="#cb70-3"></a>  <span class="st">"bpi_antisocialT1_1"</span>,</span>
<span id="cb70-4"><a href="#cb70-4"></a>  <span class="at">type =</span> <span class="st">"score"</span>,</span>
<span id="cb70-5"><a href="#cb70-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemScore1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Expected Item Score by Sex: Item 1.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemScore1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemScore1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-48" title="Figure&nbsp;16.51: Expected Item Score by Sex: Item 1."><img src="test-bias_files/figure-html/fig-itemScore1-1.png" class="img-fluid figure-img" alt="Expected Item Score by Sex: Item 1." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemScore1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.51: Expected Item Score by Sex: Item 1.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb71-2"><a href="#cb71-2"></a>  unconstrainedModel,</span>
<span id="cb71-3"><a href="#cb71-3"></a>  <span class="st">"bpi_antisocialT1_2"</span>,</span>
<span id="cb71-4"><a href="#cb71-4"></a>  <span class="at">type =</span> <span class="st">"score"</span>,</span>
<span id="cb71-5"><a href="#cb71-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemScore2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Expected Item Score by Sex: Item 2.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemScore2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemScore2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-49" title="Figure&nbsp;16.52: Expected Item Score by Sex: Item 2."><img src="test-bias_files/figure-html/fig-itemScore2-1.png" class="img-fluid figure-img" alt="Expected Item Score by Sex: Item 2." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemScore2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.52: Expected Item Score by Sex: Item 2.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb72-2"><a href="#cb72-2"></a>  unconstrainedModel,</span>
<span id="cb72-3"><a href="#cb72-3"></a>  <span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb72-4"><a href="#cb72-4"></a>  <span class="at">type =</span> <span class="st">"score"</span>,</span>
<span id="cb72-5"><a href="#cb72-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemScore3" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Expected Item Score by Sex: Item 3.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemScore3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemScore3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-50" title="Figure&nbsp;16.53: Expected Item Score by Sex: Item 3."><img src="test-bias_files/figure-html/fig-itemScore3-1.png" class="img-fluid figure-img" alt="Expected Item Score by Sex: Item 3." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemScore3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.53: Expected Item Score by Sex: Item 3.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb73-2"><a href="#cb73-2"></a>  unconstrainedModel,</span>
<span id="cb73-3"><a href="#cb73-3"></a>  <span class="st">"bpi_antisocialT1_4"</span>,</span>
<span id="cb73-4"><a href="#cb73-4"></a>  <span class="at">type =</span> <span class="st">"score"</span>,</span>
<span id="cb73-5"><a href="#cb73-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemScore4" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Expected Item Score by Sex: Item 4.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemScore4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemScore4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-51" title="Figure&nbsp;16.54: Expected Item Score by Sex: Item 4."><img src="test-bias_files/figure-html/fig-itemScore4-1.png" class="img-fluid figure-img" alt="Expected Item Score by Sex: Item 4." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemScore4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.54: Expected Item Score by Sex: Item 4.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb74-2"><a href="#cb74-2"></a>  unconstrainedModel,</span>
<span id="cb74-3"><a href="#cb74-3"></a>  <span class="st">"bpi_antisocialT1_5"</span>,</span>
<span id="cb74-4"><a href="#cb74-4"></a>  <span class="at">type =</span> <span class="st">"score"</span>,</span>
<span id="cb74-5"><a href="#cb74-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemScore5" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Expected Item Score by Sex: Item 5.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemScore5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemScore5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-52" title="Figure&nbsp;16.55: Expected Item Score by Sex: Item 5."><img src="test-bias_files/figure-html/fig-itemScore5-1.png" class="img-fluid figure-img" alt="Expected Item Score by Sex: Item 5." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemScore5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.55: Expected Item Score by Sex: Item 5.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb75-2"><a href="#cb75-2"></a>  unconstrainedModel,</span>
<span id="cb75-3"><a href="#cb75-3"></a>  <span class="st">"bpi_antisocialT1_6"</span>,</span>
<span id="cb75-4"><a href="#cb75-4"></a>  <span class="at">type =</span> <span class="st">"score"</span>,</span>
<span id="cb75-5"><a href="#cb75-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemScore6" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Expected Item Score by Sex: Item 6.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemScore6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemScore6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-53" title="Figure&nbsp;16.56: Expected Item Score by Sex: Item 6."><img src="test-bias_files/figure-html/fig-itemScore6-1.png" class="img-fluid figure-img" alt="Expected Item Score by Sex: Item 6." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemScore6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.56: Expected Item Score by Sex: Item 6.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">itemplot</span>(</span>
<span id="cb76-2"><a href="#cb76-2"></a>  unconstrainedModel,</span>
<span id="cb76-3"><a href="#cb76-3"></a>  <span class="st">"bpi_antisocialT1_7"</span>,</span>
<span id="cb76-4"><a href="#cb76-4"></a>  <span class="at">type =</span> <span class="st">"score"</span>,</span>
<span id="cb76-5"><a href="#cb76-5"></a>  <span class="at">par.settings =</span> <span class="fu">standard.theme</span>(<span class="st">"pdf"</span>, <span class="at">color =</span> <span class="cn">FALSE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-itemScore7" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Expected Item Score by Sex: Item 7.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-itemScore7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-itemScore7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-54" title="Figure&nbsp;16.57: Expected Item Score by Sex: Item 7."><img src="test-bias_files/figure-html/fig-itemScore7-1.png" class="img-fluid figure-img" alt="Expected Item Score by Sex: Item 7." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemScore7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.57: Expected Item Score by Sex: Item 7.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-addressingDIF" class="level3" data-number="16.9.9"><h3 data-number="16.9.9" class="anchored" data-anchor-id="sec-addressingDIF">
<span class="header-section-number">16.9.9</span> Addressing DIF</h3>
<p>Based on the analyses above, item 5 shows the largest magnitude of <a href="#sec-dif">DIF</a>, followed by item 4. Specifically, item 5 has a stronger <a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> parameter for women than men. So, we should handle item 5 first. If we deem the <a href="#sec-dif">DIF</a> for item 5 to be non-negligible, we have three primary options: (1) drop item 5 for both men and women, (2) drop item 5 for men but keep it for women, or (3) freely estimate the parameters (<a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> and <a href="item-response-theory.html#sec-itemDifficulty">difficulty</a>) for item 5 across groups.</p>
<section id="sec-dropItemForBothGroups" class="level4" data-number="16.9.9.1"><h4 data-number="16.9.9.1" class="anchored" data-anchor-id="sec-dropItemForBothGroups">
<span class="header-section-number">16.9.9.1</span> Drop item for both groups</h4>
<p>The first option is to drop item 5 for both men and women groups. You might do this if you want to use a measure that has only those items that function equivalently across groups. However, this can lead to lower <a href="reliability.html">reliability</a> and weaker ability to detect individual differences.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>constrainedModelDropItem5 <span class="ot">&lt;-</span> <span class="fu">multipleGroup</span>(</span>
<span id="cb77-2"><a href="#cb77-2"></a>  <span class="at">data =</span> cnlsy[,<span class="fu">c</span>(</span>
<span id="cb77-3"><a href="#cb77-3"></a>    <span class="st">"bpi_antisocialT1_1"</span>,<span class="st">"bpi_antisocialT1_2"</span>,<span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb77-4"><a href="#cb77-4"></a>    <span class="st">"bpi_antisocialT1_4"</span>,<span class="st">"bpi_antisocialT1_6"</span>,<span class="st">"bpi_antisocialT1_7"</span>)],</span>
<span id="cb77-5"><a href="#cb77-5"></a>  <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb77-6"><a href="#cb77-6"></a>  <span class="at">group =</span> cnlsy<span class="sc">$</span>sex,</span>
<span id="cb77-7"><a href="#cb77-7"></a>  <span class="at">invariance =</span> <span class="fu">c</span>(<span class="fu">c</span>(</span>
<span id="cb77-8"><a href="#cb77-8"></a>    <span class="st">"bpi_antisocialT1_1"</span>,<span class="st">"bpi_antisocialT1_2"</span>,<span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb77-9"><a href="#cb77-9"></a>    <span class="st">"bpi_antisocialT1_4"</span>,<span class="st">"bpi_antisocialT1_6"</span>,<span class="st">"bpi_antisocialT1_7"</span>),</span>
<span id="cb77-10"><a href="#cb77-10"></a>    <span class="st">"free_means"</span>, <span class="st">"free_var"</span>),</span>
<span id="cb77-11"><a href="#cb77-11"></a>  <span class="at">SE =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-12"><a href="#cb77-12"></a></span>
<span id="cb77-13"><a href="#cb77-13"></a><span class="fu">coef</span>(constrainedModelDropItem5, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-dropItemForOneGroup" class="level4" data-number="16.9.9.2"><h4 data-number="16.9.9.2" class="anchored" data-anchor-id="sec-dropItemForOneGroup">
<span class="header-section-number">16.9.9.2</span> Drop item for one group but not another group</h4>
<p>A second option is to drop item 5 for men but to keep it for women. You might do this if the item is <a href="validity.html">invalid</a> for men, but still <a href="validity.html">valid</a> for women. The coefficients show an item parameter for item 5 for men, but it was constrained to be equal to the parameter for women, and data were removed from the estimation of item 5 for men.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>dropItem5ForMen <span class="ot">&lt;-</span> cnlsy</span>
<span id="cb78-2"><a href="#cb78-2"></a>dropItem5ForMen[<span class="fu">which</span>(</span>
<span id="cb78-3"><a href="#cb78-3"></a>  dropItem5ForMen<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"male"</span>),</span>
<span id="cb78-4"><a href="#cb78-4"></a>  <span class="st">"bpi_antisocialT1_5"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb78-5"><a href="#cb78-5"></a></span>
<span id="cb78-6"><a href="#cb78-6"></a>constrainedModelDropItem5ForMen <span class="ot">&lt;-</span> <span class="fu">multipleGroup</span>(</span>
<span id="cb78-7"><a href="#cb78-7"></a>  <span class="at">data =</span> dropItem5ForMen[,<span class="fu">c</span>(</span>
<span id="cb78-8"><a href="#cb78-8"></a>    <span class="st">"bpi_antisocialT1_1"</span>,<span class="st">"bpi_antisocialT1_2"</span>,<span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb78-9"><a href="#cb78-9"></a>    <span class="st">"bpi_antisocialT1_4"</span>,<span class="st">"bpi_antisocialT1_5"</span>,<span class="st">"bpi_antisocialT1_6"</span>,</span>
<span id="cb78-10"><a href="#cb78-10"></a>    <span class="st">"bpi_antisocialT1_7"</span>)],</span>
<span id="cb78-11"><a href="#cb78-11"></a>  <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb78-12"><a href="#cb78-12"></a>  <span class="at">group =</span> dropItem5ForMen<span class="sc">$</span>sex,</span>
<span id="cb78-13"><a href="#cb78-13"></a>  <span class="at">invariance =</span> <span class="fu">c</span>(<span class="fu">c</span>(</span>
<span id="cb78-14"><a href="#cb78-14"></a>    <span class="st">"bpi_antisocialT1_1"</span>,<span class="st">"bpi_antisocialT1_2"</span>,<span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb78-15"><a href="#cb78-15"></a>    <span class="st">"bpi_antisocialT1_4"</span>,<span class="st">"bpi_antisocialT1_5"</span>,<span class="st">"bpi_antisocialT1_6"</span>,</span>
<span id="cb78-16"><a href="#cb78-16"></a>    <span class="st">"bpi_antisocialT1_7"</span>),</span>
<span id="cb78-17"><a href="#cb78-17"></a>    <span class="st">"free_means"</span>, <span class="st">"free_var"</span>),</span>
<span id="cb78-18"><a href="#cb78-18"></a>  <span class="at">SE =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-19"><a href="#cb78-19"></a></span>
<span id="cb78-20"><a href="#cb78-20"></a><span class="fu">coef</span>(constrainedModelDropItem5ForMen, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-resolveItemAcrossGroups" class="level4" data-number="16.9.9.3"><h4 data-number="16.9.9.3" class="anchored" data-anchor-id="sec-resolveItemAcrossGroups">
<span class="header-section-number">16.9.9.3</span> Freely estimate item to have different parameters across groups</h4>
<p>Alternatively, we can resolve <a href="#sec-dif">DIF</a> by allowing the item to have different parameters (<a href="item-response-theory.html#sec-itemDiscrimination">discrimination</a> and <a href="item-response-theory.html#sec-itemDifficulty">difficulty</a>) across both groups. You might do this if the item is <a href="validity.html">valid</a> for both men and women, and it has importantly different item parameters nonetheless.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>constrainedModelResolveItem5 <span class="ot">&lt;-</span> <span class="fu">multipleGroup</span>(</span>
<span id="cb79-2"><a href="#cb79-2"></a>  <span class="at">data =</span> cnlsy[,<span class="fu">c</span>(</span>
<span id="cb79-3"><a href="#cb79-3"></a>    <span class="st">"bpi_antisocialT1_1"</span>,<span class="st">"bpi_antisocialT1_2"</span>,<span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb79-4"><a href="#cb79-4"></a>    <span class="st">"bpi_antisocialT1_4"</span>,<span class="st">"bpi_antisocialT1_5"</span>,<span class="st">"bpi_antisocialT1_6"</span>,</span>
<span id="cb79-5"><a href="#cb79-5"></a>    <span class="st">"bpi_antisocialT1_7"</span>)],</span>
<span id="cb79-6"><a href="#cb79-6"></a>  <span class="at">model =</span> <span class="dv">1</span>,</span>
<span id="cb79-7"><a href="#cb79-7"></a>  <span class="at">group =</span> cnlsy<span class="sc">$</span>sex,</span>
<span id="cb79-8"><a href="#cb79-8"></a>  <span class="at">invariance =</span> <span class="fu">c</span>(<span class="fu">c</span>(</span>
<span id="cb79-9"><a href="#cb79-9"></a>    <span class="st">"bpi_antisocialT1_1"</span>,<span class="st">"bpi_antisocialT1_2"</span>,<span class="st">"bpi_antisocialT1_3"</span>,</span>
<span id="cb79-10"><a href="#cb79-10"></a>    <span class="st">"bpi_antisocialT1_4"</span>,<span class="st">"bpi_antisocialT1_6"</span>,<span class="st">"bpi_antisocialT1_7"</span>),</span>
<span id="cb79-11"><a href="#cb79-11"></a>    <span class="st">"free_means"</span>, <span class="st">"free_var"</span>),</span>
<span id="cb79-12"><a href="#cb79-12"></a>  <span class="at">SE =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-13"><a href="#cb79-13"></a></span>
<span id="cb79-14"><a href="#cb79-14"></a><span class="fu">coef</span>(constrainedModelResolveItem5, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-difResolveItemsCompareModels" class="level4" data-number="16.9.9.4"><h4 data-number="16.9.9.4" class="anchored" data-anchor-id="sec-difResolveItemsCompareModels">
<span class="header-section-number">16.9.9.4</span> Compare model fit</h4>
<p>We can compare the model fit against the fully constrained model. In this case, all three of these approaches for handling <a href="#sec-dif">DIF</a> resulted in improvement in model fit based on AIC and, for the two nested models, the chi-square difference test.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="fu">anova</span>(constrainedModel, constrainedModelDropItem5)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["AIC"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SABIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["HQ"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"34331.52","2":"34402.71","3":"34382.72","4":"34475.80","5":"-17142.76","6":"NA","7":"NA","8":"NA","_rn_":"constrainedModel"},{"1":"30777.88","2":"30839.79","3":"30822.40","4":"30903.34","5":"-15368.94","6":"3547.64","7":"2913","8":"0.000000000000003441691","_rn_":"constrainedModelDropItem5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">anova</span>(constrainedModel, constrainedModelDropItem5ForMen)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["AIC"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SABIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["HQ"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"34331.52","2":"34402.71","3":"34382.72","4":"34475.80","5":"-17142.76","6":"NA","7":"NA","8":"NA","_rn_":"constrainedModel"},{"1":"32179.07","2":"32250.27","3":"32230.27","4":"32323.36","5":"-16066.54","6":"2152.443","7":"0","8":"NaN","_rn_":"constrainedModelDropItem5ForMen"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="fu">anova</span>(constrainedModel, constrainedModelResolveItem5)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["AIC"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SABIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["HQ"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"34331.52","2":"34402.71","3":"34382.72","4":"34475.80","5":"-17142.76","6":"NA","7":"NA","8":"NA","_rn_":"constrainedModel"},{"1":"34291.28","2":"34371.76","3":"34349.16","4":"34454.38","5":"-17119.64","6":"46.23856","7":"3","8":"0.0000000005046279","_rn_":"constrainedModelResolveItem5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-difNextSteps" class="level4" data-number="16.9.9.5"><h4 data-number="16.9.9.5" class="anchored" data-anchor-id="sec-difNextSteps">
<span class="header-section-number">16.9.9.5</span> Next steps</h4>
<p>Whichever of these approaches we select, we would then identify and handle the remaining non-negligent <a href="#sec-dif">DIF</a> sequentially by magnitude. For instance, if we chose to resolve <a href="#sec-dif">DIF</a> in item 5 by allowing the item to have different parameters across both groups, we would then iteratively drop constraints to see which items continue to show non-negligible <a href="#sec-dif">DIF</a>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>difDropItemsNew <span class="ot">&lt;-</span> <span class="fu">DIF</span>(</span>
<span id="cb83-2"><a href="#cb83-2"></a>  constrainedModelResolveItem5,</span>
<span id="cb83-3"><a href="#cb83-3"></a>  <span class="fu">c</span>(<span class="st">"a1"</span>,<span class="st">"d1"</span>,<span class="st">"d2"</span>),</span>
<span id="cb83-4"><a href="#cb83-4"></a>  <span class="at">scheme =</span> <span class="st">"drop"</span>,</span>
<span id="cb83-5"><a href="#cb83-5"></a>  <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div id="tbl-itemLevelDIFAfterResolving" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-itemLevelDIFAfterResolving-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16.4: Differential Item Functioning After Resolving DIF in Item 5.
</figcaption><div aria-describedby="tbl-itemLevelDIFAfterResolving-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 2%">
<col style="width: 8%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">groups</th>
<th style="text-align: left;">converged</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">SABIC</th>
<th style="text-align: right;">HQ</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">X2</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bpi_antisocialT1_1</td>
<td style="text-align: left;">female,male</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">-5.5042001</td>
<td style="text-align: right;">3.7824138</td>
<td style="text-align: right;">1.1738421</td>
<td style="text-align: right;">13.3150439</td>
<td style="text-align: right;">11.5042001</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0092897</td>
</tr>
<tr class="even">
<td style="text-align: left;">bpi_antisocialT1_2</td>
<td style="text-align: left;">female,male</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">3.8539227</td>
<td style="text-align: right;">13.1405366</td>
<td style="text-align: right;">10.5319649</td>
<td style="text-align: right;">22.6731667</td>
<td style="text-align: right;">2.1460773</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.5426474</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bpi_antisocialT1_3</td>
<td style="text-align: left;">female,male</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">1.4534865</td>
<td style="text-align: right;">10.7401004</td>
<td style="text-align: right;">8.1315287</td>
<td style="text-align: right;">20.2727305</td>
<td style="text-align: right;">4.5465135</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.2081787</td>
</tr>
<tr class="even">
<td style="text-align: left;">bpi_antisocialT1_4</td>
<td style="text-align: left;">female,male</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">-26.4683563</td>
<td style="text-align: right;">-17.1817424</td>
<td style="text-align: right;">-19.7903141</td>
<td style="text-align: right;">-7.6491123</td>
<td style="text-align: right;">32.4683563</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0000004</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bpi_antisocialT1_5</td>
<td style="text-align: left;">female,male</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">0.0000966</td>
<td style="text-align: right;">0.0000966</td>
<td style="text-align: right;">0.0000966</td>
<td style="text-align: right;">0.0000966</td>
<td style="text-align: right;">-0.0000966</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NaN</td>
</tr>
<tr class="even">
<td style="text-align: left;">bpi_antisocialT1_6</td>
<td style="text-align: left;">female,male</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">-9.9043878</td>
<td style="text-align: right;">-0.6177739</td>
<td style="text-align: right;">-3.2263456</td>
<td style="text-align: right;">8.9148562</td>
<td style="text-align: right;">15.9043878</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0011863</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bpi_antisocialT1_7</td>
<td style="text-align: left;">female,male</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">-16.5941405</td>
<td style="text-align: right;">-7.3075266</td>
<td style="text-align: right;">-9.9160983</td>
<td style="text-align: right;">2.2251035</td>
<td style="text-align: right;">22.5941405</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0000491</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Estimates of <a href="#sec-dif">DIF</a> after resolving item 5 are in <a href="#tbl-itemLevelDIFAfterResolving" class="quarto-xref">Table&nbsp;<span>16.4</span></a>. Of the remaining <a href="#sec-dif">DIF</a>, item 4 appears to have the largest <a href="#sec-dif">DIF</a>. If we deem item 4 to show non-negligible <a href="#sec-dif">DIF</a>, we would address it using one of the three approaches above and then see which items continue to show the largest <a href="#sec-dif">DIF</a>, address it if necessary, then identify the remaining <a href="#sec-dif">DIF</a>, etc.</p>
</section></section></section><section id="sec-measurementInvariance" class="level2" data-number="16.10"><h2 data-number="16.10" class="anchored" data-anchor-id="sec-measurementInvariance">
<span class="header-section-number">16.10</span> Measurement/Factorial Invariance</h2>
<p>Before making comparisons across groups in terms of associations between constructs or their level on the construct, it is important to establish <em>measurement invariance</em> (also called <em>factorial invariance</em>) across the groups <span class="citation" data-cites="Millsap2011">(<a href="references.html#ref-Millsap2011" role="doc-biblioref">Millsap, 2011</a>)</span>. Tests of measurement invariance are equivalent to tests of <a href="#sec-dif">differential item functioning</a>. Measurement invariance can help provide greater confidence that the measure functions equivalently across groups, that is, the items have the same strength of association with the latent factor, and the latent factor is on the same metric (i.e., the items have the same level when accounting for the latent factor). For instance, If you observe differences between groups in level of depression without establishing measurement invariance across the groups, you do not know whether the differences observed reflect true group-related differences in depression or differences in the functioning of the measure across the groups.</p>
<p>Measurement invariance can be tested using many methods, including <a href="factor-analysis-pca.html#sec-cfa">confirmatory factor analysis</a> and <a href="item-response-theory.html">IRT</a>. <a href="factor-analysis-pca.html#sec-cfa">CFA</a> approaches to testing measurement invariance include multi-group <a href="factor-analysis-pca.html#sec-cfa">CFA</a> (MGCFA), multiple-indicator, multiple-causes (MIMIC) models, moderated nonlinear factor analysis (MNLFA), score-based tests <span class="citation" data-cites="Wang2014a">(<a href="references.html#ref-Wang2014a" role="doc-biblioref">T. Wang et al., 2014</a>)</span>, and the alignment method <span class="citation" data-cites="Lai2021">(<a href="references.html#ref-Lai2021" role="doc-biblioref">Lai, 2021</a>)</span>. The <a href="item-response-theory.html">IRT</a> approach to testing measurement (non-)invariance is to examine whether items show <a href="#sec-dif">differential item functioning</a>.</p>
<p>The tests of measurement invariance in <a href="factor-analysis-pca.html#sec-cfa">confirmatory factor analysis</a> (CFA) models were fit in the <code>lavaan</code> package <span class="citation" data-cites="R-lavaan">(<a href="references.html#ref-R-lavaan" role="doc-biblioref">Rosseel et al., 2022</a>)</span>. The examples were adapted from <code>lavaan</code> documentation: <a href="https://lavaan.ugent.be/tutorial/groups.html" class="uri">https://lavaan.ugent.be/tutorial/groups.html</a> (archived at <a href="https://perma.cc/2FBK-RSAH" class="uri">https://perma.cc/2FBK-RSAH</a>). Procedures for testing measurement invariance are outlined in <span class="citation" data-cites="Putnick2016">Putnick &amp; Bornstein (<a href="references.html#ref-Putnick2016" role="doc-biblioref">2016</a>)</span>. In addition to nested chi-square difference tests (<span class="math inline">\(\chi^2_{\text{diff}}\)</span>), I also demonstrate permutation procedures for testing measurement invariance, as described by <span class="citation" data-cites="Jorgensen2018">Jorgensen et al. (<a href="references.html#ref-Jorgensen2018" role="doc-biblioref">2018</a>)</span>. Also, you are encouraged to read about MIMIC models <span class="citation" data-cites="Cheng2016 Wang2009b">(<a href="references.html#ref-Cheng2016" role="doc-biblioref">Cheng et al., 2016</a>; <a href="references.html#ref-Wang2009b" role="doc-biblioref">W.-C. Wang et al., 2009</a>)</span>, score-based tests <span class="citation" data-cites="Wang2014a">(<a href="references.html#ref-Wang2014a" role="doc-biblioref">T. Wang et al., 2014</a>)</span>, and MNLFA that allows for testing measurement invariance across continuous moderators <span class="citation" data-cites="Bauer2020 Curran2014 Gottfredson2019">(<a href="references.html#ref-Bauer2020" role="doc-biblioref">Bauer et al., 2020</a>; <a href="references.html#ref-Curran2014" role="doc-biblioref">Curran et al., 2014</a>; <a href="references.html#ref-Gottfredson2019" role="doc-biblioref">N. C. Gottfredson et al., 2019</a>)</span>. MNLFA is implemented in the <code>mnlfa</code> package <span class="citation" data-cites="R-mnlfa">(<a href="references.html#ref-R-mnlfa" role="doc-biblioref">Robitzsch, 2019</a>)</span>. You can also generate syntax for conducting MNLFA in Mplus software <span class="citation" data-cites="Muthen2019">(<a href="references.html#ref-Muthen2019" role="doc-biblioref">Muthén &amp; Muthén, 2019</a>)</span> using the <code>aMNLFA</code> package <span class="citation" data-cites="R-aMNLFA">(<a href="references.html#ref-R-aMNLFA" role="doc-biblioref">V. Cole et al., 2018</a>)</span>. The alignment method allows many groups to be compared <span class="citation" data-cites="Han2019">(<a href="references.html#ref-Han2019" role="doc-biblioref">Han et al., 2019</a>)</span>.</p>
<p>Model fit of nested models can be compared with a chi-square difference test, as a way of testing measurement invariance. In this approach to testing measurement invariance, first model fit is evaluated in a configural invariance model, in which the same number of factors is specified in each group, and which indicators load on which factors are the same in each group. Then, successive constraints are made across groups, including constraining factor loadings, intercepts, and residuals across groups. The metric (“weak factorial”) invariance model is similar to the configural invariance model, but it constrains the factor loadings to be the same across groups. The scalar (“strong factorial”) invariance model keeps the constraints of the metric invariance model, but it also constrains the intercepts to be the same across groups. The residual (“strict factorial”) invariance model keeps the constraints of the scalar invariance model, but it also constrains the residuals to be the same across groups. The fit of each constrained model is compared to the previous model without such constraints. That is, the fit of the metric invariance model is compared to the fit of the configural invariance model, the fit of the scalar invariance model is compared to the fit of the metric invariance model, and the fit of the residual invariance model is compared to the fit of the scalar invariance model.</p>
<p>The chi-square difference test is sensitive to sample size, and trivial differences in fit can be detected with large samples <span class="citation" data-cites="Cheung2002">(<a href="references.html#ref-Cheung2002" role="doc-biblioref">Cheung &amp; Rensvold, 2002</a>)</span>. As a result, researchers also recommend examining change in additional criteria, including CFI, RMSEA, and SRMR <span class="citation" data-cites="Chen2007a">(<a href="references.html#ref-Chen2007a" role="doc-biblioref">Chen, 2007</a>)</span>. <span class="citation" data-cites="Cheung2002">Cheung &amp; Rensvold (<a href="references.html#ref-Cheung2002" role="doc-biblioref">2002</a>)</span> recommend a cutoff of <span class="math inline">\(\Delta \text{CFI} \geq -.01\)</span> for identifying measurement non-invariance. <span class="citation" data-cites="Chen2007a">Chen (<a href="references.html#ref-Chen2007a" role="doc-biblioref">2007</a>)</span> recommends the following cutoffs for identifying measurement non-invariance:</p>
<ul>
<li>with a small sample size (total <span class="math inline">\(N \leq 300\)</span>):
<ul>
<li>testing invariance of factor loadings:
<ul>
<li><span class="math inline">\(\Delta \text{CFI} \geq -.005\)</span></li>
<li>supplemented by <span class="math inline">\(\Delta \text{RMSEA} \geq .010\)</span> or <span class="math inline">\(\Delta \text{SRMR} \geq .025\)</span>
</li>
</ul>
</li>
<li>testing invariance of intercepts or residuals:
<ul>
<li><span class="math inline">\(\Delta \text{CFI} \geq -.005\)</span></li>
<li>supplemented by <span class="math inline">\(\Delta \text{RMSEA} \geq .010\)</span> or <span class="math inline">\(\Delta \text{SRMR} \geq .005\)</span>
</li>
</ul>
</li>
</ul>
</li>
<li>with an adequate sample size (total <span class="math inline">\(N &gt; 300\)</span>):
<ul>
<li>testing invariance of factor loadings:
<ul>
<li><span class="math inline">\(\Delta \text{CFI} \geq -.010\)</span></li>
<li>supplemented by <span class="math inline">\(\Delta \text{RMSEA} \geq .015\)</span> or <span class="math inline">\(\Delta \text{SRMR} \geq .030\)</span>
</li>
</ul>
</li>
<li>testing invariance of intercepts or residuals:
<ul>
<li><span class="math inline">\(\Delta \text{CFI} \geq -.005\)</span></li>
<li>supplemented by <span class="math inline">\(\Delta \text{RMSEA} \geq .015\)</span> or <span class="math inline">\(\Delta \text{SRMR} \geq .010\)</span>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><span class="citation" data-cites="Little2007">Little et al. (<a href="references.html#ref-Little2007" role="doc-biblioref">2007</a>)</span> suggested that researchers establish at least partial invariance of factor loadings (metric invariance) to compare covariances across groups, and at least partial invariance of intercepts (scalar invariance) to compare mean levels across groups. Partial invariance refers to invariance with some but not all indicators. So, to examine associations with other variables, invariance of at least some factor loadings would be preferable. To examine differences in level or growth, invariance of at least some factor loadings and intercepts would be preferable. Residual invariance is considered overly restrictive, and it is not generally expected that one establish residual invariance <span class="citation" data-cites="Little2013">(<a href="references.html#ref-Little2013" role="doc-biblioref">Little, 2013</a>)</span>.</p>
<p>Although measurement invariance is important to test, it is also worth noting that tests of measurement invariance and <a href="#sec-dif">DIF</a> rest on various fundamentally untestable assumptions related to scale setting <span class="citation" data-cites="Raykovinpress">(<a href="references.html#ref-Raykovinpress" role="doc-biblioref">Raykov et al., 2020</a>)</span>. For instance, to give the latent factor units, oftentimes researchers set one item’s factor loading to be equal across time (i.e., the marker variable). Results of factorial invariance tests can depend highly on which item is used as the anchor item for setting the scale of the latent factor <span class="citation" data-cites="Belzak2020">(<a href="references.html#ref-Belzak2020" role="doc-biblioref">Belzak &amp; Bauer, 2020</a>)</span>. And subsequent tests of measurement invariance then rest on the fundamentally untestable assumption that changes in the level of the latent factor precipitates the same amount of change in the item across groups. If this scaling is not proper, however, it could lead to improper conclusions. Researchers are, therefore, not conclusively able to establish measurement invariance.</p>
<p>Several possible approaches may help address this. First, it can be helpful to place greater focus on <em>degree</em> of measurement invariance and confidence (rather than presence versus absence of measurement invariance). To the extent that non-invariance is trivial in effect size, it provides the researcher with greater confidence that they can use the measure to assess a construct in a comparable way over time.</p>
<p>Second, there may be important robustness checks. I describe each in greater detail below. One important sensitivity analysis could be to see if measurement invariance holds when using different marker variables. This would provide greater evidence that their apparent measurement invariance was not specific to one marker variable (i.e., one particular set of assumptions). A second robustness check would be to use effects coding, in which the average of items’ factor loadings is equal to 1, so the metric of the latent variable is on the metric of all of the items rather than just one item <span class="citation" data-cites="Little2006a">(<a href="references.html#ref-Little2006a" role="doc-biblioref">Little et al., 2006</a>)</span>. A third robustness check would be to use regularization, which is an alternative method to select the anchor items and to identify differential item functioning based on a machine learning technique that applies penalization to remove parameters that have little impact on model fit <span class="citation" data-cites="Bauer2020 Belzak2020">(<a href="references.html#ref-Bauer2020" role="doc-biblioref">Bauer et al., 2020</a>; <a href="references.html#ref-Belzak2020" role="doc-biblioref">Belzak &amp; Bauer, 2020</a>)</span>.</p>
<p>Another issue with measurement invariance is that the null hypothesis that adding constraints across groups will not worsen fit is likely always false, because there are often at least slight differences across groups in factor loadings, intercepts, or residuals that reflect sampling variability. However, we are not interested in trivial differences across groups that reflect sampling variability. Instead, we are interested in the extent to which there are substantive, meaningful differences across the groups of large enough magnitude to be practically meaningful. Thus, it can also be helpful to consider whether the measures show <em>approximate measurement invariance</em> <span class="citation" data-cites="VanDeSchoot2015">(<a href="references.html#ref-VanDeSchoot2015" role="doc-biblioref">Van De Schoot et al., 2015</a>)</span>. For details on how to test approximate measurement invariance, see <span class="citation" data-cites="VanDeSchoot2013">Van De Schoot et al. (<a href="references.html#ref-VanDeSchoot2013" role="doc-biblioref">2013</a>)</span>.</p>
<p>When detecting measurement non-invariance in a given parameter (e.g., factor loadings, intercepts, or residuals), one can identify the specific items that show measurement non-invariance in one of two primary ways: (1) starting with a model that allows the given parameter to differ across groups, a researcher can iteratively add constraints to identify the item(s) for which measurement invariance fails, or (2) starting with a model that constrains the given parameter to be the same across groups, a researcher can iteratively remove constraints to identify the item(s) for which measurement invariance becomes established (and by process of elimination, the items for which measurement invariance does not become established).</p>
<p>Approaches to addressing measurement non-invariance are described in <a href="#sec-whenDetectingBias" class="quarto-xref"><span>Section 16.5.1</span></a>. If we identify that an item shows non-negligible non-invariance, we have three primary options (described above): (1) drop the item for both groups, (2) drop the item for one group but keep it for the other group, or (3) freely estimate the parameters (factor loadings and/or intercepts) for the item across groups.</p>
<p>Using the traditional chi-square difference test, tests of measurement invariance compare the model fit to a model with perfect fit. As the sample size grows larger, smaller differences in model fit will be detected as significant, thus rejecting measurement invariance even if the model fits well. So, it can also be useful to compare the model fit to a null hypothesis that the fit is poor, instead of the null hypothesis that the model is a perfect fit. <em>Chi-square equivalence tests</em> use the poor model fit as the null hypothesis. Thus, a significant chi-square equivalence test suggests that the equality constraints are plausible, providing support for the alternative hypothesis that the model fit is acceptable <span class="citation" data-cites="Counsell2020">(<a href="references.html#ref-Counsell2020" role="doc-biblioref">Counsell et al., 2020</a>)</span>.</p>
<section id="sec-measurementNonInvarianceEffectSize" class="level3" data-number="16.10.1"><h3 data-number="16.10.1" class="anchored" data-anchor-id="sec-measurementNonInvarianceEffectSize">
<span class="header-section-number">16.10.1</span> Effect Size of Measurement Non-Invariance</h3>
<p>A number of studies describe how to test the effect size of measurement invariance <span class="citation" data-cites="Liu2017a Gunn2020 Newsom2015 Nye2019">(<a href="references.html#ref-Gunn2020" role="doc-biblioref">Gunn et al., 2020</a>; e.g., <a href="references.html#ref-Liu2017a" role="doc-biblioref">Liu et al., 2017</a>; <a href="references.html#ref-Newsom2015" role="doc-biblioref">Newsom, 2015</a>; <a href="references.html#ref-Nye2019" role="doc-biblioref">Nye et al., 2019</a>)</span> or differential item functioning <span class="citation" data-cites="Meade2010 Gonzalez2021">(<a href="references.html#ref-Gonzalez2021" role="doc-biblioref">Gonzalez &amp; Pelham, 2021</a>; e.g., <a href="references.html#ref-Meade2010" role="doc-biblioref">Meade, 2010</a>)</span>. Indices of effect size of measurement noninvariance include <span class="math inline">\(d_{\text{MACS}}\)</span> <span class="citation" data-cites="Nye2019">(<a href="references.html#ref-Nye2019" role="doc-biblioref">Nye et al., 2019</a>)</span>, <span class="math inline">\(w\)</span> <span class="citation" data-cites="Newsom2015">(<a href="references.html#ref-Newsom2015" role="doc-biblioref">Newsom, 2015</a>)</span>, and <span class="math inline">\(\Delta \text{M}_\text{C}\)</span> <span class="citation" data-cites="Newsom2015">(<a href="references.html#ref-Newsom2015" role="doc-biblioref">Newsom, 2015</a>)</span>.</p>
<p><span class="math inline">\(w\)</span> is interpreted such that .1, .3, and .5 indicate a small, medium, and large effect size, respectively. <span class="math inline">\(w\)</span> is computed as in <a href="#eq-measurementNoninvarianceEffectSizeW" class="quarto-xref">Equation&nbsp;<span>16.1</span></a>:</p>
<p><span id="eq-measurementNoninvarianceEffectSizeW"><span class="math display">\[
w = \sqrt{\frac{\Delta \chi^2}{N(\Delta df)}}
\tag{16.1}\]</span></span></p>
<p>McDonald’s centrality index (<span class="math inline">\(\text{M}_\text{C}\)</span>) is computed as in <a href="#eq-measurementNoninvarianceEffectSizeMc" class="quarto-xref">Equation&nbsp;<span>16.2</span></a>:</p>
<p><span id="eq-measurementNoninvarianceEffectSizeMc"><span class="math display">\[
\text{M}_\text{C} = \exp\!\left[-\tfrac{1}{2}\,\left(\frac{\chi^{2} - \text{df}}{N - 1}\right)\right]
\tag{16.2}\]</span></span></p>
<p>Then, <span class="math inline">\(\Delta \text{M}_\text{C}\)</span> is computed as in <a href="#eq-measurementNoninvarianceEffectSizeDeltaMc" class="quarto-xref">Equation&nbsp;<span>16.3</span></a>:</p>
<p><span id="eq-measurementNoninvarianceEffectSizeDeltaMc"><span class="math display">\[
\Delta \text{M}_\text{C} = \text{M}_{\text{C},\text{unconstrained}} - \text{M}_{\text{C},\text{constrained}}
\tag{16.3}\]</span></span></p>
</section><section id="sec-measurementInvarianceModels" class="level3" data-number="16.10.2"><h3 data-number="16.10.2" class="anchored" data-anchor-id="sec-measurementInvarianceModels">
<span class="header-section-number">16.10.2</span> Specify Models</h3>
<section id="sec-measurementInvarianceNullModelSyntax" class="level4" data-number="16.10.2.1"><h4 data-number="16.10.2.1" class="anchored" data-anchor-id="sec-measurementInvarianceNullModelSyntax">
<span class="header-section-number">16.10.2.1</span> Null Model</h4>
<p>Fix residual variances and intercepts of manifest variables to be equal across groups.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>nullModel <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="st">#Fix residual variances of manifest variables to be equal across groups</span></span>
<span id="cb84-3"><a href="#cb84-3"></a><span class="st">x1 ~~ c(psi1, psi1)*x1</span></span>
<span id="cb84-4"><a href="#cb84-4"></a><span class="st">x2 ~~ c(psi2, psi2)*x2</span></span>
<span id="cb84-5"><a href="#cb84-5"></a><span class="st">x3 ~~ c(psi3, psi3)*x3</span></span>
<span id="cb84-6"><a href="#cb84-6"></a><span class="st">x4 ~~ c(psi4, psi4)*x4</span></span>
<span id="cb84-7"><a href="#cb84-7"></a><span class="st">x5 ~~ c(psi5, psi5)*x5</span></span>
<span id="cb84-8"><a href="#cb84-8"></a><span class="st">x6 ~~ c(psi6, psi6)*x6</span></span>
<span id="cb84-9"><a href="#cb84-9"></a><span class="st">x7 ~~ c(psi7, psi7)*x7</span></span>
<span id="cb84-10"><a href="#cb84-10"></a><span class="st">x8 ~~ c(psi8, psi8)*x8</span></span>
<span id="cb84-11"><a href="#cb84-11"></a><span class="st">x9 ~~ c(psi9, psi9)*x9</span></span>
<span id="cb84-12"><a href="#cb84-12"></a></span>
<span id="cb84-13"><a href="#cb84-13"></a><span class="st">#Fix intercepts of manifest variables to be equal across groups</span></span>
<span id="cb84-14"><a href="#cb84-14"></a><span class="st">x1 ~ c(tau1, tau1)*1</span></span>
<span id="cb84-15"><a href="#cb84-15"></a><span class="st">x2 ~ c(tau2, tau2)*1</span></span>
<span id="cb84-16"><a href="#cb84-16"></a><span class="st">x3 ~ c(tau3, tau3)*1</span></span>
<span id="cb84-17"><a href="#cb84-17"></a><span class="st">x4 ~ c(tau4, tau4)*1</span></span>
<span id="cb84-18"><a href="#cb84-18"></a><span class="st">x5 ~ c(tau5, tau5)*1</span></span>
<span id="cb84-19"><a href="#cb84-19"></a><span class="st">x6 ~ c(tau6, tau6)*1</span></span>
<span id="cb84-20"><a href="#cb84-20"></a><span class="st">x7 ~ c(tau7, tau7)*1</span></span>
<span id="cb84-21"><a href="#cb84-21"></a><span class="st">x8 ~ c(tau8, tau8)*1</span></span>
<span id="cb84-22"><a href="#cb84-22"></a><span class="st">x9 ~ c(tau9, tau9)*1</span></span>
<span id="cb84-23"><a href="#cb84-23"></a><span class="st">'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceCFAsyntax" class="level4" data-number="16.10.2.2"><h4 data-number="16.10.2.2" class="anchored" data-anchor-id="sec-measurementInvarianceCFAsyntax">
<span class="header-section-number">16.10.2.2</span> CFA Model</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>cfaModel <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="st"> #Factor loadings</span></span>
<span id="cb85-3"><a href="#cb85-3"></a><span class="st"> visual  =~ x1 + x2 + x3</span></span>
<span id="cb85-4"><a href="#cb85-4"></a><span class="st"> textual =~ x4 + x5 + x6</span></span>
<span id="cb85-5"><a href="#cb85-5"></a><span class="st"> speed   =~ x7 + x8 + x9</span></span>
<span id="cb85-6"><a href="#cb85-6"></a><span class="st">'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceConfiguralSyntax" class="level4" data-number="16.10.2.3"><h4 data-number="16.10.2.3" class="anchored" data-anchor-id="sec-measurementInvarianceConfiguralSyntax">
<span class="header-section-number">16.10.2.3</span> Configural Invariance</h4>
<p>Specify the same number of factors in each group, and which indicators load on which factors are the same in each group.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>cfaModel_configuralInvariance <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb86-2"><a href="#cb86-2"></a><span class="st"> #Factor loadings (free the factor loading of the first indicator)</span></span>
<span id="cb86-3"><a href="#cb86-3"></a><span class="st"> visual  =~ NA*x1 + x2 + x3</span></span>
<span id="cb86-4"><a href="#cb86-4"></a><span class="st"> textual =~ NA*x4 + x5 + x6</span></span>
<span id="cb86-5"><a href="#cb86-5"></a><span class="st"> speed   =~ NA*x7 + x8 + x9</span></span>
<span id="cb86-6"><a href="#cb86-6"></a><span class="st"> </span></span>
<span id="cb86-7"><a href="#cb86-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb86-8"><a href="#cb86-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb86-9"><a href="#cb86-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb86-10"><a href="#cb86-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb86-11"><a href="#cb86-11"></a><span class="st"> </span></span>
<span id="cb86-12"><a href="#cb86-12"></a><span class="st"> #Fix latent variances to one</span></span>
<span id="cb86-13"><a href="#cb86-13"></a><span class="st"> visual ~~ 1*visual</span></span>
<span id="cb86-14"><a href="#cb86-14"></a><span class="st"> textual ~~ 1*textual</span></span>
<span id="cb86-15"><a href="#cb86-15"></a><span class="st"> speed ~~ 1*speed</span></span>
<span id="cb86-16"><a href="#cb86-16"></a><span class="st"> </span></span>
<span id="cb86-17"><a href="#cb86-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb86-18"><a href="#cb86-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb86-19"><a href="#cb86-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb86-20"><a href="#cb86-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb86-21"><a href="#cb86-21"></a><span class="st"> </span></span>
<span id="cb86-22"><a href="#cb86-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb86-23"><a href="#cb86-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb86-24"><a href="#cb86-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb86-25"><a href="#cb86-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb86-26"><a href="#cb86-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb86-27"><a href="#cb86-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb86-28"><a href="#cb86-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb86-29"><a href="#cb86-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb86-30"><a href="#cb86-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb86-31"><a href="#cb86-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb86-32"><a href="#cb86-32"></a><span class="st"> </span></span>
<span id="cb86-33"><a href="#cb86-33"></a><span class="st"> #Free intercepts of manifest variables</span></span>
<span id="cb86-34"><a href="#cb86-34"></a><span class="st"> x1 ~ NA*1</span></span>
<span id="cb86-35"><a href="#cb86-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb86-36"><a href="#cb86-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb86-37"><a href="#cb86-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb86-38"><a href="#cb86-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb86-39"><a href="#cb86-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb86-40"><a href="#cb86-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb86-41"><a href="#cb86-41"></a><span class="st"> x8 ~ NA*1</span></span>
<span id="cb86-42"><a href="#cb86-42"></a><span class="st"> x9 ~ NA*1</span></span>
<span id="cb86-43"><a href="#cb86-43"></a><span class="st">'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceMetricSyntax" class="level4" data-number="16.10.2.4"><h4 data-number="16.10.2.4" class="anchored" data-anchor-id="sec-measurementInvarianceMetricSyntax">
<span class="header-section-number">16.10.2.4</span> Metric (“Weak Factorial”) Invariance</h4>
<p>Specify invariance of factor loadings across groups.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>cfaModel_metricInvariance <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb87-3"><a href="#cb87-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb87-4"><a href="#cb87-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb87-5"><a href="#cb87-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb87-6"><a href="#cb87-6"></a><span class="st"> </span></span>
<span id="cb87-7"><a href="#cb87-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb87-8"><a href="#cb87-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb87-9"><a href="#cb87-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb87-10"><a href="#cb87-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb87-11"><a href="#cb87-11"></a><span class="st"> </span></span>
<span id="cb87-12"><a href="#cb87-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb87-13"><a href="#cb87-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb87-14"><a href="#cb87-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb87-15"><a href="#cb87-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb87-16"><a href="#cb87-16"></a><span class="st"> </span></span>
<span id="cb87-17"><a href="#cb87-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb87-18"><a href="#cb87-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb87-19"><a href="#cb87-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb87-20"><a href="#cb87-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb87-21"><a href="#cb87-21"></a><span class="st"> </span></span>
<span id="cb87-22"><a href="#cb87-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb87-23"><a href="#cb87-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb87-24"><a href="#cb87-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb87-25"><a href="#cb87-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb87-26"><a href="#cb87-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb87-27"><a href="#cb87-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb87-28"><a href="#cb87-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb87-29"><a href="#cb87-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb87-30"><a href="#cb87-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb87-31"><a href="#cb87-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb87-32"><a href="#cb87-32"></a><span class="st"> </span></span>
<span id="cb87-33"><a href="#cb87-33"></a><span class="st"> #Free intercepts of manifest variables</span></span>
<span id="cb87-34"><a href="#cb87-34"></a><span class="st"> x1 ~ NA*1</span></span>
<span id="cb87-35"><a href="#cb87-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb87-36"><a href="#cb87-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb87-37"><a href="#cb87-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb87-38"><a href="#cb87-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb87-39"><a href="#cb87-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb87-40"><a href="#cb87-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb87-41"><a href="#cb87-41"></a><span class="st"> x8 ~ NA*1</span></span>
<span id="cb87-42"><a href="#cb87-42"></a><span class="st"> x9 ~ NA*1</span></span>
<span id="cb87-43"><a href="#cb87-43"></a><span class="st">'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceScalarSyntax" class="level4" data-number="16.10.2.5"><h4 data-number="16.10.2.5" class="anchored" data-anchor-id="sec-measurementInvarianceScalarSyntax">
<span class="header-section-number">16.10.2.5</span> Scalar (“Strong Factorial”) Invariance</h4>
<p>Specify invariance of factor loadings and intercepts across groups.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>cfaModel_scalarInvariance <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb88-3"><a href="#cb88-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb88-4"><a href="#cb88-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb88-5"><a href="#cb88-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb88-6"><a href="#cb88-6"></a><span class="st"> </span></span>
<span id="cb88-7"><a href="#cb88-7"></a><span class="st"> #Fix latent means to zero in group 1; free latent means in group 2</span></span>
<span id="cb88-8"><a href="#cb88-8"></a><span class="st"> visual ~ c(0, NA)*1</span></span>
<span id="cb88-9"><a href="#cb88-9"></a><span class="st"> textual ~ c(0, NA)*1</span></span>
<span id="cb88-10"><a href="#cb88-10"></a><span class="st"> speed ~ c(0, NA)*1</span></span>
<span id="cb88-11"><a href="#cb88-11"></a><span class="st"> </span></span>
<span id="cb88-12"><a href="#cb88-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb88-13"><a href="#cb88-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb88-14"><a href="#cb88-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb88-15"><a href="#cb88-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb88-16"><a href="#cb88-16"></a><span class="st"> </span></span>
<span id="cb88-17"><a href="#cb88-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb88-18"><a href="#cb88-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb88-19"><a href="#cb88-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb88-20"><a href="#cb88-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb88-21"><a href="#cb88-21"></a><span class="st"> </span></span>
<span id="cb88-22"><a href="#cb88-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb88-23"><a href="#cb88-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb88-24"><a href="#cb88-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb88-25"><a href="#cb88-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb88-26"><a href="#cb88-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb88-27"><a href="#cb88-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb88-28"><a href="#cb88-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb88-29"><a href="#cb88-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb88-30"><a href="#cb88-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb88-31"><a href="#cb88-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb88-32"><a href="#cb88-32"></a><span class="st"> </span></span>
<span id="cb88-33"><a href="#cb88-33"></a><span class="st"> #Fix intercepts of manifest variables across groups</span></span>
<span id="cb88-34"><a href="#cb88-34"></a><span class="st"> x1 ~ c(intx1, intx1)*1</span></span>
<span id="cb88-35"><a href="#cb88-35"></a><span class="st"> x2 ~ c(intx2, intx2)*1</span></span>
<span id="cb88-36"><a href="#cb88-36"></a><span class="st"> x3 ~ c(intx3, intx3)*1</span></span>
<span id="cb88-37"><a href="#cb88-37"></a><span class="st"> x4 ~ c(intx4, intx4)*1</span></span>
<span id="cb88-38"><a href="#cb88-38"></a><span class="st"> x5 ~ c(intx5, intx5)*1</span></span>
<span id="cb88-39"><a href="#cb88-39"></a><span class="st"> x6 ~ c(intx6, intx6)*1</span></span>
<span id="cb88-40"><a href="#cb88-40"></a><span class="st"> x7 ~ c(intx7, intx7)*1</span></span>
<span id="cb88-41"><a href="#cb88-41"></a><span class="st"> x8 ~ c(intx8, intx8)*1</span></span>
<span id="cb88-42"><a href="#cb88-42"></a><span class="st"> x9 ~ c(intx9, intx9)*1</span></span>
<span id="cb88-43"><a href="#cb88-43"></a><span class="st">'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceResidualSyntax" class="level4" data-number="16.10.2.6"><h4 data-number="16.10.2.6" class="anchored" data-anchor-id="sec-measurementInvarianceResidualSyntax">
<span class="header-section-number">16.10.2.6</span> Residual (“Strict Factorial”) Invariance</h4>
<p>Specify invariance of factor loadings, intercepts, and residuals across groups.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>cfaModel_residualInvariance <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb89-3"><a href="#cb89-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb89-4"><a href="#cb89-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb89-5"><a href="#cb89-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb89-6"><a href="#cb89-6"></a><span class="st"> </span></span>
<span id="cb89-7"><a href="#cb89-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb89-8"><a href="#cb89-8"></a><span class="st"> visual ~ c(0, NA)*1</span></span>
<span id="cb89-9"><a href="#cb89-9"></a><span class="st"> textual ~ c(0, NA)*1</span></span>
<span id="cb89-10"><a href="#cb89-10"></a><span class="st"> speed ~ c(0, NA)*1</span></span>
<span id="cb89-11"><a href="#cb89-11"></a><span class="st"> </span></span>
<span id="cb89-12"><a href="#cb89-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb89-13"><a href="#cb89-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb89-14"><a href="#cb89-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb89-15"><a href="#cb89-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb89-16"><a href="#cb89-16"></a><span class="st"> </span></span>
<span id="cb89-17"><a href="#cb89-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb89-18"><a href="#cb89-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb89-19"><a href="#cb89-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb89-20"><a href="#cb89-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb89-21"><a href="#cb89-21"></a><span class="st"> </span></span>
<span id="cb89-22"><a href="#cb89-22"></a><span class="st"> #Fix residual variances of manifest variables across groups</span></span>
<span id="cb89-23"><a href="#cb89-23"></a><span class="st"> x1 ~~ c(residx1, residx1)*x1</span></span>
<span id="cb89-24"><a href="#cb89-24"></a><span class="st"> x2 ~~ c(residx2, residx2)*x2</span></span>
<span id="cb89-25"><a href="#cb89-25"></a><span class="st"> x3 ~~ c(residx3, residx3)*x3</span></span>
<span id="cb89-26"><a href="#cb89-26"></a><span class="st"> x4 ~~ c(residx4, residx4)*x4</span></span>
<span id="cb89-27"><a href="#cb89-27"></a><span class="st"> x5 ~~ c(residx5, residx5)*x5</span></span>
<span id="cb89-28"><a href="#cb89-28"></a><span class="st"> x6 ~~ c(residx6, residx6)*x6</span></span>
<span id="cb89-29"><a href="#cb89-29"></a><span class="st"> x7 ~~ c(residx7, residx7)*x7</span></span>
<span id="cb89-30"><a href="#cb89-30"></a><span class="st"> x8 ~~ c(residx8, residx8)*x8</span></span>
<span id="cb89-31"><a href="#cb89-31"></a><span class="st"> x9 ~~ c(residx9, residx9)*x9</span></span>
<span id="cb89-32"><a href="#cb89-32"></a><span class="st"> </span></span>
<span id="cb89-33"><a href="#cb89-33"></a><span class="st"> #Fix intercepts of manifest variables across groups</span></span>
<span id="cb89-34"><a href="#cb89-34"></a><span class="st"> x1 ~ c(intx1, intx1)*1</span></span>
<span id="cb89-35"><a href="#cb89-35"></a><span class="st"> x2 ~ c(intx2, intx2)*1</span></span>
<span id="cb89-36"><a href="#cb89-36"></a><span class="st"> x3 ~ c(intx3, intx3)*1</span></span>
<span id="cb89-37"><a href="#cb89-37"></a><span class="st"> x4 ~ c(intx4, intx4)*1</span></span>
<span id="cb89-38"><a href="#cb89-38"></a><span class="st"> x5 ~ c(intx5, intx5)*1</span></span>
<span id="cb89-39"><a href="#cb89-39"></a><span class="st"> x6 ~ c(intx6, intx6)*1</span></span>
<span id="cb89-40"><a href="#cb89-40"></a><span class="st"> x7 ~ c(intx7, intx7)*1</span></span>
<span id="cb89-41"><a href="#cb89-41"></a><span class="st"> x8 ~ c(intx8, intx8)*1</span></span>
<span id="cb89-42"><a href="#cb89-42"></a><span class="st"> x9 ~ c(intx9, intx9)*1</span></span>
<span id="cb89-43"><a href="#cb89-43"></a><span class="st">'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="sec-measurementInvarianceFitIndices" class="level3" data-number="16.10.3"><h3 data-number="16.10.3" class="anchored" data-anchor-id="sec-measurementInvarianceFitIndices">
<span class="header-section-number">16.10.3</span> Specify the Fit Indices of Interest</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>myAFIs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"chisq.scaled"</span>,</span>
<span id="cb90-2"><a href="#cb90-2"></a>            <span class="st">"rmsea"</span>, <span class="st">"cfi"</span>, <span class="st">"tli"</span>, <span class="st">"srmr"</span>,</span>
<span id="cb90-3"><a href="#cb90-3"></a>            <span class="st">"rmsea.robust"</span>, <span class="st">"cfi.robust"</span>, <span class="st">"tli.robust"</span>)</span>
<span id="cb90-4"><a href="#cb90-4"></a>moreAFIs <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># c("gammaHat","gammaHat.scaled")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceNullModel" class="level3" data-number="16.10.4"><h3 data-number="16.10.4" class="anchored" data-anchor-id="sec-measurementInvarianceNullModel">
<span class="header-section-number">16.10.4</span> Null Model</h3>
<section id="sec-measurementInvarianceNullModelFit" class="level4" data-number="16.10.4.1"><h4 data-number="16.10.4.1" class="anchored" data-anchor-id="sec-measurementInvarianceNullModelFit">
<span class="header-section-number">16.10.4.1</span> Fit the Model</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>nullModelFit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb91-2"><a href="#cb91-2"></a>  nullModel,</span>
<span id="cb91-3"><a href="#cb91-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb91-4"><a href="#cb91-4"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb91-5"><a href="#cb91-5"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb91-6"><a href="#cb91-6"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceNullModelSummary" class="level4" data-number="16.10.4.2"><h4 data-number="16.10.4.2" class="anchored" data-anchor-id="sec-measurementInvarianceNullModelSummary">
<span class="header-section-number">16.10.4.2</span> Model Summary</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="fu">summary</span>(</span>
<span id="cb92-2"><a href="#cb92-2"></a>  nullModelFit,</span>
<span id="cb92-3"><a href="#cb92-3"></a>  <span class="at">fit.measures =</span> <span class="cn">TRUE</span>,</span>
<span id="cb92-4"><a href="#cb92-4"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb92-5"><a href="#cb92-5"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 39 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        36
  Number of equality constraints                    18

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145
  Number of missing patterns per group:               
    Pasteur                                          9
    Grant-White                                      9

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                              1034.341    1001.376
  Degrees of freedom                                90          90
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  1.033
    Yuan-Bentler correction (Mplus variant)                       
  Test statistic for each group:
    Pasteur                                    477.005     477.005
    Grant-White                                524.371     524.371

Model Test Baseline Model:

  Test statistic                               932.665     909.019
  Degrees of freedom                                72          72
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.026

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.000       0.000
  Tucker-Lewis Index (TLI)                       0.122       0.129
                                                                  
  Robust Comparative Fit Index (CFI)                         0.000
  Robust Tucker-Lewis Index (TLI)                            0.125

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -4111.291   -4111.291
  Scaling correction factor                                  0.520
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -3594.120   -3594.120
  Scaling correction factor                                  1.034
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                                8258.582    8258.582
  Bayesian (BIC)                              8325.310    8325.310
  Sample-size adjusted Bayesian (SABIC)       8268.224    8268.224

Root Mean Square Error of Approximation:

  RMSEA                                          0.264       0.259
  90 Percent confidence interval - lower         0.250       0.245
  90 Percent confidence interval - upper         0.279       0.274
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000
                                                                  
  Robust RMSEA                                               0.267
  90 Percent confidence interval - lower                     0.252
  90 Percent confidence interval - upper                     0.282
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.284       0.284

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian


Group 1 [Pasteur]:

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    x1      (tau1)    4.935    0.067   73.255    0.000    4.935    4.236
    x2      (tau2)    6.085    0.068   89.601    0.000    6.085    5.173
    x3      (tau3)    2.261    0.066   34.411    0.000    2.261    2.000
    x4      (tau4)    3.050    0.067   45.313    0.000    3.050    2.634
    x5      (tau5)    4.332    0.074   58.509    0.000    4.332    3.389
    x6      (tau6)    2.195    0.063   34.800    0.000    2.195    2.013
    x7      (tau7)    4.196    0.063   66.358    0.000    4.196    3.850
    x8      (tau8)    5.524    0.059   94.261    0.000    5.524    5.451
    x9      (tau9)    5.378    0.059   91.869    0.000    5.378    5.322

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    x1      (psi1)    1.357    0.120   11.283    0.000    1.357    1.000
    x2      (psi2)    1.384    0.123   11.273    0.000    1.384    1.000
    x3      (psi3)    1.278    0.077   16.500    0.000    1.278    1.000
    x4      (psi4)    1.341    0.114   11.780    0.000    1.341    1.000
    x5      (psi5)    1.634    0.116   14.144    0.000    1.634    1.000
    x6      (psi6)    1.189    0.116   10.243    0.000    1.189    1.000
    x7      (psi7)    1.188    0.090   13.206    0.000    1.188    1.000
    x8      (psi8)    1.027    0.106    9.674    0.000    1.027    1.000
    x9      (psi9)    1.021    0.090   11.389    0.000    1.021    1.000


Group 2 [Grant-White]:

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    x1      (tau1)    4.935    0.067   73.255    0.000    4.935    4.236
    x2      (tau2)    6.085    0.068   89.601    0.000    6.085    5.173
    x3      (tau3)    2.261    0.066   34.411    0.000    2.261    2.000
    x4      (tau4)    3.050    0.067   45.313    0.000    3.050    2.634
    x5      (tau5)    4.332    0.074   58.509    0.000    4.332    3.389
    x6      (tau6)    2.195    0.063   34.800    0.000    2.195    2.013
    x7      (tau7)    4.196    0.063   66.358    0.000    4.196    3.850
    x8      (tau8)    5.524    0.059   94.261    0.000    5.524    5.451
    x9      (tau9)    5.378    0.059   91.869    0.000    5.378    5.322

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    x1      (psi1)    1.357    0.120   11.283    0.000    1.357    1.000
    x2      (psi2)    1.384    0.123   11.273    0.000    1.384    1.000
    x3      (psi3)    1.278    0.077   16.500    0.000    1.278    1.000
    x4      (psi4)    1.341    0.114   11.780    0.000    1.341    1.000
    x5      (psi5)    1.634    0.116   14.144    0.000    1.634    1.000
    x6      (psi6)    1.189    0.116   10.243    0.000    1.189    1.000
    x7      (psi7)    1.188    0.090   13.206    0.000    1.188    1.000
    x8      (psi8)    1.027    0.106    9.674    0.000    1.027    1.000
    x9      (psi9)    1.021    0.090   11.389    0.000    1.021    1.000</code></pre>
</div>
</div>
</section></section><section id="sec-measurementInvarianceConfigural" class="level3" data-number="16.10.5"><h3 data-number="16.10.5" class="anchored" data-anchor-id="sec-measurementInvarianceConfigural">
<span class="header-section-number">16.10.5</span> Configural Invariance</h3>
<p>Specify the same number of factors in each group, and which indicators load on which factors are the same in each group.</p>
<section id="sec-measurementInvarianceConfiguralModelSyntax" class="level4" data-number="16.10.5.1"><h4 data-number="16.10.5.1" class="anchored" data-anchor-id="sec-measurementInvarianceConfiguralModelSyntax">
<span class="header-section-number">16.10.5.1</span> Model Syntax</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>configuralInvarianceModel <span class="ot">&lt;-</span> <span class="fu">measEq.syntax</span>(</span>
<span id="cb94-2"><a href="#cb94-2"></a>  <span class="at">configural.model =</span> cfaModel,</span>
<span id="cb94-3"><a href="#cb94-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb94-4"><a href="#cb94-4"></a>  <span class="at">ID.fac =</span> <span class="st">"std.lv"</span>,</span>
<span id="cb94-5"><a href="#cb94-5"></a>  <span class="at">group =</span> <span class="st">"school"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="fu">cat</span>(<span class="fu">as.character</span>(configuralInvarianceModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>## LOADINGS:

visual =~ c(NA, NA)*x1 + c(lambda.1_1.g1, lambda.1_1.g2)*x1
visual =~ c(NA, NA)*x2 + c(lambda.2_1.g1, lambda.2_1.g2)*x2
visual =~ c(NA, NA)*x3 + c(lambda.3_1.g1, lambda.3_1.g2)*x3
textual =~ c(NA, NA)*x4 + c(lambda.4_2.g1, lambda.4_2.g2)*x4
textual =~ c(NA, NA)*x5 + c(lambda.5_2.g1, lambda.5_2.g2)*x5
textual =~ c(NA, NA)*x6 + c(lambda.6_2.g1, lambda.6_2.g2)*x6
speed =~ c(NA, NA)*x7 + c(lambda.7_3.g1, lambda.7_3.g2)*x7
speed =~ c(NA, NA)*x8 + c(lambda.8_3.g1, lambda.8_3.g2)*x8
speed =~ c(NA, NA)*x9 + c(lambda.9_3.g1, lambda.9_3.g2)*x9

## INTERCEPTS:

x1 ~ c(NA, NA)*1 + c(nu.1.g1, nu.1.g2)*1
x2 ~ c(NA, NA)*1 + c(nu.2.g1, nu.2.g2)*1
x3 ~ c(NA, NA)*1 + c(nu.3.g1, nu.3.g2)*1
x4 ~ c(NA, NA)*1 + c(nu.4.g1, nu.4.g2)*1
x5 ~ c(NA, NA)*1 + c(nu.5.g1, nu.5.g2)*1
x6 ~ c(NA, NA)*1 + c(nu.6.g1, nu.6.g2)*1
x7 ~ c(NA, NA)*1 + c(nu.7.g1, nu.7.g2)*1
x8 ~ c(NA, NA)*1 + c(nu.8.g1, nu.8.g2)*1
x9 ~ c(NA, NA)*1 + c(nu.9.g1, nu.9.g2)*1

## UNIQUE-FACTOR VARIANCES:

x1 ~~ c(NA, NA)*x1 + c(theta.1_1.g1, theta.1_1.g2)*x1
x2 ~~ c(NA, NA)*x2 + c(theta.2_2.g1, theta.2_2.g2)*x2
x3 ~~ c(NA, NA)*x3 + c(theta.3_3.g1, theta.3_3.g2)*x3
x4 ~~ c(NA, NA)*x4 + c(theta.4_4.g1, theta.4_4.g2)*x4
x5 ~~ c(NA, NA)*x5 + c(theta.5_5.g1, theta.5_5.g2)*x5
x6 ~~ c(NA, NA)*x6 + c(theta.6_6.g1, theta.6_6.g2)*x6
x7 ~~ c(NA, NA)*x7 + c(theta.7_7.g1, theta.7_7.g2)*x7
x8 ~~ c(NA, NA)*x8 + c(theta.8_8.g1, theta.8_8.g2)*x8
x9 ~~ c(NA, NA)*x9 + c(theta.9_9.g1, theta.9_9.g2)*x9

## LATENT MEANS/INTERCEPTS:

visual ~ c(0, 0)*1 + c(alpha.1.g1, alpha.1.g2)*1
textual ~ c(0, 0)*1 + c(alpha.2.g1, alpha.2.g2)*1
speed ~ c(0, 0)*1 + c(alpha.3.g1, alpha.3.g2)*1

## COMMON-FACTOR VARIANCES:

visual ~~ c(1, 1)*visual + c(psi.1_1.g1, psi.1_1.g2)*visual
textual ~~ c(1, 1)*textual + c(psi.2_2.g1, psi.2_2.g2)*textual
speed ~~ c(1, 1)*speed + c(psi.3_3.g1, psi.3_3.g2)*speed

## COMMON-FACTOR COVARIANCES:

visual ~~ c(NA, NA)*textual + c(psi.2_1.g1, psi.2_1.g2)*textual
visual ~~ c(NA, NA)*speed + c(psi.3_1.g1, psi.3_1.g2)*speed
textual ~~ c(NA, NA)*speed + c(psi.3_2.g1, psi.3_2.g2)*speed</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>configuralInvarianceSyntax <span class="ot">&lt;-</span> <span class="fu">as.character</span>(configuralInvarianceModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="sec-measurementInvarianceConfiguralModelFeatures" class="level5" data-number="16.10.5.1.1"><h5 data-number="16.10.5.1.1" class="anchored" data-anchor-id="sec-measurementInvarianceConfiguralModelFeatures">
<span class="header-section-number">16.10.5.1.1</span> Summary of Model Features</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="fu">summary</span>(configuralInvarianceModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>This lavaan model syntax specifies a CFA with 9 manifest indicators of 3 common factor(s).

To identify the location and scale of each common factor, the factor means and variances were fixed to 0 and 1, respectively, unless equality constraints on measurement parameters allow them to be freed.

Pattern matrix indicating num(eric), ord(ered), and lat(ent) indicators per factor:

   visual textual speed
x1 num                 
x2 num                 
x3 num                 
x4        num          
x5        num          
x6        num          
x7                num  
x8                num  
x9                num  


This model hypothesizes only configural invariance.</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceConfiguralModelTabular" class="level5" data-number="16.10.5.1.2"><h5 data-number="16.10.5.1.2" class="anchored" data-anchor-id="sec-measurementInvarianceConfiguralModelTabular">
<span class="header-section-number">16.10.5.1.2</span> Model Syntax in Table Form</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="fu">lavaanify</span>(cfaModel, <span class="at">ngroups =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["lhs"],"name":[2],"type":["chr"],"align":["left"]},{"label":["op"],"name":[3],"type":["chr"],"align":["left"]},{"label":["rhs"],"name":[4],"type":["chr"],"align":["left"]},{"label":["user"],"name":[5],"type":["int"],"align":["right"]},{"label":["block"],"name":[6],"type":["int"],"align":["right"]},{"label":["group"],"name":[7],"type":["int"],"align":["right"]},{"label":["free"],"name":[8],"type":["int"],"align":["right"]},{"label":["ustart"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["exo"],"name":[10],"type":["int"],"align":["right"]},{"label":["label"],"name":[11],"type":["chr"],"align":["left"]},{"label":["plabel"],"name":[12],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"visual","3":"=~","4":"x1","5":"1","6":"1","7":"1","8":"1","9":"NA","10":"0","11":"","12":".p1."},{"1":"2","2":"visual","3":"=~","4":"x2","5":"1","6":"1","7":"1","8":"2","9":"NA","10":"0","11":"","12":".p2."},{"1":"3","2":"visual","3":"=~","4":"x3","5":"1","6":"1","7":"1","8":"3","9":"NA","10":"0","11":"","12":".p3."},{"1":"4","2":"textual","3":"=~","4":"x4","5":"1","6":"1","7":"1","8":"4","9":"NA","10":"0","11":"","12":".p4."},{"1":"5","2":"textual","3":"=~","4":"x5","5":"1","6":"1","7":"1","8":"5","9":"NA","10":"0","11":"","12":".p5."},{"1":"6","2":"textual","3":"=~","4":"x6","5":"1","6":"1","7":"1","8":"6","9":"NA","10":"0","11":"","12":".p6."},{"1":"7","2":"speed","3":"=~","4":"x7","5":"1","6":"1","7":"1","8":"7","9":"NA","10":"0","11":"","12":".p7."},{"1":"8","2":"speed","3":"=~","4":"x8","5":"1","6":"1","7":"1","8":"8","9":"NA","10":"0","11":"","12":".p8."},{"1":"9","2":"speed","3":"=~","4":"x9","5":"1","6":"1","7":"1","8":"9","9":"NA","10":"0","11":"","12":".p9."},{"1":"10","2":"x1","3":"~~","4":"x1","5":"0","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p10."},{"1":"11","2":"x2","3":"~~","4":"x2","5":"0","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p11."},{"1":"12","2":"x3","3":"~~","4":"x3","5":"0","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p12."},{"1":"13","2":"x4","3":"~~","4":"x4","5":"0","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p13."},{"1":"14","2":"x5","3":"~~","4":"x5","5":"0","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p14."},{"1":"15","2":"x6","3":"~~","4":"x6","5":"0","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p15."},{"1":"16","2":"x7","3":"~~","4":"x7","5":"0","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p16."},{"1":"17","2":"x8","3":"~~","4":"x8","5":"0","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p17."},{"1":"18","2":"x9","3":"~~","4":"x9","5":"0","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p18."},{"1":"19","2":"visual","3":"~~","4":"visual","5":"0","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p19."},{"1":"20","2":"textual","3":"~~","4":"textual","5":"0","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p20."},{"1":"21","2":"speed","3":"~~","4":"speed","5":"0","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p21."},{"1":"22","2":"visual","3":"=~","4":"x1","5":"1","6":"2","7":"2","8":"10","9":"NA","10":"0","11":"","12":".p22."},{"1":"23","2":"visual","3":"=~","4":"x2","5":"1","6":"2","7":"2","8":"11","9":"NA","10":"0","11":"","12":".p23."},{"1":"24","2":"visual","3":"=~","4":"x3","5":"1","6":"2","7":"2","8":"12","9":"NA","10":"0","11":"","12":".p24."},{"1":"25","2":"textual","3":"=~","4":"x4","5":"1","6":"2","7":"2","8":"13","9":"NA","10":"0","11":"","12":".p25."},{"1":"26","2":"textual","3":"=~","4":"x5","5":"1","6":"2","7":"2","8":"14","9":"NA","10":"0","11":"","12":".p26."},{"1":"27","2":"textual","3":"=~","4":"x6","5":"1","6":"2","7":"2","8":"15","9":"NA","10":"0","11":"","12":".p27."},{"1":"28","2":"speed","3":"=~","4":"x7","5":"1","6":"2","7":"2","8":"16","9":"NA","10":"0","11":"","12":".p28."},{"1":"29","2":"speed","3":"=~","4":"x8","5":"1","6":"2","7":"2","8":"17","9":"NA","10":"0","11":"","12":".p29."},{"1":"30","2":"speed","3":"=~","4":"x9","5":"1","6":"2","7":"2","8":"18","9":"NA","10":"0","11":"","12":".p30."},{"1":"31","2":"x1","3":"~~","4":"x1","5":"0","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p31."},{"1":"32","2":"x2","3":"~~","4":"x2","5":"0","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p32."},{"1":"33","2":"x3","3":"~~","4":"x3","5":"0","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p33."},{"1":"34","2":"x4","3":"~~","4":"x4","5":"0","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p34."},{"1":"35","2":"x5","3":"~~","4":"x5","5":"0","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p35."},{"1":"36","2":"x6","3":"~~","4":"x6","5":"0","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p36."},{"1":"37","2":"x7","3":"~~","4":"x7","5":"0","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p37."},{"1":"38","2":"x8","3":"~~","4":"x8","5":"0","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p38."},{"1":"39","2":"x9","3":"~~","4":"x9","5":"0","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p39."},{"1":"40","2":"visual","3":"~~","4":"visual","5":"0","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p40."},{"1":"41","2":"textual","3":"~~","4":"textual","5":"0","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p41."},{"1":"42","2":"speed","3":"~~","4":"speed","5":"0","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p42."}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="sec-measurementInvarianceConfiguralModelFit" class="level4" data-number="16.10.5.2"><h4 data-number="16.10.5.2" class="anchored" data-anchor-id="sec-measurementInvarianceConfiguralModelFit">
<span class="header-section-number">16.10.5.2</span> Fit the Model</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>configuralInvarianceModel_fit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(</span>
<span id="cb101-2"><a href="#cb101-2"></a>  configuralInvarianceSyntax,</span>
<span id="cb101-3"><a href="#cb101-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb101-4"><a href="#cb101-4"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb101-5"><a href="#cb101-5"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb101-6"><a href="#cb101-6"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a>configuralInvarianceModelFullSyntax_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb102-2"><a href="#cb102-2"></a>  cfaModel_configuralInvariance,</span>
<span id="cb102-3"><a href="#cb102-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb102-4"><a href="#cb102-4"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb102-5"><a href="#cb102-5"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb102-6"><a href="#cb102-6"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceConfiguralModelSummary" class="level4" data-number="16.10.5.3"><h4 data-number="16.10.5.3" class="anchored" data-anchor-id="sec-measurementInvarianceConfiguralModelSummary">
<span class="header-section-number">16.10.5.3</span> Model Summary</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="fu">summary</span>(</span>
<span id="cb103-2"><a href="#cb103-2"></a>  configuralInvarianceModel_fit,</span>
<span id="cb103-3"><a href="#cb103-3"></a>  <span class="at">fit.measures =</span> <span class="cn">TRUE</span>,</span>
<span id="cb103-4"><a href="#cb103-4"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb103-5"><a href="#cb103-5"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 64 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        60

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145
  Number of missing patterns per group:               
    Pasteur                                          9
    Grant-White                                      9

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               109.425     114.970
  Degrees of freedom                                48          48
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.952
    Yuan-Bentler correction (Mplus variant)                       
  Test statistic for each group:
    Pasteur                                     63.000      63.000
    Grant-White                                 51.970      51.970

Model Test Baseline Model:

  Test statistic                               932.665     909.019
  Degrees of freedom                                72          72
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.026

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.929       0.920
  Tucker-Lewis Index (TLI)                       0.893       0.880
                                                                  
  Robust Comparative Fit Index (CFI)                         0.929
  Robust Tucker-Lewis Index (TLI)                            0.893

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3648.833   -3648.833
  Scaling correction factor                                  1.100
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -3594.120   -3594.120
  Scaling correction factor                                  1.034
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                                7417.666    7417.666
  Bayesian (BIC)                              7640.092    7640.092
  Sample-size adjusted Bayesian (SABIC)       7449.806    7449.806

Root Mean Square Error of Approximation:

  RMSEA                                          0.092       0.096
  90 Percent confidence interval - lower         0.069       0.073
  90 Percent confidence interval - upper         0.115       0.120
  P-value H_0: RMSEA &lt;= 0.050                    0.002       0.001
  P-value H_0: RMSEA &gt;= 0.080                    0.821       0.883
                                                                  
  Robust RMSEA                                               0.093
  90 Percent confidence interval - lower                     0.070
  90 Percent confidence interval - upper                     0.117
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.002
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.833

Standardized Root Mean Square Residual:

  SRMR                                           0.066       0.066

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (l.1_)    0.999    0.172    5.810    0.000    0.999    0.846
    x2      (l.2_)    0.443    0.147    3.022    0.003    0.443    0.361
    x3      (l.3_)    0.624    0.134    4.662    0.000    0.624    0.541
  textual =~                                                            
    x4      (l.4_)    0.922    0.085   10.830    0.000    0.922    0.811
    x5      (l.5_)    1.126    0.072   15.723    0.000    1.126    0.864
    x6      (l.6_)    0.833    0.081   10.242    0.000    0.833    0.843
  speed =~                                                              
    x7      (l.7_)    0.570    0.119    4.790    0.000    0.570    0.527
    x8      (l.8_)    0.676    0.110    6.133    0.000    0.676    0.688
    x9      (l.9_)    0.587    0.118    4.998    0.000    0.587    0.589

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textul  (p.2_)    0.473    0.095    4.951    0.000    0.473    0.473
    speed  (p.3_1)    0.319    0.148    2.150    0.032    0.319    0.319
  textual ~~                                                            
    speed  (p.3_2)    0.311    0.100    3.099    0.002    0.311    0.311

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (n.1.)    4.947    0.095   52.269    0.000    4.947    4.191
   .x2      (n.2.)    5.984    0.098   60.949    0.000    5.984    4.880
   .x3      (n.3.)    2.510    0.093   26.912    0.000    2.510    2.178
   .x4      (n.4.)    2.814    0.091   30.873    0.000    2.814    2.476
   .x5      (n.5.)    4.002    0.105   38.256    0.000    4.002    3.070
   .x6      (n.6.)    1.929    0.079   24.376    0.000    1.929    1.953
   .x7      (n.7.)    4.439    0.087   51.126    0.000    4.439    4.104
   .x8      (n.8.)    5.563    0.079   70.133    0.000    5.563    5.663
   .x9      (n.9.)    5.426    0.080   67.537    0.000    5.426    5.443
    visual  (a.1.)    0.000                               0.000    0.000
    textual (a.2.)    0.000                               0.000    0.000
    speed   (a.3.)    0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (t.1_)    0.396    0.298    1.330    0.183    0.396    0.284
   .x2      (t.2_)    1.308    0.175    7.482    0.000    1.308    0.870
   .x3      (t.3_)    0.939    0.158    5.959    0.000    0.939    0.707
   .x4      (t.4_)    0.441    0.072    6.091    0.000    0.441    0.342
   .x5      (t.5_)    0.431    0.083    5.169    0.000    0.431    0.254
   .x6      (t.6_)    0.282    0.056    5.063    0.000    0.282    0.289
   .x7      (t.7_)    0.845    0.132    6.394    0.000    0.845    0.723
   .x8      (t.8_)    0.509    0.109    4.673    0.000    0.509    0.527
   .x9      (t.9_)    0.649    0.134    4.824    0.000    0.649    0.653
    visual  (p.1_)    1.000                               1.000    1.000
    textual (p.2_)    1.000                               1.000    1.000
    speed   (p.3_)    1.000                               1.000    1.000

R-Square:
                   Estimate
    x1                0.716
    x2                0.130
    x3                0.293
    x4                0.658
    x5                0.746
    x6                0.711
    x7                0.277
    x8                0.473
    x9                0.347


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (l.1_)    0.781    0.128    6.099    0.000    0.781    0.679
    x2      (l.2_)    0.566    0.103    5.489    0.000    0.566    0.510
    x3      (l.3_)    0.717    0.100    7.165    0.000    0.717    0.690
  textual =~                                                            
    x4      (l.4_)    0.958    0.083   11.489    0.000    0.958    0.856
    x5      (l.5_)    0.973    0.090   10.798    0.000    0.973    0.835
    x6      (l.6_)    0.947    0.088   10.753    0.000    0.947    0.830
  speed =~                                                              
    x7      (l.7_)    0.672    0.090    7.446    0.000    0.672    0.649
    x8      (l.8_)    0.833    0.112    7.447    0.000    0.833    0.796
    x9      (l.9_)    0.732    0.124    5.924    0.000    0.732    0.714

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textul  (p.2_)    0.545    0.096    5.648    0.000    0.545    0.545
    speed  (p.3_1)    0.531    0.148    3.593    0.000    0.531    0.531
  textual ~~                                                            
    speed  (p.3_2)    0.339    0.142    2.392    0.017    0.339    0.339

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (n.1.)    4.929    0.096   51.433    0.000    4.929    4.286
   .x2      (n.2.)    6.198    0.092   67.052    0.000    6.198    5.587
   .x3      (n.3.)    1.992    0.086   23.048    0.000    1.992    1.916
   .x4      (n.4.)    3.317    0.093   35.551    0.000    3.317    2.966
   .x5      (n.5.)    4.712    0.096   49.039    0.000    4.712    4.045
   .x6      (n.6.)    2.466    0.094   26.150    0.000    2.466    2.163
   .x7      (n.7.)    3.923    0.087   45.300    0.000    3.923    3.793
   .x8      (n.8.)    5.488    0.087   63.174    0.000    5.488    5.246
   .x9      (n.9.)    5.338    0.085   62.640    0.000    5.338    5.210
    visual  (a.1.)    0.000                               0.000    0.000
    textual (a.2.)    0.000                               0.000    0.000
    speed   (a.3.)    0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (t.1_)    0.712    0.183    3.884    0.000    0.712    0.538
   .x2      (t.2_)    0.911    0.143    6.364    0.000    0.911    0.740
   .x3      (t.3_)    0.566    0.123    4.601    0.000    0.566    0.524
   .x4      (t.4_)    0.333    0.066    5.025    0.000    0.333    0.267
   .x5      (t.5_)    0.411    0.074    5.570    0.000    0.411    0.303
   .x6      (t.6_)    0.404    0.078    5.182    0.000    0.404    0.311
   .x7      (t.7_)    0.619    0.101    6.105    0.000    0.619    0.578
   .x8      (t.8_)    0.401    0.160    2.512    0.012    0.401    0.366
   .x9      (t.9_)    0.514    0.140    3.684    0.000    0.514    0.490
    visual  (p.1_)    1.000                               1.000    1.000
    textual (p.2_)    1.000                               1.000    1.000
    speed   (p.3_)    1.000                               1.000    1.000

R-Square:
                   Estimate
    x1                0.462
    x2                0.260
    x3                0.476
    x4                0.733
    x5                0.697
    x6                0.689
    x7                0.422
    x8                0.634
    x9                0.510</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="fu">summary</span>(</span>
<span id="cb105-2"><a href="#cb105-2"></a>  configuralInvarianceModelFullSyntax_fit,</span>
<span id="cb105-3"><a href="#cb105-3"></a>  <span class="at">fit.measures =</span> <span class="cn">TRUE</span>,</span>
<span id="cb105-4"><a href="#cb105-4"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb105-5"><a href="#cb105-5"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 64 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        60

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145
  Number of missing patterns per group:               
    Pasteur                                          9
    Grant-White                                      9

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               109.425     114.970
  Degrees of freedom                                48          48
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.952
    Yuan-Bentler correction (Mplus variant)                       
  Test statistic for each group:
    Pasteur                                     63.000      63.000
    Grant-White                                 51.970      51.970

Model Test Baseline Model:

  Test statistic                               932.665     909.019
  Degrees of freedom                                72          72
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.026

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.929       0.920
  Tucker-Lewis Index (TLI)                       0.893       0.880
                                                                  
  Robust Comparative Fit Index (CFI)                         0.929
  Robust Tucker-Lewis Index (TLI)                            0.893

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3648.833   -3648.833
  Scaling correction factor                                  1.100
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -3594.120   -3594.120
  Scaling correction factor                                  1.034
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                                7417.666    7417.666
  Bayesian (BIC)                              7640.092    7640.092
  Sample-size adjusted Bayesian (SABIC)       7449.806    7449.806

Root Mean Square Error of Approximation:

  RMSEA                                          0.092       0.096
  90 Percent confidence interval - lower         0.069       0.073
  90 Percent confidence interval - upper         0.115       0.120
  P-value H_0: RMSEA &lt;= 0.050                    0.002       0.001
  P-value H_0: RMSEA &gt;= 0.080                    0.821       0.883
                                                                  
  Robust RMSEA                                               0.093
  90 Percent confidence interval - lower                     0.070
  90 Percent confidence interval - upper                     0.117
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.002
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.833

Standardized Root Mean Square Residual:

  SRMR                                           0.066       0.066

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1                0.999    0.172    5.810    0.000    0.999    0.846
    x2                0.443    0.147    3.022    0.003    0.443    0.361
    x3                0.624    0.134    4.662    0.000    0.624    0.541
  textual =~                                                            
    x4                0.922    0.085   10.830    0.000    0.922    0.811
    x5                1.126    0.072   15.723    0.000    1.126    0.864
    x6                0.833    0.081   10.242    0.000    0.833    0.843
  speed =~                                                              
    x7                0.570    0.119    4.790    0.000    0.570    0.527
    x8                0.676    0.110    6.133    0.000    0.676    0.688
    x9                0.587    0.118    4.998    0.000    0.587    0.589

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textual           0.473    0.095    4.951    0.000    0.473    0.473
    speed             0.319    0.148    2.150    0.032    0.319    0.319
  textual ~~                                                            
    speed             0.311    0.100    3.099    0.002    0.311    0.311

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            0.000                               0.000    0.000
    textual           0.000                               0.000    0.000
    speed             0.000                               0.000    0.000
   .x1                4.947    0.095   52.269    0.000    4.947    4.191
   .x2                5.984    0.098   60.949    0.000    5.984    4.880
   .x3                2.510    0.093   26.912    0.000    2.510    2.178
   .x4                2.814    0.091   30.873    0.000    2.814    2.476
   .x5                4.002    0.105   38.256    0.000    4.002    3.070
   .x6                1.929    0.079   24.376    0.000    1.929    1.953
   .x7                4.439    0.087   51.126    0.000    4.439    4.104
   .x8                5.563    0.079   70.133    0.000    5.563    5.663
   .x9                5.426    0.080   67.537    0.000    5.426    5.443

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            1.000                               1.000    1.000
    textual           1.000                               1.000    1.000
    speed             1.000                               1.000    1.000
   .x1                0.396    0.298    1.330    0.183    0.396    0.284
   .x2                1.308    0.175    7.482    0.000    1.308    0.870
   .x3                0.939    0.158    5.959    0.000    0.939    0.707
   .x4                0.441    0.072    6.091    0.000    0.441    0.342
   .x5                0.431    0.083    5.169    0.000    0.431    0.254
   .x6                0.282    0.056    5.063    0.000    0.282    0.289
   .x7                0.845    0.132    6.394    0.000    0.845    0.723
   .x8                0.509    0.109    4.673    0.000    0.509    0.527
   .x9                0.649    0.134    4.824    0.000    0.649    0.653

R-Square:
                   Estimate
    x1                0.716
    x2                0.130
    x3                0.293
    x4                0.658
    x5                0.746
    x6                0.711
    x7                0.277
    x8                0.473
    x9                0.347


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1                0.781    0.128    6.099    0.000    0.781    0.679
    x2                0.566    0.103    5.489    0.000    0.566    0.510
    x3                0.717    0.100    7.165    0.000    0.717    0.690
  textual =~                                                            
    x4                0.958    0.083   11.489    0.000    0.958    0.856
    x5                0.973    0.090   10.798    0.000    0.973    0.835
    x6                0.947    0.088   10.753    0.000    0.947    0.830
  speed =~                                                              
    x7                0.672    0.090    7.446    0.000    0.672    0.649
    x8                0.833    0.112    7.447    0.000    0.833    0.796
    x9                0.732    0.124    5.924    0.000    0.732    0.714

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textual           0.545    0.096    5.648    0.000    0.545    0.545
    speed             0.531    0.148    3.593    0.000    0.531    0.531
  textual ~~                                                            
    speed             0.339    0.142    2.392    0.017    0.339    0.339

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            0.000                               0.000    0.000
    textual           0.000                               0.000    0.000
    speed             0.000                               0.000    0.000
   .x1                4.929    0.096   51.433    0.000    4.929    4.286
   .x2                6.198    0.092   67.052    0.000    6.198    5.587
   .x3                1.992    0.086   23.048    0.000    1.992    1.916
   .x4                3.317    0.093   35.551    0.000    3.317    2.966
   .x5                4.712    0.096   49.039    0.000    4.712    4.045
   .x6                2.466    0.094   26.150    0.000    2.466    2.163
   .x7                3.923    0.087   45.300    0.000    3.923    3.793
   .x8                5.488    0.087   63.174    0.000    5.488    5.246
   .x9                5.338    0.085   62.640    0.000    5.338    5.210

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            1.000                               1.000    1.000
    textual           1.000                               1.000    1.000
    speed             1.000                               1.000    1.000
   .x1                0.712    0.183    3.884    0.000    0.712    0.538
   .x2                0.911    0.143    6.364    0.000    0.911    0.740
   .x3                0.566    0.123    4.601    0.000    0.566    0.524
   .x4                0.333    0.066    5.025    0.000    0.333    0.267
   .x5                0.411    0.074    5.570    0.000    0.411    0.303
   .x6                0.404    0.078    5.182    0.000    0.404    0.311
   .x7                0.619    0.101    6.105    0.000    0.619    0.578
   .x8                0.401    0.160    2.512    0.012    0.401    0.366
   .x9                0.514    0.140    3.684    0.000    0.514    0.490

R-Square:
                   Estimate
    x1                0.462
    x2                0.260
    x3                0.476
    x4                0.733
    x5                0.697
    x6                0.689
    x7                0.422
    x8                0.634
    x9                0.510</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceConfiguralModelFitCriteria" class="level4" data-number="16.10.5.4"><h4 data-number="16.10.5.4" class="anchored" data-anchor-id="sec-measurementInvarianceConfiguralModelFitCriteria">
<span class="header-section-number">16.10.5.4</span> Model Fit</h4>
<p>You can specify the null model as the baseline model using: <code>baseline.model = nullModelFit</code></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="fu">fitMeasures</span>(configuralInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                         npar                          fmin 
                       60.000                         0.182 
                        chisq                            df 
                      109.425                        48.000 
                       pvalue                  chisq.scaled 
                        0.000                       114.970 
                    df.scaled                 pvalue.scaled 
                       48.000                         0.000 
         chisq.scaling.factor                baseline.chisq 
                        0.952                       932.665 
                  baseline.df               baseline.pvalue 
                       72.000                         0.000 
        baseline.chisq.scaled            baseline.df.scaled 
                      909.019                        72.000 
       baseline.pvalue.scaled baseline.chisq.scaling.factor 
                        0.000                         1.026 
                          cfi                           tli 
                        0.929                         0.893 
                   cfi.scaled                    tli.scaled 
                        0.920                         0.880 
                   cfi.robust                    tli.robust 
                        0.929                         0.893 
                         nnfi                           rfi 
                        0.893                         0.824 
                          nfi                          pnfi 
                        0.883                         0.588 
                          ifi                           rni 
                        0.931                         0.929 
                  nnfi.scaled                    rfi.scaled 
                        0.880                         0.810 
                   nfi.scaled                   pnfi.scaled 
                        0.874                         0.582 
                   ifi.scaled                    rni.scaled 
                        0.922                         0.920 
                  nnfi.robust                    rni.robust 
                        0.893                         0.929 
                         logl             unrestricted.logl 
                    -3648.833                     -3594.120 
                          aic                           bic 
                     7417.666                      7640.092 
                       ntotal                          bic2 
                      301.000                      7449.806 
            scaling.factor.h1             scaling.factor.h0 
                        1.034                         1.100 
                        rmsea                rmsea.ci.lower 
                        0.092                         0.069 
               rmsea.ci.upper                rmsea.ci.level 
                        0.115                         0.900 
                 rmsea.pvalue                rmsea.close.h0 
                        0.002                         0.050 
        rmsea.notclose.pvalue             rmsea.notclose.h0 
                        0.821                         0.080 
                 rmsea.scaled         rmsea.ci.lower.scaled 
                        0.096                         0.073 
        rmsea.ci.upper.scaled           rmsea.pvalue.scaled 
                        0.120                         0.001 
 rmsea.notclose.pvalue.scaled                  rmsea.robust 
                        0.883                         0.093 
        rmsea.ci.lower.robust         rmsea.ci.upper.robust 
                        0.070                         0.117 
          rmsea.pvalue.robust  rmsea.notclose.pvalue.robust 
                        0.002                         0.833 
                          rmr                    rmr_nomean 
                        0.081                         0.089 
                         srmr                  srmr_bentler 
                        0.066                         0.066 
          srmr_bentler_nomean                          crmr 
                        0.072                         0.072 
                  crmr_nomean                    srmr_mplus 
                        0.080                         0.066 
            srmr_mplus_nomean                         cn_05 
                        0.072                       180.268 
                        cn_01                           gfi 
                      203.682                         0.995 
                         agfi                          pgfi 
                        0.989                         0.442 
                          mfi                          ecvi 
                        0.903                         0.762 
attr(,"scaled.test")
[1] "yuan.bentler.mplus"</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>configuralInvarianceModelFitIndices <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb109-2"><a href="#cb109-2"></a>  configuralInvarianceModel_fit)[<span class="fu">c</span>(</span>
<span id="cb109-3"><a href="#cb109-3"></a>    <span class="st">"cfi.robust"</span>, <span class="st">"rmsea.robust"</span>, <span class="st">"srmr"</span>)]</span>
<span id="cb109-4"><a href="#cb109-4"></a></span>
<span id="cb109-5"><a href="#cb109-5"></a>configuralInvarianceModel_chisquare <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb109-6"><a href="#cb109-6"></a>  configuralInvarianceModel_fit)[<span class="fu">c</span>(<span class="st">"chisq.scaled"</span>)]</span>
<span id="cb109-7"><a href="#cb109-7"></a></span>
<span id="cb109-8"><a href="#cb109-8"></a>configuralInvarianceModel_chisquareScaling <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb109-9"><a href="#cb109-9"></a>  configuralInvarianceModel_fit)[<span class="fu">c</span>(<span class="st">"chisq.scaling.factor"</span>)]</span>
<span id="cb109-10"><a href="#cb109-10"></a></span>
<span id="cb109-11"><a href="#cb109-11"></a>configuralInvarianceModel_df <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb109-12"><a href="#cb109-12"></a>  configuralInvarianceModel_fit)[<span class="fu">c</span>(<span class="st">"df.scaled"</span>)]</span>
<span id="cb109-13"><a href="#cb109-13"></a></span>
<span id="cb109-14"><a href="#cb109-14"></a>configuralInvarianceModel_N <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(</span>
<span id="cb109-15"><a href="#cb109-15"></a>  configuralInvarianceModel_fit,</span>
<span id="cb109-16"><a href="#cb109-16"></a>  <span class="at">what =</span> <span class="st">"ntotal"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceConfiguralModelEffectSize" class="level4" data-number="16.10.5.5"><h4 data-number="16.10.5.5" class="anchored" data-anchor-id="sec-measurementInvarianceConfiguralModelEffectSize">
<span class="header-section-number">16.10.5.5</span> Effect Size of Non-Invariancee</h4>
<p>The effect size of measurement non-invariance, as described by <span class="citation" data-cites="Nye2019">Nye et al. (<a href="references.html#ref-Nye2019" role="doc-biblioref">2019</a>)</span>, was calculated using the <code>dmacs</code> package <span class="citation" data-cites="R-dmacs">(<a href="references.html#ref-R-dmacs" role="doc-biblioref">Dueber, 2019</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="fu">lavaan_dmacs</span>(configuralInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$DMACS
      visual   textual     speed
x1 0.1865718        NA        NA
x2 0.2102487        NA        NA
x3 0.4774264        NA        NA
x4        NA 0.4450412        NA
x5        NA 0.5889006        NA
x6        NA 0.5196869        NA
x7        NA        NA 0.4941585
x8        NA        NA 0.1714779
x9        NA        NA 0.1669673

$ItemDeltaMean
        visual   textual       speed
x1 -0.01829609        NA          NA
x2  0.21407860        NA          NA
x3 -0.51808612        NA          NA
x4          NA 0.5031129          NA
x5          NA 0.7100353          NA
x6          NA 0.5368256          NA
x7          NA        NA -0.51547978
x8          NA        NA -0.07512450
x9          NA        NA -0.08770776

$MeanDiff
    visual    textual      speed 
-0.3223036  1.7499738 -0.6783120 </code></pre>
</div>
</div>
<p>The <span class="math inline">\(w\)</span> and <span class="math inline">\(\Delta \text{M}_\text{C}\)</span> indices of the effect size of measurement non-invariance, as described by <span class="citation" data-cites="Newsom2015">Newsom (<a href="references.html#ref-Newsom2015" role="doc-biblioref">2015</a>)</span>, were calculated using the <code>measurementNoninvarianceEffectSize()</code> function of the <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a>petersenlab<span class="sc">::</span><span class="fu">measurementNoninvarianceEffectSize</span>(</span>
<span id="cb112-2"><a href="#cb112-2"></a>  <span class="at">model_unconstrained =</span> nullModelFit,</span>
<span id="cb112-3"><a href="#cb112-3"></a>  <span class="at">model_constrained =</span> configuralInvarianceModel_fit</span>
<span id="cb112-4"><a href="#cb112-4"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$Mc_unconstrained
[1] 0.207235

$Mc_constrained
[1] 0.9026906

$Delta_Mc
[1] -0.6954556

$w
[1] 0.270485</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceConfiguralModelEquivalenceTest" class="level4" data-number="16.10.5.6"><h4 data-number="16.10.5.6" class="anchored" data-anchor-id="sec-measurementInvarianceConfiguralModelEquivalenceTest">
<span class="header-section-number">16.10.5.6</span> Equivalence Test</h4>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>equiv_chi()</code> function from <span class="citation" data-cites="Counsell2020">Counsell et al. (<a href="references.html#ref-Counsell2020" role="doc-biblioref">2020</a>)</span> that performs an equivalence test: <a href="https://osf.io/cqu8v" class="uri">https://osf.io/cqu8v</a>. An equivalence test evaluates the null hypothesis that a model is equivalent to another model. In this case, the equivalence test evaluates the null hypothesis that a model is equivalent to another model in terms of (poor) fit. Here, we operationalize a mediocre-fitting model as a model whose RMSEA is .08 or greater. So, the equivalence test evaluates whether our invariance model fits significantly better than a mediocre-fitting model. Thus, a statistically significant <em>p</em>-value indicates that our invariance model fits significantly better than the mediocre-fitting model (i.e., that invariance is established), whereas a non-significant <em>p</em>-value indicates that our invariance model does not fit significantly better than the mediocre-fitting model (i.e., that invariance is failed).</p>
<p>The chi-square equivalence test is non-significant, suggesting that the model fit of the configural invariance model is not acceptable (i.e., it is not better than the mediocre-fitting model). In other words, configural invariance failed.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a><span class="fu">equiv_chi</span>(</span>
<span id="cb114-2"><a href="#cb114-2"></a>  <span class="at">alpha =</span> .<span class="dv">05</span>,</span>
<span id="cb114-3"><a href="#cb114-3"></a>  <span class="at">chi =</span> configuralInvarianceModel_chisquare,</span>
<span id="cb114-4"><a href="#cb114-4"></a>  <span class="at">df =</span> configuralInvarianceModel_df,</span>
<span id="cb114-5"><a href="#cb114-5"></a>  <span class="at">m =</span> <span class="dv">2</span>,</span>
<span id="cb114-6"><a href="#cb114-6"></a>  <span class="at">N_sample =</span> configuralInvarianceModel_N,</span>
<span id="cb114-7"><a href="#cb114-7"></a>  <span class="at">popRMSEA =</span> .<span class="dv">08</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["chi"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Fml"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["popep"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["popdelt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pval"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"114.9699","2":"0.3845147","3":"0.1536","4":"45.9264","5":"0.8914912","_rn_":"chisq.scaled"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceConfiguralModelPermutationTest" class="level4" data-number="16.10.5.7"><h4 data-number="16.10.5.7" class="anchored" data-anchor-id="sec-measurementInvarianceConfiguralModelPermutationTest">
<span class="header-section-number">16.10.5.7</span> Permutation Test</h4>
<p>Permutation procedures for testing measurement invariance are described in <span class="citation" data-cites="Jorgensen2018">Jorgensen et al. (<a href="references.html#ref-Jorgensen2018" role="doc-biblioref">2018</a>)</span>. The permutation test evaluates the null hypothesis that the model fit is not worse than the best-possible fitting model. A significant <em>p</em>-value indicates that the model fits significanlty worse than the best-possible fitting model. A non-significant <em>p</em>-value indicates that the model does not fit significantly worse than the best-possible fitting model.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>numPermutations <span class="ot">&lt;-</span> <span class="dv">100</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>For reproducibility, I set the seed below. Using the same seed will yield the same answer every time. There is nothing special about this particular seed. You can specify the null model as the baseline model using: <code>baseline.model = nullModelFit</code>. <strong>Warning</strong>: this code takes a while to run based on <span class="math inline">\(100\)</span> iterations. You can reduce the number of iterations to be faster.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb116-2"><a href="#cb116-2"></a>configuralInvarianceTest <span class="ot">&lt;-</span> <span class="fu">permuteMeasEq</span>(</span>
<span id="cb116-3"><a href="#cb116-3"></a>  <span class="at">nPermute =</span> numPermutations,</span>
<span id="cb116-4"><a href="#cb116-4"></a>  <span class="at">modelType =</span> <span class="st">"mgcfa"</span>,</span>
<span id="cb116-5"><a href="#cb116-5"></a>  <span class="at">con =</span> configuralInvarianceModel_fit,</span>
<span id="cb116-6"><a href="#cb116-6"></a>  <span class="at">uncon =</span> <span class="cn">NULL</span>,</span>
<span id="cb116-7"><a href="#cb116-7"></a>  <span class="at">AFIs =</span> myAFIs,</span>
<span id="cb116-8"><a href="#cb116-8"></a>  <span class="at">moreAFIs =</span> moreAFIs,</span>
<span id="cb116-9"><a href="#cb116-9"></a>  <span class="at">parallelType =</span> <span class="st">"multicore"</span>, <span class="co">#only 'snow' works on Windows, but right now, it is throwing an error</span></span>
<span id="cb116-10"><a href="#cb116-10"></a>  <span class="at">iseed =</span> <span class="dv">52242</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="fu">RNGkind</span>(<span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>)</span>
<span id="cb117-2"><a href="#cb117-2"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb117-3"><a href="#cb117-3"></a></span>
<span id="cb117-4"><a href="#cb117-4"></a>configuralInvarianceTest</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Omnibus p value based on parametric chi-squared difference test:

Chisq diff    Df diff Pr(&gt;Chisq) 
    114.97      48.00       0.00 


Omnibus p values based on nonparametric permutation method: 

             AFI.Difference p.value
chisq               109.425    0.17
chisq.scaled        114.970    0.15
rmsea                 0.092    0.17
cfi                   0.929    0.15
tli                   0.893    0.15
srmr                  0.066    0.15
rmsea.robust          0.093    0.15
cfi.robust            0.929    0.14
tli.robust            0.893    0.14</code></pre>
</div>
</div>
<p>The <em>p</em>-values are non-significant, indicating that the model does not fit significantly worse than the best-possible fitting model. In other words, configural invariance held.</p>
</section><section id="sec-measurementInvarianceReliability" class="level4" data-number="16.10.5.8"><h4 data-number="16.10.5.8" class="anchored" data-anchor-id="sec-measurementInvarianceReliability">
<span class="header-section-number">16.10.5.8</span> Internal Consistency Reliability</h4>
<p><a href="reliability.html#sec-internalConsistency-reliability">Internal consistency reliability</a> of items composing the latent factors, as quantified by <a href="reliability.html#sec-coefficientOmega">omega (<span class="math inline">\(\omega\)</span>)</a>, <a href="reliability.html#sec-averageVarianceExtracted">average variance extracted</a> (AVE), and <a href="reliability.html#sec-maximalReliability">maximal reliability</a>, was estimated using the <code>semTools</code> package <span class="citation" data-cites="R-semTools">(<a href="references.html#ref-R-semTools" role="doc-biblioref">Jorgensen et al., 2021</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="fu">compRelSEM</span>(configuralInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$visual

Composite `visual` is composed of observed variables:
    x1, x2, x3
True-score variance is represented by common factor(s):
    visual
Total variance of composite `visual` determined from the unrestricted model.
The proportion attributable to "true" scores is its model-based estimate of reliability ("omega"):

    Pasteur Grant-White 
      0.592       0.659 

$textual

Composite `textual` is composed of observed variables:
    x4, x5, x6
True-score variance is represented by common factor(s):
    textual
Total variance of composite `textual` determined from the unrestricted model.
The proportion attributable to "true" scores is its model-based estimate of reliability ("omega"):

    Pasteur Grant-White 
      0.874       0.877 

$speed

Composite `speed` is composed of observed variables:
    x7, x8, x9
True-score variance is represented by common factor(s):
    speed
Total variance of composite `speed` determined from the unrestricted model.
The proportion attributable to "true" scores is its model-based estimate of reliability ("omega"):

    Pasteur Grant-White 
      0.627       0.770 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="fu">AVE</span>(configuralInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["chr"],"align":["left"]},{"label":["visual"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["textual"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["speed"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Pasteur","2":"0.3740814","3":"0.7069305","4":"0.3596373"},{"1":"Grant-White","2":"0.3983114","3":"0.7054973","4":"0.5231958"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a><span class="fu">maximalRelia</span>(configuralInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$Pasteur
[1] 0.9201301
attr(,"weight")
        x1         x2         x3         x4         x5         x6         x7 
 2.1308213  0.5595102  1.2621806  0.6109797  2.7953979  0.7275908  0.7260517 
        x8         x9 
 1.0132695 -0.8258018 

$`Grant-White`
[1] 0.9430154
attr(,"weight")
        x1         x2         x3         x4         x5         x6         x7 
 0.8125219  0.7309533  0.7822316  2.5796196  2.0168209  1.9592612 -0.1069427 
        x8         x9 
 2.0091972 -1.7836629 </code></pre>
</div>
</div>
</section><section id="sec-measurementInvariancePathDiagram" class="level4" data-number="16.10.5.9"><h4 data-number="16.10.5.9" class="anchored" data-anchor-id="sec-measurementInvariancePathDiagram">
<span class="header-section-number">16.10.5.9</span> Path Diagram</h4>
<p>A path diagram of the model generated using the <code>semPlot</code> package <span class="citation" data-cites="R-semPlot">(<a href="references.html#ref-R-semPlot" role="doc-biblioref">Epskamp, 2022</a>)</span> is in the figures below (“1” = group 1; “2” = group 2).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a><span class="fu">semPaths</span>(</span>
<span id="cb124-2"><a href="#cb124-2"></a>  configuralInvarianceModel_fit,</span>
<span id="cb124-3"><a href="#cb124-3"></a>  <span class="at">what =</span> <span class="st">"est"</span>,</span>
<span id="cb124-4"><a href="#cb124-4"></a>  <span class="at">layout =</span> <span class="st">"tree2"</span>,</span>
<span id="cb124-5"><a href="#cb124-5"></a>  <span class="at">ask =</span> <span class="cn">FALSE</span>,</span>
<span id="cb124-6"><a href="#cb124-6"></a>  <span class="at">edge.label.cex =</span> <span class="fl">1.2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-measurementInvariancePathDiagram-1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Configural Invariance Model in Confirmatory Factor Analysis (1 = Group 1; 2 = Group 2).">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-measurementInvariancePathDiagram-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-measurementInvariancePathDiagram-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-55" title="Figure&nbsp;16.58: Configural Invariance Model in Confirmatory Factor Analysis (1 = Group 1; 2 = Group 2)."><img src="test-bias_files/figure-html/fig-measurementInvariancePathDiagram-1.png" class="img-fluid figure-img" alt="Configural Invariance Model in Confirmatory Factor Analysis (1 = Group 1; 2 = Group 2)." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-measurementInvariancePathDiagram-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.58: Configural Invariance Model in Confirmatory Factor Analysis (1 = Group 1; 2 = Group 2).
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-measurementInvariancePathDiagram-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Configural Invariance Model in Confirmatory Factor Analysis (1 = Group 1; 2 = Group 2).">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-measurementInvariancePathDiagram-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-measurementInvariancePathDiagram-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-56" title="Figure&nbsp;16.59: Configural Invariance Model in Confirmatory Factor Analysis (1 = Group 1; 2 = Group 2)."><img src="test-bias_files/figure-html/fig-measurementInvariancePathDiagram-2.png" class="img-fluid figure-img" alt="Configural Invariance Model in Confirmatory Factor Analysis (1 = Group 1; 2 = Group 2)." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-measurementInvariancePathDiagram-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.59: Configural Invariance Model in Confirmatory Factor Analysis (1 = Group 1; 2 = Group 2).
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-measurementInvarianceMetricModel" class="level3" data-number="16.10.6"><h3 data-number="16.10.6" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModel">
<span class="header-section-number">16.10.6</span> Metric (“Weak Factorial”) Invariance Model</h3>
<p>Specify invariance of factor loadings across groups.</p>
<section id="sec-measurementInvarianceMetricModelSyntax" class="level4" data-number="16.10.6.1"><h4 data-number="16.10.6.1" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelSyntax">
<span class="header-section-number">16.10.6.1</span> Model Syntax</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>metricInvarianceModel <span class="ot">&lt;-</span> <span class="fu">measEq.syntax</span>(</span>
<span id="cb125-2"><a href="#cb125-2"></a>  <span class="at">configural.model =</span> cfaModel,</span>
<span id="cb125-3"><a href="#cb125-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb125-4"><a href="#cb125-4"></a>  <span class="at">ID.fac =</span> <span class="st">"std.lv"</span>,</span>
<span id="cb125-5"><a href="#cb125-5"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb125-6"><a href="#cb125-6"></a>  <span class="at">group.equal =</span> <span class="st">"loadings"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a><span class="fu">cat</span>(<span class="fu">as.character</span>(metricInvarianceModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>## LOADINGS:

visual =~ c(NA, NA)*x1 + c(lambda.1_1, lambda.1_1)*x1
visual =~ c(NA, NA)*x2 + c(lambda.2_1, lambda.2_1)*x2
visual =~ c(NA, NA)*x3 + c(lambda.3_1, lambda.3_1)*x3
textual =~ c(NA, NA)*x4 + c(lambda.4_2, lambda.4_2)*x4
textual =~ c(NA, NA)*x5 + c(lambda.5_2, lambda.5_2)*x5
textual =~ c(NA, NA)*x6 + c(lambda.6_2, lambda.6_2)*x6
speed =~ c(NA, NA)*x7 + c(lambda.7_3, lambda.7_3)*x7
speed =~ c(NA, NA)*x8 + c(lambda.8_3, lambda.8_3)*x8
speed =~ c(NA, NA)*x9 + c(lambda.9_3, lambda.9_3)*x9

## INTERCEPTS:

x1 ~ c(NA, NA)*1 + c(nu.1.g1, nu.1.g2)*1
x2 ~ c(NA, NA)*1 + c(nu.2.g1, nu.2.g2)*1
x3 ~ c(NA, NA)*1 + c(nu.3.g1, nu.3.g2)*1
x4 ~ c(NA, NA)*1 + c(nu.4.g1, nu.4.g2)*1
x5 ~ c(NA, NA)*1 + c(nu.5.g1, nu.5.g2)*1
x6 ~ c(NA, NA)*1 + c(nu.6.g1, nu.6.g2)*1
x7 ~ c(NA, NA)*1 + c(nu.7.g1, nu.7.g2)*1
x8 ~ c(NA, NA)*1 + c(nu.8.g1, nu.8.g2)*1
x9 ~ c(NA, NA)*1 + c(nu.9.g1, nu.9.g2)*1

## UNIQUE-FACTOR VARIANCES:

x1 ~~ c(NA, NA)*x1 + c(theta.1_1.g1, theta.1_1.g2)*x1
x2 ~~ c(NA, NA)*x2 + c(theta.2_2.g1, theta.2_2.g2)*x2
x3 ~~ c(NA, NA)*x3 + c(theta.3_3.g1, theta.3_3.g2)*x3
x4 ~~ c(NA, NA)*x4 + c(theta.4_4.g1, theta.4_4.g2)*x4
x5 ~~ c(NA, NA)*x5 + c(theta.5_5.g1, theta.5_5.g2)*x5
x6 ~~ c(NA, NA)*x6 + c(theta.6_6.g1, theta.6_6.g2)*x6
x7 ~~ c(NA, NA)*x7 + c(theta.7_7.g1, theta.7_7.g2)*x7
x8 ~~ c(NA, NA)*x8 + c(theta.8_8.g1, theta.8_8.g2)*x8
x9 ~~ c(NA, NA)*x9 + c(theta.9_9.g1, theta.9_9.g2)*x9

## LATENT MEANS/INTERCEPTS:

visual ~ c(0, 0)*1 + c(alpha.1.g1, alpha.1.g2)*1
textual ~ c(0, 0)*1 + c(alpha.2.g1, alpha.2.g2)*1
speed ~ c(0, 0)*1 + c(alpha.3.g1, alpha.3.g2)*1

## COMMON-FACTOR VARIANCES:

visual ~~ c(1, NA)*visual + c(psi.1_1.g1, psi.1_1.g2)*visual
textual ~~ c(1, NA)*textual + c(psi.2_2.g1, psi.2_2.g2)*textual
speed ~~ c(1, NA)*speed + c(psi.3_3.g1, psi.3_3.g2)*speed

## COMMON-FACTOR COVARIANCES:

visual ~~ c(NA, NA)*textual + c(psi.2_1.g1, psi.2_1.g2)*textual
visual ~~ c(NA, NA)*speed + c(psi.3_1.g1, psi.3_1.g2)*speed
textual ~~ c(NA, NA)*speed + c(psi.3_2.g1, psi.3_2.g2)*speed</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a>metricInvarianceSyntax <span class="ot">&lt;-</span> <span class="fu">as.character</span>(metricInvarianceModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="sec-measurementInvarianceMetricModelFeatures" class="level5" data-number="16.10.6.1.1"><h5 data-number="16.10.6.1.1" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelFeatures">
<span class="header-section-number">16.10.6.1.1</span> Summary of Model Features</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="fu">summary</span>(metricInvarianceModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>This lavaan model syntax specifies a CFA with 9 manifest indicators of 3 common factor(s).

To identify the location and scale of each common factor, the factor means and variances were fixed to 0 and 1, respectively, unless equality constraints on measurement parameters allow them to be freed.

Pattern matrix indicating num(eric), ord(ered), and lat(ent) indicators per factor:

   visual textual speed
x1 num                 
x2 num                 
x3 num                 
x4        num          
x5        num          
x6        num          
x7                num  
x8                num  
x9                num  

The following types of parameter were constrained to equality across groups:

    loadings</code></pre>
</div>
</div>
</section></section><section id="sec-measurementInvarianceMetricModelTabular" class="level4" data-number="16.10.6.2"><h4 data-number="16.10.6.2" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelTabular">
<span class="header-section-number">16.10.6.2</span> Model Syntax in Table Form</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="fu">lavaanify</span>(metricInvarianceModel, <span class="at">ngroups =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["lhs"],"name":[2],"type":["chr"],"align":["left"]},{"label":["op"],"name":[3],"type":["chr"],"align":["left"]},{"label":["rhs"],"name":[4],"type":["chr"],"align":["left"]},{"label":["user"],"name":[5],"type":["int"],"align":["right"]},{"label":["block"],"name":[6],"type":["int"],"align":["right"]},{"label":["group"],"name":[7],"type":["int"],"align":["right"]},{"label":["free"],"name":[8],"type":["int"],"align":["right"]},{"label":["ustart"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["exo"],"name":[10],"type":["int"],"align":["right"]},{"label":["label"],"name":[11],"type":["chr"],"align":["left"]},{"label":["plabel"],"name":[12],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"visual","3":"=~","4":"x1","5":"1","6":"1","7":"1","8":"1","9":"NA","10":"0","11":"lambda.1_1","12":".p1."},{"1":"2","2":"visual","3":"=~","4":"x2","5":"1","6":"1","7":"1","8":"2","9":"NA","10":"0","11":"lambda.2_1","12":".p2."},{"1":"3","2":"visual","3":"=~","4":"x3","5":"1","6":"1","7":"1","8":"3","9":"NA","10":"0","11":"lambda.3_1","12":".p3."},{"1":"4","2":"textual","3":"=~","4":"x4","5":"1","6":"1","7":"1","8":"4","9":"NA","10":"0","11":"lambda.4_2","12":".p4."},{"1":"5","2":"textual","3":"=~","4":"x5","5":"1","6":"1","7":"1","8":"5","9":"NA","10":"0","11":"lambda.5_2","12":".p5."},{"1":"6","2":"textual","3":"=~","4":"x6","5":"1","6":"1","7":"1","8":"6","9":"NA","10":"0","11":"lambda.6_2","12":".p6."},{"1":"7","2":"speed","3":"=~","4":"x7","5":"1","6":"1","7":"1","8":"7","9":"NA","10":"0","11":"lambda.7_3","12":".p7."},{"1":"8","2":"speed","3":"=~","4":"x8","5":"1","6":"1","7":"1","8":"8","9":"NA","10":"0","11":"lambda.8_3","12":".p8."},{"1":"9","2":"speed","3":"=~","4":"x9","5":"1","6":"1","7":"1","8":"9","9":"NA","10":"0","11":"lambda.9_3","12":".p9."},{"1":"10","2":"x1","3":"~1","4":"","5":"1","6":"1","7":"1","8":"10","9":"NA","10":"0","11":"nu.1.g1","12":".p10."},{"1":"11","2":"x2","3":"~1","4":"","5":"1","6":"1","7":"1","8":"11","9":"NA","10":"0","11":"nu.2.g1","12":".p11."},{"1":"12","2":"x3","3":"~1","4":"","5":"1","6":"1","7":"1","8":"12","9":"NA","10":"0","11":"nu.3.g1","12":".p12."},{"1":"13","2":"x4","3":"~1","4":"","5":"1","6":"1","7":"1","8":"13","9":"NA","10":"0","11":"nu.4.g1","12":".p13."},{"1":"14","2":"x5","3":"~1","4":"","5":"1","6":"1","7":"1","8":"14","9":"NA","10":"0","11":"nu.5.g1","12":".p14."},{"1":"15","2":"x6","3":"~1","4":"","5":"1","6":"1","7":"1","8":"15","9":"NA","10":"0","11":"nu.6.g1","12":".p15."},{"1":"16","2":"x7","3":"~1","4":"","5":"1","6":"1","7":"1","8":"16","9":"NA","10":"0","11":"nu.7.g1","12":".p16."},{"1":"17","2":"x8","3":"~1","4":"","5":"1","6":"1","7":"1","8":"17","9":"NA","10":"0","11":"nu.8.g1","12":".p17."},{"1":"18","2":"x9","3":"~1","4":"","5":"1","6":"1","7":"1","8":"18","9":"NA","10":"0","11":"nu.9.g1","12":".p18."},{"1":"19","2":"x1","3":"~~","4":"x1","5":"1","6":"1","7":"1","8":"19","9":"NA","10":"0","11":"theta.1_1.g1","12":".p19."},{"1":"20","2":"x2","3":"~~","4":"x2","5":"1","6":"1","7":"1","8":"20","9":"NA","10":"0","11":"theta.2_2.g1","12":".p20."},{"1":"21","2":"x3","3":"~~","4":"x3","5":"1","6":"1","7":"1","8":"21","9":"NA","10":"0","11":"theta.3_3.g1","12":".p21."},{"1":"22","2":"x4","3":"~~","4":"x4","5":"1","6":"1","7":"1","8":"22","9":"NA","10":"0","11":"theta.4_4.g1","12":".p22."},{"1":"23","2":"x5","3":"~~","4":"x5","5":"1","6":"1","7":"1","8":"23","9":"NA","10":"0","11":"theta.5_5.g1","12":".p23."},{"1":"24","2":"x6","3":"~~","4":"x6","5":"1","6":"1","7":"1","8":"24","9":"NA","10":"0","11":"theta.6_6.g1","12":".p24."},{"1":"25","2":"x7","3":"~~","4":"x7","5":"1","6":"1","7":"1","8":"25","9":"NA","10":"0","11":"theta.7_7.g1","12":".p25."},{"1":"26","2":"x8","3":"~~","4":"x8","5":"1","6":"1","7":"1","8":"26","9":"NA","10":"0","11":"theta.8_8.g1","12":".p26."},{"1":"27","2":"x9","3":"~~","4":"x9","5":"1","6":"1","7":"1","8":"27","9":"NA","10":"0","11":"theta.9_9.g1","12":".p27."},{"1":"28","2":"visual","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"alpha.1.g1","12":".p28."},{"1":"29","2":"textual","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"alpha.2.g1","12":".p29."},{"1":"30","2":"speed","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"alpha.3.g1","12":".p30."},{"1":"31","2":"visual","3":"~~","4":"visual","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"psi.1_1.g1","12":".p31."},{"1":"32","2":"textual","3":"~~","4":"textual","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"psi.2_2.g1","12":".p32."},{"1":"33","2":"speed","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"psi.3_3.g1","12":".p33."},{"1":"34","2":"visual","3":"~~","4":"textual","5":"1","6":"1","7":"1","8":"28","9":"NA","10":"0","11":"psi.2_1.g1","12":".p34."},{"1":"35","2":"visual","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"29","9":"NA","10":"0","11":"psi.3_1.g1","12":".p35."},{"1":"36","2":"textual","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"30","9":"NA","10":"0","11":"psi.3_2.g1","12":".p36."},{"1":"37","2":"visual","3":"=~","4":"x1","5":"1","6":"2","7":"2","8":"31","9":"NA","10":"0","11":"lambda.1_1","12":".p37."},{"1":"38","2":"visual","3":"=~","4":"x2","5":"1","6":"2","7":"2","8":"32","9":"NA","10":"0","11":"lambda.2_1","12":".p38."},{"1":"39","2":"visual","3":"=~","4":"x3","5":"1","6":"2","7":"2","8":"33","9":"NA","10":"0","11":"lambda.3_1","12":".p39."},{"1":"40","2":"textual","3":"=~","4":"x4","5":"1","6":"2","7":"2","8":"34","9":"NA","10":"0","11":"lambda.4_2","12":".p40."},{"1":"41","2":"textual","3":"=~","4":"x5","5":"1","6":"2","7":"2","8":"35","9":"NA","10":"0","11":"lambda.5_2","12":".p41."},{"1":"42","2":"textual","3":"=~","4":"x6","5":"1","6":"2","7":"2","8":"36","9":"NA","10":"0","11":"lambda.6_2","12":".p42."},{"1":"43","2":"speed","3":"=~","4":"x7","5":"1","6":"2","7":"2","8":"37","9":"NA","10":"0","11":"lambda.7_3","12":".p43."},{"1":"44","2":"speed","3":"=~","4":"x8","5":"1","6":"2","7":"2","8":"38","9":"NA","10":"0","11":"lambda.8_3","12":".p44."},{"1":"45","2":"speed","3":"=~","4":"x9","5":"1","6":"2","7":"2","8":"39","9":"NA","10":"0","11":"lambda.9_3","12":".p45."},{"1":"46","2":"x1","3":"~1","4":"","5":"1","6":"2","7":"2","8":"40","9":"NA","10":"0","11":"nu.1.g2","12":".p46."},{"1":"47","2":"x2","3":"~1","4":"","5":"1","6":"2","7":"2","8":"41","9":"NA","10":"0","11":"nu.2.g2","12":".p47."},{"1":"48","2":"x3","3":"~1","4":"","5":"1","6":"2","7":"2","8":"42","9":"NA","10":"0","11":"nu.3.g2","12":".p48."},{"1":"49","2":"x4","3":"~1","4":"","5":"1","6":"2","7":"2","8":"43","9":"NA","10":"0","11":"nu.4.g2","12":".p49."},{"1":"50","2":"x5","3":"~1","4":"","5":"1","6":"2","7":"2","8":"44","9":"NA","10":"0","11":"nu.5.g2","12":".p50."},{"1":"51","2":"x6","3":"~1","4":"","5":"1","6":"2","7":"2","8":"45","9":"NA","10":"0","11":"nu.6.g2","12":".p51."},{"1":"52","2":"x7","3":"~1","4":"","5":"1","6":"2","7":"2","8":"46","9":"NA","10":"0","11":"nu.7.g2","12":".p52."},{"1":"53","2":"x8","3":"~1","4":"","5":"1","6":"2","7":"2","8":"47","9":"NA","10":"0","11":"nu.8.g2","12":".p53."},{"1":"54","2":"x9","3":"~1","4":"","5":"1","6":"2","7":"2","8":"48","9":"NA","10":"0","11":"nu.9.g2","12":".p54."},{"1":"55","2":"x1","3":"~~","4":"x1","5":"1","6":"2","7":"2","8":"49","9":"NA","10":"0","11":"theta.1_1.g2","12":".p55."},{"1":"56","2":"x2","3":"~~","4":"x2","5":"1","6":"2","7":"2","8":"50","9":"NA","10":"0","11":"theta.2_2.g2","12":".p56."},{"1":"57","2":"x3","3":"~~","4":"x3","5":"1","6":"2","7":"2","8":"51","9":"NA","10":"0","11":"theta.3_3.g2","12":".p57."},{"1":"58","2":"x4","3":"~~","4":"x4","5":"1","6":"2","7":"2","8":"52","9":"NA","10":"0","11":"theta.4_4.g2","12":".p58."},{"1":"59","2":"x5","3":"~~","4":"x5","5":"1","6":"2","7":"2","8":"53","9":"NA","10":"0","11":"theta.5_5.g2","12":".p59."},{"1":"60","2":"x6","3":"~~","4":"x6","5":"1","6":"2","7":"2","8":"54","9":"NA","10":"0","11":"theta.6_6.g2","12":".p60."},{"1":"61","2":"x7","3":"~~","4":"x7","5":"1","6":"2","7":"2","8":"55","9":"NA","10":"0","11":"theta.7_7.g2","12":".p61."},{"1":"62","2":"x8","3":"~~","4":"x8","5":"1","6":"2","7":"2","8":"56","9":"NA","10":"0","11":"theta.8_8.g2","12":".p62."},{"1":"63","2":"x9","3":"~~","4":"x9","5":"1","6":"2","7":"2","8":"57","9":"NA","10":"0","11":"theta.9_9.g2","12":".p63."},{"1":"64","2":"visual","3":"~1","4":"","5":"1","6":"2","7":"2","8":"0","9":"0","10":"0","11":"alpha.1.g2","12":".p64."},{"1":"65","2":"textual","3":"~1","4":"","5":"1","6":"2","7":"2","8":"0","9":"0","10":"0","11":"alpha.2.g2","12":".p65."},{"1":"66","2":"speed","3":"~1","4":"","5":"1","6":"2","7":"2","8":"0","9":"0","10":"0","11":"alpha.3.g2","12":".p66."},{"1":"67","2":"visual","3":"~~","4":"visual","5":"1","6":"2","7":"2","8":"58","9":"NA","10":"0","11":"psi.1_1.g2","12":".p67."},{"1":"68","2":"textual","3":"~~","4":"textual","5":"1","6":"2","7":"2","8":"59","9":"NA","10":"0","11":"psi.2_2.g2","12":".p68."},{"1":"69","2":"speed","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"60","9":"NA","10":"0","11":"psi.3_3.g2","12":".p69."},{"1":"70","2":"visual","3":"~~","4":"textual","5":"1","6":"2","7":"2","8":"61","9":"NA","10":"0","11":"psi.2_1.g2","12":".p70."},{"1":"71","2":"visual","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"62","9":"NA","10":"0","11":"psi.3_1.g2","12":".p71."},{"1":"72","2":"textual","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"63","9":"NA","10":"0","11":"psi.3_2.g2","12":".p72."},{"1":"73","2":".p1.","3":"==","4":".p37.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"74","2":".p2.","3":"==","4":".p38.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"75","2":".p3.","3":"==","4":".p39.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"76","2":".p4.","3":"==","4":".p40.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"77","2":".p5.","3":"==","4":".p41.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"78","2":".p6.","3":"==","4":".p42.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"79","2":".p7.","3":"==","4":".p43.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"80","2":".p8.","3":"==","4":".p44.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"81","2":".p9.","3":"==","4":".p45.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a><span class="fu">lavaanify</span>(cfaModel_metricInvariance, <span class="at">ngroups =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["lhs"],"name":[2],"type":["chr"],"align":["left"]},{"label":["op"],"name":[3],"type":["chr"],"align":["left"]},{"label":["rhs"],"name":[4],"type":["chr"],"align":["left"]},{"label":["user"],"name":[5],"type":["int"],"align":["right"]},{"label":["block"],"name":[6],"type":["int"],"align":["right"]},{"label":["group"],"name":[7],"type":["int"],"align":["right"]},{"label":["free"],"name":[8],"type":["int"],"align":["right"]},{"label":["ustart"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["exo"],"name":[10],"type":["int"],"align":["right"]},{"label":["label"],"name":[11],"type":["chr"],"align":["left"]},{"label":["plabel"],"name":[12],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"visual","3":"=~","4":"x1","5":"1","6":"1","7":"1","8":"1","9":"NA","10":"0","11":"lambdax1","12":".p1."},{"1":"2","2":"visual","3":"=~","4":"x2","5":"1","6":"1","7":"1","8":"2","9":"NA","10":"0","11":"lambdax2","12":".p2."},{"1":"3","2":"visual","3":"=~","4":"x3","5":"1","6":"1","7":"1","8":"3","9":"NA","10":"0","11":"lambdax3","12":".p3."},{"1":"4","2":"textual","3":"=~","4":"x4","5":"1","6":"1","7":"1","8":"4","9":"NA","10":"0","11":"lambdax4","12":".p4."},{"1":"5","2":"textual","3":"=~","4":"x5","5":"1","6":"1","7":"1","8":"5","9":"NA","10":"0","11":"lambdax5","12":".p5."},{"1":"6","2":"textual","3":"=~","4":"x6","5":"1","6":"1","7":"1","8":"6","9":"NA","10":"0","11":"lambdax6","12":".p6."},{"1":"7","2":"speed","3":"=~","4":"x7","5":"1","6":"1","7":"1","8":"7","9":"NA","10":"0","11":"lambdax7","12":".p7."},{"1":"8","2":"speed","3":"=~","4":"x8","5":"1","6":"1","7":"1","8":"8","9":"NA","10":"0","11":"lambdax8","12":".p8."},{"1":"9","2":"speed","3":"=~","4":"x9","5":"1","6":"1","7":"1","8":"9","9":"NA","10":"0","11":"lambdax9","12":".p9."},{"1":"10","2":"visual","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p10."},{"1":"11","2":"textual","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p11."},{"1":"12","2":"speed","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p12."},{"1":"13","2":"visual","3":"~~","4":"visual","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"","12":".p13."},{"1":"14","2":"textual","3":"~~","4":"textual","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"","12":".p14."},{"1":"15","2":"speed","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"","12":".p15."},{"1":"16","2":"visual","3":"~~","4":"textual","5":"1","6":"1","7":"1","8":"10","9":"NA","10":"0","11":"","12":".p16."},{"1":"17","2":"visual","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"11","9":"NA","10":"0","11":"","12":".p17."},{"1":"18","2":"textual","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"12","9":"NA","10":"0","11":"","12":".p18."},{"1":"19","2":"x1","3":"~~","4":"x1","5":"1","6":"1","7":"1","8":"13","9":"NA","10":"0","11":"","12":".p19."},{"1":"20","2":"x2","3":"~~","4":"x2","5":"1","6":"1","7":"1","8":"14","9":"NA","10":"0","11":"","12":".p20."},{"1":"21","2":"x3","3":"~~","4":"x3","5":"1","6":"1","7":"1","8":"15","9":"NA","10":"0","11":"","12":".p21."},{"1":"22","2":"x4","3":"~~","4":"x4","5":"1","6":"1","7":"1","8":"16","9":"NA","10":"0","11":"","12":".p22."},{"1":"23","2":"x5","3":"~~","4":"x5","5":"1","6":"1","7":"1","8":"17","9":"NA","10":"0","11":"","12":".p23."},{"1":"24","2":"x6","3":"~~","4":"x6","5":"1","6":"1","7":"1","8":"18","9":"NA","10":"0","11":"","12":".p24."},{"1":"25","2":"x7","3":"~~","4":"x7","5":"1","6":"1","7":"1","8":"19","9":"NA","10":"0","11":"","12":".p25."},{"1":"26","2":"x8","3":"~~","4":"x8","5":"1","6":"1","7":"1","8":"20","9":"NA","10":"0","11":"","12":".p26."},{"1":"27","2":"x9","3":"~~","4":"x9","5":"1","6":"1","7":"1","8":"21","9":"NA","10":"0","11":"","12":".p27."},{"1":"28","2":"x1","3":"~1","4":"","5":"1","6":"1","7":"1","8":"22","9":"NA","10":"0","11":"","12":".p28."},{"1":"29","2":"x2","3":"~1","4":"","5":"1","6":"1","7":"1","8":"23","9":"NA","10":"0","11":"","12":".p29."},{"1":"30","2":"x3","3":"~1","4":"","5":"1","6":"1","7":"1","8":"24","9":"NA","10":"0","11":"","12":".p30."},{"1":"31","2":"x4","3":"~1","4":"","5":"1","6":"1","7":"1","8":"25","9":"NA","10":"0","11":"","12":".p31."},{"1":"32","2":"x5","3":"~1","4":"","5":"1","6":"1","7":"1","8":"26","9":"NA","10":"0","11":"","12":".p32."},{"1":"33","2":"x6","3":"~1","4":"","5":"1","6":"1","7":"1","8":"27","9":"NA","10":"0","11":"","12":".p33."},{"1":"34","2":"x7","3":"~1","4":"","5":"1","6":"1","7":"1","8":"28","9":"NA","10":"0","11":"","12":".p34."},{"1":"35","2":"x8","3":"~1","4":"","5":"1","6":"1","7":"1","8":"29","9":"NA","10":"0","11":"","12":".p35."},{"1":"36","2":"x9","3":"~1","4":"","5":"1","6":"1","7":"1","8":"30","9":"NA","10":"0","11":"","12":".p36."},{"1":"37","2":"visual","3":"=~","4":"x1","5":"1","6":"2","7":"2","8":"31","9":"NA","10":"0","11":"lambdax1","12":".p37."},{"1":"38","2":"visual","3":"=~","4":"x2","5":"1","6":"2","7":"2","8":"32","9":"NA","10":"0","11":"lambdax2","12":".p38."},{"1":"39","2":"visual","3":"=~","4":"x3","5":"1","6":"2","7":"2","8":"33","9":"NA","10":"0","11":"lambdax3","12":".p39."},{"1":"40","2":"textual","3":"=~","4":"x4","5":"1","6":"2","7":"2","8":"34","9":"NA","10":"0","11":"lambdax4","12":".p40."},{"1":"41","2":"textual","3":"=~","4":"x5","5":"1","6":"2","7":"2","8":"35","9":"NA","10":"0","11":"lambdax5","12":".p41."},{"1":"42","2":"textual","3":"=~","4":"x6","5":"1","6":"2","7":"2","8":"36","9":"NA","10":"0","11":"lambdax6","12":".p42."},{"1":"43","2":"speed","3":"=~","4":"x7","5":"1","6":"2","7":"2","8":"37","9":"NA","10":"0","11":"lambdax7","12":".p43."},{"1":"44","2":"speed","3":"=~","4":"x8","5":"1","6":"2","7":"2","8":"38","9":"NA","10":"0","11":"lambdax8","12":".p44."},{"1":"45","2":"speed","3":"=~","4":"x9","5":"1","6":"2","7":"2","8":"39","9":"NA","10":"0","11":"lambdax9","12":".p45."},{"1":"46","2":"visual","3":"~1","4":"","5":"1","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p46."},{"1":"47","2":"textual","3":"~1","4":"","5":"1","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p47."},{"1":"48","2":"speed","3":"~1","4":"","5":"1","6":"2","7":"2","8":"0","9":"0","10":"0","11":"","12":".p48."},{"1":"49","2":"visual","3":"~~","4":"visual","5":"1","6":"2","7":"2","8":"40","9":"NA","10":"0","11":"","12":".p49."},{"1":"50","2":"textual","3":"~~","4":"textual","5":"1","6":"2","7":"2","8":"41","9":"NA","10":"0","11":"","12":".p50."},{"1":"51","2":"speed","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"42","9":"NA","10":"0","11":"","12":".p51."},{"1":"52","2":"visual","3":"~~","4":"textual","5":"1","6":"2","7":"2","8":"43","9":"NA","10":"0","11":"","12":".p52."},{"1":"53","2":"visual","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"44","9":"NA","10":"0","11":"","12":".p53."},{"1":"54","2":"textual","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"45","9":"NA","10":"0","11":"","12":".p54."},{"1":"55","2":"x1","3":"~~","4":"x1","5":"1","6":"2","7":"2","8":"46","9":"NA","10":"0","11":"","12":".p55."},{"1":"56","2":"x2","3":"~~","4":"x2","5":"1","6":"2","7":"2","8":"47","9":"NA","10":"0","11":"","12":".p56."},{"1":"57","2":"x3","3":"~~","4":"x3","5":"1","6":"2","7":"2","8":"48","9":"NA","10":"0","11":"","12":".p57."},{"1":"58","2":"x4","3":"~~","4":"x4","5":"1","6":"2","7":"2","8":"49","9":"NA","10":"0","11":"","12":".p58."},{"1":"59","2":"x5","3":"~~","4":"x5","5":"1","6":"2","7":"2","8":"50","9":"NA","10":"0","11":"","12":".p59."},{"1":"60","2":"x6","3":"~~","4":"x6","5":"1","6":"2","7":"2","8":"51","9":"NA","10":"0","11":"","12":".p60."},{"1":"61","2":"x7","3":"~~","4":"x7","5":"1","6":"2","7":"2","8":"52","9":"NA","10":"0","11":"","12":".p61."},{"1":"62","2":"x8","3":"~~","4":"x8","5":"1","6":"2","7":"2","8":"53","9":"NA","10":"0","11":"","12":".p62."},{"1":"63","2":"x9","3":"~~","4":"x9","5":"1","6":"2","7":"2","8":"54","9":"NA","10":"0","11":"","12":".p63."},{"1":"64","2":"x1","3":"~1","4":"","5":"1","6":"2","7":"2","8":"55","9":"NA","10":"0","11":"","12":".p64."},{"1":"65","2":"x2","3":"~1","4":"","5":"1","6":"2","7":"2","8":"56","9":"NA","10":"0","11":"","12":".p65."},{"1":"66","2":"x3","3":"~1","4":"","5":"1","6":"2","7":"2","8":"57","9":"NA","10":"0","11":"","12":".p66."},{"1":"67","2":"x4","3":"~1","4":"","5":"1","6":"2","7":"2","8":"58","9":"NA","10":"0","11":"","12":".p67."},{"1":"68","2":"x5","3":"~1","4":"","5":"1","6":"2","7":"2","8":"59","9":"NA","10":"0","11":"","12":".p68."},{"1":"69","2":"x6","3":"~1","4":"","5":"1","6":"2","7":"2","8":"60","9":"NA","10":"0","11":"","12":".p69."},{"1":"70","2":"x7","3":"~1","4":"","5":"1","6":"2","7":"2","8":"61","9":"NA","10":"0","11":"","12":".p70."},{"1":"71","2":"x8","3":"~1","4":"","5":"1","6":"2","7":"2","8":"62","9":"NA","10":"0","11":"","12":".p71."},{"1":"72","2":"x9","3":"~1","4":"","5":"1","6":"2","7":"2","8":"63","9":"NA","10":"0","11":"","12":".p72."},{"1":"73","2":".p1.","3":"==","4":".p37.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"74","2":".p2.","3":"==","4":".p38.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"75","2":".p3.","3":"==","4":".p39.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"76","2":".p4.","3":"==","4":".p40.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"77","2":".p5.","3":"==","4":".p41.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"78","2":".p6.","3":"==","4":".p42.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"79","2":".p7.","3":"==","4":".p43.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"80","2":".p8.","3":"==","4":".p44.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"81","2":".p9.","3":"==","4":".p45.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceMetricModelFit" class="level4" data-number="16.10.6.3"><h4 data-number="16.10.6.3" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelFit">
<span class="header-section-number">16.10.6.3</span> Fit the Model</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a>metricInvarianceModel_fit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(</span>
<span id="cb133-2"><a href="#cb133-2"></a>  metricInvarianceSyntax,</span>
<span id="cb133-3"><a href="#cb133-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb133-4"><a href="#cb133-4"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb133-5"><a href="#cb133-5"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb133-6"><a href="#cb133-6"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a>metricInvarianceModelFullSyntax_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb134-2"><a href="#cb134-2"></a>  cfaModel_metricInvariance,</span>
<span id="cb134-3"><a href="#cb134-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb134-4"><a href="#cb134-4"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb134-5"><a href="#cb134-5"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb134-6"><a href="#cb134-6"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceMetricModelOutput" class="level4" data-number="16.10.6.4"><h4 data-number="16.10.6.4" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelOutput">
<span class="header-section-number">16.10.6.4</span> Model Summary</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a><span class="fu">summary</span>(</span>
<span id="cb135-2"><a href="#cb135-2"></a>  metricInvarianceModel_fit,</span>
<span id="cb135-3"><a href="#cb135-3"></a>  <span class="at">fit.measures =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-4"><a href="#cb135-4"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-5"><a href="#cb135-5"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 73 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        63
  Number of equality constraints                     9

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145
  Number of missing patterns per group:               
    Pasteur                                          9
    Grant-White                                      9

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               116.313     117.955
  Degrees of freedom                                54          54
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.986
    Yuan-Bentler correction (Mplus variant)                       
  Test statistic for each group:
    Pasteur                                     64.366      64.366
    Grant-White                                 53.590      53.590

Model Test Baseline Model:

  Test statistic                               932.665     909.019
  Degrees of freedom                                72          72
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.026

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.928       0.924
  Tucker-Lewis Index (TLI)                       0.903       0.898
                                                                  
  Robust Comparative Fit Index (CFI)                         0.928
  Robust Tucker-Lewis Index (TLI)                            0.905

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3652.277   -3652.277
  Scaling correction factor                                  0.928
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -3594.120   -3594.120
  Scaling correction factor                                  1.034
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                                7412.554    7412.554
  Bayesian (BIC)                              7612.738    7612.738
  Sample-size adjusted Bayesian (SABIC)       7441.480    7441.480

Root Mean Square Error of Approximation:

  RMSEA                                          0.088       0.089
  90 Percent confidence interval - lower         0.066       0.067
  90 Percent confidence interval - upper         0.109       0.111
  P-value H_0: RMSEA &lt;= 0.050                    0.004       0.003
  P-value H_0: RMSEA &gt;= 0.080                    0.730       0.757
                                                                  
  Robust RMSEA                                               0.088
  90 Percent confidence interval - lower                     0.066
  90 Percent confidence interval - upper                     0.111
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.004
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.740

Standardized Root Mean Square Residual:

  SRMR                                           0.069       0.069

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (l.1_)    0.885    0.122    7.258    0.000    0.885    0.759
    x2      (l.2_)    0.536    0.088    6.106    0.000    0.536    0.432
    x3      (l.3_)    0.707    0.087    8.148    0.000    0.707    0.608
  textual =~                                                            
    x4      (l.4_)    0.935    0.072   12.929    0.000    0.935    0.813
    x5      (l.5_)    1.045    0.076   13.740    0.000    1.045    0.832
    x6      (l.6_)    0.874    0.070   12.496    0.000    0.874    0.865
  speed =~                                                              
    x7      (l.7_)    0.550    0.075    7.346    0.000    0.550    0.510
    x8      (l.8_)    0.675    0.087    7.784    0.000    0.675    0.686
    x9      (l.9_)    0.602    0.088    6.867    0.000    0.602    0.603

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textul  (p.2_)    0.473    0.105    4.484    0.000    0.473    0.473
    speed  (p.3_1)    0.347    0.125    2.778    0.005    0.347    0.347
  textual ~~                                                            
    speed  (p.3_2)    0.320    0.096    3.342    0.001    0.320    0.320

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (n.1.)    4.948    0.095   52.314    0.000    4.948    4.243
   .x2      (n.2.)    5.984    0.098   60.949    0.000    5.984    4.823
   .x3      (n.3.)    2.510    0.093   26.891    0.000    2.510    2.157
   .x4      (n.4.)    2.814    0.091   30.886    0.000    2.814    2.448
   .x5      (n.5.)    4.002    0.105   38.265    0.000    4.002    3.186
   .x6      (n.6.)    1.929    0.079   24.377    0.000    1.929    1.907
   .x7      (n.7.)    4.439    0.087   51.128    0.000    4.439    4.117
   .x8      (n.8.)    5.564    0.079   70.170    0.000    5.564    5.655
   .x9      (n.9.)    5.426    0.080   67.539    0.000    5.426    5.435
    visual  (a.1.)    0.000                               0.000    0.000
    textual (a.2.)    0.000                               0.000    0.000
    speed   (a.3.)    0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (t.1_)    0.577    0.166    3.482    0.000    0.577    0.424
   .x2      (t.2_)    1.252    0.162    7.718    0.000    1.252    0.813
   .x3      (t.3_)    0.853    0.127    6.737    0.000    0.853    0.630
   .x4      (t.4_)    0.447    0.072    6.189    0.000    0.447    0.339
   .x5      (t.5_)    0.486    0.075    6.445    0.000    0.486    0.308
   .x6      (t.6_)    0.258    0.057    4.499    0.000    0.258    0.252
   .x7      (t.7_)    0.860    0.114    7.549    0.000    0.860    0.739
   .x8      (t.8_)    0.512    0.097    5.296    0.000    0.512    0.529
   .x9      (t.9_)    0.635    0.118    5.376    0.000    0.635    0.637
    visual  (p.1_)    1.000                               1.000    1.000
    textual (p.2_)    1.000                               1.000    1.000
    speed   (p.3_)    1.000                               1.000    1.000

R-Square:
                   Estimate
    x1                0.576
    x2                0.187
    x3                0.370
    x4                0.661
    x5                0.692
    x6                0.748
    x7                0.261
    x8                0.471
    x9                0.363


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (l.1_)    0.885    0.122    7.258    0.000    0.844    0.723
    x2      (l.2_)    0.536    0.088    6.106    0.000    0.512    0.467
    x3      (l.3_)    0.707    0.087    8.148    0.000    0.675    0.655
  textual =~                                                            
    x4      (l.4_)    0.935    0.072   12.929    0.000    0.937    0.846
    x5      (l.5_)    1.045    0.076   13.740    0.000    1.047    0.864
    x6      (l.6_)    0.874    0.070   12.496    0.000    0.876    0.798
  speed =~                                                              
    x7      (l.7_)    0.550    0.075    7.346    0.000    0.674    0.649
    x8      (l.8_)    0.675    0.087    7.784    0.000    0.826    0.790
    x9      (l.9_)    0.602    0.088    6.867    0.000    0.736    0.719

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textul  (p.2_)    0.520    0.134    3.867    0.000    0.544    0.544
    speed  (p.3_1)    0.638    0.211    3.023    0.002    0.546    0.546
  textual ~~                                                            
    speed  (p.3_2)    0.429    0.193    2.219    0.026    0.350    0.350

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (n.1.)    4.930    0.096   51.453    0.000    4.930    4.220
   .x2      (n.2.)    6.198    0.092   67.063    0.000    6.198    5.654
   .x3      (n.3.)    1.992    0.086   23.042    0.000    1.992    1.934
   .x4      (n.4.)    3.318    0.093   35.501    0.000    3.318    2.997
   .x5      (n.5.)    4.714    0.097   48.693    0.000    4.714    3.891
   .x6      (n.6.)    2.467    0.094   26.165    0.000    2.467    2.246
   .x7      (n.7.)    3.923    0.087   45.299    0.000    3.923    3.782
   .x8      (n.8.)    5.488    0.087   63.174    0.000    5.488    5.250
   .x9      (n.9.)    5.338    0.085   62.628    0.000    5.338    5.216
    visual  (a.1.)    0.000                               0.000    0.000
    textual (a.2.)    0.000                               0.000    0.000
    speed   (a.3.)    0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (t.1_)    0.652    0.168    3.877    0.000    0.652    0.478
   .x2      (t.2_)    0.940    0.145    6.473    0.000    0.940    0.782
   .x3      (t.3_)    0.606    0.113    5.376    0.000    0.606    0.571
   .x4      (t.4_)    0.348    0.066    5.257    0.000    0.348    0.284
   .x5      (t.5_)    0.371    0.074    5.021    0.000    0.371    0.253
   .x6      (t.6_)    0.439    0.076    5.738    0.000    0.439    0.364
   .x7      (t.7_)    0.622    0.098    6.338    0.000    0.622    0.578
   .x8      (t.8_)    0.410    0.148    2.765    0.006    0.410    0.375
   .x9      (t.9_)    0.505    0.128    3.957    0.000    0.505    0.482
    visual  (p.1_)    0.910    0.234    3.895    0.000    1.000    1.000
    textual (p.2_)    1.004    0.191    5.257    0.000    1.000    1.000
    speed   (p.3_)    1.498    0.357    4.201    0.000    1.000    1.000

R-Square:
                   Estimate
    x1                0.522
    x2                0.218
    x3                0.429
    x4                0.716
    x5                0.747
    x6                0.636
    x7                0.422
    x8                0.625
    x9                0.518</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="fu">summary</span>(</span>
<span id="cb137-2"><a href="#cb137-2"></a>  metricInvarianceModelFullSyntax_fit,</span>
<span id="cb137-3"><a href="#cb137-3"></a>  <span class="at">fit.measures =</span> <span class="cn">TRUE</span>,</span>
<span id="cb137-4"><a href="#cb137-4"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb137-5"><a href="#cb137-5"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 73 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        63
  Number of equality constraints                     9

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145
  Number of missing patterns per group:               
    Pasteur                                          9
    Grant-White                                      9

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               116.313     117.955
  Degrees of freedom                                54          54
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.986
    Yuan-Bentler correction (Mplus variant)                       
  Test statistic for each group:
    Pasteur                                     64.366      64.366
    Grant-White                                 53.590      53.590

Model Test Baseline Model:

  Test statistic                               932.665     909.019
  Degrees of freedom                                72          72
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.026

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.928       0.924
  Tucker-Lewis Index (TLI)                       0.903       0.898
                                                                  
  Robust Comparative Fit Index (CFI)                         0.928
  Robust Tucker-Lewis Index (TLI)                            0.905

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3652.277   -3652.277
  Scaling correction factor                                  0.928
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -3594.120   -3594.120
  Scaling correction factor                                  1.034
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                                7412.554    7412.554
  Bayesian (BIC)                              7612.738    7612.738
  Sample-size adjusted Bayesian (SABIC)       7441.480    7441.480

Root Mean Square Error of Approximation:

  RMSEA                                          0.088       0.089
  90 Percent confidence interval - lower         0.066       0.067
  90 Percent confidence interval - upper         0.109       0.111
  P-value H_0: RMSEA &lt;= 0.050                    0.004       0.003
  P-value H_0: RMSEA &gt;= 0.080                    0.730       0.757
                                                                  
  Robust RMSEA                                               0.088
  90 Percent confidence interval - lower                     0.066
  90 Percent confidence interval - upper                     0.111
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.004
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.740

Standardized Root Mean Square Residual:

  SRMR                                           0.069       0.069

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (lmb1)    0.885    0.122    7.258    0.000    0.885    0.759
    x2      (lmb2)    0.536    0.088    6.106    0.000    0.536    0.432
    x3      (lmb3)    0.707    0.087    8.148    0.000    0.707    0.608
  textual =~                                                            
    x4      (lmb4)    0.935    0.072   12.929    0.000    0.935    0.813
    x5      (lmb5)    1.045    0.076   13.740    0.000    1.045    0.832
    x6      (lmb6)    0.874    0.070   12.496    0.000    0.874    0.865
  speed =~                                                              
    x7      (lmb7)    0.550    0.075    7.346    0.000    0.550    0.510
    x8      (lmb8)    0.675    0.087    7.784    0.000    0.675    0.686
    x9      (lmb9)    0.602    0.088    6.867    0.000    0.602    0.603

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textual           0.473    0.105    4.484    0.000    0.473    0.473
    speed             0.347    0.125    2.778    0.005    0.347    0.347
  textual ~~                                                            
    speed             0.320    0.096    3.342    0.001    0.320    0.320

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            0.000                               0.000    0.000
    textual           0.000                               0.000    0.000
    speed             0.000                               0.000    0.000
   .x1                4.948    0.095   52.314    0.000    4.948    4.243
   .x2                5.984    0.098   60.949    0.000    5.984    4.823
   .x3                2.510    0.093   26.891    0.000    2.510    2.157
   .x4                2.814    0.091   30.886    0.000    2.814    2.448
   .x5                4.002    0.105   38.265    0.000    4.002    3.186
   .x6                1.929    0.079   24.377    0.000    1.929    1.907
   .x7                4.439    0.087   51.128    0.000    4.439    4.117
   .x8                5.564    0.079   70.170    0.000    5.564    5.655
   .x9                5.426    0.080   67.539    0.000    5.426    5.435

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            1.000                               1.000    1.000
    textual           1.000                               1.000    1.000
    speed             1.000                               1.000    1.000
   .x1                0.577    0.166    3.482    0.000    0.577    0.424
   .x2                1.252    0.162    7.718    0.000    1.252    0.813
   .x3                0.853    0.127    6.737    0.000    0.853    0.630
   .x4                0.447    0.072    6.189    0.000    0.447    0.339
   .x5                0.486    0.075    6.445    0.000    0.486    0.308
   .x6                0.258    0.057    4.499    0.000    0.258    0.252
   .x7                0.860    0.114    7.549    0.000    0.860    0.739
   .x8                0.512    0.097    5.296    0.000    0.512    0.529
   .x9                0.635    0.118    5.376    0.000    0.635    0.637

R-Square:
                   Estimate
    x1                0.576
    x2                0.187
    x3                0.370
    x4                0.661
    x5                0.692
    x6                0.748
    x7                0.261
    x8                0.471
    x9                0.363


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (lmb1)    0.885    0.122    7.258    0.000    0.844    0.723
    x2      (lmb2)    0.536    0.088    6.106    0.000    0.512    0.467
    x3      (lmb3)    0.707    0.087    8.148    0.000    0.675    0.655
  textual =~                                                            
    x4      (lmb4)    0.935    0.072   12.929    0.000    0.937    0.846
    x5      (lmb5)    1.045    0.076   13.740    0.000    1.047    0.864
    x6      (lmb6)    0.874    0.070   12.496    0.000    0.876    0.798
  speed =~                                                              
    x7      (lmb7)    0.550    0.075    7.346    0.000    0.674    0.649
    x8      (lmb8)    0.675    0.087    7.784    0.000    0.826    0.790
    x9      (lmb9)    0.602    0.088    6.867    0.000    0.736    0.719

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textual           0.520    0.134    3.867    0.000    0.544    0.544
    speed             0.638    0.211    3.023    0.002    0.546    0.546
  textual ~~                                                            
    speed             0.429    0.193    2.219    0.026    0.350    0.350

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            0.000                               0.000    0.000
    textual           0.000                               0.000    0.000
    speed             0.000                               0.000    0.000
   .x1                4.930    0.096   51.453    0.000    4.930    4.220
   .x2                6.198    0.092   67.063    0.000    6.198    5.654
   .x3                1.992    0.086   23.042    0.000    1.992    1.934
   .x4                3.318    0.093   35.501    0.000    3.318    2.997
   .x5                4.714    0.097   48.693    0.000    4.714    3.891
   .x6                2.467    0.094   26.165    0.000    2.467    2.246
   .x7                3.923    0.087   45.299    0.000    3.923    3.782
   .x8                5.488    0.087   63.174    0.000    5.488    5.250
   .x9                5.338    0.085   62.628    0.000    5.338    5.216

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            0.910    0.234    3.895    0.000    1.000    1.000
    textual           1.004    0.191    5.257    0.000    1.000    1.000
    speed             1.498    0.357    4.201    0.000    1.000    1.000
   .x1                0.652    0.168    3.877    0.000    0.652    0.478
   .x2                0.940    0.145    6.473    0.000    0.940    0.782
   .x3                0.606    0.113    5.376    0.000    0.606    0.571
   .x4                0.348    0.066    5.257    0.000    0.348    0.284
   .x5                0.371    0.074    5.021    0.000    0.371    0.253
   .x6                0.439    0.076    5.738    0.000    0.439    0.364
   .x7                0.622    0.098    6.338    0.000    0.622    0.578
   .x8                0.410    0.148    2.765    0.006    0.410    0.375
   .x9                0.505    0.128    3.957    0.000    0.505    0.482

R-Square:
                   Estimate
    x1                0.522
    x2                0.218
    x3                0.429
    x4                0.716
    x5                0.747
    x6                0.636
    x7                0.422
    x8                0.625
    x9                0.518</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceMetricModelFitCriteria" class="level4" data-number="16.10.6.5"><h4 data-number="16.10.6.5" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelFitCriteria">
<span class="header-section-number">16.10.6.5</span> Model Fit</h4>
<p>You can specify the null model as the baseline model using: <code>baseline.model = nullModelFit</code></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="fu">fitMeasures</span>(metricInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                         npar                          fmin 
                       54.000                         0.193 
                        chisq                            df 
                      116.313                        54.000 
                       pvalue                  chisq.scaled 
                        0.000                       117.955 
                    df.scaled                 pvalue.scaled 
                       54.000                         0.000 
         chisq.scaling.factor                baseline.chisq 
                        0.986                       932.665 
                  baseline.df               baseline.pvalue 
                       72.000                         0.000 
        baseline.chisq.scaled            baseline.df.scaled 
                      909.019                        72.000 
       baseline.pvalue.scaled baseline.chisq.scaling.factor 
                        0.000                         1.026 
                          cfi                           tli 
                        0.928                         0.903 
                   cfi.scaled                    tli.scaled 
                        0.924                         0.898 
                   cfi.robust                    tli.robust 
                        0.928                         0.905 
                         nnfi                           rfi 
                        0.903                         0.834 
                          nfi                          pnfi 
                        0.875                         0.656 
                          ifi                           rni 
                        0.929                         0.928 
                  nnfi.scaled                    rfi.scaled 
                        0.898                         0.827 
                   nfi.scaled                   pnfi.scaled 
                        0.870                         0.653 
                   ifi.scaled                    rni.scaled 
                        0.925                         0.924 
                  nnfi.robust                    rni.robust 
                        0.905                         0.928 
                         logl             unrestricted.logl 
                    -3652.277                     -3594.120 
                          aic                           bic 
                     7412.554                      7612.738 
                       ntotal                          bic2 
                      301.000                      7441.480 
            scaling.factor.h1             scaling.factor.h0 
                        1.034                         0.928 
                        rmsea                rmsea.ci.lower 
                        0.088                         0.066 
               rmsea.ci.upper                rmsea.ci.level 
                        0.109                         0.900 
                 rmsea.pvalue                rmsea.close.h0 
                        0.004                         0.050 
        rmsea.notclose.pvalue             rmsea.notclose.h0 
                        0.730                         0.080 
                 rmsea.scaled         rmsea.ci.lower.scaled 
                        0.089                         0.067 
        rmsea.ci.upper.scaled           rmsea.pvalue.scaled 
                        0.111                         0.003 
 rmsea.notclose.pvalue.scaled                  rmsea.robust 
                        0.757                         0.088 
        rmsea.ci.lower.robust         rmsea.ci.upper.robust 
                        0.066                         0.111 
          rmsea.pvalue.robust  rmsea.notclose.pvalue.robust 
                        0.004                         0.740 
                          rmr                    rmr_nomean 
                        0.085                         0.093 
                         srmr                  srmr_bentler 
                        0.069                         0.069 
          srmr_bentler_nomean                          crmr 
                        0.075                         0.073 
                  crmr_nomean                    srmr_mplus 
                        0.081                         0.072 
            srmr_mplus_nomean                         cn_05 
                        0.074                       187.721 
                        cn_01                           gfi 
                      210.793                         0.995 
                         agfi                          pgfi 
                        0.989                         0.497 
                          mfi                          ecvi 
                        0.902                         0.745 
attr(,"scaled.test")
[1] "yuan.bentler.mplus"</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a>metricInvarianceModelFitIndices <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb141-2"><a href="#cb141-2"></a>  metricInvarianceModel_fit)[<span class="fu">c</span>(</span>
<span id="cb141-3"><a href="#cb141-3"></a>    <span class="st">"cfi.robust"</span>, <span class="st">"rmsea.robust"</span>, <span class="st">"srmr"</span>)]</span>
<span id="cb141-4"><a href="#cb141-4"></a></span>
<span id="cb141-5"><a href="#cb141-5"></a>metricInvarianceModel_chisquare <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb141-6"><a href="#cb141-6"></a>  metricInvarianceModel_fit)[<span class="fu">c</span>(<span class="st">"chisq.scaled"</span>)]</span>
<span id="cb141-7"><a href="#cb141-7"></a></span>
<span id="cb141-8"><a href="#cb141-8"></a>metricInvarianceModel_chisquareScaling <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb141-9"><a href="#cb141-9"></a>  metricInvarianceModel_fit)[<span class="fu">c</span>(<span class="st">"chisq.scaling.factor"</span>)]</span>
<span id="cb141-10"><a href="#cb141-10"></a></span>
<span id="cb141-11"><a href="#cb141-11"></a>metricInvarianceModel_df <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb141-12"><a href="#cb141-12"></a>  metricInvarianceModel_fit)[<span class="fu">c</span>(<span class="st">"df.scaled"</span>)]</span>
<span id="cb141-13"><a href="#cb141-13"></a></span>
<span id="cb141-14"><a href="#cb141-14"></a>metricInvarianceModel_N <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(</span>
<span id="cb141-15"><a href="#cb141-15"></a>  metricInvarianceModel_fit, <span class="at">what =</span> <span class="st">"ntotal"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceMetricModelCompare" class="level4" data-number="16.10.6.6"><h4 data-number="16.10.6.6" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelCompare">
<span class="header-section-number">16.10.6.6</span> Compare Model Fit</h4>
<section id="sec-measurementInvarianceMetricModelNestedModelComparison" class="level5" data-number="16.10.6.6.1"><h5 data-number="16.10.6.6.1" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelNestedModelComparison">
<span class="header-section-number">16.10.6.6.1</span> Nested Model (<span class="math inline">\(\chi^2\)</span>) Difference Test</h5>
<p>The configural invariance model and the metric (“weak factorial”) invariance model are considered “nested” models. The metric invariance model is nested within the configural invariance model because the configural invariance model includes all of the terms of the metric invariance model along with additional terms. Model fit of nested models can be compared with a chi-square difference test, also known as a likelihood ratio test or deviance test. A significant chi-square difference test would indicate that the simplified model with additional constraints (the metric invariance model) is significantly worse fitting than the more complex model that has fewer constraints (the configural invariance model).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a><span class="fu">anova</span>(configuralInvarianceModel_fit, metricInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"48","2":"7417.666","3":"7640.092","4":"109.4252","5":"NA","6":"NA","7":"NA","_rn_":"configuralInvarianceModel_fit"},{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"5.464443","6":"6","7":"0.4857647","_rn_":"metricInvarianceModel_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The metric invariance model did not fit significantly worse than the configural invariance model, so metric invariance held. This provides evidence of measurement invariance of factor loadings across groups. Measurement invariance of factor loadings across groups provides support for examining whether the groups show different associations of the factor with other constructs <span class="citation" data-cites="Little2007">(<a href="references.html#ref-Little2007" role="doc-biblioref">Little et al., 2007</a>)</span>.</p>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>satorraBentlerScaledChiSquareDifferenceTestStatistic()</code> function that performs a Satorra-Bentler scaled chi-square difference test: Below is a Satorra-Bentler scaled chi-square difference test, where <span class="math inline">\(c0\)</span> and <span class="math inline">\(c1\)</span> are the scaling correction factor for the nested model and comparison model, respectively; <span class="math inline">\(d0\)</span> and <span class="math inline">\(d1\)</span> are the degrees of freedom of the nested model and comparison model, respectively; and <span class="math inline">\(T0\)</span> and <span class="math inline">\(T1\)</span> are the chi-square values of the nested model and comparison model, respectively.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a>metricInvarianceModel_chisquareDiff <span class="ot">&lt;-</span> </span>
<span id="cb143-2"><a href="#cb143-2"></a>  <span class="fu">satorraBentlerScaledChiSquareDifferenceTestStatistic</span>(</span>
<span id="cb143-3"><a href="#cb143-3"></a>    <span class="at">T0 =</span> metricInvarianceModel_chisquare,</span>
<span id="cb143-4"><a href="#cb143-4"></a>    <span class="at">c0 =</span> metricInvarianceModel_chisquareScaling,</span>
<span id="cb143-5"><a href="#cb143-5"></a>    <span class="at">d0 =</span> metricInvarianceModel_df,</span>
<span id="cb143-6"><a href="#cb143-6"></a>    <span class="at">T1 =</span> configuralInvarianceModel_chisquare,</span>
<span id="cb143-7"><a href="#cb143-7"></a>    <span class="at">c1 =</span> configuralInvarianceModel_chisquareScaling,</span>
<span id="cb143-8"><a href="#cb143-8"></a>    <span class="at">d1 =</span> configuralInvarianceModel_df)</span>
<span id="cb143-9"><a href="#cb143-9"></a></span>
<span id="cb143-10"><a href="#cb143-10"></a>metricInvarianceModel_chisquareDiff</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>chisq.scaled 
    5.464443 </code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceMetricModelCompareFitCriteria" class="level5" data-number="16.10.6.6.2"><h5 data-number="16.10.6.6.2" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelCompareFitCriteria">
<span class="header-section-number">16.10.6.6.2</span> Compare Other Fit Criteria</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a><span class="fu">round</span>(metricInvarianceModelFitIndices <span class="sc">-</span> configuralInvarianceModelFitIndices, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  cfi.robust rmsea.robust         srmr 
      -0.001       -0.005        0.003 </code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceMetricModelScoreBasedTest" class="level5" data-number="16.10.6.6.3"><h5 data-number="16.10.6.6.3" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelScoreBasedTest">
<span class="header-section-number">16.10.6.6.3</span> Score-Based Test</h5>
<p>Score-based tests of measurement invariance are implemented using the <code>strucchange</code> package and are described by <span class="citation" data-cites="Wang2014a">T. Wang et al. (<a href="references.html#ref-Wang2014a" role="doc-biblioref">2014</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="fu">coef</span>(metricInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  lambda.1_1   lambda.2_1   lambda.3_1   lambda.4_2   lambda.5_2   lambda.6_2 
       0.885        0.536        0.707        0.935        1.045        0.874 
  lambda.7_3   lambda.8_3   lambda.9_3      nu.1.g1      nu.2.g1      nu.3.g1 
       0.550        0.675        0.602        4.948        5.984        2.510 
     nu.4.g1      nu.5.g1      nu.6.g1      nu.7.g1      nu.8.g1      nu.9.g1 
       2.814        4.002        1.929        4.439        5.564        5.426 
theta.1_1.g1 theta.2_2.g1 theta.3_3.g1 theta.4_4.g1 theta.5_5.g1 theta.6_6.g1 
       0.577        1.252        0.853        0.447        0.486        0.258 
theta.7_7.g1 theta.8_8.g1 theta.9_9.g1   psi.2_1.g1   psi.3_1.g1   psi.3_2.g1 
       0.860        0.512        0.635        0.473        0.347        0.320 
  lambda.1_1   lambda.2_1   lambda.3_1   lambda.4_2   lambda.5_2   lambda.6_2 
       0.885        0.536        0.707        0.935        1.045        0.874 
  lambda.7_3   lambda.8_3   lambda.9_3      nu.1.g2      nu.2.g2      nu.3.g2 
       0.550        0.675        0.602        4.930        6.198        1.992 
     nu.4.g2      nu.5.g2      nu.6.g2      nu.7.g2      nu.8.g2      nu.9.g2 
       3.318        4.714        2.467        3.923        5.488        5.338 
theta.1_1.g2 theta.2_2.g2 theta.3_3.g2 theta.4_4.g2 theta.5_5.g2 theta.6_6.g2 
       0.652        0.940        0.606        0.348        0.371        0.439 
theta.7_7.g2 theta.8_8.g2 theta.9_9.g2   psi.1_1.g2   psi.2_2.g2   psi.3_3.g2 
       0.622        0.410        0.505        0.910        1.004        1.498 
  psi.2_1.g2   psi.3_1.g2   psi.3_2.g2 
       0.520        0.638        0.429 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a><span class="fu">coef</span>(metricInvarianceModel_fit)[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lambda.1_1 lambda.2_1 lambda.3_1 lambda.4_2 lambda.5_2 lambda.6_2 lambda.7_3 
 0.8850052  0.5363099  0.7072357  0.9347277  1.0449934  0.8743059  0.5504042 
lambda.8_3 lambda.9_3 
 0.6751277  0.6015120 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a>strucchange<span class="sc">::</span><span class="fu">sctest</span>(</span>
<span id="cb151-2"><a href="#cb151-2"></a>  metricInvarianceModel_fit,</span>
<span id="cb151-3"><a href="#cb151-3"></a>  <span class="at">order.by =</span> HolzingerSwineford1939<span class="sc">$</span>school,</span>
<span id="cb151-4"><a href="#cb151-4"></a>  <span class="at">parm =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb151-5"><a href="#cb151-5"></a>  <span class="at">functional =</span> <span class="st">"LMuo"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    M-fluctuation test

data:  metricInvarianceModel_fit
f(efp) = 5.0601, p-value = 0.829</code></pre>
</div>
</div>
<p>A score-based test and expected parameter change (EPC) estimates <span class="citation" data-cites="Oberski2014 Oberski2015">(<a href="references.html#ref-Oberski2014" role="doc-biblioref">Oberski, 2014</a>; <a href="references.html#ref-Oberski2015" role="doc-biblioref">Oberski et al., 2015</a>)</span> are provided by the <code>lavaan</code> package <span class="citation" data-cites="R-lavaan">(<a href="references.html#ref-R-lavaan" role="doc-biblioref">Rosseel et al., 2022</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a><span class="fu">lavTestScore</span>(</span>
<span id="cb153-2"><a href="#cb153-2"></a>  metricInvarianceModel_fit,</span>
<span id="cb153-3"><a href="#cb153-3"></a>  <span class="at">epc =</span> <span class="cn">TRUE</span></span>
<span id="cb153-4"><a href="#cb153-4"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$test

total score test:

   test    X2 df p.value
1 score 6.199  9    0.72

$uni

univariate score tests:

   lhs op   rhs    X2 df p.value
1 .p1. == .p37. 1.303  1   0.254
2 .p2. == .p38. 0.468  1   0.494
3 .p3. == .p39. 0.334  1   0.563
4 .p4. == .p40. 0.314  1   0.575
5 .p5. == .p41. 4.447  1   0.035
6 .p6. == .p42. 2.539  1   0.111
7 .p7. == .p43. 0.027  1   0.869
8 .p8. == .p44. 0.005  1   0.942
9 .p9. == .p45. 0.007  1   0.932

$epc

expected parameter changes (epc) and expected parameter values (epv):

       lhs op     rhs block group free        label plabel   est    epc   epv
1   visual =~      x1     1     1    1   lambda.1_1   .p1. 0.885  0.072 0.957
2   visual =~      x2     1     1    2   lambda.2_1   .p2. 0.536 -0.060 0.476
3   visual =~      x3     1     1    3   lambda.3_1   .p3. 0.707 -0.052 0.655
4  textual =~      x4     1     1    4   lambda.4_2   .p4. 0.935 -0.018 0.916
5  textual =~      x5     1     1    5   lambda.5_2   .p5. 1.045  0.081 1.126
6  textual =~      x6     1     1    6   lambda.6_2   .p6. 0.874 -0.042 0.832
7    speed =~      x7     1     1    7   lambda.7_3   .p7. 0.550  0.013 0.563
8    speed =~      x8     1     1    8   lambda.8_3   .p8. 0.675 -0.004 0.671
9    speed =~      x9     1     1    9   lambda.9_3   .p9. 0.602 -0.004 0.597
10      x1 ~1             1     1   10      nu.1.g1  .p10. 4.948  0.000 4.948
11      x2 ~1             1     1   11      nu.2.g1  .p11. 5.984  0.000 5.984
12      x3 ~1             1     1   12      nu.3.g1  .p12. 2.510  0.000 2.510
13      x4 ~1             1     1   13      nu.4.g1  .p13. 2.814  0.000 2.814
14      x5 ~1             1     1   14      nu.5.g1  .p14. 4.002  0.000 4.002
15      x6 ~1             1     1   15      nu.6.g1  .p15. 1.929  0.000 1.929
16      x7 ~1             1     1   16      nu.7.g1  .p16. 4.439  0.000 4.439
17      x8 ~1             1     1   17      nu.8.g1  .p17. 5.564  0.000 5.564
18      x9 ~1             1     1   18      nu.9.g1  .p18. 5.426  0.000 5.426
19      x1 ~~      x1     1     1   19 theta.1_1.g1  .p19. 0.577 -0.094 0.483
20      x2 ~~      x2     1     1   20 theta.2_2.g1  .p20. 1.252  0.029 1.280
21      x3 ~~      x3     1     1   21 theta.3_3.g1  .p21. 0.853  0.048 0.901
22      x4 ~~      x4     1     1   22 theta.4_4.g1  .p22. 0.447  0.005 0.453
23      x5 ~~      x5     1     1   23 theta.5_5.g1  .p23. 0.486 -0.048 0.439
24      x6 ~~      x6     1     1   24 theta.6_6.g1  .p24. 0.258  0.026 0.284
25      x7 ~~      x7     1     1   25 theta.7_7.g1  .p25. 0.860 -0.007 0.853
26      x8 ~~      x8     1     1   26 theta.8_8.g1  .p26. 0.512  0.004 0.516
27      x9 ~~      x9     1     1   27 theta.9_9.g1  .p27. 0.635  0.002 0.637
28  visual ~1             1     1    0   alpha.1.g1  .p28. 0.000     NA    NA
29 textual ~1             1     1    0   alpha.2.g1  .p29. 0.000     NA    NA
30   speed ~1             1     1    0   alpha.3.g1  .p30. 0.000     NA    NA
31  visual ~~  visual     1     1    0   psi.1_1.g1  .p31. 1.000     NA    NA
32 textual ~~ textual     1     1    0   psi.2_2.g1  .p32. 1.000     NA    NA
33   speed ~~   speed     1     1    0   psi.3_3.g1  .p33. 1.000     NA    NA
34  visual ~~ textual     1     1   28   psi.2_1.g1  .p34. 0.473 -0.009 0.464
35  visual ~~   speed     1     1   29   psi.3_1.g1  .p35. 0.347 -0.007 0.341
36 textual ~~   speed     1     1   30   psi.3_2.g1  .p36. 0.320  0.001 0.320
37  visual =~      x1     2     2   31   lambda.1_1  .p37. 0.885 -0.056 0.829
38  visual =~      x2     2     2   32   lambda.2_1  .p38. 0.536  0.046 0.583
39  visual =~      x3     2     2   33   lambda.3_1  .p39. 0.707  0.033 0.740
40 textual =~      x4     2     2   34   lambda.4_2  .p40. 0.935  0.023 0.958
41 textual =~      x5     2     2   35   lambda.5_2  .p41. 1.045 -0.072 0.973
42 textual =~      x6     2     2   36   lambda.6_2  .p42. 0.874  0.065 0.939
43   speed =~      x7     2     2   37   lambda.7_3  .p43. 0.550 -0.005 0.545
44   speed =~      x8     2     2   38   lambda.8_3  .p44. 0.675  0.002 0.677
45   speed =~      x9     2     2   39   lambda.9_3  .p45. 0.602  0.002 0.604
46      x1 ~1             2     2   40      nu.1.g2  .p46. 4.930  0.000 4.930
47      x2 ~1             2     2   41      nu.2.g2  .p47. 6.198  0.000 6.198
48      x3 ~1             2     2   42      nu.3.g2  .p48. 1.992  0.000 1.992
49      x4 ~1             2     2   43      nu.4.g2  .p49. 3.318  0.000 3.318
50      x5 ~1             2     2   44      nu.5.g2  .p50. 4.714  0.000 4.714
51      x6 ~1             2     2   45      nu.6.g2  .p51. 2.467  0.000 2.467
52      x7 ~1             2     2   46      nu.7.g2  .p52. 3.923  0.000 3.923
53      x8 ~1             2     2   47      nu.8.g2  .p53. 5.488  0.000 5.488
54      x9 ~1             2     2   48      nu.9.g2  .p54. 5.338  0.000 5.338
55      x1 ~~      x1     2     2   49 theta.1_1.g2  .p55. 0.652  0.051 0.702
56      x2 ~~      x2     2     2   50 theta.2_2.g2  .p56. 0.940 -0.015 0.924
57      x3 ~~      x3     2     2   51 theta.3_3.g2  .p57. 0.606 -0.022 0.584
58      x4 ~~      x4     2     2   52 theta.4_4.g2  .p58. 0.348 -0.018 0.330
59      x5 ~~      x5     2     2   53 theta.5_5.g2  .p59. 0.371  0.050 0.421
60      x6 ~~      x6     2     2   54 theta.6_6.g2  .p60. 0.439 -0.027 0.412
61      x7 ~~      x7     2     2   55 theta.7_7.g2  .p61. 0.622  0.003 0.625
62      x8 ~~      x8     2     2   56 theta.8_8.g2  .p62. 0.410 -0.002 0.408
63      x9 ~~      x9     2     2   57 theta.9_9.g2  .p63. 0.505 -0.001 0.504
64  visual ~1             2     2    0   alpha.1.g2  .p64. 0.000     NA    NA
65 textual ~1             2     2    0   alpha.2.g2  .p65. 0.000     NA    NA
66   speed ~1             2     2    0   alpha.3.g2  .p66. 0.000     NA    NA
67  visual ~~  visual     2     2   58   psi.1_1.g2  .p67. 0.910 -0.002 0.907
68 textual ~~ textual     2     2   59   psi.2_2.g2  .p68. 1.004  0.000 1.005
69   speed ~~   speed     2     2   60   psi.3_3.g2  .p69. 1.498 -0.001 1.497
70  visual ~~ textual     2     2   61   psi.2_1.g2  .p70. 0.520  0.003 0.523
71  visual ~~   speed     2     2   62   psi.3_1.g2  .p71. 0.638  0.003 0.641
72 textual ~~   speed     2     2   63   psi.3_2.g2  .p72. 0.429  0.001 0.430
   sepc.lv sepc.all sepc.nox
1    0.072    0.062    0.062
2   -0.060   -0.048   -0.048
3   -0.052   -0.045   -0.045
4   -0.018   -0.016   -0.016
5    0.081    0.065    0.065
6   -0.042   -0.042   -0.042
7    0.013    0.012    0.012
8   -0.004   -0.004   -0.004
9   -0.004   -0.004   -0.004
10   0.000    0.000    0.000
11   0.000    0.000    0.000
12   0.000    0.000    0.000
13   0.000    0.000    0.000
14   0.000    0.000    0.000
15   0.000    0.000    0.000
16   0.000    0.000    0.000
17   0.000    0.000    0.000
18   0.000    0.000    0.000
19  -0.577   -0.424   -0.424
20   1.252    0.813    0.813
21   0.853    0.630    0.630
22   0.447    0.339    0.339
23  -0.486   -0.308   -0.308
24   0.258    0.252    0.252
25  -0.860   -0.739   -0.739
26   0.512    0.529    0.529
27   0.635    0.637    0.637
28      NA       NA       NA
29      NA       NA       NA
30      NA       NA       NA
31      NA       NA       NA
32      NA       NA       NA
33      NA       NA       NA
34  -0.009   -0.009   -0.009
35  -0.007   -0.007   -0.007
36   0.001    0.001    0.001
37  -0.053   -0.045   -0.045
38   0.044    0.040    0.040
39   0.031    0.030    0.030
40   0.023    0.021    0.021
41  -0.072   -0.060   -0.060
42   0.065    0.059    0.059
43  -0.006   -0.006   -0.006
44   0.002    0.002    0.002
45   0.003    0.003    0.003
46   0.000    0.000    0.000
47   0.000    0.000    0.000
48   0.000    0.000    0.000
49   0.000    0.000    0.000
50   0.000    0.000    0.000
51   0.000    0.000    0.000
52   0.000    0.000    0.000
53   0.000    0.000    0.000
54   0.000    0.000    0.000
55   0.652    0.478    0.478
56  -0.940   -0.782   -0.782
57  -0.606   -0.571   -0.571
58  -0.348   -0.284   -0.284
59   0.371    0.253    0.253
60  -0.439   -0.364   -0.364
61   0.622    0.578    0.578
62  -0.410   -0.375   -0.375
63  -0.505   -0.482   -0.482
64      NA       NA       NA
65      NA       NA       NA
66      NA       NA       NA
67  -1.000   -1.000   -1.000
68   1.000    1.000    1.000
69  -1.000   -1.000   -1.000
70   0.003    0.003    0.003
71   0.002    0.002    0.002
72   0.000    0.000    0.000</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceMetricModelEffectSize" class="level5" data-number="16.10.6.6.4"><h5 data-number="16.10.6.6.4" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelEffectSize">
<span class="header-section-number">16.10.6.6.4</span> Effect Size of Non-Invariance</h5>
<p>The effect size of measurement non-invariance, as described by <span class="citation" data-cites="Nye2019">Nye et al. (<a href="references.html#ref-Nye2019" role="doc-biblioref">2019</a>)</span>, was calculated using the <code>dmacs</code> package <span class="citation" data-cites="R-dmacs">(<a href="references.html#ref-R-dmacs" role="doc-biblioref">Dueber, 2019</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a><span class="fu">lavaan_dmacs</span>(metricInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$DMACS
       visual   textual      speed
x1 0.01593095        NA         NA
x2 0.18201703        NA         NA
x3 0.46928939        NA         NA
x4         NA 0.4447078         NA
x5         NA 0.5774043         NA
x6         NA 0.5099205         NA
x7         NA        NA 0.48491342
x8         NA        NA 0.07411716
x9         NA        NA 0.08693423

$ItemDeltaMean
        visual   textual       speed
x1 -0.01861594        NA          NA
x2  0.21369298        NA          NA
x3 -0.51750811        NA          NA
x4          NA 0.5039787          NA
x5          NA 0.7122322          NA
x6          NA 0.5384225          NA
x7          NA        NA -0.51565293
x8          NA        NA -0.07526967
x9          NA        NA -0.08805919

$MeanDiff
    visual    textual      speed 
-0.3224311  1.7546334 -0.6789818 </code></pre>
</div>
</div>
<p>The <span class="math inline">\(w\)</span> and <span class="math inline">\(\Delta \text{M}_\text{C}\)</span> indices of the effect size of measurement non-invariance, as described by <span class="citation" data-cites="Newsom2015">Newsom (<a href="references.html#ref-Newsom2015" role="doc-biblioref">2015</a>)</span>, were calculated using the <code>measurementNoninvarianceEffectSize()</code> function of the <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a>petersenlab<span class="sc">::</span><span class="fu">measurementNoninvarianceEffectSize</span>(</span>
<span id="cb157-2"><a href="#cb157-2"></a>  <span class="at">model_unconstrained =</span> configuralInvarianceModel_fit,</span>
<span id="cb157-3"><a href="#cb157-3"></a>  <span class="at">model_constrained =</span> metricInvarianceModel_fit</span>
<span id="cb157-4"><a href="#cb157-4"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$Mc_unconstrained
[1] 0.9026906

$Mc_constrained
[1] 0.9013555

$Delta_Mc
[1] 0.001335086

$w
[1] 0.06175749</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceMetricModelEquivalenceTest" class="level5" data-number="16.10.6.6.5"><h5 data-number="16.10.6.6.5" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelEquivalenceTest">
<span class="header-section-number">16.10.6.6.5</span> Equivalence Test</h5>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>equiv_chi()</code> function from <span class="citation" data-cites="Counsell2020">Counsell et al. (<a href="references.html#ref-Counsell2020" role="doc-biblioref">2020</a>)</span> that performs an equivalence test: <a href="https://osf.io/cqu8v" class="uri">https://osf.io/cqu8v</a>. The chi-square equivalence test is non-significant, suggesting that the model fit is not acceptable.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1"></a><span class="fu">equiv_chi</span>(</span>
<span id="cb159-2"><a href="#cb159-2"></a>  <span class="at">alpha =</span> .<span class="dv">05</span>,</span>
<span id="cb159-3"><a href="#cb159-3"></a>  <span class="at">chi =</span> metricInvarianceModel_chisquare,</span>
<span id="cb159-4"><a href="#cb159-4"></a>  <span class="at">df =</span> metricInvarianceModel_df,</span>
<span id="cb159-5"><a href="#cb159-5"></a>  <span class="at">m =</span> <span class="dv">2</span>,</span>
<span id="cb159-6"><a href="#cb159-6"></a>  <span class="at">N_sample =</span> metricInvarianceModel_N,</span>
<span id="cb159-7"><a href="#cb159-7"></a>  <span class="at">popRMSEA =</span> .<span class="dv">08</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["chi"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Fml"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["popep"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["popdelt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pval"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"117.9554","2":"0.3944997","3":"0.1728","4":"51.6672","5":"0.7639705","_rn_":"chisq.scaled"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Moreover, the equivalence test of the chi-square difference test is non-significant, suggesting that the degree of worsening of model fit is not acceptable. In other words, metric invariance failed.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb160"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1"></a>metricInvarianceModel_dfDiff <span class="ot">&lt;-</span> </span>
<span id="cb160-2"><a href="#cb160-2"></a>  metricInvarianceModel_df <span class="sc">-</span> configuralInvarianceModel_df</span>
<span id="cb160-3"><a href="#cb160-3"></a></span>
<span id="cb160-4"><a href="#cb160-4"></a><span class="fu">equiv_chi</span>(</span>
<span id="cb160-5"><a href="#cb160-5"></a>  <span class="at">alpha =</span> .<span class="dv">05</span>,</span>
<span id="cb160-6"><a href="#cb160-6"></a>  <span class="at">chi =</span> metricInvarianceModel_chisquareDiff,</span>
<span id="cb160-7"><a href="#cb160-7"></a>  <span class="at">df =</span> metricInvarianceModel_dfDiff,</span>
<span id="cb160-8"><a href="#cb160-8"></a>  <span class="at">m =</span> <span class="dv">2</span>,</span>
<span id="cb160-9"><a href="#cb160-9"></a>  <span class="at">N_sample =</span> metricInvarianceModel_N,</span>
<span id="cb160-10"><a href="#cb160-10"></a>  <span class="at">popRMSEA =</span> .<span class="dv">08</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["chi"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Fml"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["popep"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["popdelt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pval"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"5.464443","2":"0.01827573","3":"0.0192","4":"5.7408","5":"0.1274538","_rn_":"chisq.scaled"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceMetricModelPermutationTest" class="level5" data-number="16.10.6.6.6"><h5 data-number="16.10.6.6.6" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelPermutationTest">
<span class="header-section-number">16.10.6.6.6</span> Permutation Test</h5>
<p>Permutation procedures for testing measurement invariance are described in <span class="citation" data-cites="Jorgensen2018">(<a href="references.html#ref-Jorgensen2018" role="doc-biblioref">Jorgensen et al., 2018</a>)</span>.</p>
<p>For reproducibility, I set the seed below. Using the same seed will yield the same answer every time. There is nothing special about this particular seed. You can specify the null model as the baseline model using: <code>baseline.model = nullModelFit</code>. <strong>Warning</strong>: this code takes a while to run based on <span class="math inline">\(100\)</span> iterations. You can reduce the number of iterations to be faster.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb161-2"><a href="#cb161-2"></a>metricInvarianceTest <span class="ot">&lt;-</span> <span class="fu">permuteMeasEq</span>(</span>
<span id="cb161-3"><a href="#cb161-3"></a>  <span class="at">nPermute =</span> numPermutations,</span>
<span id="cb161-4"><a href="#cb161-4"></a>  <span class="at">modelType =</span> <span class="st">"mgcfa"</span>,</span>
<span id="cb161-5"><a href="#cb161-5"></a>  <span class="at">con =</span> metricInvarianceModel_fit,</span>
<span id="cb161-6"><a href="#cb161-6"></a>  <span class="at">uncon =</span> configuralInvarianceModel_fit,</span>
<span id="cb161-7"><a href="#cb161-7"></a>  <span class="at">AFIs =</span> myAFIs,</span>
<span id="cb161-8"><a href="#cb161-8"></a>  <span class="at">moreAFIs =</span> moreAFIs,</span>
<span id="cb161-9"><a href="#cb161-9"></a>  <span class="at">parallelType =</span> <span class="st">"multicore"</span>, <span class="co">#only 'snow' works on Windows, but right now, it is throwing an error</span></span>
<span id="cb161-10"><a href="#cb161-10"></a>  <span class="at">iseed =</span> <span class="dv">52242</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb162"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1"></a><span class="fu">RNGkind</span>(<span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>)</span>
<span id="cb162-2"><a href="#cb162-2"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb162-3"><a href="#cb162-3"></a></span>
<span id="cb162-4"><a href="#cb162-4"></a>metricInvarianceTest</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Omnibus p value based on parametric chi-squared difference test:

Chisq diff    Df diff Pr(&gt;Chisq) 
     5.464      6.000      0.486 


Omnibus p values based on nonparametric permutation method: 

             AFI.Difference p.value
chisq                 6.888    0.57
chisq.scaled          2.986    0.59
rmsea                -0.005    0.60
cfi                  -0.001    0.57
tli                   0.011    0.61
srmr                  0.003    0.71
rmsea.robust         -0.005    0.61
cfi.robust           -0.001    0.59
tli.robust            0.011    0.64</code></pre>
</div>
</div>
<p>The <em>p</em>-values are non-significant, indicating that the model does not fit significantly worse than the configural invariance model. In other words, metric invariance held.</p>
</section></section><section id="sec-measurementInvarianceMetricModelReliability" class="level4" data-number="16.10.6.7"><h4 data-number="16.10.6.7" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelReliability">
<span class="header-section-number">16.10.6.7</span> Internal Consistency Reliability</h4>
<p><a href="reliability.html#sec-internalConsistency-reliability">Internal consistency reliability</a> of items composing the latent factors, as quantified by <a href="reliability.html#sec-coefficientOmega">omega (<span class="math inline">\(\omega\)</span>)</a>, <a href="reliability.html#sec-averageVarianceExtracted">average variance extracted</a> (AVE), and <a href="reliability.html#sec-maximalReliability">maximal reliability</a>, was estimated using the <code>semTools</code> package <span class="citation" data-cites="R-semTools">(<a href="references.html#ref-R-semTools" role="doc-biblioref">Jorgensen et al., 2021</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb164"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1"></a><span class="fu">compRelSEM</span>(metricInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$visual

Composite `visual` is composed of observed variables:
    x1, x2, x3
True-score variance is represented by common factor(s):
    visual
Total variance of composite `visual` determined from the unrestricted model.
The proportion attributable to "true" scores is its model-based estimate of reliability ("omega"):

    Pasteur Grant-White 
      0.629       0.638 

$textual

Composite `textual` is composed of observed variables:
    x4, x5, x6
True-score variance is represented by common factor(s):
    textual
Total variance of composite `textual` determined from the unrestricted model.
The proportion attributable to "true" scores is its model-based estimate of reliability ("omega"):

    Pasteur Grant-White 
      0.858       0.867 

$speed

Composite `speed` is composed of observed variables:
    x7, x8, x9
True-score variance is represented by common factor(s):
    speed
Total variance of composite `speed` determined from the unrestricted model.
The proportion attributable to "true" scores is its model-based estimate of reliability ("omega"):

    Pasteur Grant-White 
      0.623       0.769 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb166"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1"></a><span class="fu">AVE</span>(metricInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["chr"],"align":["left"]},{"label":["visual"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["textual"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["speed"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Pasteur","2":"0.3713712","3":"0.6861439","4":"0.3579097"},{"1":"Grant-White","2":"0.3939286","3":"0.7009211","4":"0.5225752"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1"></a><span class="fu">maximalRelia</span>(metricInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$Pasteur
[1] 0.9303971
attr(,"weight")
         x1          x2          x3          x4          x5          x6 
-1.21092633  0.43002192  1.21078763  2.96726636  1.10340696  4.40364573 
         x7          x8          x9 
-0.53087954  0.66406330 -0.03738604 

$`Grant-White`
[1] 0.9584814
attr(,"weight")
         x1          x2          x3          x4          x5          x6 
 1.60495305  0.57755722  0.72816587  2.27594440  3.82321655  0.71562981 
         x7          x8          x9 
-0.05745294  1.67794631 -2.34596028 </code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceMetricModelPathDiagram" class="level4" data-number="16.10.6.8"><h4 data-number="16.10.6.8" class="anchored" data-anchor-id="sec-measurementInvarianceMetricModelPathDiagram">
<span class="header-section-number">16.10.6.8</span> Path Diagram</h4>
<p>A path diagram of the model generated using the <code>semPlot</code> package <span class="citation" data-cites="R-semPlot">(<a href="references.html#ref-R-semPlot" role="doc-biblioref">Epskamp, 2022</a>)</span> is below.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1"></a><span class="fu">semPaths</span>(</span>
<span id="cb169-2"><a href="#cb169-2"></a>  metricInvarianceModel_fit,</span>
<span id="cb169-3"><a href="#cb169-3"></a>  <span class="at">what =</span> <span class="st">"est"</span>,</span>
<span id="cb169-4"><a href="#cb169-4"></a>  <span class="at">layout =</span> <span class="st">"tree2"</span>,</span>
<span id="cb169-5"><a href="#cb169-5"></a>  <span class="at">ask =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-6"><a href="#cb169-6"></a>  <span class="at">edge.label.cex =</span> <span class="fl">1.2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-measurementInvarianceMetricModelPathDiagram-1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Metric Invariance Model in Confirmatory Factor Analysis.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-measurementInvarianceMetricModelPathDiagram-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-measurementInvarianceMetricModelPathDiagram-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-57" title="Figure&nbsp;16.60: Metric Invariance Model in Confirmatory Factor Analysis."><img src="test-bias_files/figure-html/fig-measurementInvarianceMetricModelPathDiagram-1.png" class="img-fluid figure-img" alt="Metric Invariance Model in Confirmatory Factor Analysis." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-measurementInvarianceMetricModelPathDiagram-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.60: Metric Invariance Model in Confirmatory Factor Analysis.
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-measurementInvarianceMetricModelPathDiagram-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Metric Invariance Model in Confirmatory Factor Analysis.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-measurementInvarianceMetricModelPathDiagram-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-measurementInvarianceMetricModelPathDiagram-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-58" title="Figure&nbsp;16.61: Metric Invariance Model in Confirmatory Factor Analysis."><img src="test-bias_files/figure-html/fig-measurementInvarianceMetricModelPathDiagram-2.png" class="img-fluid figure-img" alt="Metric Invariance Model in Confirmatory Factor Analysis." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-measurementInvarianceMetricModelPathDiagram-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.61: Metric Invariance Model in Confirmatory Factor Analysis.
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-measurementInvarianceScalarModel" class="level3" data-number="16.10.7"><h3 data-number="16.10.7" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModel">
<span class="header-section-number">16.10.7</span> Scalar (“Strong Factorial”) Invariance Model</h3>
<p>Specify invariance of factor loadings and intercepts across groups.</p>
<section id="sec-measurementInvarianceScalarModelSyntax" class="level4" data-number="16.10.7.1"><h4 data-number="16.10.7.1" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelSyntax">
<span class="header-section-number">16.10.7.1</span> Model Syntax</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a>scalarInvarianceModel <span class="ot">&lt;-</span> <span class="fu">measEq.syntax</span>(</span>
<span id="cb170-2"><a href="#cb170-2"></a>  <span class="at">configural.model =</span> cfaModel,</span>
<span id="cb170-3"><a href="#cb170-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb170-4"><a href="#cb170-4"></a>  <span class="at">ID.fac =</span> <span class="st">"std.lv"</span>,</span>
<span id="cb170-5"><a href="#cb170-5"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb170-6"><a href="#cb170-6"></a>  <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">"loadings"</span>,<span class="st">"intercepts"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a><span class="fu">cat</span>(<span class="fu">as.character</span>(scalarInvarianceModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>## LOADINGS:

visual =~ c(NA, NA)*x1 + c(lambda.1_1, lambda.1_1)*x1
visual =~ c(NA, NA)*x2 + c(lambda.2_1, lambda.2_1)*x2
visual =~ c(NA, NA)*x3 + c(lambda.3_1, lambda.3_1)*x3
textual =~ c(NA, NA)*x4 + c(lambda.4_2, lambda.4_2)*x4
textual =~ c(NA, NA)*x5 + c(lambda.5_2, lambda.5_2)*x5
textual =~ c(NA, NA)*x6 + c(lambda.6_2, lambda.6_2)*x6
speed =~ c(NA, NA)*x7 + c(lambda.7_3, lambda.7_3)*x7
speed =~ c(NA, NA)*x8 + c(lambda.8_3, lambda.8_3)*x8
speed =~ c(NA, NA)*x9 + c(lambda.9_3, lambda.9_3)*x9

## INTERCEPTS:

x1 ~ c(NA, NA)*1 + c(nu.1, nu.1)*1
x2 ~ c(NA, NA)*1 + c(nu.2, nu.2)*1
x3 ~ c(NA, NA)*1 + c(nu.3, nu.3)*1
x4 ~ c(NA, NA)*1 + c(nu.4, nu.4)*1
x5 ~ c(NA, NA)*1 + c(nu.5, nu.5)*1
x6 ~ c(NA, NA)*1 + c(nu.6, nu.6)*1
x7 ~ c(NA, NA)*1 + c(nu.7, nu.7)*1
x8 ~ c(NA, NA)*1 + c(nu.8, nu.8)*1
x9 ~ c(NA, NA)*1 + c(nu.9, nu.9)*1

## UNIQUE-FACTOR VARIANCES:

x1 ~~ c(NA, NA)*x1 + c(theta.1_1.g1, theta.1_1.g2)*x1
x2 ~~ c(NA, NA)*x2 + c(theta.2_2.g1, theta.2_2.g2)*x2
x3 ~~ c(NA, NA)*x3 + c(theta.3_3.g1, theta.3_3.g2)*x3
x4 ~~ c(NA, NA)*x4 + c(theta.4_4.g1, theta.4_4.g2)*x4
x5 ~~ c(NA, NA)*x5 + c(theta.5_5.g1, theta.5_5.g2)*x5
x6 ~~ c(NA, NA)*x6 + c(theta.6_6.g1, theta.6_6.g2)*x6
x7 ~~ c(NA, NA)*x7 + c(theta.7_7.g1, theta.7_7.g2)*x7
x8 ~~ c(NA, NA)*x8 + c(theta.8_8.g1, theta.8_8.g2)*x8
x9 ~~ c(NA, NA)*x9 + c(theta.9_9.g1, theta.9_9.g2)*x9

## LATENT MEANS/INTERCEPTS:

visual ~ c(0, NA)*1 + c(alpha.1.g1, alpha.1.g2)*1
textual ~ c(0, NA)*1 + c(alpha.2.g1, alpha.2.g2)*1
speed ~ c(0, NA)*1 + c(alpha.3.g1, alpha.3.g2)*1

## COMMON-FACTOR VARIANCES:

visual ~~ c(1, NA)*visual + c(psi.1_1.g1, psi.1_1.g2)*visual
textual ~~ c(1, NA)*textual + c(psi.2_2.g1, psi.2_2.g2)*textual
speed ~~ c(1, NA)*speed + c(psi.3_3.g1, psi.3_3.g2)*speed

## COMMON-FACTOR COVARIANCES:

visual ~~ c(NA, NA)*textual + c(psi.2_1.g1, psi.2_1.g2)*textual
visual ~~ c(NA, NA)*speed + c(psi.3_1.g1, psi.3_1.g2)*speed
textual ~~ c(NA, NA)*speed + c(psi.3_2.g1, psi.3_2.g2)*speed</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a>scalarInvarianceSyntax <span class="ot">&lt;-</span> <span class="fu">as.character</span>(scalarInvarianceModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="sec-measurementInvarianceScalarModelFeatures" class="level5" data-number="16.10.7.1.1"><h5 data-number="16.10.7.1.1" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelFeatures">
<span class="header-section-number">16.10.7.1.1</span> Summary of Model Features</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1"></a><span class="fu">summary</span>(scalarInvarianceModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>This lavaan model syntax specifies a CFA with 9 manifest indicators of 3 common factor(s).

To identify the location and scale of each common factor, the factor means and variances were fixed to 0 and 1, respectively, unless equality constraints on measurement parameters allow them to be freed.

Pattern matrix indicating num(eric), ord(ered), and lat(ent) indicators per factor:

   visual textual speed
x1 num                 
x2 num                 
x3 num                 
x4        num          
x5        num          
x6        num          
x7                num  
x8                num  
x9                num  

The following types of parameter were constrained to equality across groups:

    loadings
    intercepts</code></pre>
</div>
</div>
</section></section><section id="sec-measurementInvarianceScalarModelTabular" class="level4" data-number="16.10.7.2"><h4 data-number="16.10.7.2" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelTabular">
<span class="header-section-number">16.10.7.2</span> Model Syntax in Table Form</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb176"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1"></a><span class="fu">lavaanify</span>(scalarInvarianceModel, <span class="at">ngroups =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["lhs"],"name":[2],"type":["chr"],"align":["left"]},{"label":["op"],"name":[3],"type":["chr"],"align":["left"]},{"label":["rhs"],"name":[4],"type":["chr"],"align":["left"]},{"label":["user"],"name":[5],"type":["int"],"align":["right"]},{"label":["block"],"name":[6],"type":["int"],"align":["right"]},{"label":["group"],"name":[7],"type":["int"],"align":["right"]},{"label":["free"],"name":[8],"type":["int"],"align":["right"]},{"label":["ustart"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["exo"],"name":[10],"type":["int"],"align":["right"]},{"label":["label"],"name":[11],"type":["chr"],"align":["left"]},{"label":["plabel"],"name":[12],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"visual","3":"=~","4":"x1","5":"1","6":"1","7":"1","8":"1","9":"NA","10":"0","11":"lambda.1_1","12":".p1."},{"1":"2","2":"visual","3":"=~","4":"x2","5":"1","6":"1","7":"1","8":"2","9":"NA","10":"0","11":"lambda.2_1","12":".p2."},{"1":"3","2":"visual","3":"=~","4":"x3","5":"1","6":"1","7":"1","8":"3","9":"NA","10":"0","11":"lambda.3_1","12":".p3."},{"1":"4","2":"textual","3":"=~","4":"x4","5":"1","6":"1","7":"1","8":"4","9":"NA","10":"0","11":"lambda.4_2","12":".p4."},{"1":"5","2":"textual","3":"=~","4":"x5","5":"1","6":"1","7":"1","8":"5","9":"NA","10":"0","11":"lambda.5_2","12":".p5."},{"1":"6","2":"textual","3":"=~","4":"x6","5":"1","6":"1","7":"1","8":"6","9":"NA","10":"0","11":"lambda.6_2","12":".p6."},{"1":"7","2":"speed","3":"=~","4":"x7","5":"1","6":"1","7":"1","8":"7","9":"NA","10":"0","11":"lambda.7_3","12":".p7."},{"1":"8","2":"speed","3":"=~","4":"x8","5":"1","6":"1","7":"1","8":"8","9":"NA","10":"0","11":"lambda.8_3","12":".p8."},{"1":"9","2":"speed","3":"=~","4":"x9","5":"1","6":"1","7":"1","8":"9","9":"NA","10":"0","11":"lambda.9_3","12":".p9."},{"1":"10","2":"x1","3":"~1","4":"","5":"1","6":"1","7":"1","8":"10","9":"NA","10":"0","11":"nu.1","12":".p10."},{"1":"11","2":"x2","3":"~1","4":"","5":"1","6":"1","7":"1","8":"11","9":"NA","10":"0","11":"nu.2","12":".p11."},{"1":"12","2":"x3","3":"~1","4":"","5":"1","6":"1","7":"1","8":"12","9":"NA","10":"0","11":"nu.3","12":".p12."},{"1":"13","2":"x4","3":"~1","4":"","5":"1","6":"1","7":"1","8":"13","9":"NA","10":"0","11":"nu.4","12":".p13."},{"1":"14","2":"x5","3":"~1","4":"","5":"1","6":"1","7":"1","8":"14","9":"NA","10":"0","11":"nu.5","12":".p14."},{"1":"15","2":"x6","3":"~1","4":"","5":"1","6":"1","7":"1","8":"15","9":"NA","10":"0","11":"nu.6","12":".p15."},{"1":"16","2":"x7","3":"~1","4":"","5":"1","6":"1","7":"1","8":"16","9":"NA","10":"0","11":"nu.7","12":".p16."},{"1":"17","2":"x8","3":"~1","4":"","5":"1","6":"1","7":"1","8":"17","9":"NA","10":"0","11":"nu.8","12":".p17."},{"1":"18","2":"x9","3":"~1","4":"","5":"1","6":"1","7":"1","8":"18","9":"NA","10":"0","11":"nu.9","12":".p18."},{"1":"19","2":"x1","3":"~~","4":"x1","5":"1","6":"1","7":"1","8":"19","9":"NA","10":"0","11":"theta.1_1.g1","12":".p19."},{"1":"20","2":"x2","3":"~~","4":"x2","5":"1","6":"1","7":"1","8":"20","9":"NA","10":"0","11":"theta.2_2.g1","12":".p20."},{"1":"21","2":"x3","3":"~~","4":"x3","5":"1","6":"1","7":"1","8":"21","9":"NA","10":"0","11":"theta.3_3.g1","12":".p21."},{"1":"22","2":"x4","3":"~~","4":"x4","5":"1","6":"1","7":"1","8":"22","9":"NA","10":"0","11":"theta.4_4.g1","12":".p22."},{"1":"23","2":"x5","3":"~~","4":"x5","5":"1","6":"1","7":"1","8":"23","9":"NA","10":"0","11":"theta.5_5.g1","12":".p23."},{"1":"24","2":"x6","3":"~~","4":"x6","5":"1","6":"1","7":"1","8":"24","9":"NA","10":"0","11":"theta.6_6.g1","12":".p24."},{"1":"25","2":"x7","3":"~~","4":"x7","5":"1","6":"1","7":"1","8":"25","9":"NA","10":"0","11":"theta.7_7.g1","12":".p25."},{"1":"26","2":"x8","3":"~~","4":"x8","5":"1","6":"1","7":"1","8":"26","9":"NA","10":"0","11":"theta.8_8.g1","12":".p26."},{"1":"27","2":"x9","3":"~~","4":"x9","5":"1","6":"1","7":"1","8":"27","9":"NA","10":"0","11":"theta.9_9.g1","12":".p27."},{"1":"28","2":"visual","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"alpha.1.g1","12":".p28."},{"1":"29","2":"textual","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"alpha.2.g1","12":".p29."},{"1":"30","2":"speed","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"alpha.3.g1","12":".p30."},{"1":"31","2":"visual","3":"~~","4":"visual","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"psi.1_1.g1","12":".p31."},{"1":"32","2":"textual","3":"~~","4":"textual","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"psi.2_2.g1","12":".p32."},{"1":"33","2":"speed","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"psi.3_3.g1","12":".p33."},{"1":"34","2":"visual","3":"~~","4":"textual","5":"1","6":"1","7":"1","8":"28","9":"NA","10":"0","11":"psi.2_1.g1","12":".p34."},{"1":"35","2":"visual","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"29","9":"NA","10":"0","11":"psi.3_1.g1","12":".p35."},{"1":"36","2":"textual","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"30","9":"NA","10":"0","11":"psi.3_2.g1","12":".p36."},{"1":"37","2":"visual","3":"=~","4":"x1","5":"1","6":"2","7":"2","8":"31","9":"NA","10":"0","11":"lambda.1_1","12":".p37."},{"1":"38","2":"visual","3":"=~","4":"x2","5":"1","6":"2","7":"2","8":"32","9":"NA","10":"0","11":"lambda.2_1","12":".p38."},{"1":"39","2":"visual","3":"=~","4":"x3","5":"1","6":"2","7":"2","8":"33","9":"NA","10":"0","11":"lambda.3_1","12":".p39."},{"1":"40","2":"textual","3":"=~","4":"x4","5":"1","6":"2","7":"2","8":"34","9":"NA","10":"0","11":"lambda.4_2","12":".p40."},{"1":"41","2":"textual","3":"=~","4":"x5","5":"1","6":"2","7":"2","8":"35","9":"NA","10":"0","11":"lambda.5_2","12":".p41."},{"1":"42","2":"textual","3":"=~","4":"x6","5":"1","6":"2","7":"2","8":"36","9":"NA","10":"0","11":"lambda.6_2","12":".p42."},{"1":"43","2":"speed","3":"=~","4":"x7","5":"1","6":"2","7":"2","8":"37","9":"NA","10":"0","11":"lambda.7_3","12":".p43."},{"1":"44","2":"speed","3":"=~","4":"x8","5":"1","6":"2","7":"2","8":"38","9":"NA","10":"0","11":"lambda.8_3","12":".p44."},{"1":"45","2":"speed","3":"=~","4":"x9","5":"1","6":"2","7":"2","8":"39","9":"NA","10":"0","11":"lambda.9_3","12":".p45."},{"1":"46","2":"x1","3":"~1","4":"","5":"1","6":"2","7":"2","8":"40","9":"NA","10":"0","11":"nu.1","12":".p46."},{"1":"47","2":"x2","3":"~1","4":"","5":"1","6":"2","7":"2","8":"41","9":"NA","10":"0","11":"nu.2","12":".p47."},{"1":"48","2":"x3","3":"~1","4":"","5":"1","6":"2","7":"2","8":"42","9":"NA","10":"0","11":"nu.3","12":".p48."},{"1":"49","2":"x4","3":"~1","4":"","5":"1","6":"2","7":"2","8":"43","9":"NA","10":"0","11":"nu.4","12":".p49."},{"1":"50","2":"x5","3":"~1","4":"","5":"1","6":"2","7":"2","8":"44","9":"NA","10":"0","11":"nu.5","12":".p50."},{"1":"51","2":"x6","3":"~1","4":"","5":"1","6":"2","7":"2","8":"45","9":"NA","10":"0","11":"nu.6","12":".p51."},{"1":"52","2":"x7","3":"~1","4":"","5":"1","6":"2","7":"2","8":"46","9":"NA","10":"0","11":"nu.7","12":".p52."},{"1":"53","2":"x8","3":"~1","4":"","5":"1","6":"2","7":"2","8":"47","9":"NA","10":"0","11":"nu.8","12":".p53."},{"1":"54","2":"x9","3":"~1","4":"","5":"1","6":"2","7":"2","8":"48","9":"NA","10":"0","11":"nu.9","12":".p54."},{"1":"55","2":"x1","3":"~~","4":"x1","5":"1","6":"2","7":"2","8":"49","9":"NA","10":"0","11":"theta.1_1.g2","12":".p55."},{"1":"56","2":"x2","3":"~~","4":"x2","5":"1","6":"2","7":"2","8":"50","9":"NA","10":"0","11":"theta.2_2.g2","12":".p56."},{"1":"57","2":"x3","3":"~~","4":"x3","5":"1","6":"2","7":"2","8":"51","9":"NA","10":"0","11":"theta.3_3.g2","12":".p57."},{"1":"58","2":"x4","3":"~~","4":"x4","5":"1","6":"2","7":"2","8":"52","9":"NA","10":"0","11":"theta.4_4.g2","12":".p58."},{"1":"59","2":"x5","3":"~~","4":"x5","5":"1","6":"2","7":"2","8":"53","9":"NA","10":"0","11":"theta.5_5.g2","12":".p59."},{"1":"60","2":"x6","3":"~~","4":"x6","5":"1","6":"2","7":"2","8":"54","9":"NA","10":"0","11":"theta.6_6.g2","12":".p60."},{"1":"61","2":"x7","3":"~~","4":"x7","5":"1","6":"2","7":"2","8":"55","9":"NA","10":"0","11":"theta.7_7.g2","12":".p61."},{"1":"62","2":"x8","3":"~~","4":"x8","5":"1","6":"2","7":"2","8":"56","9":"NA","10":"0","11":"theta.8_8.g2","12":".p62."},{"1":"63","2":"x9","3":"~~","4":"x9","5":"1","6":"2","7":"2","8":"57","9":"NA","10":"0","11":"theta.9_9.g2","12":".p63."},{"1":"64","2":"visual","3":"~1","4":"","5":"1","6":"2","7":"2","8":"58","9":"NA","10":"0","11":"alpha.1.g2","12":".p64."},{"1":"65","2":"textual","3":"~1","4":"","5":"1","6":"2","7":"2","8":"59","9":"NA","10":"0","11":"alpha.2.g2","12":".p65."},{"1":"66","2":"speed","3":"~1","4":"","5":"1","6":"2","7":"2","8":"60","9":"NA","10":"0","11":"alpha.3.g2","12":".p66."},{"1":"67","2":"visual","3":"~~","4":"visual","5":"1","6":"2","7":"2","8":"61","9":"NA","10":"0","11":"psi.1_1.g2","12":".p67."},{"1":"68","2":"textual","3":"~~","4":"textual","5":"1","6":"2","7":"2","8":"62","9":"NA","10":"0","11":"psi.2_2.g2","12":".p68."},{"1":"69","2":"speed","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"63","9":"NA","10":"0","11":"psi.3_3.g2","12":".p69."},{"1":"70","2":"visual","3":"~~","4":"textual","5":"1","6":"2","7":"2","8":"64","9":"NA","10":"0","11":"psi.2_1.g2","12":".p70."},{"1":"71","2":"visual","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"65","9":"NA","10":"0","11":"psi.3_1.g2","12":".p71."},{"1":"72","2":"textual","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"66","9":"NA","10":"0","11":"psi.3_2.g2","12":".p72."},{"1":"73","2":".p1.","3":"==","4":".p37.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"74","2":".p2.","3":"==","4":".p38.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"75","2":".p3.","3":"==","4":".p39.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"76","2":".p4.","3":"==","4":".p40.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"77","2":".p5.","3":"==","4":".p41.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"78","2":".p6.","3":"==","4":".p42.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"79","2":".p7.","3":"==","4":".p43.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"80","2":".p8.","3":"==","4":".p44.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"81","2":".p9.","3":"==","4":".p45.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"82","2":".p10.","3":"==","4":".p46.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"83","2":".p11.","3":"==","4":".p47.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"84","2":".p12.","3":"==","4":".p48.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"85","2":".p13.","3":"==","4":".p49.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"86","2":".p14.","3":"==","4":".p50.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"87","2":".p15.","3":"==","4":".p51.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"88","2":".p16.","3":"==","4":".p52.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"89","2":".p17.","3":"==","4":".p53.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"90","2":".p18.","3":"==","4":".p54.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1"></a><span class="fu">lavaanify</span>(cfaModel_scalarInvariance, <span class="at">ngroups =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["lhs"],"name":[2],"type":["chr"],"align":["left"]},{"label":["op"],"name":[3],"type":["chr"],"align":["left"]},{"label":["rhs"],"name":[4],"type":["chr"],"align":["left"]},{"label":["user"],"name":[5],"type":["int"],"align":["right"]},{"label":["block"],"name":[6],"type":["int"],"align":["right"]},{"label":["group"],"name":[7],"type":["int"],"align":["right"]},{"label":["free"],"name":[8],"type":["int"],"align":["right"]},{"label":["ustart"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["exo"],"name":[10],"type":["int"],"align":["right"]},{"label":["label"],"name":[11],"type":["chr"],"align":["left"]},{"label":["plabel"],"name":[12],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"visual","3":"=~","4":"x1","5":"1","6":"1","7":"1","8":"1","9":"NA","10":"0","11":"lambdax1","12":".p1."},{"1":"2","2":"visual","3":"=~","4":"x2","5":"1","6":"1","7":"1","8":"2","9":"NA","10":"0","11":"lambdax2","12":".p2."},{"1":"3","2":"visual","3":"=~","4":"x3","5":"1","6":"1","7":"1","8":"3","9":"NA","10":"0","11":"lambdax3","12":".p3."},{"1":"4","2":"textual","3":"=~","4":"x4","5":"1","6":"1","7":"1","8":"4","9":"NA","10":"0","11":"lambdax4","12":".p4."},{"1":"5","2":"textual","3":"=~","4":"x5","5":"1","6":"1","7":"1","8":"5","9":"NA","10":"0","11":"lambdax5","12":".p5."},{"1":"6","2":"textual","3":"=~","4":"x6","5":"1","6":"1","7":"1","8":"6","9":"NA","10":"0","11":"lambdax6","12":".p6."},{"1":"7","2":"speed","3":"=~","4":"x7","5":"1","6":"1","7":"1","8":"7","9":"NA","10":"0","11":"lambdax7","12":".p7."},{"1":"8","2":"speed","3":"=~","4":"x8","5":"1","6":"1","7":"1","8":"8","9":"NA","10":"0","11":"lambdax8","12":".p8."},{"1":"9","2":"speed","3":"=~","4":"x9","5":"1","6":"1","7":"1","8":"9","9":"NA","10":"0","11":"lambdax9","12":".p9."},{"1":"10","2":"visual","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p10."},{"1":"11","2":"textual","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p11."},{"1":"12","2":"speed","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p12."},{"1":"13","2":"visual","3":"~~","4":"visual","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"","12":".p13."},{"1":"14","2":"textual","3":"~~","4":"textual","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"","12":".p14."},{"1":"15","2":"speed","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"","12":".p15."},{"1":"16","2":"visual","3":"~~","4":"textual","5":"1","6":"1","7":"1","8":"10","9":"NA","10":"0","11":"","12":".p16."},{"1":"17","2":"visual","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"11","9":"NA","10":"0","11":"","12":".p17."},{"1":"18","2":"textual","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"12","9":"NA","10":"0","11":"","12":".p18."},{"1":"19","2":"x1","3":"~~","4":"x1","5":"1","6":"1","7":"1","8":"13","9":"NA","10":"0","11":"","12":".p19."},{"1":"20","2":"x2","3":"~~","4":"x2","5":"1","6":"1","7":"1","8":"14","9":"NA","10":"0","11":"","12":".p20."},{"1":"21","2":"x3","3":"~~","4":"x3","5":"1","6":"1","7":"1","8":"15","9":"NA","10":"0","11":"","12":".p21."},{"1":"22","2":"x4","3":"~~","4":"x4","5":"1","6":"1","7":"1","8":"16","9":"NA","10":"0","11":"","12":".p22."},{"1":"23","2":"x5","3":"~~","4":"x5","5":"1","6":"1","7":"1","8":"17","9":"NA","10":"0","11":"","12":".p23."},{"1":"24","2":"x6","3":"~~","4":"x6","5":"1","6":"1","7":"1","8":"18","9":"NA","10":"0","11":"","12":".p24."},{"1":"25","2":"x7","3":"~~","4":"x7","5":"1","6":"1","7":"1","8":"19","9":"NA","10":"0","11":"","12":".p25."},{"1":"26","2":"x8","3":"~~","4":"x8","5":"1","6":"1","7":"1","8":"20","9":"NA","10":"0","11":"","12":".p26."},{"1":"27","2":"x9","3":"~~","4":"x9","5":"1","6":"1","7":"1","8":"21","9":"NA","10":"0","11":"","12":".p27."},{"1":"28","2":"x1","3":"~1","4":"","5":"1","6":"1","7":"1","8":"22","9":"NA","10":"0","11":"intx1","12":".p28."},{"1":"29","2":"x2","3":"~1","4":"","5":"1","6":"1","7":"1","8":"23","9":"NA","10":"0","11":"intx2","12":".p29."},{"1":"30","2":"x3","3":"~1","4":"","5":"1","6":"1","7":"1","8":"24","9":"NA","10":"0","11":"intx3","12":".p30."},{"1":"31","2":"x4","3":"~1","4":"","5":"1","6":"1","7":"1","8":"25","9":"NA","10":"0","11":"intx4","12":".p31."},{"1":"32","2":"x5","3":"~1","4":"","5":"1","6":"1","7":"1","8":"26","9":"NA","10":"0","11":"intx5","12":".p32."},{"1":"33","2":"x6","3":"~1","4":"","5":"1","6":"1","7":"1","8":"27","9":"NA","10":"0","11":"intx6","12":".p33."},{"1":"34","2":"x7","3":"~1","4":"","5":"1","6":"1","7":"1","8":"28","9":"NA","10":"0","11":"intx7","12":".p34."},{"1":"35","2":"x8","3":"~1","4":"","5":"1","6":"1","7":"1","8":"29","9":"NA","10":"0","11":"intx8","12":".p35."},{"1":"36","2":"x9","3":"~1","4":"","5":"1","6":"1","7":"1","8":"30","9":"NA","10":"0","11":"intx9","12":".p36."},{"1":"37","2":"visual","3":"=~","4":"x1","5":"1","6":"2","7":"2","8":"31","9":"NA","10":"0","11":"lambdax1","12":".p37."},{"1":"38","2":"visual","3":"=~","4":"x2","5":"1","6":"2","7":"2","8":"32","9":"NA","10":"0","11":"lambdax2","12":".p38."},{"1":"39","2":"visual","3":"=~","4":"x3","5":"1","6":"2","7":"2","8":"33","9":"NA","10":"0","11":"lambdax3","12":".p39."},{"1":"40","2":"textual","3":"=~","4":"x4","5":"1","6":"2","7":"2","8":"34","9":"NA","10":"0","11":"lambdax4","12":".p40."},{"1":"41","2":"textual","3":"=~","4":"x5","5":"1","6":"2","7":"2","8":"35","9":"NA","10":"0","11":"lambdax5","12":".p41."},{"1":"42","2":"textual","3":"=~","4":"x6","5":"1","6":"2","7":"2","8":"36","9":"NA","10":"0","11":"lambdax6","12":".p42."},{"1":"43","2":"speed","3":"=~","4":"x7","5":"1","6":"2","7":"2","8":"37","9":"NA","10":"0","11":"lambdax7","12":".p43."},{"1":"44","2":"speed","3":"=~","4":"x8","5":"1","6":"2","7":"2","8":"38","9":"NA","10":"0","11":"lambdax8","12":".p44."},{"1":"45","2":"speed","3":"=~","4":"x9","5":"1","6":"2","7":"2","8":"39","9":"NA","10":"0","11":"lambdax9","12":".p45."},{"1":"46","2":"visual","3":"~1","4":"","5":"1","6":"2","7":"2","8":"40","9":"NA","10":"0","11":"","12":".p46."},{"1":"47","2":"textual","3":"~1","4":"","5":"1","6":"2","7":"2","8":"41","9":"NA","10":"0","11":"","12":".p47."},{"1":"48","2":"speed","3":"~1","4":"","5":"1","6":"2","7":"2","8":"42","9":"NA","10":"0","11":"","12":".p48."},{"1":"49","2":"visual","3":"~~","4":"visual","5":"1","6":"2","7":"2","8":"43","9":"NA","10":"0","11":"","12":".p49."},{"1":"50","2":"textual","3":"~~","4":"textual","5":"1","6":"2","7":"2","8":"44","9":"NA","10":"0","11":"","12":".p50."},{"1":"51","2":"speed","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"45","9":"NA","10":"0","11":"","12":".p51."},{"1":"52","2":"visual","3":"~~","4":"textual","5":"1","6":"2","7":"2","8":"46","9":"NA","10":"0","11":"","12":".p52."},{"1":"53","2":"visual","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"47","9":"NA","10":"0","11":"","12":".p53."},{"1":"54","2":"textual","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"48","9":"NA","10":"0","11":"","12":".p54."},{"1":"55","2":"x1","3":"~~","4":"x1","5":"1","6":"2","7":"2","8":"49","9":"NA","10":"0","11":"","12":".p55."},{"1":"56","2":"x2","3":"~~","4":"x2","5":"1","6":"2","7":"2","8":"50","9":"NA","10":"0","11":"","12":".p56."},{"1":"57","2":"x3","3":"~~","4":"x3","5":"1","6":"2","7":"2","8":"51","9":"NA","10":"0","11":"","12":".p57."},{"1":"58","2":"x4","3":"~~","4":"x4","5":"1","6":"2","7":"2","8":"52","9":"NA","10":"0","11":"","12":".p58."},{"1":"59","2":"x5","3":"~~","4":"x5","5":"1","6":"2","7":"2","8":"53","9":"NA","10":"0","11":"","12":".p59."},{"1":"60","2":"x6","3":"~~","4":"x6","5":"1","6":"2","7":"2","8":"54","9":"NA","10":"0","11":"","12":".p60."},{"1":"61","2":"x7","3":"~~","4":"x7","5":"1","6":"2","7":"2","8":"55","9":"NA","10":"0","11":"","12":".p61."},{"1":"62","2":"x8","3":"~~","4":"x8","5":"1","6":"2","7":"2","8":"56","9":"NA","10":"0","11":"","12":".p62."},{"1":"63","2":"x9","3":"~~","4":"x9","5":"1","6":"2","7":"2","8":"57","9":"NA","10":"0","11":"","12":".p63."},{"1":"64","2":"x1","3":"~1","4":"","5":"1","6":"2","7":"2","8":"58","9":"NA","10":"0","11":"intx1","12":".p64."},{"1":"65","2":"x2","3":"~1","4":"","5":"1","6":"2","7":"2","8":"59","9":"NA","10":"0","11":"intx2","12":".p65."},{"1":"66","2":"x3","3":"~1","4":"","5":"1","6":"2","7":"2","8":"60","9":"NA","10":"0","11":"intx3","12":".p66."},{"1":"67","2":"x4","3":"~1","4":"","5":"1","6":"2","7":"2","8":"61","9":"NA","10":"0","11":"intx4","12":".p67."},{"1":"68","2":"x5","3":"~1","4":"","5":"1","6":"2","7":"2","8":"62","9":"NA","10":"0","11":"intx5","12":".p68."},{"1":"69","2":"x6","3":"~1","4":"","5":"1","6":"2","7":"2","8":"63","9":"NA","10":"0","11":"intx6","12":".p69."},{"1":"70","2":"x7","3":"~1","4":"","5":"1","6":"2","7":"2","8":"64","9":"NA","10":"0","11":"intx7","12":".p70."},{"1":"71","2":"x8","3":"~1","4":"","5":"1","6":"2","7":"2","8":"65","9":"NA","10":"0","11":"intx8","12":".p71."},{"1":"72","2":"x9","3":"~1","4":"","5":"1","6":"2","7":"2","8":"66","9":"NA","10":"0","11":"intx9","12":".p72."},{"1":"73","2":".p1.","3":"==","4":".p37.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"74","2":".p2.","3":"==","4":".p38.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"75","2":".p3.","3":"==","4":".p39.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"76","2":".p4.","3":"==","4":".p40.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"77","2":".p5.","3":"==","4":".p41.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"78","2":".p6.","3":"==","4":".p42.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"79","2":".p7.","3":"==","4":".p43.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"80","2":".p8.","3":"==","4":".p44.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"81","2":".p9.","3":"==","4":".p45.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"82","2":".p28.","3":"==","4":".p64.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"83","2":".p29.","3":"==","4":".p65.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"84","2":".p30.","3":"==","4":".p66.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"85","2":".p31.","3":"==","4":".p67.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"86","2":".p32.","3":"==","4":".p68.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"87","2":".p33.","3":"==","4":".p69.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"88","2":".p34.","3":"==","4":".p70.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"89","2":".p35.","3":"==","4":".p71.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"90","2":".p36.","3":"==","4":".p72.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceScalarModelFit" class="level4" data-number="16.10.7.3"><h4 data-number="16.10.7.3" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelFit">
<span class="header-section-number">16.10.7.3</span> Fit the Model</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb178"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1"></a>scalarInvarianceModel_fit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(</span>
<span id="cb178-2"><a href="#cb178-2"></a>  scalarInvarianceSyntax,</span>
<span id="cb178-3"><a href="#cb178-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb178-4"><a href="#cb178-4"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb178-5"><a href="#cb178-5"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb178-6"><a href="#cb178-6"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1"></a>scalarInvarianceModelFullSyntax_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb179-2"><a href="#cb179-2"></a>  cfaModel_scalarInvariance,</span>
<span id="cb179-3"><a href="#cb179-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb179-4"><a href="#cb179-4"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb179-5"><a href="#cb179-5"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb179-6"><a href="#cb179-6"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceScalarModelOutput" class="level4" data-number="16.10.7.4"><h4 data-number="16.10.7.4" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelOutput">
<span class="header-section-number">16.10.7.4</span> Model Summary</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb180"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1"></a><span class="fu">summary</span>(</span>
<span id="cb180-2"><a href="#cb180-2"></a>  scalarInvarianceModel_fit,</span>
<span id="cb180-3"><a href="#cb180-3"></a>  <span class="at">fit.measures =</span> <span class="cn">TRUE</span>,</span>
<span id="cb180-4"><a href="#cb180-4"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb180-5"><a href="#cb180-5"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 66 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        66
  Number of equality constraints                    18

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145
  Number of missing patterns per group:               
    Pasteur                                          9
    Grant-White                                      9

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               156.955     159.442
  Degrees of freedom                                60          60
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.984
    Yuan-Bentler correction (Mplus variant)                       
  Test statistic for each group:
    Pasteur                                     86.521      86.521
    Grant-White                                 72.921      72.921

Model Test Baseline Model:

  Test statistic                               932.665     909.019
  Degrees of freedom                                72          72
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.026

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.887       0.881
  Tucker-Lewis Index (TLI)                       0.865       0.857
                                                                  
  Robust Comparative Fit Index (CFI)                         0.890
  Robust Tucker-Lewis Index (TLI)                            0.868

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3672.597   -3672.597
  Scaling correction factor                                  0.797
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -3594.120   -3594.120
  Scaling correction factor                                  1.034
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                                7441.195    7441.195
  Bayesian (BIC)                              7619.136    7619.136
  Sample-size adjusted Bayesian (SABIC)       7466.908    7466.908

Root Mean Square Error of Approximation:

  RMSEA                                          0.104       0.105
  90 Percent confidence interval - lower         0.084       0.085
  90 Percent confidence interval - upper         0.124       0.125
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.975       0.980
                                                                  
  Robust RMSEA                                               0.104
  90 Percent confidence interval - lower                     0.083
  90 Percent confidence interval - upper                     0.124
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.972

Standardized Root Mean Square Residual:

  SRMR                                           0.080       0.080

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (l.1_)    0.874    0.132    6.630    0.000    0.874    0.751
    x2      (l.2_)    0.512    0.086    5.984    0.000    0.512    0.411
    x3      (l.3_)    0.722    0.095    7.610    0.000    0.722    0.604
  textual =~                                                            
    x4      (l.4_)    0.921    0.071   12.920    0.000    0.921    0.807
    x5      (l.5_)    1.059    0.077   13.763    0.000    1.059    0.837
    x6      (l.6_)    0.875    0.066   13.259    0.000    0.875    0.865
  speed =~                                                              
    x7      (l.7_)    0.566    0.081    6.946    0.000    0.566    0.512
    x8      (l.8_)    0.657    0.082    8.028    0.000    0.657    0.669
    x9      (l.9_)    0.602    0.085    7.049    0.000    0.602    0.604

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textul  (p.2_)    0.473    0.108    4.397    0.000    0.473    0.473
    speed  (p.3_1)    0.355    0.125    2.842    0.004    0.355    0.355
  textual ~~                                                            
    speed  (p.3_2)    0.322    0.095    3.377    0.001    0.322    0.322

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (nu.1)    5.016    0.094   53.146    0.000    5.016    4.309
   .x2      (nu.2)    6.156    0.088   69.594    0.000    6.156    4.944
   .x3      (nu.3)    2.292    0.098   23.329    0.000    2.292    1.916
   .x4      (nu.4)    2.780    0.086   32.469    0.000    2.780    2.435
   .x5      (nu.5)    4.035    0.104   38.981    0.000    4.035    3.189
   .x6      (nu.6)    1.928    0.074   25.882    0.000    1.928    1.907
   .x7      (nu.7)    4.244    0.078   54.164    0.000    4.244    3.840
   .x8      (nu.8)    5.627    0.076   73.915    0.000    5.627    5.726
   .x9      (nu.9)    5.474    0.073   74.934    0.000    5.474    5.492
    visual  (a.1.)    0.000                               0.000    0.000
    textual (a.2.)    0.000                               0.000    0.000
    speed   (a.3.)    0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (t.1_)    0.591    0.179    3.295    0.001    0.591    0.436
   .x2      (t.2_)    1.288    0.160    8.075    0.000    1.288    0.831
   .x3      (t.3_)    0.910    0.151    6.046    0.000    0.910    0.636
   .x4      (t.4_)    0.454    0.073    6.245    0.000    0.454    0.349
   .x5      (t.5_)    0.480    0.076    6.295    0.000    0.480    0.300
   .x6      (t.6_)    0.257    0.058    4.401    0.000    0.257    0.252
   .x7      (t.7_)    0.901    0.129    7.000    0.000    0.901    0.738
   .x8      (t.8_)    0.534    0.091    5.838    0.000    0.534    0.553
   .x9      (t.9_)    0.631    0.115    5.469    0.000    0.631    0.635
    visual  (p.1_)    1.000                               1.000    1.000
    textual (p.2_)    1.000                               1.000    1.000
    speed   (p.3_)    1.000                               1.000    1.000

R-Square:
                   Estimate
    x1                0.564
    x2                0.169
    x3                0.364
    x4                0.651
    x5                0.700
    x6                0.748
    x7                0.262
    x8                0.447
    x9                0.365


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (l.1_)    0.874    0.132    6.630    0.000    0.827    0.711
    x2      (l.2_)    0.512    0.086    5.984    0.000    0.485    0.441
    x3      (l.3_)    0.722    0.095    7.610    0.000    0.684    0.649
  textual =~                                                            
    x4      (l.4_)    0.921    0.071   12.920    0.000    0.921    0.838
    x5      (l.5_)    1.059    0.077   13.763    0.000    1.059    0.869
    x6      (l.6_)    0.875    0.066   13.259    0.000    0.875    0.797
  speed =~                                                              
    x7      (l.7_)    0.566    0.081    6.946    0.000    0.692    0.651
    x8      (l.8_)    0.657    0.082    8.028    0.000    0.803    0.773
    x9      (l.9_)    0.602    0.085    7.049    0.000    0.736    0.722

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textul  (p.2_)    0.519    0.136    3.829    0.000    0.549    0.549
    speed  (p.3_1)    0.649    0.215    3.014    0.003    0.561    0.561
  textual ~~                                                            
    speed  (p.3_2)    0.442    0.189    2.335    0.020    0.361    0.361

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (nu.1)    5.016    0.094   53.146    0.000    5.016    4.312
   .x2      (nu.2)    6.156    0.088   69.594    0.000    6.156    5.602
   .x3      (nu.3)    2.292    0.098   23.329    0.000    2.292    2.177
   .x4      (nu.4)    2.780    0.086   32.469    0.000    2.780    2.529
   .x5      (nu.5)    4.035    0.104   38.981    0.000    4.035    3.312
   .x6      (nu.6)    1.928    0.074   25.882    0.000    1.928    1.756
   .x7      (nu.7)    4.244    0.078   54.164    0.000    4.244    3.990
   .x8      (nu.8)    5.627    0.076   73.915    0.000    5.627    5.412
   .x9      (nu.9)    5.474    0.073   74.934    0.000    5.474    5.370
    visual  (a.1.)   -0.193    0.175   -1.101    0.271   -0.204   -0.204
    textual (a.2.)    0.617    0.135    4.587    0.000    0.617    0.617
    speed   (a.3.)   -0.294    0.161   -1.828    0.068   -0.240   -0.240

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (t.1_)    0.668    0.176    3.793    0.000    0.668    0.494
   .x2      (t.2_)    0.973    0.152    6.384    0.000    0.973    0.805
   .x3      (t.3_)    0.641    0.133    4.833    0.000    0.641    0.578
   .x4      (t.4_)    0.359    0.066    5.464    0.000    0.359    0.297
   .x5      (t.5_)    0.363    0.074    4.883    0.000    0.363    0.245
   .x6      (t.6_)    0.441    0.075    5.851    0.000    0.441    0.366
   .x7      (t.7_)    0.652    0.108    6.016    0.000    0.652    0.577
   .x8      (t.8_)    0.436    0.152    2.872    0.004    0.436    0.403
   .x9      (t.9_)    0.497    0.127    3.918    0.000    0.497    0.478
    visual  (p.1_)    0.896    0.235    3.816    0.000    1.000    1.000
    textual (p.2_)    1.000    0.194    5.157    0.000    1.000    1.000
    speed   (p.3_)    1.495    0.360    4.156    0.000    1.000    1.000

R-Square:
                   Estimate
    x1                0.506
    x2                0.195
    x3                0.422
    x4                0.703
    x5                0.755
    x6                0.634
    x7                0.423
    x8                0.597
    x9                0.522</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1"></a><span class="fu">summary</span>(</span>
<span id="cb182-2"><a href="#cb182-2"></a>  scalarInvarianceModelFullSyntax_fit,</span>
<span id="cb182-3"><a href="#cb182-3"></a>  <span class="at">fit.measures =</span> <span class="cn">TRUE</span>,</span>
<span id="cb182-4"><a href="#cb182-4"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb182-5"><a href="#cb182-5"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 66 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        66
  Number of equality constraints                    18

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145
  Number of missing patterns per group:               
    Pasteur                                          9
    Grant-White                                      9

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               156.955     159.442
  Degrees of freedom                                60          60
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.984
    Yuan-Bentler correction (Mplus variant)                       
  Test statistic for each group:
    Pasteur                                     86.520      86.520
    Grant-White                                 72.921      72.921

Model Test Baseline Model:

  Test statistic                               932.665     909.019
  Degrees of freedom                                72          72
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.026

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.887       0.881
  Tucker-Lewis Index (TLI)                       0.865       0.857
                                                                  
  Robust Comparative Fit Index (CFI)                         0.890
  Robust Tucker-Lewis Index (TLI)                            0.868

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3672.597   -3672.597
  Scaling correction factor                                  0.797
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -3594.120   -3594.120
  Scaling correction factor                                  1.034
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                                7441.195    7441.195
  Bayesian (BIC)                              7619.136    7619.136
  Sample-size adjusted Bayesian (SABIC)       7466.908    7466.908

Root Mean Square Error of Approximation:

  RMSEA                                          0.104       0.105
  90 Percent confidence interval - lower         0.084       0.085
  90 Percent confidence interval - upper         0.124       0.125
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.975       0.980
                                                                  
  Robust RMSEA                                               0.104
  90 Percent confidence interval - lower                     0.083
  90 Percent confidence interval - upper                     0.124
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.972

Standardized Root Mean Square Residual:

  SRMR                                           0.080       0.080

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (lmb1)    0.874    0.132    6.630    0.000    0.874    0.751
    x2      (lmb2)    0.512    0.086    5.984    0.000    0.512    0.411
    x3      (lmb3)    0.722    0.095    7.610    0.000    0.722    0.604
  textual =~                                                            
    x4      (lmb4)    0.921    0.071   12.920    0.000    0.921    0.807
    x5      (lmb5)    1.059    0.077   13.763    0.000    1.059    0.837
    x6      (lmb6)    0.875    0.066   13.259    0.000    0.875    0.865
  speed =~                                                              
    x7      (lmb7)    0.566    0.081    6.946    0.000    0.566    0.512
    x8      (lmb8)    0.657    0.082    8.028    0.000    0.657    0.669
    x9      (lmb9)    0.602    0.085    7.049    0.000    0.602    0.604

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textual           0.473    0.108    4.397    0.000    0.473    0.473
    speed             0.355    0.125    2.842    0.004    0.355    0.355
  textual ~~                                                            
    speed             0.322    0.095    3.377    0.001    0.322    0.322

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            0.000                               0.000    0.000
    textual           0.000                               0.000    0.000
    speed             0.000                               0.000    0.000
   .x1      (int1)    5.016    0.094   53.146    0.000    5.016    4.309
   .x2      (int2)    6.156    0.088   69.594    0.000    6.156    4.944
   .x3      (int3)    2.292    0.098   23.329    0.000    2.292    1.916
   .x4      (int4)    2.780    0.086   32.469    0.000    2.780    2.435
   .x5      (int5)    4.035    0.104   38.981    0.000    4.035    3.189
   .x6      (int6)    1.928    0.074   25.882    0.000    1.928    1.907
   .x7      (int7)    4.244    0.078   54.164    0.000    4.244    3.840
   .x8      (int8)    5.627    0.076   73.915    0.000    5.627    5.726
   .x9      (int9)    5.474    0.073   74.934    0.000    5.474    5.492

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            1.000                               1.000    1.000
    textual           1.000                               1.000    1.000
    speed             1.000                               1.000    1.000
   .x1                0.591    0.179    3.295    0.001    0.591    0.436
   .x2                1.288    0.160    8.075    0.000    1.288    0.831
   .x3                0.910    0.151    6.046    0.000    0.910    0.636
   .x4                0.454    0.073    6.245    0.000    0.454    0.349
   .x5                0.480    0.076    6.295    0.000    0.480    0.300
   .x6                0.257    0.058    4.401    0.000    0.257    0.252
   .x7                0.901    0.129    7.000    0.000    0.901    0.738
   .x8                0.534    0.091    5.838    0.000    0.534    0.553
   .x9                0.631    0.115    5.469    0.000    0.631    0.635

R-Square:
                   Estimate
    x1                0.564
    x2                0.169
    x3                0.364
    x4                0.651
    x5                0.700
    x6                0.748
    x7                0.262
    x8                0.447
    x9                0.365


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (lmb1)    0.874    0.132    6.630    0.000    0.827    0.711
    x2      (lmb2)    0.512    0.086    5.984    0.000    0.485    0.441
    x3      (lmb3)    0.722    0.095    7.610    0.000    0.684    0.649
  textual =~                                                            
    x4      (lmb4)    0.921    0.071   12.920    0.000    0.921    0.838
    x5      (lmb5)    1.059    0.077   13.763    0.000    1.059    0.869
    x6      (lmb6)    0.875    0.066   13.259    0.000    0.875    0.797
  speed =~                                                              
    x7      (lmb7)    0.566    0.081    6.946    0.000    0.692    0.651
    x8      (lmb8)    0.657    0.082    8.028    0.000    0.803    0.773
    x9      (lmb9)    0.602    0.085    7.049    0.000    0.736    0.722

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textual           0.519    0.136    3.829    0.000    0.549    0.549
    speed             0.649    0.215    3.014    0.003    0.561    0.561
  textual ~~                                                            
    speed             0.442    0.189    2.335    0.020    0.361    0.361

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual           -0.193    0.175   -1.101    0.271   -0.204   -0.204
    textual           0.617    0.135    4.587    0.000    0.617    0.617
    speed            -0.294    0.161   -1.828    0.068   -0.240   -0.240
   .x1      (int1)    5.016    0.094   53.146    0.000    5.016    4.312
   .x2      (int2)    6.156    0.088   69.594    0.000    6.156    5.602
   .x3      (int3)    2.292    0.098   23.329    0.000    2.292    2.177
   .x4      (int4)    2.780    0.086   32.469    0.000    2.780    2.529
   .x5      (int5)    4.035    0.104   38.981    0.000    4.035    3.312
   .x6      (int6)    1.928    0.074   25.882    0.000    1.928    1.756
   .x7      (int7)    4.244    0.078   54.164    0.000    4.244    3.990
   .x8      (int8)    5.627    0.076   73.915    0.000    5.627    5.412
   .x9      (int9)    5.474    0.073   74.934    0.000    5.474    5.370

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            0.896    0.235    3.815    0.000    1.000    1.000
    textual           1.000    0.194    5.157    0.000    1.000    1.000
    speed             1.495    0.360    4.156    0.000    1.000    1.000
   .x1                0.668    0.176    3.793    0.000    0.668    0.494
   .x2                0.973    0.152    6.384    0.000    0.973    0.805
   .x3                0.641    0.133    4.833    0.000    0.641    0.578
   .x4                0.359    0.066    5.464    0.000    0.359    0.297
   .x5                0.363    0.074    4.883    0.000    0.363    0.245
   .x6                0.441    0.075    5.851    0.000    0.441    0.366
   .x7                0.652    0.108    6.016    0.000    0.652    0.577
   .x8                0.436    0.152    2.872    0.004    0.436    0.403
   .x9                0.497    0.127    3.918    0.000    0.497    0.478

R-Square:
                   Estimate
    x1                0.506
    x2                0.195
    x3                0.422
    x4                0.703
    x5                0.755
    x6                0.634
    x7                0.423
    x8                0.597
    x9                0.522</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceScalarModelFitCriteria" class="level4" data-number="16.10.7.5"><h4 data-number="16.10.7.5" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelFitCriteria">
<span class="header-section-number">16.10.7.5</span> Model Fit</h4>
<p>You can specify the null model as the baseline model using: <code>baseline.model = nullModelFit</code></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1"></a><span class="fu">fitMeasures</span>(scalarInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                         npar                          fmin 
                       48.000                         0.261 
                        chisq                            df 
                      156.955                        60.000 
                       pvalue                  chisq.scaled 
                        0.000                       159.442 
                    df.scaled                 pvalue.scaled 
                       60.000                         0.000 
         chisq.scaling.factor                baseline.chisq 
                        0.984                       932.665 
                  baseline.df               baseline.pvalue 
                       72.000                         0.000 
        baseline.chisq.scaled            baseline.df.scaled 
                      909.019                        72.000 
       baseline.pvalue.scaled baseline.chisq.scaling.factor 
                        0.000                         1.026 
                          cfi                           tli 
                        0.887                         0.865 
                   cfi.scaled                    tli.scaled 
                        0.881                         0.857 
                   cfi.robust                    tli.robust 
                        0.890                         0.868 
                         nnfi                           rfi 
                        0.865                         0.798 
                          nfi                          pnfi 
                        0.832                         0.693 
                          ifi                           rni 
                        0.889                         0.887 
                  nnfi.scaled                    rfi.scaled 
                        0.857                         0.790 
                   nfi.scaled                   pnfi.scaled 
                        0.825                         0.687 
                   ifi.scaled                    rni.scaled 
                        0.883                         0.881 
                  nnfi.robust                    rni.robust 
                        0.868                         0.890 
                         logl             unrestricted.logl 
                    -3672.597                     -3594.120 
                          aic                           bic 
                     7441.195                      7619.136 
                       ntotal                          bic2 
                      301.000                      7466.908 
            scaling.factor.h1             scaling.factor.h0 
                        1.034                         0.797 
                        rmsea                rmsea.ci.lower 
                        0.104                         0.084 
               rmsea.ci.upper                rmsea.ci.level 
                        0.124                         0.900 
                 rmsea.pvalue                rmsea.close.h0 
                        0.000                         0.050 
        rmsea.notclose.pvalue             rmsea.notclose.h0 
                        0.975                         0.080 
                 rmsea.scaled         rmsea.ci.lower.scaled 
                        0.105                         0.085 
        rmsea.ci.upper.scaled           rmsea.pvalue.scaled 
                        0.125                         0.000 
 rmsea.notclose.pvalue.scaled                  rmsea.robust 
                        0.980                         0.104 
        rmsea.ci.lower.robust         rmsea.ci.upper.robust 
                        0.083                         0.124 
          rmsea.pvalue.robust  rmsea.notclose.pvalue.robust 
                        0.000                         0.972 
                          rmr                    rmr_nomean 
                        0.097                         0.095 
                         srmr                  srmr_bentler 
                        0.080                         0.080 
          srmr_bentler_nomean                          crmr 
                        0.076                         0.084 
                  crmr_nomean                    srmr_mplus 
                        0.081                         0.084 
            srmr_mplus_nomean                         cn_05 
                        0.075                       152.660 
                        cn_01                           gfi 
                      170.490                         0.993 
                         agfi                          pgfi 
                        0.987                         0.552 
                          mfi                          ecvi 
                        0.851                         0.840 
attr(,"scaled.test")
[1] "yuan.bentler.mplus"</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb186"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1"></a>scalarInvarianceModelFitIndices <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb186-2"><a href="#cb186-2"></a>  scalarInvarianceModel_fit)[<span class="fu">c</span>(</span>
<span id="cb186-3"><a href="#cb186-3"></a>    <span class="st">"cfi.robust"</span>, <span class="st">"rmsea.robust"</span>, <span class="st">"srmr"</span>)]</span>
<span id="cb186-4"><a href="#cb186-4"></a></span>
<span id="cb186-5"><a href="#cb186-5"></a>scalarInvarianceModel_chisquare <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb186-6"><a href="#cb186-6"></a>  scalarInvarianceModel_fit)[<span class="fu">c</span>(<span class="st">"chisq.scaled"</span>)]</span>
<span id="cb186-7"><a href="#cb186-7"></a></span>
<span id="cb186-8"><a href="#cb186-8"></a>scalarInvarianceModel_chisquareScaling <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb186-9"><a href="#cb186-9"></a>  scalarInvarianceModel_fit)[<span class="fu">c</span>(<span class="st">"chisq.scaling.factor"</span>)]</span>
<span id="cb186-10"><a href="#cb186-10"></a></span>
<span id="cb186-11"><a href="#cb186-11"></a>scalarInvarianceModel_df <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb186-12"><a href="#cb186-12"></a>  scalarInvarianceModel_fit)[<span class="fu">c</span>(<span class="st">"df.scaled"</span>)]</span>
<span id="cb186-13"><a href="#cb186-13"></a></span>
<span id="cb186-14"><a href="#cb186-14"></a>scalarInvarianceModel_N <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(</span>
<span id="cb186-15"><a href="#cb186-15"></a>  scalarInvarianceModel_fit, <span class="at">what =</span> <span class="st">"ntotal"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceScalarModelCompare" class="level4" data-number="16.10.7.6"><h4 data-number="16.10.7.6" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelCompare">
<span class="header-section-number">16.10.7.6</span> Compare Model Fit</h4>
<section id="sec-measurementInvarianceScalarModelNestedModelComparison" class="level5" data-number="16.10.7.6.1"><h5 data-number="16.10.7.6.1" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelNestedModelComparison">
<span class="header-section-number">16.10.7.6.1</span> Nested Model (<span class="math inline">\(\chi^2\)</span>) Difference Test</h5>
<p>The metric invariance model and the scalar (“strong factorial”) invariance model are considered “nested” models. The scalar invariance model is nested within the metric invariance model because the metric invariance model includes all of the terms of the metric invariance model along with additional terms. Model fit of nested models can be compared with a chi-square difference test, also known as a likelihood ratio test or deviance test. A significant chi-square difference test would indicate that the simplified model with additional constraints (the scalar invariance model) is significantly worse fitting than the more complex model that has fewer constraints (the metric invariance model).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1"></a><span class="fu">anova</span>(metricInvarianceModel_fit, scalarInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"60","2":"7441.195","3":"7619.136","4":"156.9546","5":"41.928","6":"6","7":"0.0000001899955","_rn_":"scalarInvarianceModel_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The scalar invariance model fit significantly worse than the configural invariance model, so scalar invariance did not hold. This provides evidence of measurement non-invariance of indicator intercepts across groups. Measurement non-invariance of indicator intercepts poses challenges to being able to meaningfully compare levels on the latent factor across groups <span class="citation" data-cites="Little2007">(<a href="references.html#ref-Little2007" role="doc-biblioref">Little et al., 2007</a>)</span>.</p>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>satorraBentlerScaledChiSquareDifferenceTestStatistic()</code> function that performs a Satorra-Bentler scaled chi-square difference test:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb188"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1"></a>scalarInvarianceModel_chisquareDiff <span class="ot">&lt;-</span> </span>
<span id="cb188-2"><a href="#cb188-2"></a>  <span class="fu">satorraBentlerScaledChiSquareDifferenceTestStatistic</span>(</span>
<span id="cb188-3"><a href="#cb188-3"></a>    <span class="at">T0 =</span> scalarInvarianceModel_chisquare,</span>
<span id="cb188-4"><a href="#cb188-4"></a>    <span class="at">c0 =</span> scalarInvarianceModel_chisquareScaling,</span>
<span id="cb188-5"><a href="#cb188-5"></a>    <span class="at">d0 =</span> scalarInvarianceModel_df,</span>
<span id="cb188-6"><a href="#cb188-6"></a>    <span class="at">T1 =</span> metricInvarianceModel_chisquare,</span>
<span id="cb188-7"><a href="#cb188-7"></a>    <span class="at">c1 =</span> metricInvarianceModel_chisquareScaling,</span>
<span id="cb188-8"><a href="#cb188-8"></a>    <span class="at">d1 =</span> metricInvarianceModel_df)</span>
<span id="cb188-9"><a href="#cb188-9"></a></span>
<span id="cb188-10"><a href="#cb188-10"></a>scalarInvarianceModel_chisquareDiff</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>chisq.scaled 
      41.928 </code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceScalarModelCompareFitCriteria" class="level5" data-number="16.10.7.6.2"><h5 data-number="16.10.7.6.2" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelCompareFitCriteria">
<span class="header-section-number">16.10.7.6.2</span> Compare Other Fit Criteria</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb190"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1"></a><span class="fu">round</span>(</span>
<span id="cb190-2"><a href="#cb190-2"></a>  scalarInvarianceModelFitIndices <span class="sc">-</span> metricInvarianceModelFitIndices,</span>
<span id="cb190-3"><a href="#cb190-3"></a>  <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  cfi.robust rmsea.robust         srmr 
      -0.038        0.015        0.011 </code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceScalarScoreBasedTest" class="level5" data-number="16.10.7.6.3"><h5 data-number="16.10.7.6.3" class="anchored" data-anchor-id="sec-measurementInvarianceScalarScoreBasedTest">
<span class="header-section-number">16.10.7.6.3</span> Score-Based Test</h5>
<p>Score-based tests of measurement invariance are implemented using the <code>strucchange</code> package and are described by <span class="citation" data-cites="Wang2014a">T. Wang et al. (<a href="references.html#ref-Wang2014a" role="doc-biblioref">2014</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb192"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1"></a><span class="fu">coef</span>(scalarInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  lambda.1_1   lambda.2_1   lambda.3_1   lambda.4_2   lambda.5_2   lambda.6_2 
       0.874        0.512        0.722        0.921        1.059        0.875 
  lambda.7_3   lambda.8_3   lambda.9_3         nu.1         nu.2         nu.3 
       0.566        0.657        0.602        5.016        6.156        2.292 
        nu.4         nu.5         nu.6         nu.7         nu.8         nu.9 
       2.780        4.035        1.928        4.244        5.627        5.474 
theta.1_1.g1 theta.2_2.g1 theta.3_3.g1 theta.4_4.g1 theta.5_5.g1 theta.6_6.g1 
       0.591        1.288        0.910        0.454        0.480        0.257 
theta.7_7.g1 theta.8_8.g1 theta.9_9.g1   psi.2_1.g1   psi.3_1.g1   psi.3_2.g1 
       0.901        0.534        0.631        0.473        0.355        0.322 
  lambda.1_1   lambda.2_1   lambda.3_1   lambda.4_2   lambda.5_2   lambda.6_2 
       0.874        0.512        0.722        0.921        1.059        0.875 
  lambda.7_3   lambda.8_3   lambda.9_3         nu.1         nu.2         nu.3 
       0.566        0.657        0.602        5.016        6.156        2.292 
        nu.4         nu.5         nu.6         nu.7         nu.8         nu.9 
       2.780        4.035        1.928        4.244        5.627        5.474 
theta.1_1.g2 theta.2_2.g2 theta.3_3.g2 theta.4_4.g2 theta.5_5.g2 theta.6_6.g2 
       0.668        0.973        0.641        0.359        0.363        0.441 
theta.7_7.g2 theta.8_8.g2 theta.9_9.g2   alpha.1.g2   alpha.2.g2   alpha.3.g2 
       0.652        0.436        0.497       -0.193        0.617       -0.294 
  psi.1_1.g2   psi.2_2.g2   psi.3_3.g2   psi.2_1.g2   psi.3_1.g2   psi.3_2.g2 
       0.896        1.000        1.495        0.519        0.649        0.442 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb194"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1"></a><span class="fu">coef</span>(scalarInvarianceModel_fit)[<span class="dv">10</span><span class="sc">:</span><span class="dv">18</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>    nu.1     nu.2     nu.3     nu.4     nu.5     nu.6     nu.7     nu.8 
5.015537 6.155701 2.292365 2.779781 4.034564 1.928163 4.243593 5.626570 
    nu.9 
5.474024 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb196"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1"></a>strucchange<span class="sc">::</span><span class="fu">sctest</span>(</span>
<span id="cb196-2"><a href="#cb196-2"></a>  scalarInvarianceModel_fit,</span>
<span id="cb196-3"><a href="#cb196-3"></a>  <span class="at">order.by =</span> HolzingerSwineford1939<span class="sc">$</span>school,</span>
<span id="cb196-4"><a href="#cb196-4"></a>  <span class="at">parm =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">18</span>,</span>
<span id="cb196-5"><a href="#cb196-5"></a>  <span class="at">functional =</span> <span class="st">"LMuo"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    M-fluctuation test

data:  scalarInvarianceModel_fit
f(efp) = 44.639, p-value = 0.000001076</code></pre>
</div>
</div>
<p>A score-based test and expected parameter change (EPC) estimates <span class="citation" data-cites="Oberski2014 Oberski2015">(<a href="references.html#ref-Oberski2014" role="doc-biblioref">Oberski, 2014</a>; <a href="references.html#ref-Oberski2015" role="doc-biblioref">Oberski et al., 2015</a>)</span> are provided by the <code>lavaan</code> package <span class="citation" data-cites="R-lavaan">(<a href="references.html#ref-R-lavaan" role="doc-biblioref">Rosseel et al., 2022</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb198"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1"></a><span class="fu">lavTestScore</span>(</span>
<span id="cb198-2"><a href="#cb198-2"></a>  scalarInvarianceModel_fit,</span>
<span id="cb198-3"><a href="#cb198-3"></a>  <span class="at">epc =</span> <span class="cn">TRUE</span></span>
<span id="cb198-4"><a href="#cb198-4"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$test

total score test:

   test     X2 df p.value
1 score 46.446 18       0

$uni

univariate score tests:

     lhs op   rhs     X2 df p.value
1   .p1. == .p37.  2.216  1   0.137
2   .p2. == .p38.  0.115  1   0.734
3   .p3. == .p39.  1.483  1   0.223
4   .p4. == .p40.  0.039  1   0.843
5   .p5. == .p41.  2.724  1   0.099
6   .p6. == .p42.  2.205  1   0.138
7   .p7. == .p43.  0.088  1   0.767
8   .p8. == .p44.  0.035  1   0.851
9   .p9. == .p45.  0.010  1   0.922
10 .p10. == .p46.  6.336  1   0.012
11 .p11. == .p47.  7.421  1   0.006
12 .p12. == .p48. 20.450  1   0.000
13 .p13. == .p49.  1.216  1   0.270
14 .p14. == .p50.  1.146  1   0.284
15 .p15. == .p51.  0.001  1   0.976
16 .p16. == .p52. 15.301  1   0.000
17 .p17. == .p53.  4.102  1   0.043
18 .p18. == .p54.  1.602  1   0.206

$epc

expected parameter changes (epc) and expected parameter values (epv):

       lhs op     rhs block group free        label plabel    est    epc    epv
1   visual =~      x1     1     1    1   lambda.1_1   .p1.  0.874  0.100  0.974
2   visual =~      x2     1     1    2   lambda.2_1   .p2.  0.512 -0.038  0.474
3   visual =~      x3     1     1    3   lambda.3_1   .p3.  0.722 -0.098  0.624
4  textual =~      x4     1     1    4   lambda.4_2   .p4.  0.921 -0.006  0.915
5  textual =~      x5     1     1    5   lambda.5_2   .p5.  1.059  0.067  1.126
6  textual =~      x6     1     1    6   lambda.6_2   .p6.  0.875 -0.042  0.833
7    speed =~      x7     1     1    7   lambda.7_3   .p7.  0.566 -0.024  0.542
8    speed =~      x8     1     1    8   lambda.8_3   .p8.  0.657  0.012  0.669
9    speed =~      x9     1     1    9   lambda.9_3   .p9.  0.602  0.004  0.606
10      x1 ~1             1     1   10         nu.1  .p10.  5.016 -0.068  4.948
11      x2 ~1             1     1   11         nu.2  .p11.  6.156 -0.172  5.984
12      x3 ~1             1     1   12         nu.3  .p12.  2.292  0.217  2.510
13      x4 ~1             1     1   13         nu.4  .p13.  2.780  0.034  2.814
14      x5 ~1             1     1   14         nu.5  .p14.  4.035 -0.032  4.002
15      x6 ~1             1     1   15         nu.6  .p15.  1.928  0.001  1.929
16      x7 ~1             1     1   16         nu.7  .p16.  4.244  0.195  4.439
17      x8 ~1             1     1   17         nu.8  .p17.  5.627 -0.063  5.563
18      x9 ~1             1     1   18         nu.9  .p18.  5.474 -0.048  5.426
19      x1 ~~      x1     1     1   19 theta.1_1.g1  .p19.  0.591 -0.132  0.459
20      x2 ~~      x2     1     1   20 theta.2_2.g1  .p20.  1.288  0.022  1.310
21      x3 ~~      x3     1     1   21 theta.3_3.g1  .p21.  0.910  0.086  0.997
22      x4 ~~      x4     1     1   22 theta.4_4.g1  .p22.  0.454  0.000  0.454
23      x5 ~~      x5     1     1   23 theta.5_5.g1  .p23.  0.480 -0.042  0.437
24      x6 ~~      x6     1     1   24 theta.6_6.g1  .p24.  0.257  0.026  0.283
25      x7 ~~      x7     1     1   25 theta.7_7.g1  .p25.  0.901  0.013  0.914
26      x8 ~~      x8     1     1   26 theta.8_8.g1  .p26.  0.534 -0.010  0.524
27      x9 ~~      x9     1     1   27 theta.9_9.g1  .p27.  0.631 -0.002  0.629
28  visual ~1             1     1    0   alpha.1.g1  .p28.  0.000     NA     NA
29 textual ~1             1     1    0   alpha.2.g1  .p29.  0.000     NA     NA
30   speed ~1             1     1    0   alpha.3.g1  .p30.  0.000     NA     NA
31  visual ~~  visual     1     1    0   psi.1_1.g1  .p31.  1.000     NA     NA
32 textual ~~ textual     1     1    0   psi.2_2.g1  .p32.  1.000     NA     NA
33   speed ~~   speed     1     1    0   psi.3_3.g1  .p33.  1.000     NA     NA
34  visual ~~ textual     1     1   28   psi.2_1.g1  .p34.  0.473 -0.013  0.460
35  visual ~~   speed     1     1   29   psi.3_1.g1  .p35.  0.355 -0.010  0.345
36 textual ~~   speed     1     1   30   psi.3_2.g1  .p36.  0.322  0.000  0.322
37  visual =~      x1     2     2   31   lambda.1_1  .p37.  0.874 -0.035  0.839
38  visual =~      x2     2     2   32   lambda.2_1  .p38.  0.512  0.068  0.580
39  visual =~      x3     2     2   33   lambda.3_1  .p39.  0.722 -0.002  0.721
40 textual =~      x4     2     2   34   lambda.4_2  .p40.  0.921  0.038  0.959
41 textual =~      x5     2     2   35   lambda.5_2  .p41.  1.059 -0.086  0.973
42 textual =~      x6     2     2   36   lambda.6_2  .p42.  0.875  0.067  0.942
43   speed =~      x7     2     2   37   lambda.7_3  .p43.  0.566 -0.036  0.530
44   speed =~      x8     2     2   38   lambda.8_3  .p44.  0.657  0.017  0.674
45   speed =~      x9     2     2   39   lambda.9_3  .p45.  0.602  0.009  0.611
46      x1 ~1             2     2   40         nu.1  .p46.  5.016  0.066  5.081
47      x2 ~1             2     2   41         nu.2  .p47.  6.156  0.148  6.304
48      x3 ~1             2     2   42         nu.3  .p48.  2.292 -0.169  2.123
49      x4 ~1             2     2   43         nu.4  .p49.  2.780 -0.053  2.727
50      x5 ~1             2     2   44         nu.5  .p50.  4.035  0.080  4.115
51      x6 ~1             2     2   45         nu.6  .p51.  1.928 -0.042  1.886
52      x7 ~1             2     2   46         nu.7  .p52.  4.244 -0.158  4.086
53      x8 ~1             2     2   47         nu.8  .p53.  5.627  0.068  5.695
54      x9 ~1             2     2   48         nu.9  .p54.  5.474  0.051  5.525
55      x1 ~~      x1     2     2   49 theta.1_1.g2  .p55.  0.668  0.029  0.697
56      x2 ~~      x2     2     2   50 theta.2_2.g2  .p56.  0.973 -0.021  0.952
57      x3 ~~      x3     2     2   51 theta.3_3.g2  .p57.  0.641 -0.002  0.639
58      x4 ~~      x4     2     2   52 theta.4_4.g2  .p58.  0.359 -0.026  0.333
59      x5 ~~      x5     2     2   53 theta.5_5.g2  .p59.  0.363  0.064  0.427
60      x6 ~~      x6     2     2   54 theta.6_6.g2  .p60.  0.441 -0.029  0.411
61      x7 ~~      x7     2     2   55 theta.7_7.g2  .p61.  0.652  0.021  0.674
62      x8 ~~      x8     2     2   56 theta.8_8.g2  .p62.  0.436 -0.015  0.420
63      x9 ~~      x9     2     2   57 theta.9_9.g2  .p63.  0.497 -0.004  0.493
64  visual ~1             2     2   58   alpha.1.g2  .p64. -0.193  0.011 -0.182
65 textual ~1             2     2   59   alpha.2.g2  .p65.  0.617 -0.001  0.617
66   speed ~1             2     2   60   alpha.3.g2  .p66. -0.294 -0.013 -0.307
67  visual ~~  visual     2     2   61   psi.1_1.g2  .p67.  0.896  0.001  0.897
68 textual ~~ textual     2     2   62   psi.2_2.g2  .p68.  1.000  0.001  1.000
69   speed ~~   speed     2     2   63   psi.3_3.g2  .p69.  1.495 -0.003  1.492
70  visual ~~ textual     2     2   64   psi.2_1.g2  .p70.  0.519  0.004  0.524
71  visual ~~   speed     2     2   65   psi.3_1.g2  .p71.  0.649  0.002  0.650
72 textual ~~   speed     2     2   66   psi.3_2.g2  .p72.  0.442  0.000  0.442
   sepc.lv sepc.all sepc.nox
1    0.100    0.086    0.086
2   -0.038   -0.031   -0.031
3   -0.098   -0.082   -0.082
4   -0.006   -0.005   -0.005
5    0.067    0.053    0.053
6   -0.042   -0.042   -0.042
7   -0.024   -0.021   -0.021
8    0.012    0.012    0.012
9    0.004    0.004    0.004
10  -0.068   -0.058   -0.058
11  -0.172   -0.138   -0.138
12   0.217    0.182    0.182
13   0.034    0.030    0.030
14  -0.032   -0.026   -0.026
15   0.001    0.001    0.001
16   0.195    0.177    0.177
17  -0.063   -0.064   -0.064
18  -0.048   -0.048   -0.048
19  -0.591   -0.436   -0.436
20   1.288    0.831    0.831
21   0.910    0.636    0.636
22   0.454    0.349    0.349
23  -0.480   -0.300   -0.300
24   0.257    0.252    0.252
25   0.901    0.738    0.738
26  -0.534   -0.553   -0.553
27  -0.631   -0.635   -0.635
28      NA       NA       NA
29      NA       NA       NA
30      NA       NA       NA
31      NA       NA       NA
32      NA       NA       NA
33      NA       NA       NA
34  -0.013   -0.013   -0.013
35  -0.010   -0.010   -0.010
36   0.000    0.000    0.000
37  -0.033   -0.028   -0.028
38   0.064    0.059    0.059
39  -0.002   -0.001   -0.001
40   0.038    0.034    0.034
41  -0.086   -0.070   -0.070
42   0.067    0.061    0.061
43  -0.044   -0.041   -0.041
44   0.021    0.020    0.020
45   0.011    0.011    0.011
46   0.066    0.057    0.057
47   0.148    0.135    0.135
48  -0.169   -0.161   -0.161
49  -0.053   -0.048   -0.048
50   0.080    0.066    0.066
51  -0.042   -0.038   -0.038
52  -0.158   -0.148   -0.148
53   0.068    0.066    0.066
54   0.051    0.050    0.050
55   0.668    0.494    0.494
56  -0.973   -0.805   -0.805
57  -0.641   -0.578   -0.578
58  -0.359   -0.297   -0.297
59   0.363    0.245    0.245
60  -0.441   -0.366   -0.366
61   0.652    0.577    0.577
62  -0.436   -0.403   -0.403
63  -0.497   -0.478   -0.478
64   0.012    0.012    0.012
65  -0.001   -0.001   -0.001
66  -0.011   -0.011   -0.011
67   1.000    1.000    1.000
68   1.000    1.000    1.000
69  -1.000   -1.000   -1.000
70   0.004    0.004    0.004
71   0.001    0.001    0.001
72   0.000    0.000    0.000</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceScalarModelEffectSize" class="level5" data-number="16.10.7.6.4"><h5 data-number="16.10.7.6.4" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelEffectSize">
<span class="header-section-number">16.10.7.6.4</span> Effect Size of Non-Invariance</h5>
<p>The effect size of measurement non-invariance, as described by <span class="citation" data-cites="Nye2019">Nye et al. (<a href="references.html#ref-Nye2019" role="doc-biblioref">2019</a>)</span>, was calculated using the <code>dmacs</code> package <span class="citation" data-cites="R-dmacs">(<a href="references.html#ref-R-dmacs" role="doc-biblioref">Dueber, 2019</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb200"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1"></a><span class="fu">lavaan_dmacs</span>(scalarInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$DMACS
                     visual                  textual                    speed
x1 0.0000000000000007920021                       NA                       NA
x2 0.0000000000000007407014                       NA                       NA
x3 0.0000000000000004219034                       NA                       NA
x4                       NA 0.0000000000000005588883                       NA
x5                       NA 0.0000000000000008870391                       NA
x6                       NA 0.0000000000000003586730                       NA
x7                       NA                       NA 0.0000000000000008351723
x8                       NA                       NA 0.0000000000000008838855
x9                       NA                       NA 0.0000000000000009596085

$ItemDeltaMean
                     visual                  textual                    speed
x1 0.0000000000000008751006                       NA                       NA
x2 0.0000000000000008511632                       NA                       NA
x3 0.0000000000000004252872                       NA                       NA
x4                       NA 0.0000000000000005406170                       NA
x5                       NA 0.0000000000000010140133                       NA
x6                       NA 0.0000000000000002698357                       NA
x7                       NA                       NA 0.0000000000000008880522
x8                       NA                       NA 0.0000000000000008481388
x9                       NA                       NA 0.0000000000000008995829

$MeanDiff
                 visual                 textual                   speed 
0.000000000000002151551 0.000000000000001824466 0.000000000000002635774 </code></pre>
</div>
</div>
<p>The <span class="math inline">\(w\)</span> and <span class="math inline">\(\Delta \text{M}_\text{C}\)</span> indices of the effect size of measurement non-invariance, as described by <span class="citation" data-cites="Newsom2015">Newsom (<a href="references.html#ref-Newsom2015" role="doc-biblioref">2015</a>)</span>, were calculated using the <code>measurementNoninvarianceEffectSize()</code> function of the <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb202"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1"></a>petersenlab<span class="sc">::</span><span class="fu">measurementNoninvarianceEffectSize</span>(</span>
<span id="cb202-2"><a href="#cb202-2"></a>  <span class="at">model_unconstrained =</span> metricInvarianceModel_fit,</span>
<span id="cb202-3"><a href="#cb202-3"></a>  <span class="at">model_constrained =</span> scalarInvarianceModel_fit</span>
<span id="cb202-4"><a href="#cb202-4"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$Mc_unconstrained
[1] 0.9013555

$Mc_constrained
[1] 0.8507891

$Delta_Mc
[1] 0.0505664

$w
[1] 0.1500116</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceScalarModelEquivalenceTest" class="level5" data-number="16.10.7.6.5"><h5 data-number="16.10.7.6.5" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelEquivalenceTest">
<span class="header-section-number">16.10.7.6.5</span> Equivalence Test</h5>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>equiv_chi()</code> function from <span class="citation" data-cites="Counsell2020">Counsell et al. (<a href="references.html#ref-Counsell2020" role="doc-biblioref">2020</a>)</span> that performs an equivalence test: <a href="https://osf.io/cqu8v" class="uri">https://osf.io/cqu8v</a>. The chi-square equivalence test is non-significant, suggesting that the model fit is not acceptable.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb204"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1"></a><span class="fu">equiv_chi</span>(</span>
<span id="cb204-2"><a href="#cb204-2"></a>  <span class="at">alpha =</span> .<span class="dv">05</span>,</span>
<span id="cb204-3"><a href="#cb204-3"></a>  <span class="at">chi =</span> scalarInvarianceModel_chisquare,</span>
<span id="cb204-4"><a href="#cb204-4"></a>  <span class="at">df =</span> scalarInvarianceModel_df,</span>
<span id="cb204-5"><a href="#cb204-5"></a>  <span class="at">m =</span> <span class="dv">2</span>,</span>
<span id="cb204-6"><a href="#cb204-6"></a>  <span class="at">N_sample =</span> scalarInvarianceModel_N,</span>
<span id="cb204-7"><a href="#cb204-7"></a>  <span class="at">popRMSEA =</span> .<span class="dv">08</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["chi"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Fml"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["popep"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["popdelt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pval"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"159.4416","2":"0.5332494","3":"0.192","4":"57.408","5":"0.9817801","_rn_":"chisq.scaled"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Moreover, the equivalence test of the chi-square difference test is non-significant, suggesting that the degree of worsening of model fit is not acceptable. In other words, scalar invariance failed.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb205"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1"></a>scalarInvarianceModel_dfDiff <span class="ot">&lt;-</span> </span>
<span id="cb205-2"><a href="#cb205-2"></a>  scalarInvarianceModel_df <span class="sc">-</span> metricInvarianceModel_df</span>
<span id="cb205-3"><a href="#cb205-3"></a></span>
<span id="cb205-4"><a href="#cb205-4"></a><span class="fu">equiv_chi</span>(</span>
<span id="cb205-5"><a href="#cb205-5"></a>  <span class="at">alpha =</span> .<span class="dv">05</span>,</span>
<span id="cb205-6"><a href="#cb205-6"></a>  <span class="at">chi =</span> scalarInvarianceModel_chisquareDiff,</span>
<span id="cb205-7"><a href="#cb205-7"></a>  <span class="at">df =</span> scalarInvarianceModel_dfDiff,</span>
<span id="cb205-8"><a href="#cb205-8"></a>  <span class="at">m =</span> <span class="dv">2</span>,</span>
<span id="cb205-9"><a href="#cb205-9"></a>  <span class="at">N_sample =</span> scalarInvarianceModel_N,</span>
<span id="cb205-10"><a href="#cb205-10"></a>  <span class="at">popRMSEA =</span> .<span class="dv">08</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["chi"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Fml"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["popep"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["popdelt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pval"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"41.928","2":"0.1402274","3":"0.0192","4":"5.7408","5":"0.9997378","_rn_":"chisq.scaled"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceScalarModelPermutationTest" class="level5" data-number="16.10.7.6.6"><h5 data-number="16.10.7.6.6" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelPermutationTest">
<span class="header-section-number">16.10.7.6.6</span> Permutation Test</h5>
<p>Permutation procedures for testing measurement invariance are described in <span class="citation" data-cites="Jorgensen2018">(<a href="references.html#ref-Jorgensen2018" role="doc-biblioref">Jorgensen et al., 2018</a>)</span>. For reproducibility, I set the seed below. Using the same seed will yield the same answer every time. There is nothing special about this particular seed. You can specify the null model as the baseline model using: <code>baseline.model = nullModelFit</code></p>
<p><strong>Warning</strong>: this code takes a while to run based on 100 iterations. You can reduce the number of iterations to be faster.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb206"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb206-2"><a href="#cb206-2"></a>scalarInvarianceTest <span class="ot">&lt;-</span> <span class="fu">permuteMeasEq</span>(</span>
<span id="cb206-3"><a href="#cb206-3"></a>  <span class="at">nPermute =</span> numPermutations,</span>
<span id="cb206-4"><a href="#cb206-4"></a>  <span class="at">modelType =</span> <span class="st">"mgcfa"</span>,</span>
<span id="cb206-5"><a href="#cb206-5"></a>  <span class="at">con =</span> scalarInvarianceModel_fit,</span>
<span id="cb206-6"><a href="#cb206-6"></a>  <span class="at">uncon =</span> metricInvarianceModel_fit,</span>
<span id="cb206-7"><a href="#cb206-7"></a>  <span class="at">AFIs =</span> myAFIs,</span>
<span id="cb206-8"><a href="#cb206-8"></a>  <span class="at">moreAFIs =</span> moreAFIs,</span>
<span id="cb206-9"><a href="#cb206-9"></a>  <span class="at">parallelType =</span> <span class="st">"multicore"</span>, <span class="co">#only 'snow' works on Windows, but right now, it is throwing an error</span></span>
<span id="cb206-10"><a href="#cb206-10"></a>  <span class="at">iseed =</span> <span class="dv">52242</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb207"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1"></a><span class="fu">RNGkind</span>(<span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>)</span>
<span id="cb207-2"><a href="#cb207-2"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb207-3"><a href="#cb207-3"></a></span>
<span id="cb207-4"><a href="#cb207-4"></a>scalarInvarianceTest</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Omnibus p value based on parametric chi-squared difference test:

Chisq diff    Df diff Pr(&gt;Chisq) 
    41.928      6.000      0.000 


Omnibus p values based on nonparametric permutation method: 

             AFI.Difference p.value
chisq                40.641       0
chisq.scaled         41.486       0
rmsea                 0.016       0
cfi                  -0.040       0
tli                  -0.039       0
srmr                  0.011       0
rmsea.robust          0.015       0
cfi.robust           -0.038       0
tli.robust           -0.036       0</code></pre>
</div>
</div>
<p>The <em>p</em>-values are significant, indicating that the model fit significantly worse than the metric invariance model. In other words, scalar invariance failed.</p>
</section></section><section id="sec-measurementInvarianceScalarModelReliability" class="level4" data-number="16.10.7.7"><h4 data-number="16.10.7.7" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelReliability">
<span class="header-section-number">16.10.7.7</span> Internal Consistency Reliability</h4>
<p><a href="reliability.html#sec-internalConsistency-reliability">Internal consistency reliability</a> of items composing the latent factors, as quantified by <a href="reliability.html#sec-coefficientOmega">omega (<span class="math inline">\(\omega\)</span>)</a>, <a href="reliability.html#sec-averageVarianceExtracted">average variance extracted</a> (AVE), and <a href="reliability.html#sec-maximalReliability">maximal reliability</a>, was estimated using the <code>semTools</code> package <span class="citation" data-cites="R-semTools">(<a href="references.html#ref-R-semTools" role="doc-biblioref">Jorgensen et al., 2021</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb209"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1"></a><span class="fu">compRelSEM</span>(scalarInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$visual

Composite `visual` is composed of observed variables:
    x1, x2, x3
True-score variance is represented by common factor(s):
    visual
Total variance of composite `visual` determined from the unrestricted model.
The proportion attributable to "true" scores is its model-based estimate of reliability ("omega"):

    Pasteur Grant-White 
      0.617       0.616 

$textual

Composite `textual` is composed of observed variables:
    x4, x5, x6
True-score variance is represented by common factor(s):
    textual
Total variance of composite `textual` determined from the unrestricted model.
The proportion attributable to "true" scores is its model-based estimate of reliability ("omega"):

    Pasteur Grant-White 
      0.858       0.863 

$speed

Composite `speed` is composed of observed variables:
    x7, x8, x9
True-score variance is represented by common factor(s):
    speed
Total variance of composite `speed` determined from the unrestricted model.
The proportion attributable to "true" scores is its model-based estimate of reliability ("omega"):

    Pasteur Grant-White 
      0.622       0.766 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb211"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1"></a><span class="fu">AVE</span>(scalarInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["chr"],"align":["left"]},{"label":["visual"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["textual"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["speed"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Pasteur","2":"0.3659807","3":"0.6874279","4":"0.3559319"},{"1":"Grant-White","2":"0.3821957","3":"0.6991725","4":"0.5187171"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb212"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1"></a><span class="fu">maximalRelia</span>(scalarInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$Pasteur
[1] 0.9275905
attr(,"weight")
        x1         x2         x3         x4         x5         x6         x7 
-1.0096511  0.3880185  1.4059100  2.4845109  1.4500033  4.1353640 -0.3145371 
        x8         x9 
 0.5754143 -0.1150327 

$`Grant-White`
[1] 0.9534082
attr(,"weight")
        x1         x2         x3         x4         x5         x6         x7 
 1.4866477  0.4311207  0.8977581  1.9189886  4.0024036  0.7076788  0.1643978 
        x8         x9 
 1.5357674 -2.1447627 </code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceScalarModelPathDiagram" class="level4" data-number="16.10.7.8"><h4 data-number="16.10.7.8" class="anchored" data-anchor-id="sec-measurementInvarianceScalarModelPathDiagram">
<span class="header-section-number">16.10.7.8</span> Path Diagram</h4>
<p>A path diagram of the model generated using the <code>semPlot</code> package <span class="citation" data-cites="R-semPlot">(<a href="references.html#ref-R-semPlot" role="doc-biblioref">Epskamp, 2022</a>)</span> is below.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb214"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1"></a><span class="fu">semPaths</span>(</span>
<span id="cb214-2"><a href="#cb214-2"></a>  scalarInvarianceModel_fit,</span>
<span id="cb214-3"><a href="#cb214-3"></a>  <span class="at">what =</span> <span class="st">"est"</span>,</span>
<span id="cb214-4"><a href="#cb214-4"></a>  <span class="at">layout =</span> <span class="st">"tree2"</span>,</span>
<span id="cb214-5"><a href="#cb214-5"></a>  <span class="at">ask =</span> <span class="cn">FALSE</span>,</span>
<span id="cb214-6"><a href="#cb214-6"></a>  <span class="at">edge.label.cex =</span> <span class="fl">1.2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-measurementInvarianceScalarModelPathDiagram-1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scalar Invariance Model in Confirmatory Factor Analysis.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-measurementInvarianceScalarModelPathDiagram-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-measurementInvarianceScalarModelPathDiagram-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-59" title="Figure&nbsp;16.62: Scalar Invariance Model in Confirmatory Factor Analysis."><img src="test-bias_files/figure-html/fig-measurementInvarianceScalarModelPathDiagram-1.png" class="img-fluid figure-img" alt="Scalar Invariance Model in Confirmatory Factor Analysis." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-measurementInvarianceScalarModelPathDiagram-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.62: Scalar Invariance Model in Confirmatory Factor Analysis.
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-measurementInvarianceScalarModelPathDiagram-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scalar Invariance Model in Confirmatory Factor Analysis.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-measurementInvarianceScalarModelPathDiagram-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-measurementInvarianceScalarModelPathDiagram-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-60" title="Figure&nbsp;16.63: Scalar Invariance Model in Confirmatory Factor Analysis."><img src="test-bias_files/figure-html/fig-measurementInvarianceScalarModelPathDiagram-2.png" class="img-fluid figure-img" alt="Scalar Invariance Model in Confirmatory Factor Analysis." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-measurementInvarianceScalarModelPathDiagram-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.63: Scalar Invariance Model in Confirmatory Factor Analysis.
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-measurementInvarianceResidualModel" class="level3" data-number="16.10.8"><h3 data-number="16.10.8" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModel">
<span class="header-section-number">16.10.8</span> Residual (“Strict Factorial”) Invariance Model</h3>
<p>Specify invariance of factor loadings, intercepts, and residuals across groups.</p>
<section id="sec-measurementInvarianceResidualModelSyntax" class="level4" data-number="16.10.8.1"><h4 data-number="16.10.8.1" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelSyntax">
<span class="header-section-number">16.10.8.1</span> Model Syntax</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb215"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1"></a>residualInvarianceModel <span class="ot">&lt;-</span> <span class="fu">measEq.syntax</span>(</span>
<span id="cb215-2"><a href="#cb215-2"></a>  <span class="at">configural.model =</span> cfaModel,</span>
<span id="cb215-3"><a href="#cb215-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb215-4"><a href="#cb215-4"></a>  <span class="at">ID.fac =</span> <span class="st">"std.lv"</span>,</span>
<span id="cb215-5"><a href="#cb215-5"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb215-6"><a href="#cb215-6"></a>  <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">"loadings"</span>,<span class="st">"intercepts"</span>,<span class="st">"residuals"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb216"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1"></a><span class="fu">cat</span>(<span class="fu">as.character</span>(residualInvarianceModel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>## LOADINGS:

visual =~ c(NA, NA)*x1 + c(lambda.1_1, lambda.1_1)*x1
visual =~ c(NA, NA)*x2 + c(lambda.2_1, lambda.2_1)*x2
visual =~ c(NA, NA)*x3 + c(lambda.3_1, lambda.3_1)*x3
textual =~ c(NA, NA)*x4 + c(lambda.4_2, lambda.4_2)*x4
textual =~ c(NA, NA)*x5 + c(lambda.5_2, lambda.5_2)*x5
textual =~ c(NA, NA)*x6 + c(lambda.6_2, lambda.6_2)*x6
speed =~ c(NA, NA)*x7 + c(lambda.7_3, lambda.7_3)*x7
speed =~ c(NA, NA)*x8 + c(lambda.8_3, lambda.8_3)*x8
speed =~ c(NA, NA)*x9 + c(lambda.9_3, lambda.9_3)*x9

## INTERCEPTS:

x1 ~ c(NA, NA)*1 + c(nu.1, nu.1)*1
x2 ~ c(NA, NA)*1 + c(nu.2, nu.2)*1
x3 ~ c(NA, NA)*1 + c(nu.3, nu.3)*1
x4 ~ c(NA, NA)*1 + c(nu.4, nu.4)*1
x5 ~ c(NA, NA)*1 + c(nu.5, nu.5)*1
x6 ~ c(NA, NA)*1 + c(nu.6, nu.6)*1
x7 ~ c(NA, NA)*1 + c(nu.7, nu.7)*1
x8 ~ c(NA, NA)*1 + c(nu.8, nu.8)*1
x9 ~ c(NA, NA)*1 + c(nu.9, nu.9)*1

## UNIQUE-FACTOR VARIANCES:

x1 ~~ c(NA, NA)*x1 + c(theta.1_1, theta.1_1)*x1
x2 ~~ c(NA, NA)*x2 + c(theta.2_2, theta.2_2)*x2
x3 ~~ c(NA, NA)*x3 + c(theta.3_3, theta.3_3)*x3
x4 ~~ c(NA, NA)*x4 + c(theta.4_4, theta.4_4)*x4
x5 ~~ c(NA, NA)*x5 + c(theta.5_5, theta.5_5)*x5
x6 ~~ c(NA, NA)*x6 + c(theta.6_6, theta.6_6)*x6
x7 ~~ c(NA, NA)*x7 + c(theta.7_7, theta.7_7)*x7
x8 ~~ c(NA, NA)*x8 + c(theta.8_8, theta.8_8)*x8
x9 ~~ c(NA, NA)*x9 + c(theta.9_9, theta.9_9)*x9

## LATENT MEANS/INTERCEPTS:

visual ~ c(0, NA)*1 + c(alpha.1.g1, alpha.1.g2)*1
textual ~ c(0, NA)*1 + c(alpha.2.g1, alpha.2.g2)*1
speed ~ c(0, NA)*1 + c(alpha.3.g1, alpha.3.g2)*1

## COMMON-FACTOR VARIANCES:

visual ~~ c(1, NA)*visual + c(psi.1_1.g1, psi.1_1.g2)*visual
textual ~~ c(1, NA)*textual + c(psi.2_2.g1, psi.2_2.g2)*textual
speed ~~ c(1, NA)*speed + c(psi.3_3.g1, psi.3_3.g2)*speed

## COMMON-FACTOR COVARIANCES:

visual ~~ c(NA, NA)*textual + c(psi.2_1.g1, psi.2_1.g2)*textual
visual ~~ c(NA, NA)*speed + c(psi.3_1.g1, psi.3_1.g2)*speed
textual ~~ c(NA, NA)*speed + c(psi.3_2.g1, psi.3_2.g2)*speed</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb218"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1"></a>residualInvarianceSyntax <span class="ot">&lt;-</span> <span class="fu">as.character</span>(residualInvarianceModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="sec-measurementInvarianceResidualModelFeatures" class="level5" data-number="16.10.8.1.1"><h5 data-number="16.10.8.1.1" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelFeatures">
<span class="header-section-number">16.10.8.1.1</span> Summary of Model Features</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb219"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1"></a><span class="fu">summary</span>(residualInvarianceModel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>This lavaan model syntax specifies a CFA with 9 manifest indicators of 3 common factor(s).

To identify the location and scale of each common factor, the factor means and variances were fixed to 0 and 1, respectively, unless equality constraints on measurement parameters allow them to be freed.

Pattern matrix indicating num(eric), ord(ered), and lat(ent) indicators per factor:

   visual textual speed
x1 num                 
x2 num                 
x3 num                 
x4        num          
x5        num          
x6        num          
x7                num  
x8                num  
x9                num  

The following types of parameter were constrained to equality across groups:

    loadings
    intercepts
    residuals</code></pre>
</div>
</div>
</section></section><section id="sec-measurementInvarianceResidualModelTabular" class="level4" data-number="16.10.8.2"><h4 data-number="16.10.8.2" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelTabular">
<span class="header-section-number">16.10.8.2</span> Model Syntax in Table Form</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb221"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1"></a><span class="fu">lavaanify</span>(residualInvarianceModel, <span class="at">ngroups =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["lhs"],"name":[2],"type":["chr"],"align":["left"]},{"label":["op"],"name":[3],"type":["chr"],"align":["left"]},{"label":["rhs"],"name":[4],"type":["chr"],"align":["left"]},{"label":["user"],"name":[5],"type":["int"],"align":["right"]},{"label":["block"],"name":[6],"type":["int"],"align":["right"]},{"label":["group"],"name":[7],"type":["int"],"align":["right"]},{"label":["free"],"name":[8],"type":["int"],"align":["right"]},{"label":["ustart"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["exo"],"name":[10],"type":["int"],"align":["right"]},{"label":["label"],"name":[11],"type":["chr"],"align":["left"]},{"label":["plabel"],"name":[12],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"visual","3":"=~","4":"x1","5":"1","6":"1","7":"1","8":"1","9":"NA","10":"0","11":"lambda.1_1","12":".p1."},{"1":"2","2":"visual","3":"=~","4":"x2","5":"1","6":"1","7":"1","8":"2","9":"NA","10":"0","11":"lambda.2_1","12":".p2."},{"1":"3","2":"visual","3":"=~","4":"x3","5":"1","6":"1","7":"1","8":"3","9":"NA","10":"0","11":"lambda.3_1","12":".p3."},{"1":"4","2":"textual","3":"=~","4":"x4","5":"1","6":"1","7":"1","8":"4","9":"NA","10":"0","11":"lambda.4_2","12":".p4."},{"1":"5","2":"textual","3":"=~","4":"x5","5":"1","6":"1","7":"1","8":"5","9":"NA","10":"0","11":"lambda.5_2","12":".p5."},{"1":"6","2":"textual","3":"=~","4":"x6","5":"1","6":"1","7":"1","8":"6","9":"NA","10":"0","11":"lambda.6_2","12":".p6."},{"1":"7","2":"speed","3":"=~","4":"x7","5":"1","6":"1","7":"1","8":"7","9":"NA","10":"0","11":"lambda.7_3","12":".p7."},{"1":"8","2":"speed","3":"=~","4":"x8","5":"1","6":"1","7":"1","8":"8","9":"NA","10":"0","11":"lambda.8_3","12":".p8."},{"1":"9","2":"speed","3":"=~","4":"x9","5":"1","6":"1","7":"1","8":"9","9":"NA","10":"0","11":"lambda.9_3","12":".p9."},{"1":"10","2":"x1","3":"~1","4":"","5":"1","6":"1","7":"1","8":"10","9":"NA","10":"0","11":"nu.1","12":".p10."},{"1":"11","2":"x2","3":"~1","4":"","5":"1","6":"1","7":"1","8":"11","9":"NA","10":"0","11":"nu.2","12":".p11."},{"1":"12","2":"x3","3":"~1","4":"","5":"1","6":"1","7":"1","8":"12","9":"NA","10":"0","11":"nu.3","12":".p12."},{"1":"13","2":"x4","3":"~1","4":"","5":"1","6":"1","7":"1","8":"13","9":"NA","10":"0","11":"nu.4","12":".p13."},{"1":"14","2":"x5","3":"~1","4":"","5":"1","6":"1","7":"1","8":"14","9":"NA","10":"0","11":"nu.5","12":".p14."},{"1":"15","2":"x6","3":"~1","4":"","5":"1","6":"1","7":"1","8":"15","9":"NA","10":"0","11":"nu.6","12":".p15."},{"1":"16","2":"x7","3":"~1","4":"","5":"1","6":"1","7":"1","8":"16","9":"NA","10":"0","11":"nu.7","12":".p16."},{"1":"17","2":"x8","3":"~1","4":"","5":"1","6":"1","7":"1","8":"17","9":"NA","10":"0","11":"nu.8","12":".p17."},{"1":"18","2":"x9","3":"~1","4":"","5":"1","6":"1","7":"1","8":"18","9":"NA","10":"0","11":"nu.9","12":".p18."},{"1":"19","2":"x1","3":"~~","4":"x1","5":"1","6":"1","7":"1","8":"19","9":"NA","10":"0","11":"theta.1_1","12":".p19."},{"1":"20","2":"x2","3":"~~","4":"x2","5":"1","6":"1","7":"1","8":"20","9":"NA","10":"0","11":"theta.2_2","12":".p20."},{"1":"21","2":"x3","3":"~~","4":"x3","5":"1","6":"1","7":"1","8":"21","9":"NA","10":"0","11":"theta.3_3","12":".p21."},{"1":"22","2":"x4","3":"~~","4":"x4","5":"1","6":"1","7":"1","8":"22","9":"NA","10":"0","11":"theta.4_4","12":".p22."},{"1":"23","2":"x5","3":"~~","4":"x5","5":"1","6":"1","7":"1","8":"23","9":"NA","10":"0","11":"theta.5_5","12":".p23."},{"1":"24","2":"x6","3":"~~","4":"x6","5":"1","6":"1","7":"1","8":"24","9":"NA","10":"0","11":"theta.6_6","12":".p24."},{"1":"25","2":"x7","3":"~~","4":"x7","5":"1","6":"1","7":"1","8":"25","9":"NA","10":"0","11":"theta.7_7","12":".p25."},{"1":"26","2":"x8","3":"~~","4":"x8","5":"1","6":"1","7":"1","8":"26","9":"NA","10":"0","11":"theta.8_8","12":".p26."},{"1":"27","2":"x9","3":"~~","4":"x9","5":"1","6":"1","7":"1","8":"27","9":"NA","10":"0","11":"theta.9_9","12":".p27."},{"1":"28","2":"visual","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"alpha.1.g1","12":".p28."},{"1":"29","2":"textual","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"alpha.2.g1","12":".p29."},{"1":"30","2":"speed","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"alpha.3.g1","12":".p30."},{"1":"31","2":"visual","3":"~~","4":"visual","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"psi.1_1.g1","12":".p31."},{"1":"32","2":"textual","3":"~~","4":"textual","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"psi.2_2.g1","12":".p32."},{"1":"33","2":"speed","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"psi.3_3.g1","12":".p33."},{"1":"34","2":"visual","3":"~~","4":"textual","5":"1","6":"1","7":"1","8":"28","9":"NA","10":"0","11":"psi.2_1.g1","12":".p34."},{"1":"35","2":"visual","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"29","9":"NA","10":"0","11":"psi.3_1.g1","12":".p35."},{"1":"36","2":"textual","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"30","9":"NA","10":"0","11":"psi.3_2.g1","12":".p36."},{"1":"37","2":"visual","3":"=~","4":"x1","5":"1","6":"2","7":"2","8":"31","9":"NA","10":"0","11":"lambda.1_1","12":".p37."},{"1":"38","2":"visual","3":"=~","4":"x2","5":"1","6":"2","7":"2","8":"32","9":"NA","10":"0","11":"lambda.2_1","12":".p38."},{"1":"39","2":"visual","3":"=~","4":"x3","5":"1","6":"2","7":"2","8":"33","9":"NA","10":"0","11":"lambda.3_1","12":".p39."},{"1":"40","2":"textual","3":"=~","4":"x4","5":"1","6":"2","7":"2","8":"34","9":"NA","10":"0","11":"lambda.4_2","12":".p40."},{"1":"41","2":"textual","3":"=~","4":"x5","5":"1","6":"2","7":"2","8":"35","9":"NA","10":"0","11":"lambda.5_2","12":".p41."},{"1":"42","2":"textual","3":"=~","4":"x6","5":"1","6":"2","7":"2","8":"36","9":"NA","10":"0","11":"lambda.6_2","12":".p42."},{"1":"43","2":"speed","3":"=~","4":"x7","5":"1","6":"2","7":"2","8":"37","9":"NA","10":"0","11":"lambda.7_3","12":".p43."},{"1":"44","2":"speed","3":"=~","4":"x8","5":"1","6":"2","7":"2","8":"38","9":"NA","10":"0","11":"lambda.8_3","12":".p44."},{"1":"45","2":"speed","3":"=~","4":"x9","5":"1","6":"2","7":"2","8":"39","9":"NA","10":"0","11":"lambda.9_3","12":".p45."},{"1":"46","2":"x1","3":"~1","4":"","5":"1","6":"2","7":"2","8":"40","9":"NA","10":"0","11":"nu.1","12":".p46."},{"1":"47","2":"x2","3":"~1","4":"","5":"1","6":"2","7":"2","8":"41","9":"NA","10":"0","11":"nu.2","12":".p47."},{"1":"48","2":"x3","3":"~1","4":"","5":"1","6":"2","7":"2","8":"42","9":"NA","10":"0","11":"nu.3","12":".p48."},{"1":"49","2":"x4","3":"~1","4":"","5":"1","6":"2","7":"2","8":"43","9":"NA","10":"0","11":"nu.4","12":".p49."},{"1":"50","2":"x5","3":"~1","4":"","5":"1","6":"2","7":"2","8":"44","9":"NA","10":"0","11":"nu.5","12":".p50."},{"1":"51","2":"x6","3":"~1","4":"","5":"1","6":"2","7":"2","8":"45","9":"NA","10":"0","11":"nu.6","12":".p51."},{"1":"52","2":"x7","3":"~1","4":"","5":"1","6":"2","7":"2","8":"46","9":"NA","10":"0","11":"nu.7","12":".p52."},{"1":"53","2":"x8","3":"~1","4":"","5":"1","6":"2","7":"2","8":"47","9":"NA","10":"0","11":"nu.8","12":".p53."},{"1":"54","2":"x9","3":"~1","4":"","5":"1","6":"2","7":"2","8":"48","9":"NA","10":"0","11":"nu.9","12":".p54."},{"1":"55","2":"x1","3":"~~","4":"x1","5":"1","6":"2","7":"2","8":"49","9":"NA","10":"0","11":"theta.1_1","12":".p55."},{"1":"56","2":"x2","3":"~~","4":"x2","5":"1","6":"2","7":"2","8":"50","9":"NA","10":"0","11":"theta.2_2","12":".p56."},{"1":"57","2":"x3","3":"~~","4":"x3","5":"1","6":"2","7":"2","8":"51","9":"NA","10":"0","11":"theta.3_3","12":".p57."},{"1":"58","2":"x4","3":"~~","4":"x4","5":"1","6":"2","7":"2","8":"52","9":"NA","10":"0","11":"theta.4_4","12":".p58."},{"1":"59","2":"x5","3":"~~","4":"x5","5":"1","6":"2","7":"2","8":"53","9":"NA","10":"0","11":"theta.5_5","12":".p59."},{"1":"60","2":"x6","3":"~~","4":"x6","5":"1","6":"2","7":"2","8":"54","9":"NA","10":"0","11":"theta.6_6","12":".p60."},{"1":"61","2":"x7","3":"~~","4":"x7","5":"1","6":"2","7":"2","8":"55","9":"NA","10":"0","11":"theta.7_7","12":".p61."},{"1":"62","2":"x8","3":"~~","4":"x8","5":"1","6":"2","7":"2","8":"56","9":"NA","10":"0","11":"theta.8_8","12":".p62."},{"1":"63","2":"x9","3":"~~","4":"x9","5":"1","6":"2","7":"2","8":"57","9":"NA","10":"0","11":"theta.9_9","12":".p63."},{"1":"64","2":"visual","3":"~1","4":"","5":"1","6":"2","7":"2","8":"58","9":"NA","10":"0","11":"alpha.1.g2","12":".p64."},{"1":"65","2":"textual","3":"~1","4":"","5":"1","6":"2","7":"2","8":"59","9":"NA","10":"0","11":"alpha.2.g2","12":".p65."},{"1":"66","2":"speed","3":"~1","4":"","5":"1","6":"2","7":"2","8":"60","9":"NA","10":"0","11":"alpha.3.g2","12":".p66."},{"1":"67","2":"visual","3":"~~","4":"visual","5":"1","6":"2","7":"2","8":"61","9":"NA","10":"0","11":"psi.1_1.g2","12":".p67."},{"1":"68","2":"textual","3":"~~","4":"textual","5":"1","6":"2","7":"2","8":"62","9":"NA","10":"0","11":"psi.2_2.g2","12":".p68."},{"1":"69","2":"speed","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"63","9":"NA","10":"0","11":"psi.3_3.g2","12":".p69."},{"1":"70","2":"visual","3":"~~","4":"textual","5":"1","6":"2","7":"2","8":"64","9":"NA","10":"0","11":"psi.2_1.g2","12":".p70."},{"1":"71","2":"visual","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"65","9":"NA","10":"0","11":"psi.3_1.g2","12":".p71."},{"1":"72","2":"textual","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"66","9":"NA","10":"0","11":"psi.3_2.g2","12":".p72."},{"1":"73","2":".p1.","3":"==","4":".p37.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"74","2":".p2.","3":"==","4":".p38.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"75","2":".p3.","3":"==","4":".p39.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"76","2":".p4.","3":"==","4":".p40.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"77","2":".p5.","3":"==","4":".p41.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"78","2":".p6.","3":"==","4":".p42.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"79","2":".p7.","3":"==","4":".p43.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"80","2":".p8.","3":"==","4":".p44.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"81","2":".p9.","3":"==","4":".p45.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"82","2":".p10.","3":"==","4":".p46.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"83","2":".p11.","3":"==","4":".p47.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"84","2":".p12.","3":"==","4":".p48.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"85","2":".p13.","3":"==","4":".p49.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"86","2":".p14.","3":"==","4":".p50.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"87","2":".p15.","3":"==","4":".p51.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"88","2":".p16.","3":"==","4":".p52.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"89","2":".p17.","3":"==","4":".p53.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"90","2":".p18.","3":"==","4":".p54.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"91","2":".p19.","3":"==","4":".p55.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"92","2":".p20.","3":"==","4":".p56.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"93","2":".p21.","3":"==","4":".p57.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"94","2":".p22.","3":"==","4":".p58.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"95","2":".p23.","3":"==","4":".p59.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"96","2":".p24.","3":"==","4":".p60.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"97","2":".p25.","3":"==","4":".p61.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"98","2":".p26.","3":"==","4":".p62.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"99","2":".p27.","3":"==","4":".p63.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb222"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1"></a><span class="fu">lavaanify</span>(cfaModel_residualInvariance, <span class="at">ngroups =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["lhs"],"name":[2],"type":["chr"],"align":["left"]},{"label":["op"],"name":[3],"type":["chr"],"align":["left"]},{"label":["rhs"],"name":[4],"type":["chr"],"align":["left"]},{"label":["user"],"name":[5],"type":["int"],"align":["right"]},{"label":["block"],"name":[6],"type":["int"],"align":["right"]},{"label":["group"],"name":[7],"type":["int"],"align":["right"]},{"label":["free"],"name":[8],"type":["int"],"align":["right"]},{"label":["ustart"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["exo"],"name":[10],"type":["int"],"align":["right"]},{"label":["label"],"name":[11],"type":["chr"],"align":["left"]},{"label":["plabel"],"name":[12],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"visual","3":"=~","4":"x1","5":"1","6":"1","7":"1","8":"1","9":"NA","10":"0","11":"lambdax1","12":".p1."},{"1":"2","2":"visual","3":"=~","4":"x2","5":"1","6":"1","7":"1","8":"2","9":"NA","10":"0","11":"lambdax2","12":".p2."},{"1":"3","2":"visual","3":"=~","4":"x3","5":"1","6":"1","7":"1","8":"3","9":"NA","10":"0","11":"lambdax3","12":".p3."},{"1":"4","2":"textual","3":"=~","4":"x4","5":"1","6":"1","7":"1","8":"4","9":"NA","10":"0","11":"lambdax4","12":".p4."},{"1":"5","2":"textual","3":"=~","4":"x5","5":"1","6":"1","7":"1","8":"5","9":"NA","10":"0","11":"lambdax5","12":".p5."},{"1":"6","2":"textual","3":"=~","4":"x6","5":"1","6":"1","7":"1","8":"6","9":"NA","10":"0","11":"lambdax6","12":".p6."},{"1":"7","2":"speed","3":"=~","4":"x7","5":"1","6":"1","7":"1","8":"7","9":"NA","10":"0","11":"lambdax7","12":".p7."},{"1":"8","2":"speed","3":"=~","4":"x8","5":"1","6":"1","7":"1","8":"8","9":"NA","10":"0","11":"lambdax8","12":".p8."},{"1":"9","2":"speed","3":"=~","4":"x9","5":"1","6":"1","7":"1","8":"9","9":"NA","10":"0","11":"lambdax9","12":".p9."},{"1":"10","2":"visual","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p10."},{"1":"11","2":"textual","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p11."},{"1":"12","2":"speed","3":"~1","4":"","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"","12":".p12."},{"1":"13","2":"visual","3":"~~","4":"visual","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"","12":".p13."},{"1":"14","2":"textual","3":"~~","4":"textual","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"","12":".p14."},{"1":"15","2":"speed","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"0","9":"1","10":"0","11":"","12":".p15."},{"1":"16","2":"visual","3":"~~","4":"textual","5":"1","6":"1","7":"1","8":"10","9":"NA","10":"0","11":"","12":".p16."},{"1":"17","2":"visual","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"11","9":"NA","10":"0","11":"","12":".p17."},{"1":"18","2":"textual","3":"~~","4":"speed","5":"1","6":"1","7":"1","8":"12","9":"NA","10":"0","11":"","12":".p18."},{"1":"19","2":"x1","3":"~~","4":"x1","5":"1","6":"1","7":"1","8":"13","9":"NA","10":"0","11":"residx1","12":".p19."},{"1":"20","2":"x2","3":"~~","4":"x2","5":"1","6":"1","7":"1","8":"14","9":"NA","10":"0","11":"residx2","12":".p20."},{"1":"21","2":"x3","3":"~~","4":"x3","5":"1","6":"1","7":"1","8":"15","9":"NA","10":"0","11":"residx3","12":".p21."},{"1":"22","2":"x4","3":"~~","4":"x4","5":"1","6":"1","7":"1","8":"16","9":"NA","10":"0","11":"residx4","12":".p22."},{"1":"23","2":"x5","3":"~~","4":"x5","5":"1","6":"1","7":"1","8":"17","9":"NA","10":"0","11":"residx5","12":".p23."},{"1":"24","2":"x6","3":"~~","4":"x6","5":"1","6":"1","7":"1","8":"18","9":"NA","10":"0","11":"residx6","12":".p24."},{"1":"25","2":"x7","3":"~~","4":"x7","5":"1","6":"1","7":"1","8":"19","9":"NA","10":"0","11":"residx7","12":".p25."},{"1":"26","2":"x8","3":"~~","4":"x8","5":"1","6":"1","7":"1","8":"20","9":"NA","10":"0","11":"residx8","12":".p26."},{"1":"27","2":"x9","3":"~~","4":"x9","5":"1","6":"1","7":"1","8":"21","9":"NA","10":"0","11":"residx9","12":".p27."},{"1":"28","2":"x1","3":"~1","4":"","5":"1","6":"1","7":"1","8":"22","9":"NA","10":"0","11":"intx1","12":".p28."},{"1":"29","2":"x2","3":"~1","4":"","5":"1","6":"1","7":"1","8":"23","9":"NA","10":"0","11":"intx2","12":".p29."},{"1":"30","2":"x3","3":"~1","4":"","5":"1","6":"1","7":"1","8":"24","9":"NA","10":"0","11":"intx3","12":".p30."},{"1":"31","2":"x4","3":"~1","4":"","5":"1","6":"1","7":"1","8":"25","9":"NA","10":"0","11":"intx4","12":".p31."},{"1":"32","2":"x5","3":"~1","4":"","5":"1","6":"1","7":"1","8":"26","9":"NA","10":"0","11":"intx5","12":".p32."},{"1":"33","2":"x6","3":"~1","4":"","5":"1","6":"1","7":"1","8":"27","9":"NA","10":"0","11":"intx6","12":".p33."},{"1":"34","2":"x7","3":"~1","4":"","5":"1","6":"1","7":"1","8":"28","9":"NA","10":"0","11":"intx7","12":".p34."},{"1":"35","2":"x8","3":"~1","4":"","5":"1","6":"1","7":"1","8":"29","9":"NA","10":"0","11":"intx8","12":".p35."},{"1":"36","2":"x9","3":"~1","4":"","5":"1","6":"1","7":"1","8":"30","9":"NA","10":"0","11":"intx9","12":".p36."},{"1":"37","2":"visual","3":"=~","4":"x1","5":"1","6":"2","7":"2","8":"31","9":"NA","10":"0","11":"lambdax1","12":".p37."},{"1":"38","2":"visual","3":"=~","4":"x2","5":"1","6":"2","7":"2","8":"32","9":"NA","10":"0","11":"lambdax2","12":".p38."},{"1":"39","2":"visual","3":"=~","4":"x3","5":"1","6":"2","7":"2","8":"33","9":"NA","10":"0","11":"lambdax3","12":".p39."},{"1":"40","2":"textual","3":"=~","4":"x4","5":"1","6":"2","7":"2","8":"34","9":"NA","10":"0","11":"lambdax4","12":".p40."},{"1":"41","2":"textual","3":"=~","4":"x5","5":"1","6":"2","7":"2","8":"35","9":"NA","10":"0","11":"lambdax5","12":".p41."},{"1":"42","2":"textual","3":"=~","4":"x6","5":"1","6":"2","7":"2","8":"36","9":"NA","10":"0","11":"lambdax6","12":".p42."},{"1":"43","2":"speed","3":"=~","4":"x7","5":"1","6":"2","7":"2","8":"37","9":"NA","10":"0","11":"lambdax7","12":".p43."},{"1":"44","2":"speed","3":"=~","4":"x8","5":"1","6":"2","7":"2","8":"38","9":"NA","10":"0","11":"lambdax8","12":".p44."},{"1":"45","2":"speed","3":"=~","4":"x9","5":"1","6":"2","7":"2","8":"39","9":"NA","10":"0","11":"lambdax9","12":".p45."},{"1":"46","2":"visual","3":"~1","4":"","5":"1","6":"2","7":"2","8":"40","9":"NA","10":"0","11":"","12":".p46."},{"1":"47","2":"textual","3":"~1","4":"","5":"1","6":"2","7":"2","8":"41","9":"NA","10":"0","11":"","12":".p47."},{"1":"48","2":"speed","3":"~1","4":"","5":"1","6":"2","7":"2","8":"42","9":"NA","10":"0","11":"","12":".p48."},{"1":"49","2":"visual","3":"~~","4":"visual","5":"1","6":"2","7":"2","8":"43","9":"NA","10":"0","11":"","12":".p49."},{"1":"50","2":"textual","3":"~~","4":"textual","5":"1","6":"2","7":"2","8":"44","9":"NA","10":"0","11":"","12":".p50."},{"1":"51","2":"speed","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"45","9":"NA","10":"0","11":"","12":".p51."},{"1":"52","2":"visual","3":"~~","4":"textual","5":"1","6":"2","7":"2","8":"46","9":"NA","10":"0","11":"","12":".p52."},{"1":"53","2":"visual","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"47","9":"NA","10":"0","11":"","12":".p53."},{"1":"54","2":"textual","3":"~~","4":"speed","5":"1","6":"2","7":"2","8":"48","9":"NA","10":"0","11":"","12":".p54."},{"1":"55","2":"x1","3":"~~","4":"x1","5":"1","6":"2","7":"2","8":"49","9":"NA","10":"0","11":"residx1","12":".p55."},{"1":"56","2":"x2","3":"~~","4":"x2","5":"1","6":"2","7":"2","8":"50","9":"NA","10":"0","11":"residx2","12":".p56."},{"1":"57","2":"x3","3":"~~","4":"x3","5":"1","6":"2","7":"2","8":"51","9":"NA","10":"0","11":"residx3","12":".p57."},{"1":"58","2":"x4","3":"~~","4":"x4","5":"1","6":"2","7":"2","8":"52","9":"NA","10":"0","11":"residx4","12":".p58."},{"1":"59","2":"x5","3":"~~","4":"x5","5":"1","6":"2","7":"2","8":"53","9":"NA","10":"0","11":"residx5","12":".p59."},{"1":"60","2":"x6","3":"~~","4":"x6","5":"1","6":"2","7":"2","8":"54","9":"NA","10":"0","11":"residx6","12":".p60."},{"1":"61","2":"x7","3":"~~","4":"x7","5":"1","6":"2","7":"2","8":"55","9":"NA","10":"0","11":"residx7","12":".p61."},{"1":"62","2":"x8","3":"~~","4":"x8","5":"1","6":"2","7":"2","8":"56","9":"NA","10":"0","11":"residx8","12":".p62."},{"1":"63","2":"x9","3":"~~","4":"x9","5":"1","6":"2","7":"2","8":"57","9":"NA","10":"0","11":"residx9","12":".p63."},{"1":"64","2":"x1","3":"~1","4":"","5":"1","6":"2","7":"2","8":"58","9":"NA","10":"0","11":"intx1","12":".p64."},{"1":"65","2":"x2","3":"~1","4":"","5":"1","6":"2","7":"2","8":"59","9":"NA","10":"0","11":"intx2","12":".p65."},{"1":"66","2":"x3","3":"~1","4":"","5":"1","6":"2","7":"2","8":"60","9":"NA","10":"0","11":"intx3","12":".p66."},{"1":"67","2":"x4","3":"~1","4":"","5":"1","6":"2","7":"2","8":"61","9":"NA","10":"0","11":"intx4","12":".p67."},{"1":"68","2":"x5","3":"~1","4":"","5":"1","6":"2","7":"2","8":"62","9":"NA","10":"0","11":"intx5","12":".p68."},{"1":"69","2":"x6","3":"~1","4":"","5":"1","6":"2","7":"2","8":"63","9":"NA","10":"0","11":"intx6","12":".p69."},{"1":"70","2":"x7","3":"~1","4":"","5":"1","6":"2","7":"2","8":"64","9":"NA","10":"0","11":"intx7","12":".p70."},{"1":"71","2":"x8","3":"~1","4":"","5":"1","6":"2","7":"2","8":"65","9":"NA","10":"0","11":"intx8","12":".p71."},{"1":"72","2":"x9","3":"~1","4":"","5":"1","6":"2","7":"2","8":"66","9":"NA","10":"0","11":"intx9","12":".p72."},{"1":"73","2":".p1.","3":"==","4":".p37.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"74","2":".p2.","3":"==","4":".p38.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"75","2":".p3.","3":"==","4":".p39.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"76","2":".p4.","3":"==","4":".p40.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"77","2":".p5.","3":"==","4":".p41.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"78","2":".p6.","3":"==","4":".p42.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"79","2":".p7.","3":"==","4":".p43.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"80","2":".p8.","3":"==","4":".p44.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"81","2":".p9.","3":"==","4":".p45.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"82","2":".p19.","3":"==","4":".p55.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"83","2":".p20.","3":"==","4":".p56.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"84","2":".p21.","3":"==","4":".p57.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"85","2":".p22.","3":"==","4":".p58.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"86","2":".p23.","3":"==","4":".p59.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"87","2":".p24.","3":"==","4":".p60.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"88","2":".p25.","3":"==","4":".p61.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"89","2":".p26.","3":"==","4":".p62.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"90","2":".p27.","3":"==","4":".p63.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"91","2":".p28.","3":"==","4":".p64.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"92","2":".p29.","3":"==","4":".p65.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"93","2":".p30.","3":"==","4":".p66.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"94","2":".p31.","3":"==","4":".p67.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"95","2":".p32.","3":"==","4":".p68.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"96","2":".p33.","3":"==","4":".p69.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"97","2":".p34.","3":"==","4":".p70.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"98","2":".p35.","3":"==","4":".p71.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""},{"1":"99","2":".p36.","3":"==","4":".p72.","5":"2","6":"0","7":"0","8":"0","9":"NA","10":"0","11":"","12":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceResidualModelFit" class="level4" data-number="16.10.8.3"><h4 data-number="16.10.8.3" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelFit">
<span class="header-section-number">16.10.8.3</span> Fit the Model</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb223"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1"></a>residualInvarianceModel_fit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(</span>
<span id="cb223-2"><a href="#cb223-2"></a>  residualInvarianceSyntax,</span>
<span id="cb223-3"><a href="#cb223-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb223-4"><a href="#cb223-4"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb223-5"><a href="#cb223-5"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb223-6"><a href="#cb223-6"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb224"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1"></a>residualInvarianceModelFullSyntax_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb224-2"><a href="#cb224-2"></a>  cfaModel_residualInvariance,</span>
<span id="cb224-3"><a href="#cb224-3"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb224-4"><a href="#cb224-4"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb224-5"><a href="#cb224-5"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb224-6"><a href="#cb224-6"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceResidualModelOutput" class="level4" data-number="16.10.8.4"><h4 data-number="16.10.8.4" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelOutput">
<span class="header-section-number">16.10.8.4</span> Model Summary</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb225"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1"></a><span class="fu">summary</span>(</span>
<span id="cb225-2"><a href="#cb225-2"></a>  residualInvarianceModel_fit,</span>
<span id="cb225-3"><a href="#cb225-3"></a>  <span class="at">fit.measures =</span> <span class="cn">TRUE</span>,</span>
<span id="cb225-4"><a href="#cb225-4"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb225-5"><a href="#cb225-5"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 62 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        66
  Number of equality constraints                    27

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145
  Number of missing patterns per group:               
    Pasteur                                          9
    Grant-White                                      9

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               172.960     172.714
  Degrees of freedom                                69          69
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  1.001
    Yuan-Bentler correction (Mplus variant)                       
  Test statistic for each group:
    Pasteur                                     87.707      87.707
    Grant-White                                 85.007      85.007

Model Test Baseline Model:

  Test statistic                               932.665     909.019
  Degrees of freedom                                72          72
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.026

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.879       0.876
  Tucker-Lewis Index (TLI)                       0.874       0.871
                                                                  
  Robust Comparative Fit Index (CFI)                         0.883
  Robust Tucker-Lewis Index (TLI)                            0.878

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3680.600   -3680.600
  Scaling correction factor                                  0.645
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -3594.120   -3594.120
  Scaling correction factor                                  1.034
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                                7439.201    7439.201
  Bayesian (BIC)                              7583.778    7583.778
  Sample-size adjusted Bayesian (SABIC)       7460.092    7460.092

Root Mean Square Error of Approximation:

  RMSEA                                          0.100       0.100
  90 Percent confidence interval - lower         0.082       0.081
  90 Percent confidence interval - upper         0.119       0.119
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.962       0.961
                                                                  
  Robust RMSEA                                               0.100
  90 Percent confidence interval - lower                     0.081
  90 Percent confidence interval - upper                     0.119
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.955

Standardized Root Mean Square Residual:

  SRMR                                           0.086       0.086

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (l.1_)    0.862    0.126    6.855    0.000    0.862    0.728
    x2      (l.2_)    0.516    0.091    5.678    0.000    0.516    0.436
    x3      (l.3_)    0.745    0.112    6.630    0.000    0.745    0.651
  textual =~                                                            
    x4      (l.4_)    0.928    0.071   13.094    0.000    0.928    0.828
    x5      (l.5_)    1.069    0.076   14.113    0.000    1.069    0.855
    x6      (l.6_)    0.882    0.062   14.125    0.000    0.882    0.830
  speed =~                                                              
    x7      (l.7_)    0.577    0.087    6.658    0.000    0.577    0.544
    x8      (l.8_)    0.669    0.083    8.109    0.000    0.669    0.688
    x9      (l.9_)    0.632    0.085    7.461    0.000    0.632    0.649

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textul  (p.2_)    0.430    0.124    3.472    0.001    0.430    0.430
    speed  (p.3_1)    0.351    0.129    2.710    0.007    0.351    0.351
  textual ~~                                                            
    speed  (p.3_2)    0.302    0.093    3.250    0.001    0.302    0.302

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (nu.1)    5.025    0.095   52.938    0.000    5.025    4.243
   .x2      (nu.2)    6.138    0.086   71.711    0.000    6.138    5.188
   .x3      (nu.3)    2.332    0.099   23.546    0.000    2.332    2.039
   .x4      (nu.4)    2.784    0.086   32.453    0.000    2.784    2.483
   .x5      (nu.5)    4.030    0.102   39.369    0.000    4.030    3.224
   .x6      (nu.6)    1.928    0.075   25.828    0.000    1.928    1.815
   .x7      (nu.7)    4.270    0.076   55.911    0.000    4.270    4.027
   .x8      (nu.8)    5.619    0.075   74.597    0.000    5.619    5.775
   .x9      (nu.9)    5.470    0.073   74.756    0.000    5.470    5.616
    visual  (a.1.)    0.000                               0.000    0.000
    textual (a.2.)    0.000                               0.000    0.000
    speed   (a.3.)    0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (t.1_)    0.660    0.165    4.008    0.000    0.660    0.470
   .x2      (t.2_)    1.133    0.110   10.337    0.000    1.133    0.810
   .x3      (t.3_)    0.754    0.131    5.749    0.000    0.754    0.576
   .x4      (t.4_)    0.396    0.050    7.904    0.000    0.396    0.315
   .x5      (t.5_)    0.420    0.057    7.385    0.000    0.420    0.269
   .x6      (t.6_)    0.350    0.048    7.311    0.000    0.350    0.310
   .x7      (t.7_)    0.792    0.094    8.413    0.000    0.792    0.704
   .x8      (t.8_)    0.499    0.095    5.244    0.000    0.499    0.527
   .x9      (t.9_)    0.549    0.100    5.479    0.000    0.549    0.579
    visual  (p.1_)    1.000                               1.000    1.000
    textual (p.2_)    1.000                               1.000    1.000
    speed   (p.3_)    1.000                               1.000    1.000

R-Square:
                   Estimate
    x1                0.530
    x2                0.190
    x3                0.424
    x4                0.685
    x5                0.731
    x6                0.690
    x7                0.296
    x8                0.473
    x9                0.421


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (l.1_)    0.862    0.126    6.855    0.000    0.796    0.700
    x2      (l.2_)    0.516    0.091    5.678    0.000    0.476    0.408
    x3      (l.3_)    0.745    0.112    6.630    0.000    0.687    0.621
  textual =~                                                            
    x4      (l.4_)    0.928    0.071   13.094    0.000    0.926    0.827
    x5      (l.5_)    1.069    0.076   14.113    0.000    1.068    0.855
    x6      (l.6_)    0.882    0.062   14.125    0.000    0.881    0.830
  speed =~                                                              
    x7      (l.7_)    0.577    0.087    6.658    0.000    0.670    0.601
    x8      (l.8_)    0.669    0.083    8.109    0.000    0.777    0.740
    x9      (l.9_)    0.632    0.085    7.461    0.000    0.733    0.703

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textul  (p.2_)    0.519    0.135    3.852    0.000    0.563    0.563
    speed  (p.3_1)    0.643    0.202    3.183    0.001    0.600    0.600
  textual ~~                                                            
    speed  (p.3_2)    0.426    0.181    2.351    0.019    0.368    0.368

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (nu.1)    5.025    0.095   52.938    0.000    5.025    4.420
   .x2      (nu.2)    6.138    0.086   71.711    0.000    6.138    5.263
   .x3      (nu.3)    2.332    0.099   23.546    0.000    2.332    2.106
   .x4      (nu.4)    2.784    0.086   32.453    0.000    2.784    2.486
   .x5      (nu.5)    4.030    0.102   39.369    0.000    4.030    3.228
   .x6      (nu.6)    1.928    0.075   25.828    0.000    1.928    1.817
   .x7      (nu.7)    4.270    0.076   55.911    0.000    4.270    3.835
   .x8      (nu.8)    5.619    0.075   74.597    0.000    5.619    5.353
   .x9      (nu.9)    5.470    0.073   74.756    0.000    5.470    5.247
    visual  (a.1.)   -0.208    0.181   -1.149    0.251   -0.225   -0.225
    textual (a.2.)    0.611    0.132    4.646    0.000    0.612    0.612
    speed   (a.3.)   -0.283    0.155   -1.824    0.068   -0.244   -0.244

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1      (t.1_)    0.660    0.165    4.008    0.000    0.660    0.510
   .x2      (t.2_)    1.133    0.110   10.337    0.000    1.133    0.833
   .x3      (t.3_)    0.754    0.131    5.749    0.000    0.754    0.615
   .x4      (t.4_)    0.396    0.050    7.904    0.000    0.396    0.316
   .x5      (t.5_)    0.420    0.057    7.385    0.000    0.420    0.269
   .x6      (t.6_)    0.350    0.048    7.311    0.000    0.350    0.311
   .x7      (t.7_)    0.792    0.094    8.413    0.000    0.792    0.638
   .x8      (t.8_)    0.499    0.095    5.244    0.000    0.499    0.453
   .x9      (t.9_)    0.549    0.100    5.479    0.000    0.549    0.505
    visual  (p.1_)    0.852    0.217    3.932    0.000    1.000    1.000
    textual (p.2_)    0.997    0.193    5.160    0.000    1.000    1.000
    speed   (p.3_)    1.346    0.328    4.101    0.000    1.000    1.000

R-Square:
                   Estimate
    x1                0.490
    x2                0.167
    x3                0.385
    x4                0.684
    x5                0.731
    x6                0.689
    x7                0.362
    x8                0.547
    x9                0.495</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb227"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1"></a><span class="fu">summary</span>(</span>
<span id="cb227-2"><a href="#cb227-2"></a>  residualInvarianceModelFullSyntax_fit,</span>
<span id="cb227-3"><a href="#cb227-3"></a>  <span class="at">fit.measures =</span> <span class="cn">TRUE</span>,</span>
<span id="cb227-4"><a href="#cb227-4"></a>  <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb227-5"><a href="#cb227-5"></a>  <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 59 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        66
  Number of equality constraints                    27

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145
  Number of missing patterns per group:               
    Pasteur                                          9
    Grant-White                                      9

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               172.960     172.714
  Degrees of freedom                                69          69
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  1.001
    Yuan-Bentler correction (Mplus variant)                       
  Test statistic for each group:
    Pasteur                                     87.707      87.707
    Grant-White                                 85.007      85.007

Model Test Baseline Model:

  Test statistic                               932.665     909.019
  Degrees of freedom                                72          72
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.026

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.879       0.876
  Tucker-Lewis Index (TLI)                       0.874       0.871
                                                                  
  Robust Comparative Fit Index (CFI)                         0.883
  Robust Tucker-Lewis Index (TLI)                            0.878

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3680.600   -3680.600
  Scaling correction factor                                  0.645
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -3594.120   -3594.120
  Scaling correction factor                                  1.034
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                                7439.201    7439.201
  Bayesian (BIC)                              7583.778    7583.778
  Sample-size adjusted Bayesian (SABIC)       7460.092    7460.092

Root Mean Square Error of Approximation:

  RMSEA                                          0.100       0.100
  90 Percent confidence interval - lower         0.082       0.081
  90 Percent confidence interval - upper         0.119       0.119
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.962       0.961
                                                                  
  Robust RMSEA                                               0.100
  90 Percent confidence interval - lower                     0.081
  90 Percent confidence interval - upper                     0.119
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.955

Standardized Root Mean Square Residual:

  SRMR                                           0.086       0.086

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (lmb1)    0.862    0.126    6.855    0.000    0.862    0.728
    x2      (lmb2)    0.516    0.091    5.678    0.000    0.516    0.436
    x3      (lmb3)    0.745    0.112    6.630    0.000    0.745    0.651
  textual =~                                                            
    x4      (lmb4)    0.928    0.071   13.094    0.000    0.928    0.828
    x5      (lmb5)    1.069    0.076   14.113    0.000    1.069    0.855
    x6      (lmb6)    0.882    0.062   14.125    0.000    0.882    0.830
  speed =~                                                              
    x7      (lmb7)    0.577    0.087    6.658    0.000    0.577    0.544
    x8      (lmb8)    0.669    0.083    8.110    0.000    0.669    0.688
    x9      (lmb9)    0.632    0.085    7.461    0.000    0.632    0.649

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textual           0.430    0.124    3.472    0.001    0.430    0.430
    speed             0.351    0.129    2.710    0.007    0.351    0.351
  textual ~~                                                            
    speed             0.302    0.093    3.250    0.001    0.302    0.302

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            0.000                               0.000    0.000
    textual           0.000                               0.000    0.000
    speed             0.000                               0.000    0.000
   .x1      (int1)    5.025    0.095   52.938    0.000    5.025    4.243
   .x2      (int2)    6.138    0.086   71.710    0.000    6.138    5.188
   .x3      (int3)    2.332    0.099   23.546    0.000    2.332    2.039
   .x4      (int4)    2.784    0.086   32.453    0.000    2.784    2.483
   .x5      (int5)    4.030    0.102   39.369    0.000    4.030    3.224
   .x6      (int6)    1.928    0.075   25.828    0.000    1.928    1.815
   .x7      (int7)    4.270    0.076   55.911    0.000    4.270    4.027
   .x8      (int8)    5.619    0.075   74.598    0.000    5.619    5.775
   .x9      (int9)    5.470    0.073   74.756    0.000    5.470    5.616

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            1.000                               1.000    1.000
    textual           1.000                               1.000    1.000
    speed             1.000                               1.000    1.000
   .x1      (rsd1)    0.660    0.165    4.008    0.000    0.660    0.470
   .x2      (rsd2)    1.133    0.110   10.337    0.000    1.133    0.810
   .x3      (rsd3)    0.754    0.131    5.749    0.000    0.754    0.576
   .x4      (rsd4)    0.396    0.050    7.904    0.000    0.396    0.315
   .x5      (rsd5)    0.420    0.057    7.385    0.000    0.420    0.269
   .x6      (rsd6)    0.350    0.048    7.311    0.000    0.350    0.310
   .x7      (rsd7)    0.792    0.094    8.414    0.000    0.792    0.704
   .x8      (rsd8)    0.499    0.095    5.244    0.000    0.499    0.527
   .x9      (rsd9)    0.549    0.100    5.479    0.000    0.549    0.579

R-Square:
                   Estimate
    x1                0.530
    x2                0.190
    x3                0.424
    x4                0.685
    x5                0.731
    x6                0.690
    x7                0.296
    x8                0.473
    x9                0.421


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1      (lmb1)    0.862    0.126    6.855    0.000    0.796    0.700
    x2      (lmb2)    0.516    0.091    5.678    0.000    0.476    0.408
    x3      (lmb3)    0.745    0.112    6.630    0.000    0.687    0.621
  textual =~                                                            
    x4      (lmb4)    0.928    0.071   13.094    0.000    0.926    0.827
    x5      (lmb5)    1.069    0.076   14.113    0.000    1.068    0.855
    x6      (lmb6)    0.882    0.062   14.125    0.000    0.881    0.830
  speed =~                                                              
    x7      (lmb7)    0.577    0.087    6.658    0.000    0.670    0.601
    x8      (lmb8)    0.669    0.083    8.110    0.000    0.777    0.740
    x9      (lmb9)    0.632    0.085    7.461    0.000    0.733    0.703

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textual           0.519    0.135    3.852    0.000    0.563    0.563
    speed             0.643    0.202    3.183    0.001    0.600    0.600
  textual ~~                                                            
    speed             0.426    0.181    2.351    0.019    0.368    0.368

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual           -0.208    0.181   -1.149    0.251   -0.225   -0.225
    textual           0.611    0.132    4.646    0.000    0.612    0.612
    speed            -0.283    0.155   -1.824    0.068   -0.244   -0.244
   .x1      (int1)    5.025    0.095   52.938    0.000    5.025    4.420
   .x2      (int2)    6.138    0.086   71.710    0.000    6.138    5.263
   .x3      (int3)    2.332    0.099   23.546    0.000    2.332    2.106
   .x4      (int4)    2.784    0.086   32.453    0.000    2.784    2.486
   .x5      (int5)    4.030    0.102   39.369    0.000    4.030    3.228
   .x6      (int6)    1.928    0.075   25.828    0.000    1.928    1.817
   .x7      (int7)    4.270    0.076   55.911    0.000    4.270    3.835
   .x8      (int8)    5.619    0.075   74.598    0.000    5.619    5.353
   .x9      (int9)    5.470    0.073   74.756    0.000    5.470    5.247

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    visual            0.852    0.217    3.932    0.000    1.000    1.000
    textual           0.997    0.193    5.160    0.000    1.000    1.000
    speed             1.346    0.328    4.101    0.000    1.000    1.000
   .x1      (rsd1)    0.660    0.165    4.008    0.000    0.660    0.510
   .x2      (rsd2)    1.133    0.110   10.337    0.000    1.133    0.833
   .x3      (rsd3)    0.754    0.131    5.749    0.000    0.754    0.615
   .x4      (rsd4)    0.396    0.050    7.904    0.000    0.396    0.316
   .x5      (rsd5)    0.420    0.057    7.385    0.000    0.420    0.269
   .x6      (rsd6)    0.350    0.048    7.311    0.000    0.350    0.311
   .x7      (rsd7)    0.792    0.094    8.414    0.000    0.792    0.638
   .x8      (rsd8)    0.499    0.095    5.244    0.000    0.499    0.453
   .x9      (rsd9)    0.549    0.100    5.479    0.000    0.549    0.505

R-Square:
                   Estimate
    x1                0.490
    x2                0.167
    x3                0.385
    x4                0.684
    x5                0.731
    x6                0.689
    x7                0.362
    x8                0.547
    x9                0.495</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceResidualModelFitCriteria" class="level4" data-number="16.10.8.5"><h4 data-number="16.10.8.5" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelFitCriteria">
<span class="header-section-number">16.10.8.5</span> Model Fit</h4>
<p>You can specify the null model as the baseline model using: <code>baseline.model = nullModelFit</code></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb229"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1"></a><span class="fu">fitMeasures</span>(residualInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                         npar                          fmin 
                       39.000                         0.287 
                        chisq                            df 
                      172.960                        69.000 
                       pvalue                  chisq.scaled 
                        0.000                       172.714 
                    df.scaled                 pvalue.scaled 
                       69.000                         0.000 
         chisq.scaling.factor                baseline.chisq 
                        1.001                       932.665 
                  baseline.df               baseline.pvalue 
                       72.000                         0.000 
        baseline.chisq.scaled            baseline.df.scaled 
                      909.019                        72.000 
       baseline.pvalue.scaled baseline.chisq.scaling.factor 
                        0.000                         1.026 
                          cfi                           tli 
                        0.879                         0.874 
                   cfi.scaled                    tli.scaled 
                        0.876                         0.871 
                   cfi.robust                    tli.robust 
                        0.883                         0.878 
                         nnfi                           rfi 
                        0.874                         0.806 
                          nfi                          pnfi 
                        0.815                         0.781 
                          ifi                           rni 
                        0.880                         0.879 
                  nnfi.scaled                    rfi.scaled 
                        0.871                         0.802 
                   nfi.scaled                   pnfi.scaled 
                        0.810                         0.776 
                   ifi.scaled                    rni.scaled 
                        0.877                         0.876 
                  nnfi.robust                    rni.robust 
                        0.878                         0.883 
                         logl             unrestricted.logl 
                    -3680.600                     -3594.120 
                          aic                           bic 
                     7439.201                      7583.778 
                       ntotal                          bic2 
                      301.000                      7460.092 
            scaling.factor.h1             scaling.factor.h0 
                        1.034                         0.645 
                        rmsea                rmsea.ci.lower 
                        0.100                         0.082 
               rmsea.ci.upper                rmsea.ci.level 
                        0.119                         0.900 
                 rmsea.pvalue                rmsea.close.h0 
                        0.000                         0.050 
        rmsea.notclose.pvalue             rmsea.notclose.h0 
                        0.962                         0.080 
                 rmsea.scaled         rmsea.ci.lower.scaled 
                        0.100                         0.081 
        rmsea.ci.upper.scaled           rmsea.pvalue.scaled 
                        0.119                         0.000 
 rmsea.notclose.pvalue.scaled                  rmsea.robust 
                        0.961                         0.100 
        rmsea.ci.lower.robust         rmsea.ci.upper.robust 
                        0.081                         0.119 
          rmsea.pvalue.robust  rmsea.notclose.pvalue.robust 
                        0.000                         0.955 
                          rmr                    rmr_nomean 
                        0.103                         0.102 
                         srmr                  srmr_bentler 
                        0.086                         0.086 
          srmr_bentler_nomean                          crmr 
                        0.083                         0.086 
                  crmr_nomean                    srmr_mplus 
                        0.083                         0.104 
            srmr_mplus_nomean                         cn_05 
                        0.084                       156.566 
                        cn_01                           gfi 
                      173.684                         0.992 
                         agfi                          pgfi 
                        0.988                         0.634 
                          mfi                          ecvi 
                        0.841                         0.834 
attr(,"scaled.test")
[1] "yuan.bentler.mplus"</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb231"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1"></a>residualInvarianceModelFitIndices <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb231-2"><a href="#cb231-2"></a>  residualInvarianceModel_fit)[<span class="fu">c</span>(</span>
<span id="cb231-3"><a href="#cb231-3"></a>    <span class="st">"cfi.robust"</span>, <span class="st">"rmsea.robust"</span>, <span class="st">"srmr"</span>)]</span>
<span id="cb231-4"><a href="#cb231-4"></a></span>
<span id="cb231-5"><a href="#cb231-5"></a>residualInvarianceModel_chisquare <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb231-6"><a href="#cb231-6"></a>  residualInvarianceModel_fit)[<span class="fu">c</span>(<span class="st">"chisq.scaled"</span>)]</span>
<span id="cb231-7"><a href="#cb231-7"></a></span>
<span id="cb231-8"><a href="#cb231-8"></a>residualInvarianceModel_chisquareScaling <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb231-9"><a href="#cb231-9"></a>  residualInvarianceModel_fit)[<span class="fu">c</span>(<span class="st">"chisq.scaling.factor"</span>)]</span>
<span id="cb231-10"><a href="#cb231-10"></a></span>
<span id="cb231-11"><a href="#cb231-11"></a>residualInvarianceModel_df <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(</span>
<span id="cb231-12"><a href="#cb231-12"></a>  residualInvarianceModel_fit)[<span class="fu">c</span>(<span class="st">"df.scaled"</span>)]</span>
<span id="cb231-13"><a href="#cb231-13"></a></span>
<span id="cb231-14"><a href="#cb231-14"></a>residualInvarianceModel_N <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(</span>
<span id="cb231-15"><a href="#cb231-15"></a>  residualInvarianceModel_fit,</span>
<span id="cb231-16"><a href="#cb231-16"></a>  <span class="at">what =</span> <span class="st">"ntotal"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-measurementInvarianceResidualModelCompare" class="level4" data-number="16.10.8.6"><h4 data-number="16.10.8.6" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelCompare">
<span class="header-section-number">16.10.8.6</span> Compare Model Fit</h4>
<section id="sec-measurementInvarianceResidualModelNestedModelComparison" class="level5" data-number="16.10.8.6.1"><h5 data-number="16.10.8.6.1" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelNestedModelComparison">
<span class="header-section-number">16.10.8.6.1</span> Nested Model (<span class="math inline">\(\chi^2\)</span>) Difference Test</h5>
<p>The scalar invariance model and the residual invariance model are considered “nested” models. The residual invariance model is nested within the scalar invariance model because the scalar invariance model includes all of the terms of the residual invariance model along with additional terms. Model fit of nested models can be compared with a chi-square difference test, also known as a likelihood ratio test or deviance test. A significant chi-square difference test would indicate that the simplified model with additional constraints (the residual invariance model) is significantly worse fitting than the more complex model that has fewer constraints (the scalar invariance model).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb232"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1"></a><span class="fu">anova</span>(scalarInvarianceModel_fit, residualInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"60","2":"7441.195","3":"7619.136","4":"156.9546","5":"NA","6":"NA","7":"NA","_rn_":"scalarInvarianceModel_fit"},{"1":"69","2":"7439.201","3":"7583.778","4":"172.9604","5":"14.35586","6":"9","7":"0.1102176","_rn_":"residualInvarianceModel_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>In this instance, you do not need to examine whether residual invariance held because the preceding level of measurement invariance (scalar invariance) did not hold.</p>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>satorraBentlerScaledChiSquareDifferenceTestStatistic()</code> function that performs a Satorra-Bentler scaled chi-square difference test:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb233"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1"></a>residualInvarianceModel_chisquareDiff <span class="ot">&lt;-</span> </span>
<span id="cb233-2"><a href="#cb233-2"></a>  <span class="fu">satorraBentlerScaledChiSquareDifferenceTestStatistic</span>(</span>
<span id="cb233-3"><a href="#cb233-3"></a>    <span class="at">T0 =</span> residualInvarianceModel_chisquare,</span>
<span id="cb233-4"><a href="#cb233-4"></a>    <span class="at">c0 =</span> residualInvarianceModel_chisquareScaling,</span>
<span id="cb233-5"><a href="#cb233-5"></a>    <span class="at">d0 =</span> residualInvarianceModel_df,</span>
<span id="cb233-6"><a href="#cb233-6"></a>    <span class="at">T1 =</span> scalarInvarianceModel_chisquare,</span>
<span id="cb233-7"><a href="#cb233-7"></a>    <span class="at">c1 =</span> scalarInvarianceModel_chisquareScaling,</span>
<span id="cb233-8"><a href="#cb233-8"></a>    <span class="at">d1 =</span> scalarInvarianceModel_df)</span>
<span id="cb233-9"><a href="#cb233-9"></a></span>
<span id="cb233-10"><a href="#cb233-10"></a>residualInvarianceModel_chisquareDiff</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>chisq.scaled 
    14.35586 </code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceResidualModelCompareFitCriteria" class="level5" data-number="16.10.8.6.2"><h5 data-number="16.10.8.6.2" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelCompareFitCriteria">
<span class="header-section-number">16.10.8.6.2</span> Compare Other Fit Criteria</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb235"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1"></a><span class="fu">round</span>(</span>
<span id="cb235-2"><a href="#cb235-2"></a>  residualInvarianceModelFitIndices <span class="sc">-</span> scalarInvarianceModelFitIndices,</span>
<span id="cb235-3"><a href="#cb235-3"></a>  <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  cfi.robust rmsea.robust         srmr 
      -0.007       -0.004        0.006 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb237"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(</span>
<span id="cb237-2"><a href="#cb237-2"></a>  <span class="at">null =</span> <span class="fu">inspect</span>(nullModelFit, <span class="st">"fit.measures"</span>),</span>
<span id="cb237-3"><a href="#cb237-3"></a>  <span class="at">configural =</span> <span class="fu">inspect</span>(configuralInvarianceModel_fit, <span class="st">"fit.measures"</span>), </span>
<span id="cb237-4"><a href="#cb237-4"></a>  <span class="at">weak =</span> <span class="fu">inspect</span>(metricInvarianceModel_fit, <span class="st">"fit.measures"</span>),</span>
<span id="cb237-5"><a href="#cb237-5"></a>  <span class="at">strong =</span> <span class="fu">inspect</span>(scalarInvarianceModel_fit, <span class="st">"fit.measures"</span>),</span>
<span id="cb237-6"><a href="#cb237-6"></a>  <span class="at">strict =</span> <span class="fu">inspect</span>(residualInvarianceModel_fit, <span class="st">"fit.measures"</span>)), <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                   null configural      weak    strong
npar                             18.000     60.000    54.000    48.000
fmin                              1.718      0.182     0.193     0.261
chisq                          1034.341    109.425   116.313   156.955
df                               90.000     48.000    54.000    60.000
pvalue                            0.000      0.000     0.000     0.000
chisq.scaled                   1001.376    114.970   117.955   159.442
df.scaled                        90.000     48.000    54.000    60.000
pvalue.scaled                     0.000      0.000     0.000     0.000
chisq.scaling.factor              1.033      0.952     0.986     0.984
baseline.chisq                  932.665    932.665   932.665   932.665
baseline.df                      72.000     72.000    72.000    72.000
baseline.pvalue                   0.000      0.000     0.000     0.000
baseline.chisq.scaled           909.019    909.019   909.019   909.019
baseline.df.scaled               72.000     72.000    72.000    72.000
baseline.pvalue.scaled            0.000      0.000     0.000     0.000
baseline.chisq.scaling.factor     1.026      1.026     1.026     1.026
cfi                               0.000      0.929     0.928     0.887
tli                               0.122      0.893     0.903     0.865
cfi.scaled                        0.000      0.920     0.924     0.881
tli.scaled                        0.129      0.880     0.898     0.857
cfi.robust                        0.000      0.929     0.928     0.890
tli.robust                        0.125      0.893     0.905     0.868
nnfi                              0.122      0.893     0.903     0.865
rfi                                  NA      0.824     0.834     0.798
nfi                                  NA      0.883     0.875     0.832
pnfi                             -0.136      0.588     0.656     0.693
ifi                              -0.121      0.931     0.929     0.889
rni                              -0.097      0.929     0.928     0.887
nnfi.scaled                       0.129      0.880     0.898     0.857
rfi.scaled                           NA      0.810     0.827     0.790
nfi.scaled                           NA      0.874     0.870     0.825
pnfi.scaled                      -0.127      0.582     0.653     0.687
ifi.scaled                       -0.113      0.922     0.925     0.883
rni.scaled                       -0.089      0.920     0.924     0.881
nnfi.robust                       0.125      0.893     0.905     0.868
rni.robust                       -0.094      0.929     0.928     0.890
logl                          -4111.291  -3648.833 -3652.277 -3672.597
unrestricted.logl             -3594.120  -3594.120 -3594.120 -3594.120
aic                            8258.582   7417.666  7412.554  7441.195
bic                            8325.310   7640.092  7612.738  7619.136
ntotal                          301.000    301.000   301.000   301.000
bic2                           8268.224   7449.806  7441.480  7466.908
scaling.factor.h1                 1.034      1.034     1.034     1.034
scaling.factor.h0                 0.520      1.100     0.928     0.797
rmsea                             0.264      0.092     0.088     0.104
rmsea.ci.lower                    0.250      0.069     0.066     0.084
rmsea.ci.upper                    0.279      0.115     0.109     0.124
rmsea.ci.level                    0.900      0.900     0.900     0.900
rmsea.pvalue                      0.000      0.002     0.004     0.000
rmsea.close.h0                    0.050      0.050     0.050     0.050
rmsea.notclose.pvalue             1.000      0.821     0.730     0.975
rmsea.notclose.h0                 0.080      0.080     0.080     0.080
rmsea.scaled                      0.259      0.096     0.089     0.105
rmsea.ci.lower.scaled             0.245      0.073     0.067     0.085
rmsea.ci.upper.scaled             0.274      0.120     0.111     0.125
rmsea.pvalue.scaled               0.000      0.001     0.003     0.000
rmsea.notclose.pvalue.scaled      1.000      0.883     0.757     0.980
rmsea.robust                      0.267      0.093     0.088     0.104
rmsea.ci.lower.robust             0.252      0.070     0.066     0.083
rmsea.ci.upper.robust             0.282      0.117     0.111     0.124
rmsea.pvalue.robust               0.000      0.002     0.004     0.000
rmsea.notclose.pvalue.robust      1.000      0.833     0.740     0.972
rmr                               0.350      0.081     0.085     0.097
rmr_nomean                        0.372      0.089     0.093     0.095
srmr                              0.284      0.066     0.069     0.080
srmr_bentler                      0.284      0.066     0.069     0.080
srmr_bentler_nomean               0.300      0.072     0.075     0.076
crmr                              0.308      0.072     0.073     0.084
crmr_nomean                       0.332      0.080     0.081     0.081
srmr_mplus                        0.292      0.066     0.072     0.084
srmr_mplus_nomean                 0.300      0.072     0.074     0.075
cn_05                            33.926    180.268   187.721   152.660
cn_01                            37.119    203.682   210.793   170.490
gfi                               0.975      0.995     0.995     0.993
agfi                              0.970      0.989     0.989     0.987
pgfi                              0.812      0.442     0.497     0.552
mfi                               0.208      0.903     0.902     0.851
ecvi                              3.556      0.762     0.745     0.840
                                 strict
npar                             39.000
fmin                              0.287
chisq                           172.960
df                               69.000
pvalue                            0.000
chisq.scaled                    172.714
df.scaled                        69.000
pvalue.scaled                     0.000
chisq.scaling.factor              1.001
baseline.chisq                  932.665
baseline.df                      72.000
baseline.pvalue                   0.000
baseline.chisq.scaled           909.019
baseline.df.scaled               72.000
baseline.pvalue.scaled            0.000
baseline.chisq.scaling.factor     1.026
cfi                               0.879
tli                               0.874
cfi.scaled                        0.876
tli.scaled                        0.871
cfi.robust                        0.883
tli.robust                        0.878
nnfi                              0.874
rfi                               0.806
nfi                               0.815
pnfi                              0.781
ifi                               0.880
rni                               0.879
nnfi.scaled                       0.871
rfi.scaled                        0.802
nfi.scaled                        0.810
pnfi.scaled                       0.776
ifi.scaled                        0.877
rni.scaled                        0.876
nnfi.robust                       0.878
rni.robust                        0.883
logl                          -3680.600
unrestricted.logl             -3594.120
aic                            7439.201
bic                            7583.778
ntotal                          301.000
bic2                           7460.092
scaling.factor.h1                 1.034
scaling.factor.h0                 0.645
rmsea                             0.100
rmsea.ci.lower                    0.082
rmsea.ci.upper                    0.119
rmsea.ci.level                    0.900
rmsea.pvalue                      0.000
rmsea.close.h0                    0.050
rmsea.notclose.pvalue             0.962
rmsea.notclose.h0                 0.080
rmsea.scaled                      0.100
rmsea.ci.lower.scaled             0.081
rmsea.ci.upper.scaled             0.119
rmsea.pvalue.scaled               0.000
rmsea.notclose.pvalue.scaled      0.961
rmsea.robust                      0.100
rmsea.ci.lower.robust             0.081
rmsea.ci.upper.robust             0.119
rmsea.pvalue.robust               0.000
rmsea.notclose.pvalue.robust      0.955
rmr                               0.103
rmr_nomean                        0.102
srmr                              0.086
srmr_bentler                      0.086
srmr_bentler_nomean               0.083
crmr                              0.086
crmr_nomean                       0.083
srmr_mplus                        0.104
srmr_mplus_nomean                 0.084
cn_05                           156.566
cn_01                           173.684
gfi                               0.992
agfi                              0.988
pgfi                              0.634
mfi                               0.841
ecvi                              0.834</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceResidualModelScoreBasedTest" class="level5" data-number="16.10.8.6.3"><h5 data-number="16.10.8.6.3" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelScoreBasedTest">
<span class="header-section-number">16.10.8.6.3</span> Score-Based Test</h5>
<p>Score-based tests of measurement invariance are implemented using the <code>strucchange</code> package and are described by <span class="citation" data-cites="Wang2014a">T. Wang et al. (<a href="references.html#ref-Wang2014a" role="doc-biblioref">2014</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb239"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1"></a><span class="fu">coef</span>(residualInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lambda.1_1 lambda.2_1 lambda.3_1 lambda.4_2 lambda.5_2 lambda.6_2 lambda.7_3 
     0.862      0.516      0.745      0.928      1.069      0.882      0.577 
lambda.8_3 lambda.9_3       nu.1       nu.2       nu.3       nu.4       nu.5 
     0.669      0.632      5.025      6.138      2.332      2.784      4.030 
      nu.6       nu.7       nu.8       nu.9  theta.1_1  theta.2_2  theta.3_3 
     1.928      4.270      5.619      5.470      0.660      1.133      0.754 
 theta.4_4  theta.5_5  theta.6_6  theta.7_7  theta.8_8  theta.9_9 psi.2_1.g1 
     0.396      0.420      0.350      0.792      0.499      0.549      0.430 
psi.3_1.g1 psi.3_2.g1 lambda.1_1 lambda.2_1 lambda.3_1 lambda.4_2 lambda.5_2 
     0.351      0.302      0.862      0.516      0.745      0.928      1.069 
lambda.6_2 lambda.7_3 lambda.8_3 lambda.9_3       nu.1       nu.2       nu.3 
     0.882      0.577      0.669      0.632      5.025      6.138      2.332 
      nu.4       nu.5       nu.6       nu.7       nu.8       nu.9  theta.1_1 
     2.784      4.030      1.928      4.270      5.619      5.470      0.660 
 theta.2_2  theta.3_3  theta.4_4  theta.5_5  theta.6_6  theta.7_7  theta.8_8 
     1.133      0.754      0.396      0.420      0.350      0.792      0.499 
 theta.9_9 alpha.1.g2 alpha.2.g2 alpha.3.g2 psi.1_1.g2 psi.2_2.g2 psi.3_3.g2 
     0.549     -0.208      0.611     -0.283      0.852      0.997      1.346 
psi.2_1.g2 psi.3_1.g2 psi.3_2.g2 
     0.519      0.643      0.426 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb241"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1"></a><span class="fu">coef</span>(residualInvarianceModel_fit)[<span class="dv">19</span><span class="sc">:</span><span class="dv">27</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>theta.1_1 theta.2_2 theta.3_3 theta.4_4 theta.5_5 theta.6_6 theta.7_7 theta.8_8 
0.6598353 1.1333770 0.7536794 0.3957809 0.4196626 0.3504637 0.7916721 0.4987961 
theta.9_9 
0.5490913 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb243"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1"></a>strucchange<span class="sc">::</span><span class="fu">sctest</span>(</span>
<span id="cb243-2"><a href="#cb243-2"></a>  residualInvarianceModel_fit,</span>
<span id="cb243-3"><a href="#cb243-3"></a>  <span class="at">order.by =</span> HolzingerSwineford1939<span class="sc">$</span>school,</span>
<span id="cb243-4"><a href="#cb243-4"></a>  <span class="at">parm =</span> <span class="dv">19</span><span class="sc">:</span><span class="dv">27</span>,</span>
<span id="cb243-5"><a href="#cb243-5"></a>  <span class="at">functional =</span> <span class="st">"LMuo"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    M-fluctuation test

data:  residualInvarianceModel_fit
f(efp) = 10.64, p-value = 0.3012</code></pre>
</div>
</div>
<p>A score-based test and expected parameter change (EPC) estimates <span class="citation" data-cites="Oberski2014 Oberski2015">(<a href="references.html#ref-Oberski2014" role="doc-biblioref">Oberski, 2014</a>; <a href="references.html#ref-Oberski2015" role="doc-biblioref">Oberski et al., 2015</a>)</span> are provided by the <code>lavaan</code> package <span class="citation" data-cites="R-lavaan">(<a href="references.html#ref-R-lavaan" role="doc-biblioref">Rosseel et al., 2022</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb245"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1"></a><span class="fu">lavTestScore</span>(</span>
<span id="cb245-2"><a href="#cb245-2"></a>  residualInvarianceModel_fit,</span>
<span id="cb245-3"><a href="#cb245-3"></a>  <span class="at">epc =</span> <span class="cn">TRUE</span></span>
<span id="cb245-4"><a href="#cb245-4"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$test

total score test:

   test     X2 df p.value
1 score 60.136 27       0

$uni

univariate score tests:

     lhs op   rhs     X2 df p.value
1   .p1. == .p37.  0.011  1   0.915
2   .p2. == .p38.  0.043  1   0.836
3   .p3. == .p39.  0.062  1   0.803
4   .p4. == .p40.  0.089  1   0.766
5   .p5. == .p41.  4.083  1   0.043
6   .p6. == .p42.  5.815  1   0.016
7   .p7. == .p43.  0.026  1   0.872
8   .p8. == .p44.  0.003  1   0.954
9   .p9. == .p45.  0.006  1   0.939
10 .p10. == .p46.  6.331  1   0.012
11 .p11. == .p47.  7.812  1   0.005
12 .p12. == .p48. 20.213  1   0.000
13 .p13. == .p49.  1.231  1   0.267
14 .p14. == .p50.  1.155  1   0.283
15 .p15. == .p51.  0.001  1   0.982
16 .p16. == .p52. 14.986  1   0.000
17 .p17. == .p53.  3.574  1   0.059
18 .p18. == .p54.  1.735  1   0.188
19 .p19. == .p55.  0.055  1   0.815
20 .p20. == .p56.  2.026  1   0.155
21 .p21. == .p57.  1.867  1   0.172
22 .p22. == .p58.  0.754  1   0.385
23 .p23. == .p59.  0.619  1   0.432
24 .p24. == .p60.  3.852  1   0.050
25 .p25. == .p61.  2.273  1   0.132
26 .p26. == .p62.  0.674  1   0.412
27 .p27. == .p63.  1.954  1   0.162

$epc

expected parameter changes (epc) and expected parameter values (epv):

       lhs op     rhs block group free      label plabel    est    epc    epv
1   visual =~      x1     1     1    1 lambda.1_1   .p1.  0.862  0.083  0.945
2   visual =~      x2     1     1    2 lambda.2_1   .p2.  0.516 -0.017  0.499
3   visual =~      x3     1     1    3 lambda.3_1   .p3.  0.745 -0.095  0.650
4  textual =~      x4     1     1    4 lambda.4_2   .p4.  0.928 -0.006  0.922
5  textual =~      x5     1     1    5 lambda.5_2   .p5.  1.069  0.060  1.130
6  textual =~      x6     1     1    6 lambda.6_2   .p6.  0.882 -0.054  0.828
7    speed =~      x7     1     1    7 lambda.7_3   .p7.  0.577 -0.036  0.541
8    speed =~      x8     1     1    8 lambda.8_3   .p8.  0.669  0.006  0.676
9    speed =~      x9     1     1    9 lambda.9_3   .p9.  0.632 -0.028  0.604
10      x1 ~1             1     1   10       nu.1  .p10.  5.025 -0.076  4.949
11      x2 ~1             1     1   11       nu.2  .p11.  6.138 -0.154  5.984
12      x3 ~1             1     1   12       nu.3  .p12.  2.332  0.177  2.509
13      x4 ~1             1     1   13       nu.4  .p13.  2.784  0.030  2.814
14      x5 ~1             1     1   14       nu.5  .p14.  4.030 -0.029  4.002
15      x6 ~1             1     1   15       nu.6  .p15.  1.928  0.001  1.929
16      x7 ~1             1     1   16       nu.7  .p16.  4.270  0.168  4.439
17      x8 ~1             1     1   17       nu.8  .p17.  5.619 -0.055  5.564
18      x9 ~1             1     1   18       nu.9  .p18.  5.470 -0.043  5.427
19      x1 ~~      x1     1     1   19  theta.1_1  .p19.  0.660 -0.145  0.514
20      x2 ~~      x2     1     1   20  theta.2_2  .p20.  1.133  0.145  1.279
21      x3 ~~      x3     1     1   21  theta.3_3  .p21.  0.754  0.194  0.947
22      x4 ~~      x4     1     1   22  theta.4_4  .p22.  0.396  0.046  0.442
23      x5 ~~      x5     1     1   23  theta.5_5  .p23.  0.420  0.009  0.428
24      x6 ~~      x6     1     1   24  theta.6_6  .p24.  0.350 -0.059  0.291
25      x7 ~~      x7     1     1   25  theta.7_7  .p25.  0.792  0.115  0.906
26      x8 ~~      x8     1     1   26  theta.8_8  .p26.  0.499  0.016  0.515
27      x9 ~~      x9     1     1   27  theta.9_9  .p27.  0.549  0.084  0.633
28  visual ~1             1     1    0 alpha.1.g1  .p28.  0.000     NA     NA
29 textual ~1             1     1    0 alpha.2.g1  .p29.  0.000     NA     NA
30   speed ~1             1     1    0 alpha.3.g1  .p30.  0.000     NA     NA
31  visual ~~  visual     1     1    0 psi.1_1.g1  .p31.  1.000     NA     NA
32 textual ~~ textual     1     1    0 psi.2_2.g1  .p32.  1.000     NA     NA
33   speed ~~   speed     1     1    0 psi.3_3.g1  .p33.  1.000     NA     NA
34  visual ~~ textual     1     1   28 psi.2_1.g1  .p34.  0.430 -0.002  0.428
35  visual ~~   speed     1     1   29 psi.3_1.g1  .p35.  0.351  0.007  0.358
36 textual ~~   speed     1     1   30 psi.3_2.g1  .p36.  0.302  0.007  0.309
37  visual =~      x1     2     2   31 lambda.1_1  .p37.  0.862  0.000  0.862
38  visual =~      x2     2     2   32 lambda.2_1  .p38.  0.516  0.063  0.579
39  visual =~      x3     2     2   33 lambda.3_1  .p39.  0.745 -0.024  0.721
40 textual =~      x4     2     2   34 lambda.4_2  .p40.  0.928  0.036  0.963
41 textual =~      x5     2     2   35 lambda.5_2  .p41.  1.069 -0.091  0.978
42 textual =~      x6     2     2   36 lambda.6_2  .p42.  0.882  0.061  0.944
43   speed =~      x7     2     2   37 lambda.7_3  .p43.  0.577 -0.035  0.542
44   speed =~      x8     2     2   38 lambda.8_3  .p44.  0.669  0.020  0.689
45   speed =~      x9     2     2   39 lambda.9_3  .p45.  0.632  0.033  0.665
46      x1 ~1             2     2   40       nu.1  .p46.  5.025  0.075  5.100
47      x2 ~1             2     2   41       nu.2  .p47.  6.138  0.176  6.314
48      x3 ~1             2     2   42       nu.3  .p48.  2.332 -0.197  2.135
49      x4 ~1             2     2   43       nu.4  .p49.  2.784 -0.057  2.726
50      x5 ~1             2     2   44       nu.5  .p50.  4.030  0.085  4.115
51      x6 ~1             2     2   45       nu.6  .p51.  1.928 -0.040  1.888
52      x7 ~1             2     2   46       nu.7  .p52.  4.270 -0.185  4.086
53      x8 ~1             2     2   47       nu.8  .p53.  5.619  0.074  5.694
54      x9 ~1             2     2   48       nu.9  .p54.  5.470  0.065  5.535
55      x1 ~~      x1     2     2   49  theta.1_1  .p55.  0.660  0.021  0.681
56      x2 ~~      x2     2     2   50  theta.2_2  .p56.  1.133 -0.162  0.971
57      x3 ~~      x3     2     2   51  theta.3_3  .p57.  0.754 -0.091  0.663
58      x4 ~~      x4     2     2   52  theta.4_4  .p58.  0.396 -0.064  0.332
59      x5 ~~      x5     2     2   53  theta.5_5  .p59.  0.420  0.009  0.428
60      x6 ~~      x6     2     2   54  theta.6_6  .p60.  0.350  0.062  0.412
61      x7 ~~      x7     2     2   55  theta.7_7  .p61.  0.792 -0.088  0.704
62      x8 ~~      x8     2     2   56  theta.8_8  .p62.  0.499 -0.044  0.455
63      x9 ~~      x9     2     2   57  theta.9_9  .p63.  0.549 -0.095  0.454
64  visual ~1             2     2   58 alpha.1.g2  .p64. -0.208  0.009 -0.200
65 textual ~1             2     2   59 alpha.2.g2  .p65.  0.611  0.002  0.614
66   speed ~1             2     2   60 alpha.3.g2  .p66. -0.283 -0.016 -0.298
67  visual ~~  visual     2     2   61 psi.1_1.g2  .p67.  0.852  0.016  0.868
68 textual ~~ textual     2     2   62 psi.2_2.g2  .p68.  0.997 -0.004  0.993
69   speed ~~   speed     2     2   63 psi.3_3.g2  .p69.  1.346  0.008  1.354
70  visual ~~ textual     2     2   64 psi.2_1.g2  .p70.  0.519 -0.002  0.517
71  visual ~~   speed     2     2   65 psi.3_1.g2  .p71.  0.643 -0.014  0.629
72 textual ~~   speed     2     2   66 psi.3_2.g2  .p72.  0.426 -0.009  0.417
   sepc.lv sepc.all sepc.nox
1    0.083    0.070    0.070
2   -0.017   -0.014   -0.014
3   -0.095   -0.083   -0.083
4   -0.006   -0.005   -0.005
5    0.060    0.048    0.048
6   -0.054   -0.051   -0.051
7   -0.036   -0.034   -0.034
8    0.006    0.006    0.006
9   -0.028   -0.029   -0.029
10  -0.076   -0.065   -0.065
11  -0.154   -0.130   -0.130
12   0.177    0.155    0.155
13   0.030    0.027    0.027
14  -0.029   -0.023   -0.023
15   0.001    0.001    0.001
16   0.168    0.159    0.159
17  -0.055   -0.057   -0.057
18  -0.043   -0.044   -0.044
19  -0.660   -0.470   -0.470
20   1.133    0.810    0.810
21   0.754    0.576    0.576
22   0.396    0.315    0.315
23   0.420    0.269    0.269
24  -0.350   -0.310   -0.310
25   0.792    0.704    0.704
26   0.499    0.527    0.527
27   0.549    0.579    0.579
28      NA       NA       NA
29      NA       NA       NA
30      NA       NA       NA
31      NA       NA       NA
32      NA       NA       NA
33      NA       NA       NA
34  -0.002   -0.002   -0.002
35   0.007    0.007    0.007
36   0.007    0.007    0.007
37   0.000    0.000    0.000
38   0.058    0.050    0.050
39  -0.022   -0.020   -0.020
40   0.036    0.032    0.032
41  -0.091   -0.073   -0.073
42   0.061    0.058    0.058
43  -0.041   -0.037   -0.037
44   0.023    0.022    0.022
45   0.038    0.037    0.037
46   0.075    0.066    0.066
47   0.176    0.151    0.151
48  -0.197   -0.178   -0.178
49  -0.057   -0.051   -0.051
50   0.085    0.068    0.068
51  -0.040   -0.038   -0.038
52  -0.185   -0.166   -0.166
53   0.074    0.071    0.071
54   0.065    0.063    0.063
55   0.660    0.510    0.510
56  -1.133   -0.833   -0.833
57  -0.754   -0.615   -0.615
58  -0.396   -0.316   -0.316
59   0.420    0.269    0.269
60   0.350    0.311    0.311
61  -0.792   -0.638   -0.638
62  -0.499   -0.453   -0.453
63  -0.549   -0.505   -0.505
64   0.009    0.009    0.009
65   0.002    0.002    0.002
66  -0.013   -0.013   -0.013
67   1.000    1.000    1.000
68  -1.000   -1.000   -1.000
69   1.000    1.000    1.000
70  -0.002   -0.002   -0.002
71  -0.013   -0.013   -0.013
72  -0.007   -0.007   -0.007</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceResidualModelEffectSize" class="level5" data-number="16.10.8.6.4"><h5 data-number="16.10.8.6.4" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelEffectSize">
<span class="header-section-number">16.10.8.6.4</span> Effect Size of Non-Invariance</h5>
<p>The effect size of measurement non-invariance, as described by <span class="citation" data-cites="Nye2019">Nye et al. (<a href="references.html#ref-Nye2019" role="doc-biblioref">2019</a>)</span>, was calculated using the <code>dmacs</code> package <span class="citation" data-cites="R-dmacs">(<a href="references.html#ref-R-dmacs" role="doc-biblioref">Dueber, 2019</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb247"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1"></a><span class="fu">lavaan_dmacs</span>(residualInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$DMACS
                     visual                  textual                    speed
x1 0.0000000000000007757508                       NA                       NA
x2 0.0000000000000007455410                       NA                       NA
x3 0.0000000000000001273068                       NA                       NA
x4                       NA 0.0000000000000004817253                       NA
x5                       NA 0.0000000000000000000000                       NA
x6                       NA 0.0000000000000003340834                       NA
x7                       NA                       NA 0.0000000000000007914977
x8                       NA                       NA 0.0000000000000008160377
x9                       NA                       NA 0.0000000000000008988589

$ItemDeltaMean
                       visual                  textual                    speed
x1  0.00000000000000088292288                       NA                       NA
x2  0.00000000000000086257978                       NA                       NA
x3 -0.00000000000000004452136                       NA                       NA
x4                         NA 0.0000000000000004616772                       NA
x5                         NA 0.0000000000000000000000                       NA
x6                         NA 0.0000000000000002559985                       NA
x7                         NA                       NA 0.0000000000000008276666
x8                         NA                       NA 0.0000000000000007760855
x9                         NA                       NA 0.0000000000000008838053

$MeanDiff
                  visual                  textual                    speed 
0.0000000000000017009813 0.0000000000000007176757 0.0000000000000024875574 </code></pre>
</div>
</div>
<p>The <span class="math inline">\(w\)</span> and <span class="math inline">\(\Delta \text{M}_\text{C}\)</span> indices of the effect size of measurement non-invariance, as described by <span class="citation" data-cites="Newsom2015">Newsom (<a href="references.html#ref-Newsom2015" role="doc-biblioref">2015</a>)</span>, were calculated using the <code>measurementNoninvarianceEffectSize()</code> function of the <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb249"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1"></a>petersenlab<span class="sc">::</span><span class="fu">measurementNoninvarianceEffectSize</span>(</span>
<span id="cb249-2"><a href="#cb249-2"></a>  <span class="at">model_unconstrained =</span> scalarInvarianceModel_fit,</span>
<span id="cb249-3"><a href="#cb249-3"></a>  <span class="at">model_constrained =</span> residualInvarianceModel_fit</span>
<span id="cb249-4"><a href="#cb249-4"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$Mc_unconstrained
[1] 0.8507891

$Mc_constrained
[1] 0.8409128

$Delta_Mc
[1] 0.0098763

$w
[1] 0.07686594</code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceResidualModelEquivalenceTest" class="level5" data-number="16.10.8.6.5"><h5 data-number="16.10.8.6.5" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelEquivalenceTest">
<span class="header-section-number">16.10.8.6.5</span> Equivalence Test</h5>
<p>The <a href="https://github.com/DevPsyLab/petersenlab"><code>petersenlab</code></a> package <span class="citation" data-cites="R-petersenlab">(<a href="references.html#ref-R-petersenlab" role="doc-biblioref">Petersen, 2025</a>)</span> contains the <code>equiv_chi()</code> function from <span class="citation" data-cites="Counsell2020">Counsell et al. (<a href="references.html#ref-Counsell2020" role="doc-biblioref">2020</a>)</span> that performs an equivalence test: <a href="https://osf.io/cqu8v" class="uri">https://osf.io/cqu8v</a>. The chi-square equivalence test is non-significant, suggesting that the model fit is not acceptable. The equivalence test of the chi-square difference test is non-significant, suggesting that the degree of worsening of model fit is not acceptable.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb251"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1"></a><span class="fu">equiv_chi</span>(</span>
<span id="cb251-2"><a href="#cb251-2"></a>  <span class="at">alpha =</span> .<span class="dv">05</span>,</span>
<span id="cb251-3"><a href="#cb251-3"></a>  <span class="at">chi =</span> residualInvarianceModel_chisquare,</span>
<span id="cb251-4"><a href="#cb251-4"></a>  <span class="at">df =</span> residualInvarianceModel_df,</span>
<span id="cb251-5"><a href="#cb251-5"></a>  <span class="at">m =</span> <span class="dv">2</span>,</span>
<span id="cb251-6"><a href="#cb251-6"></a>  <span class="at">N_sample =</span> residualInvarianceModel_N,</span>
<span id="cb251-7"><a href="#cb251-7"></a>  <span class="at">popRMSEA =</span> .<span class="dv">08</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["chi"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Fml"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["popep"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["popdelt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pval"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"172.7138","2":"0.5776383","3":"0.2208","4":"66.0192","5":"0.9629861","_rn_":"chisq.scaled"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Moreover, the equivalence test of the chi-square difference test is non-significant, suggesting that the degree of worsening of model fit is not acceptable. In other words, residual invariance failed.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb252"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1"></a>residualInvarianceModel_dfDiff <span class="ot">&lt;-</span> </span>
<span id="cb252-2"><a href="#cb252-2"></a>  residualInvarianceModel_df <span class="sc">-</span> scalarInvarianceModel_df</span>
<span id="cb252-3"><a href="#cb252-3"></a></span>
<span id="cb252-4"><a href="#cb252-4"></a><span class="fu">equiv_chi</span>(</span>
<span id="cb252-5"><a href="#cb252-5"></a>  <span class="at">alpha =</span> .<span class="dv">05</span>,</span>
<span id="cb252-6"><a href="#cb252-6"></a>  <span class="at">chi =</span> residualInvarianceModel_chisquareDiff,</span>
<span id="cb252-7"><a href="#cb252-7"></a>  <span class="at">df =</span> residualInvarianceModel_dfDiff,</span>
<span id="cb252-8"><a href="#cb252-8"></a>  <span class="at">m =</span> <span class="dv">2</span>,</span>
<span id="cb252-9"><a href="#cb252-9"></a>  <span class="at">N_sample =</span> residualInvarianceModel_N,</span>
<span id="cb252-10"><a href="#cb252-10"></a>  <span class="at">popRMSEA =</span> .<span class="dv">08</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["chi"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Fml"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["popep"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["popdelt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pval"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"14.35586","2":"0.04801292","3":"0.0288","4":"8.6112","5":"0.3636516","_rn_":"chisq.scaled"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceResidualModelPermutationTest" class="level5" data-number="16.10.8.6.6"><h5 data-number="16.10.8.6.6" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelPermutationTest">
<span class="header-section-number">16.10.8.6.6</span> Permutation Test</h5>
<p>Permutation procedures for testing measurement invariance are described in <span class="citation" data-cites="Jorgensen2018">(<a href="references.html#ref-Jorgensen2018" role="doc-biblioref">Jorgensen et al., 2018</a>)</span>. For reproducibility, I set the seed below. Using the same seed will yield the same answer every time. There is nothing special about this particular seed. You can specify the null model as the baseline model using: <code>baseline.model = nullModelFit</code>.</p>
<p><strong>Warning</strong>: this code takes a while to run based on <span class="math inline">\(100\)</span> iterations. You can reduce the number of iterations to be faster.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb253"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb253-2"><a href="#cb253-2"></a>residualInvarianceTest <span class="ot">&lt;-</span> <span class="fu">permuteMeasEq</span>(</span>
<span id="cb253-3"><a href="#cb253-3"></a>  <span class="at">nPermute =</span> numPermutations,</span>
<span id="cb253-4"><a href="#cb253-4"></a>  <span class="at">modelType =</span> <span class="st">"mgcfa"</span>,</span>
<span id="cb253-5"><a href="#cb253-5"></a>  <span class="at">con =</span> residualInvarianceModel_fit,</span>
<span id="cb253-6"><a href="#cb253-6"></a>  <span class="at">uncon =</span> scalarInvarianceModel_fit,</span>
<span id="cb253-7"><a href="#cb253-7"></a>  <span class="at">AFIs =</span> myAFIs,</span>
<span id="cb253-8"><a href="#cb253-8"></a>  <span class="at">moreAFIs =</span> moreAFIs,</span>
<span id="cb253-9"><a href="#cb253-9"></a>  <span class="at">parallelType =</span> <span class="st">"multicore"</span>, <span class="co">#only 'snow' works on Windows, but right now, it is throwing an error</span></span>
<span id="cb253-10"><a href="#cb253-10"></a>  <span class="at">iseed =</span> <span class="dv">52242</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb254"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1"></a><span class="fu">RNGkind</span>(<span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>)</span>
<span id="cb254-2"><a href="#cb254-2"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb254-3"><a href="#cb254-3"></a></span>
<span id="cb254-4"><a href="#cb254-4"></a>residualInvarianceTest</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Omnibus p value based on parametric chi-squared difference test:

Chisq diff    Df diff Pr(&gt;Chisq) 
    14.356      9.000      0.110 


Omnibus p values based on nonparametric permutation method: 

             AFI.Difference p.value
chisq                16.006    0.15
chisq.scaled         13.272    0.24
rmsea                -0.004    0.38
cfi                  -0.008    0.15
tli                   0.009    0.52
srmr                  0.006    0.20
rmsea.robust         -0.004    0.38
cfi.robust           -0.007    0.15
tli.robust            0.010    0.50</code></pre>
</div>
</div>
<p>The <em>p</em>-values are non-significant, indicating that the model did not fit significantly worse than the scalar invariance model.</p>
</section></section><section id="sec-measurementInvarianceResidualModelReliability" class="level4" data-number="16.10.8.7"><h4 data-number="16.10.8.7" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelReliability">
<span class="header-section-number">16.10.8.7</span> Internal Consistency Reliability</h4>
<p><a href="reliability.html#sec-internalConsistency-reliability">Internal consistency reliability</a> of items composing the latent factors, as quantified by <a href="reliability.html#sec-coefficientOmega">omega (<span class="math inline">\(\omega\)</span>)</a>, <a href="reliability.html#sec-averageVarianceExtracted">average variance extracted</a> (AVE), and <a href="reliability.html#sec-maximalReliability">maximal reliability</a>, was estimated using the <code>semTools</code> package <span class="citation" data-cites="R-semTools">(<a href="references.html#ref-R-semTools" role="doc-biblioref">Jorgensen et al., 2021</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb256"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1"></a><span class="fu">compRelSEM</span>(residualInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$visual

Composite `visual` is composed of observed variables:
    x1, x2, x3
True-score variance is represented by common factor(s):
    visual
Total variance of composite `visual` determined from the unrestricted model.
The proportion attributable to "true" scores is its model-based estimate of reliability ("omega"):

    Pasteur Grant-White 
      0.625       0.594 

$textual

Composite `textual` is composed of observed variables:
    x4, x5, x6
True-score variance is represented by common factor(s):
    textual
Total variance of composite `textual` determined from the unrestricted model.
The proportion attributable to "true" scores is its model-based estimate of reliability ("omega"):

    Pasteur Grant-White 
      0.873       0.875 

$speed

Composite `speed` is composed of observed variables:
    x7, x8, x9
True-score variance is represented by common factor(s):
    speed
Total variance of composite `speed` determined from the unrestricted model.
The proportion attributable to "true" scores is its model-based estimate of reliability ("omega"):

    Pasteur Grant-White 
      0.659       0.731 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb258"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1"></a><span class="fu">AVE</span>(residualInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["chr"],"align":["left"]},{"label":["visual"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["textual"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["speed"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Pasteur","2":"0.3696721","3":"0.6992522","4":"0.3770485"},{"1":"Grant-White","2":"0.3671495","3":"0.7090124","4":"0.4947666"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb259"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1"></a><span class="fu">maximalRelia</span>(residualInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$Pasteur
[1] 0.9540663
attr(,"weight")
         x1          x2          x3          x4          x5          x6 
-3.02923420 -0.02992414  1.10117790  3.98092197  1.24017964  6.56032758 
         x7          x8          x9 
-1.34603371  0.22006031  0.30252466 

$`Grant-White`
[1] 0.9593383
attr(,"weight")
         x1          x2          x3          x4          x5          x6 
 1.14078150  0.38817617  0.86831952  2.07082593  4.29182303  0.80705140 
         x7          x8          x9 
-0.06747397  1.56299874 -2.06250231 </code></pre>
</div>
</div>
</section><section id="sec-measurementInvarianceResidualModelPathDiagram" class="level4" data-number="16.10.8.8"><h4 data-number="16.10.8.8" class="anchored" data-anchor-id="sec-measurementInvarianceResidualModelPathDiagram">
<span class="header-section-number">16.10.8.8</span> Path Diagram</h4>
<p>A path diagram of the model generated using the <code>semPlot</code> package <span class="citation" data-cites="R-semPlot">(<a href="references.html#ref-R-semPlot" role="doc-biblioref">Epskamp, 2022</a>)</span> is below.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb261"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1"></a><span class="fu">semPaths</span>(</span>
<span id="cb261-2"><a href="#cb261-2"></a>  residualInvarianceModel_fit,</span>
<span id="cb261-3"><a href="#cb261-3"></a>  <span class="at">what =</span> <span class="st">"est"</span>,</span>
<span id="cb261-4"><a href="#cb261-4"></a>  <span class="at">layout =</span> <span class="st">"tree2"</span>,</span>
<span id="cb261-5"><a href="#cb261-5"></a>  <span class="at">ask =</span> <span class="cn">FALSE</span>,</span>
<span id="cb261-6"><a href="#cb261-6"></a>  <span class="at">edge.label.cex =</span> <span class="fl">1.2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-measurementInvarianceResidualModelPathDiagram-1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Residual Invariance Model in Confirmatory Factor Analysis.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-measurementInvarianceResidualModelPathDiagram-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-measurementInvarianceResidualModelPathDiagram-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-61" title="Figure&nbsp;16.64: Residual Invariance Model in Confirmatory Factor Analysis."><img src="test-bias_files/figure-html/fig-measurementInvarianceResidualModelPathDiagram-1.png" class="img-fluid figure-img" alt="Residual Invariance Model in Confirmatory Factor Analysis." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-measurementInvarianceResidualModelPathDiagram-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.64: Residual Invariance Model in Confirmatory Factor Analysis.
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-measurementInvarianceResidualModelPathDiagram-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Residual Invariance Model in Confirmatory Factor Analysis.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-measurementInvarianceResidualModelPathDiagram-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="test-bias_files/figure-html/fig-measurementInvarianceResidualModelPathDiagram-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-62" title="Figure&nbsp;16.65: Residual Invariance Model in Confirmatory Factor Analysis."><img src="test-bias_files/figure-html/fig-measurementInvarianceResidualModelPathDiagram-2.png" class="img-fluid figure-img" alt="Residual Invariance Model in Confirmatory Factor Analysis." width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-measurementInvarianceResidualModelPathDiagram-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.65: Residual Invariance Model in Confirmatory Factor Analysis.
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-addressingMeasurementNonInvariance" class="level3" data-number="16.10.9"><h3 data-number="16.10.9" class="anchored" data-anchor-id="sec-addressingMeasurementNonInvariance">
<span class="header-section-number">16.10.9</span> Addressing Measurement Non-Invariance</h3>
<p>In the example above, we detected measurement non-invariance of intercepts, but not factor loadings. Thus, we would want to identify which item(s) show non-invariant intercepts across groups. When detecting measurement non-invariance in a given parameter (e.g., factor loadings, intercepts, or residuals), one can identify the specific items that show measurement non-invariance in one of two primary ways: (1) starting with a model that allows the given parameter to differ across groups, a researcher can iteratively add constraints to identify the item(s) for which measurement invariance fails, or (2) starting with a model that constrains the given parameter to be the same across groups, a researcher can iteratively remove constraints to identify the item(s) for which measurement invariance becomes established (and by process of elimination, the items for which measurement invariance does not become established).</p>
<section id="sec-measurementInvarianceAddConstraints" class="level4" data-number="16.10.9.1"><h4 data-number="16.10.9.1" class="anchored" data-anchor-id="sec-measurementInvarianceAddConstraints">
<span class="header-section-number">16.10.9.1</span> Iteratively add constraints to identify measurement non-invariance</h4>
<p>In the example above, we detected measurement non-invariance of intercepts. One approach to identify measurement non-invariance is to iteratively add constraints to a model that allows the given parameter (intercepts) to differ across groups. So, we will use the metric invariance model as the baseline model (in which item intercepts are allowed to differ across groups), and iteratively add constraints to identify which item(s) show non-invariant intercepts across groups.</p>
<section id="sec-measurementInvarianceAddConstraintsVariable1" class="level5" data-number="16.10.9.1.1"><h5 data-number="16.10.9.1.1" class="anchored" data-anchor-id="sec-measurementInvarianceAddConstraintsVariable1">
<span class="header-section-number">16.10.9.1.1</span> Variable 1</h5>
<p>Variable 1 does not have non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb262"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1"></a>cfaModel_metricInvarianceV1 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb262-2"><a href="#cb262-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb262-3"><a href="#cb262-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb262-4"><a href="#cb262-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb262-5"><a href="#cb262-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb262-6"><a href="#cb262-6"></a><span class="st"> </span></span>
<span id="cb262-7"><a href="#cb262-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb262-8"><a href="#cb262-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb262-9"><a href="#cb262-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb262-10"><a href="#cb262-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb262-11"><a href="#cb262-11"></a><span class="st"> </span></span>
<span id="cb262-12"><a href="#cb262-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb262-13"><a href="#cb262-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb262-14"><a href="#cb262-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb262-15"><a href="#cb262-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb262-16"><a href="#cb262-16"></a><span class="st"> </span></span>
<span id="cb262-17"><a href="#cb262-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb262-18"><a href="#cb262-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb262-19"><a href="#cb262-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb262-20"><a href="#cb262-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb262-21"><a href="#cb262-21"></a><span class="st"> </span></span>
<span id="cb262-22"><a href="#cb262-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb262-23"><a href="#cb262-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb262-24"><a href="#cb262-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb262-25"><a href="#cb262-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb262-26"><a href="#cb262-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb262-27"><a href="#cb262-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb262-28"><a href="#cb262-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb262-29"><a href="#cb262-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb262-30"><a href="#cb262-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb262-31"><a href="#cb262-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb262-32"><a href="#cb262-32"></a><span class="st"> </span></span>
<span id="cb262-33"><a href="#cb262-33"></a><span class="st"> #Iteratively fix intercepts of manifest variables across groups</span></span>
<span id="cb262-34"><a href="#cb262-34"></a><span class="st"> x1 ~ c(intx1, intx1)*1</span></span>
<span id="cb262-35"><a href="#cb262-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb262-36"><a href="#cb262-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb262-37"><a href="#cb262-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb262-38"><a href="#cb262-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb262-39"><a href="#cb262-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb262-40"><a href="#cb262-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb262-41"><a href="#cb262-41"></a><span class="st"> x8 ~ NA*1</span></span>
<span id="cb262-42"><a href="#cb262-42"></a><span class="st"> x9 ~ NA*1</span></span>
<span id="cb262-43"><a href="#cb262-43"></a><span class="st">'</span></span>
<span id="cb262-44"><a href="#cb262-44"></a></span>
<span id="cb262-45"><a href="#cb262-45"></a>cfaModel_metricInvarianceV1_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb262-46"><a href="#cb262-46"></a>  cfaModel_metricInvarianceV1,</span>
<span id="cb262-47"><a href="#cb262-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb262-48"><a href="#cb262-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb262-49"><a href="#cb262-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb262-50"><a href="#cb262-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb262-51"><a href="#cb262-51"></a></span>
<span id="cb262-52"><a href="#cb262-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_metricInvarianceV1_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"55","2":"7410.573","3":"7607.050","4":"116.3323","5":"0.01905591","6":"1","7":"0.8902063","_rn_":"cfaModel_metricInvarianceV1_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceAddConstraintsVariable2" class="level5" data-number="16.10.9.1.2"><h5 data-number="16.10.9.1.2" class="anchored" data-anchor-id="sec-measurementInvarianceAddConstraintsVariable2">
<span class="header-section-number">16.10.9.1.2</span> Variable 2</h5>
<p>Variable 2 has non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb263"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1"></a>cfaModel_metricInvarianceV2 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb263-2"><a href="#cb263-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb263-3"><a href="#cb263-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb263-4"><a href="#cb263-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb263-5"><a href="#cb263-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb263-6"><a href="#cb263-6"></a><span class="st"> </span></span>
<span id="cb263-7"><a href="#cb263-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb263-8"><a href="#cb263-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb263-9"><a href="#cb263-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb263-10"><a href="#cb263-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb263-11"><a href="#cb263-11"></a><span class="st"> </span></span>
<span id="cb263-12"><a href="#cb263-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb263-13"><a href="#cb263-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb263-14"><a href="#cb263-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb263-15"><a href="#cb263-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb263-16"><a href="#cb263-16"></a><span class="st"> </span></span>
<span id="cb263-17"><a href="#cb263-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb263-18"><a href="#cb263-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb263-19"><a href="#cb263-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb263-20"><a href="#cb263-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb263-21"><a href="#cb263-21"></a><span class="st"> </span></span>
<span id="cb263-22"><a href="#cb263-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb263-23"><a href="#cb263-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb263-24"><a href="#cb263-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb263-25"><a href="#cb263-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb263-26"><a href="#cb263-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb263-27"><a href="#cb263-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb263-28"><a href="#cb263-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb263-29"><a href="#cb263-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb263-30"><a href="#cb263-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb263-31"><a href="#cb263-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb263-32"><a href="#cb263-32"></a><span class="st"> </span></span>
<span id="cb263-33"><a href="#cb263-33"></a><span class="st"> #Iteratively fix intercepts of manifest variables across groups</span></span>
<span id="cb263-34"><a href="#cb263-34"></a><span class="st"> x1 ~ c(intx1, intx1)*1</span></span>
<span id="cb263-35"><a href="#cb263-35"></a><span class="st"> x2 ~ c(intx1, intx1)*1</span></span>
<span id="cb263-36"><a href="#cb263-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb263-37"><a href="#cb263-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb263-38"><a href="#cb263-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb263-39"><a href="#cb263-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb263-40"><a href="#cb263-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb263-41"><a href="#cb263-41"></a><span class="st"> x8 ~ NA*1</span></span>
<span id="cb263-42"><a href="#cb263-42"></a><span class="st"> x9 ~ NA*1</span></span>
<span id="cb263-43"><a href="#cb263-43"></a><span class="st">'</span></span>
<span id="cb263-44"><a href="#cb263-44"></a></span>
<span id="cb263-45"><a href="#cb263-45"></a>cfaModel_metricInvarianceV2_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb263-46"><a href="#cb263-46"></a>  cfaModel_metricInvarianceV2,</span>
<span id="cb263-47"><a href="#cb263-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb263-48"><a href="#cb263-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb263-49"><a href="#cb263-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb263-50"><a href="#cb263-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb263-51"><a href="#cb263-51"></a></span>
<span id="cb263-52"><a href="#cb263-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_metricInvarianceV2_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"57","2":"7578.349","3":"7767.412","4":"288.1087","5":"165.0147","6":"3","7":"0.00000000000000000000000000000000001516417","_rn_":"cfaModel_metricInvarianceV2_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Variable 2 appears to have larger intercepts in group 2 than in group 1:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb264"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1"></a><span class="fu">summary</span>(metricInvarianceModel_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 73 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        63
  Number of equality constraints                     9

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145
  Number of missing patterns per group:               
    Pasteur                                          9
    Grant-White                                      9

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               116.313     117.955
  Degrees of freedom                                54          54
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.986
    Yuan-Bentler correction (Mplus variant)                       
  Test statistic for each group:
    Pasteur                                     64.366      64.366
    Grant-White                                 53.590      53.590

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1      (l.1_)    0.885    0.122    7.258    0.000
    x2      (l.2_)    0.536    0.088    6.106    0.000
    x3      (l.3_)    0.707    0.087    8.148    0.000
  textual =~                                          
    x4      (l.4_)    0.935    0.072   12.929    0.000
    x5      (l.5_)    1.045    0.076   13.740    0.000
    x6      (l.6_)    0.874    0.070   12.496    0.000
  speed =~                                            
    x7      (l.7_)    0.550    0.075    7.346    0.000
    x8      (l.8_)    0.675    0.087    7.784    0.000
    x9      (l.9_)    0.602    0.088    6.867    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textul  (p.2_)    0.473    0.105    4.484    0.000
    speed  (p.3_1)    0.347    0.125    2.778    0.005
  textual ~~                                          
    speed  (p.3_2)    0.320    0.096    3.342    0.001

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1      (n.1.)    4.948    0.095   52.314    0.000
   .x2      (n.2.)    5.984    0.098   60.949    0.000
   .x3      (n.3.)    2.510    0.093   26.891    0.000
   .x4      (n.4.)    2.814    0.091   30.886    0.000
   .x5      (n.5.)    4.002    0.105   38.265    0.000
   .x6      (n.6.)    1.929    0.079   24.377    0.000
   .x7      (n.7.)    4.439    0.087   51.128    0.000
   .x8      (n.8.)    5.564    0.079   70.170    0.000
   .x9      (n.9.)    5.426    0.080   67.539    0.000
    visual  (a.1.)    0.000                           
    textual (a.2.)    0.000                           
    speed   (a.3.)    0.000                           

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1      (t.1_)    0.577    0.166    3.482    0.000
   .x2      (t.2_)    1.252    0.162    7.718    0.000
   .x3      (t.3_)    0.853    0.127    6.737    0.000
   .x4      (t.4_)    0.447    0.072    6.189    0.000
   .x5      (t.5_)    0.486    0.075    6.445    0.000
   .x6      (t.6_)    0.258    0.057    4.499    0.000
   .x7      (t.7_)    0.860    0.114    7.549    0.000
   .x8      (t.8_)    0.512    0.097    5.296    0.000
   .x9      (t.9_)    0.635    0.118    5.376    0.000
    visual  (p.1_)    1.000                           
    textual (p.2_)    1.000                           
    speed   (p.3_)    1.000                           


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1      (l.1_)    0.885    0.122    7.258    0.000
    x2      (l.2_)    0.536    0.088    6.106    0.000
    x3      (l.3_)    0.707    0.087    8.148    0.000
  textual =~                                          
    x4      (l.4_)    0.935    0.072   12.929    0.000
    x5      (l.5_)    1.045    0.076   13.740    0.000
    x6      (l.6_)    0.874    0.070   12.496    0.000
  speed =~                                            
    x7      (l.7_)    0.550    0.075    7.346    0.000
    x8      (l.8_)    0.675    0.087    7.784    0.000
    x9      (l.9_)    0.602    0.088    6.867    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textul  (p.2_)    0.520    0.134    3.867    0.000
    speed  (p.3_1)    0.638    0.211    3.023    0.002
  textual ~~                                          
    speed  (p.3_2)    0.429    0.193    2.219    0.026

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1      (n.1.)    4.930    0.096   51.453    0.000
   .x2      (n.2.)    6.198    0.092   67.063    0.000
   .x3      (n.3.)    1.992    0.086   23.042    0.000
   .x4      (n.4.)    3.318    0.093   35.501    0.000
   .x5      (n.5.)    4.714    0.097   48.693    0.000
   .x6      (n.6.)    2.467    0.094   26.165    0.000
   .x7      (n.7.)    3.923    0.087   45.299    0.000
   .x8      (n.8.)    5.488    0.087   63.174    0.000
   .x9      (n.9.)    5.338    0.085   62.628    0.000
    visual  (a.1.)    0.000                           
    textual (a.2.)    0.000                           
    speed   (a.3.)    0.000                           

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1      (t.1_)    0.652    0.168    3.877    0.000
   .x2      (t.2_)    0.940    0.145    6.473    0.000
   .x3      (t.3_)    0.606    0.113    5.376    0.000
   .x4      (t.4_)    0.348    0.066    5.257    0.000
   .x5      (t.5_)    0.371    0.074    5.021    0.000
   .x6      (t.6_)    0.439    0.076    5.738    0.000
   .x7      (t.7_)    0.622    0.098    6.338    0.000
   .x8      (t.8_)    0.410    0.148    2.765    0.006
   .x9      (t.9_)    0.505    0.128    3.957    0.000
    visual  (p.1_)    0.910    0.234    3.895    0.000
    textual (p.2_)    1.004    0.191    5.257    0.000
    speed   (p.3_)    1.498    0.357    4.201    0.000</code></pre>
</div>
</div>
<p>Thus, in subsequent models, we would allow variable 2 to have different intercepts across groups.</p>
</section><section id="sec-measurementInvarianceAddConstraintsVariable3" class="level5" data-number="16.10.9.1.3"><h5 data-number="16.10.9.1.3" class="anchored" data-anchor-id="sec-measurementInvarianceAddConstraintsVariable3">
<span class="header-section-number">16.10.9.1.3</span> Variable 3</h5>
<p>Variable 3 has non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb266"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1"></a>cfaModel_metricInvarianceV3 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb266-2"><a href="#cb266-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb266-3"><a href="#cb266-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb266-4"><a href="#cb266-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb266-5"><a href="#cb266-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb266-6"><a href="#cb266-6"></a><span class="st"> </span></span>
<span id="cb266-7"><a href="#cb266-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb266-8"><a href="#cb266-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb266-9"><a href="#cb266-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb266-10"><a href="#cb266-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb266-11"><a href="#cb266-11"></a><span class="st"> </span></span>
<span id="cb266-12"><a href="#cb266-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb266-13"><a href="#cb266-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb266-14"><a href="#cb266-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb266-15"><a href="#cb266-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb266-16"><a href="#cb266-16"></a><span class="st"> </span></span>
<span id="cb266-17"><a href="#cb266-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb266-18"><a href="#cb266-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb266-19"><a href="#cb266-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb266-20"><a href="#cb266-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb266-21"><a href="#cb266-21"></a><span class="st"> </span></span>
<span id="cb266-22"><a href="#cb266-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb266-23"><a href="#cb266-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb266-24"><a href="#cb266-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb266-25"><a href="#cb266-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb266-26"><a href="#cb266-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb266-27"><a href="#cb266-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb266-28"><a href="#cb266-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb266-29"><a href="#cb266-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb266-30"><a href="#cb266-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb266-31"><a href="#cb266-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb266-32"><a href="#cb266-32"></a><span class="st"> </span></span>
<span id="cb266-33"><a href="#cb266-33"></a><span class="st"> #Iteratively fix intercepts of manifest variables across groups</span></span>
<span id="cb266-34"><a href="#cb266-34"></a><span class="st"> x1 ~ c(intx1, intx1)*1</span></span>
<span id="cb266-35"><a href="#cb266-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb266-36"><a href="#cb266-36"></a><span class="st"> x3 ~ c(intx1, intx1)*1</span></span>
<span id="cb266-37"><a href="#cb266-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb266-38"><a href="#cb266-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb266-39"><a href="#cb266-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb266-40"><a href="#cb266-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb266-41"><a href="#cb266-41"></a><span class="st"> x8 ~ NA*1</span></span>
<span id="cb266-42"><a href="#cb266-42"></a><span class="st"> x9 ~ NA*1</span></span>
<span id="cb266-43"><a href="#cb266-43"></a><span class="st">'</span></span>
<span id="cb266-44"><a href="#cb266-44"></a></span>
<span id="cb266-45"><a href="#cb266-45"></a>cfaModel_metricInvarianceV3_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb266-46"><a href="#cb266-46"></a>  cfaModel_metricInvarianceV3,</span>
<span id="cb266-47"><a href="#cb266-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb266-48"><a href="#cb266-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb266-49"><a href="#cb266-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb266-50"><a href="#cb266-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb266-51"><a href="#cb266-51"></a></span>
<span id="cb266-52"><a href="#cb266-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_metricInvarianceV3_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"57","2":"7962.938","3":"8152.000","4":"672.6972","5":"363.5409","6":"3","7":"0.000000000000000000000000000000000000000000000000000000000000000000000000000001743816","_rn_":"cfaModel_metricInvarianceV3_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceAddConstraintsVariable4" class="level5" data-number="16.10.9.1.4"><h5 data-number="16.10.9.1.4" class="anchored" data-anchor-id="sec-measurementInvarianceAddConstraintsVariable4">
<span class="header-section-number">16.10.9.1.4</span> Variable 4</h5>
<p>Variable 4 has non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb267"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1"></a>cfaModel_metricInvarianceV4 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb267-2"><a href="#cb267-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb267-3"><a href="#cb267-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb267-4"><a href="#cb267-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb267-5"><a href="#cb267-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb267-6"><a href="#cb267-6"></a><span class="st"> </span></span>
<span id="cb267-7"><a href="#cb267-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb267-8"><a href="#cb267-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb267-9"><a href="#cb267-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb267-10"><a href="#cb267-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb267-11"><a href="#cb267-11"></a><span class="st"> </span></span>
<span id="cb267-12"><a href="#cb267-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb267-13"><a href="#cb267-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb267-14"><a href="#cb267-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb267-15"><a href="#cb267-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb267-16"><a href="#cb267-16"></a><span class="st"> </span></span>
<span id="cb267-17"><a href="#cb267-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb267-18"><a href="#cb267-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb267-19"><a href="#cb267-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb267-20"><a href="#cb267-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb267-21"><a href="#cb267-21"></a><span class="st"> </span></span>
<span id="cb267-22"><a href="#cb267-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb267-23"><a href="#cb267-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb267-24"><a href="#cb267-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb267-25"><a href="#cb267-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb267-26"><a href="#cb267-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb267-27"><a href="#cb267-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb267-28"><a href="#cb267-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb267-29"><a href="#cb267-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb267-30"><a href="#cb267-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb267-31"><a href="#cb267-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb267-32"><a href="#cb267-32"></a><span class="st"> </span></span>
<span id="cb267-33"><a href="#cb267-33"></a><span class="st"> #Iteratively fix intercepts of manifest variables across groups</span></span>
<span id="cb267-34"><a href="#cb267-34"></a><span class="st"> x1 ~ c(intx1, intx1)*1</span></span>
<span id="cb267-35"><a href="#cb267-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb267-36"><a href="#cb267-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb267-37"><a href="#cb267-37"></a><span class="st"> x4 ~ c(intx1, intx1)*1</span></span>
<span id="cb267-38"><a href="#cb267-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb267-39"><a href="#cb267-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb267-40"><a href="#cb267-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb267-41"><a href="#cb267-41"></a><span class="st"> x8 ~ NA*1</span></span>
<span id="cb267-42"><a href="#cb267-42"></a><span class="st"> x9 ~ NA*1</span></span>
<span id="cb267-43"><a href="#cb267-43"></a><span class="st">'</span></span>
<span id="cb267-44"><a href="#cb267-44"></a></span>
<span id="cb267-45"><a href="#cb267-45"></a>cfaModel_metricInvarianceV4_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb267-46"><a href="#cb267-46"></a>  cfaModel_metricInvarianceV4,</span>
<span id="cb267-47"><a href="#cb267-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb267-48"><a href="#cb267-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb267-49"><a href="#cb267-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb267-50"><a href="#cb267-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb267-51"><a href="#cb267-51"></a></span>
<span id="cb267-52"><a href="#cb267-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_metricInvarianceV4_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"57","2":"7756.338","3":"7945.400","4":"466.0975","5":"261.8289","6":"3","7":"0.00000000000000000000000000000000000000000000000000000001807939","_rn_":"cfaModel_metricInvarianceV4_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceAddConstraintsVariable5" class="level5" data-number="16.10.9.1.5"><h5 data-number="16.10.9.1.5" class="anchored" data-anchor-id="sec-measurementInvarianceAddConstraintsVariable5">
<span class="header-section-number">16.10.9.1.5</span> Variable 5</h5>
<p>Variable 5 has non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb268"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1"></a>cfaModel_metricInvarianceV5 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb268-2"><a href="#cb268-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb268-3"><a href="#cb268-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb268-4"><a href="#cb268-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb268-5"><a href="#cb268-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb268-6"><a href="#cb268-6"></a><span class="st"> </span></span>
<span id="cb268-7"><a href="#cb268-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb268-8"><a href="#cb268-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb268-9"><a href="#cb268-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb268-10"><a href="#cb268-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb268-11"><a href="#cb268-11"></a><span class="st"> </span></span>
<span id="cb268-12"><a href="#cb268-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb268-13"><a href="#cb268-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb268-14"><a href="#cb268-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb268-15"><a href="#cb268-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb268-16"><a href="#cb268-16"></a><span class="st"> </span></span>
<span id="cb268-17"><a href="#cb268-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb268-18"><a href="#cb268-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb268-19"><a href="#cb268-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb268-20"><a href="#cb268-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb268-21"><a href="#cb268-21"></a><span class="st"> </span></span>
<span id="cb268-22"><a href="#cb268-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb268-23"><a href="#cb268-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb268-24"><a href="#cb268-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb268-25"><a href="#cb268-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb268-26"><a href="#cb268-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb268-27"><a href="#cb268-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb268-28"><a href="#cb268-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb268-29"><a href="#cb268-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb268-30"><a href="#cb268-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb268-31"><a href="#cb268-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb268-32"><a href="#cb268-32"></a><span class="st"> </span></span>
<span id="cb268-33"><a href="#cb268-33"></a><span class="st"> #Iteratively fix intercepts of manifest variables across groups</span></span>
<span id="cb268-34"><a href="#cb268-34"></a><span class="st"> x1 ~ c(intx1, intx1)*1</span></span>
<span id="cb268-35"><a href="#cb268-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb268-36"><a href="#cb268-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb268-37"><a href="#cb268-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb268-38"><a href="#cb268-38"></a><span class="st"> x5 ~ c(intx1, intx1)*1</span></span>
<span id="cb268-39"><a href="#cb268-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb268-40"><a href="#cb268-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb268-41"><a href="#cb268-41"></a><span class="st"> x8 ~ NA*1</span></span>
<span id="cb268-42"><a href="#cb268-42"></a><span class="st"> x9 ~ NA*1</span></span>
<span id="cb268-43"><a href="#cb268-43"></a><span class="st">'</span></span>
<span id="cb268-44"><a href="#cb268-44"></a></span>
<span id="cb268-45"><a href="#cb268-45"></a>cfaModel_metricInvarianceV5_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb268-46"><a href="#cb268-46"></a>  cfaModel_metricInvarianceV5,</span>
<span id="cb268-47"><a href="#cb268-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb268-48"><a href="#cb268-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb268-49"><a href="#cb268-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb268-50"><a href="#cb268-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb268-51"><a href="#cb268-51"></a></span>
<span id="cb268-52"><a href="#cb268-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_metricInvarianceV5_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"57","2":"7473.720","3":"7662.783","4":"183.4797","5":"64.17339","6":"3","7":"0.00000000000007536301","_rn_":"cfaModel_metricInvarianceV5_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceAddConstraintsVariable6" class="level5" data-number="16.10.9.1.6"><h5 data-number="16.10.9.1.6" class="anchored" data-anchor-id="sec-measurementInvarianceAddConstraintsVariable6">
<span class="header-section-number">16.10.9.1.6</span> Variable 6</h5>
<p>Variable 6 has non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb269"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1"></a>cfaModel_metricInvarianceV6 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb269-2"><a href="#cb269-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb269-3"><a href="#cb269-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb269-4"><a href="#cb269-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb269-5"><a href="#cb269-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb269-6"><a href="#cb269-6"></a><span class="st"> </span></span>
<span id="cb269-7"><a href="#cb269-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb269-8"><a href="#cb269-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb269-9"><a href="#cb269-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb269-10"><a href="#cb269-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb269-11"><a href="#cb269-11"></a><span class="st"> </span></span>
<span id="cb269-12"><a href="#cb269-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb269-13"><a href="#cb269-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb269-14"><a href="#cb269-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb269-15"><a href="#cb269-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb269-16"><a href="#cb269-16"></a><span class="st"> </span></span>
<span id="cb269-17"><a href="#cb269-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb269-18"><a href="#cb269-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb269-19"><a href="#cb269-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb269-20"><a href="#cb269-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb269-21"><a href="#cb269-21"></a><span class="st"> </span></span>
<span id="cb269-22"><a href="#cb269-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb269-23"><a href="#cb269-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb269-24"><a href="#cb269-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb269-25"><a href="#cb269-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb269-26"><a href="#cb269-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb269-27"><a href="#cb269-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb269-28"><a href="#cb269-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb269-29"><a href="#cb269-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb269-30"><a href="#cb269-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb269-31"><a href="#cb269-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb269-32"><a href="#cb269-32"></a><span class="st"> </span></span>
<span id="cb269-33"><a href="#cb269-33"></a><span class="st"> #Iteratively fix intercepts of manifest variables across groups</span></span>
<span id="cb269-34"><a href="#cb269-34"></a><span class="st"> x1 ~ c(intx1, intx1)*1</span></span>
<span id="cb269-35"><a href="#cb269-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb269-36"><a href="#cb269-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb269-37"><a href="#cb269-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb269-38"><a href="#cb269-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb269-39"><a href="#cb269-39"></a><span class="st"> x6 ~ c(intx1, intx1)*1</span></span>
<span id="cb269-40"><a href="#cb269-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb269-41"><a href="#cb269-41"></a><span class="st"> x8 ~ NA*1</span></span>
<span id="cb269-42"><a href="#cb269-42"></a><span class="st"> x9 ~ NA*1</span></span>
<span id="cb269-43"><a href="#cb269-43"></a><span class="st">'</span></span>
<span id="cb269-44"><a href="#cb269-44"></a></span>
<span id="cb269-45"><a href="#cb269-45"></a>cfaModel_metricInvarianceV6_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb269-46"><a href="#cb269-46"></a>  cfaModel_metricInvarianceV6,</span>
<span id="cb269-47"><a href="#cb269-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb269-48"><a href="#cb269-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb269-49"><a href="#cb269-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb269-50"><a href="#cb269-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb269-51"><a href="#cb269-51"></a></span>
<span id="cb269-52"><a href="#cb269-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_metricInvarianceV6_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"57","2":"7959.810","3":"8148.873","4":"669.5697","5":"337.3869","6":"3","7":"0.0000000000000000000000000000000000000000000000000000000000000000000000008028699","_rn_":"cfaModel_metricInvarianceV6_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceAddConstraintsVariable7" class="level5" data-number="16.10.9.1.7"><h5 data-number="16.10.9.1.7" class="anchored" data-anchor-id="sec-measurementInvarianceAddConstraintsVariable7">
<span class="header-section-number">16.10.9.1.7</span> Variable 7</h5>
<p>Variable 7 has non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb270"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1"></a>cfaModel_metricInvarianceV7 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb270-2"><a href="#cb270-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb270-3"><a href="#cb270-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb270-4"><a href="#cb270-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb270-5"><a href="#cb270-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb270-6"><a href="#cb270-6"></a><span class="st"> </span></span>
<span id="cb270-7"><a href="#cb270-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb270-8"><a href="#cb270-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb270-9"><a href="#cb270-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb270-10"><a href="#cb270-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb270-11"><a href="#cb270-11"></a><span class="st"> </span></span>
<span id="cb270-12"><a href="#cb270-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb270-13"><a href="#cb270-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb270-14"><a href="#cb270-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb270-15"><a href="#cb270-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb270-16"><a href="#cb270-16"></a><span class="st"> </span></span>
<span id="cb270-17"><a href="#cb270-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb270-18"><a href="#cb270-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb270-19"><a href="#cb270-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb270-20"><a href="#cb270-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb270-21"><a href="#cb270-21"></a><span class="st"> </span></span>
<span id="cb270-22"><a href="#cb270-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb270-23"><a href="#cb270-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb270-24"><a href="#cb270-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb270-25"><a href="#cb270-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb270-26"><a href="#cb270-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb270-27"><a href="#cb270-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb270-28"><a href="#cb270-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb270-29"><a href="#cb270-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb270-30"><a href="#cb270-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb270-31"><a href="#cb270-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb270-32"><a href="#cb270-32"></a><span class="st"> </span></span>
<span id="cb270-33"><a href="#cb270-33"></a><span class="st"> #Iteratively fix intercepts of manifest variables across groups</span></span>
<span id="cb270-34"><a href="#cb270-34"></a><span class="st"> x1 ~ c(intx1, intx1)*1</span></span>
<span id="cb270-35"><a href="#cb270-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb270-36"><a href="#cb270-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb270-37"><a href="#cb270-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb270-38"><a href="#cb270-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb270-39"><a href="#cb270-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb270-40"><a href="#cb270-40"></a><span class="st"> x7 ~ c(intx1, intx1)*1</span></span>
<span id="cb270-41"><a href="#cb270-41"></a><span class="st"> x8 ~ NA*1</span></span>
<span id="cb270-42"><a href="#cb270-42"></a><span class="st"> x9 ~ NA*1</span></span>
<span id="cb270-43"><a href="#cb270-43"></a><span class="st">'</span></span>
<span id="cb270-44"><a href="#cb270-44"></a></span>
<span id="cb270-45"><a href="#cb270-45"></a>cfaModel_metricInvarianceV7_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb270-46"><a href="#cb270-46"></a>  cfaModel_metricInvarianceV7,</span>
<span id="cb270-47"><a href="#cb270-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb270-48"><a href="#cb270-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb270-49"><a href="#cb270-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb270-50"><a href="#cb270-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb270-51"><a href="#cb270-51"></a></span>
<span id="cb270-52"><a href="#cb270-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_metricInvarianceV7_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"57","2":"7500.706","3":"7689.769","4":"210.4657","5":"82.5573","6":"3","7":"0.00000000000000000867753","_rn_":"cfaModel_metricInvarianceV7_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceAddConstraintsVariable8" class="level5" data-number="16.10.9.1.8"><h5 data-number="16.10.9.1.8" class="anchored" data-anchor-id="sec-measurementInvarianceAddConstraintsVariable8">
<span class="header-section-number">16.10.9.1.8</span> Variable 8</h5>
<p>Variable 8 has non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb271"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1"></a>cfaModel_metricInvarianceV8 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb271-2"><a href="#cb271-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb271-3"><a href="#cb271-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb271-4"><a href="#cb271-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb271-5"><a href="#cb271-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb271-6"><a href="#cb271-6"></a><span class="st"> </span></span>
<span id="cb271-7"><a href="#cb271-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb271-8"><a href="#cb271-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb271-9"><a href="#cb271-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb271-10"><a href="#cb271-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb271-11"><a href="#cb271-11"></a><span class="st"> </span></span>
<span id="cb271-12"><a href="#cb271-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb271-13"><a href="#cb271-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb271-14"><a href="#cb271-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb271-15"><a href="#cb271-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb271-16"><a href="#cb271-16"></a><span class="st"> </span></span>
<span id="cb271-17"><a href="#cb271-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb271-18"><a href="#cb271-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb271-19"><a href="#cb271-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb271-20"><a href="#cb271-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb271-21"><a href="#cb271-21"></a><span class="st"> </span></span>
<span id="cb271-22"><a href="#cb271-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb271-23"><a href="#cb271-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb271-24"><a href="#cb271-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb271-25"><a href="#cb271-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb271-26"><a href="#cb271-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb271-27"><a href="#cb271-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb271-28"><a href="#cb271-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb271-29"><a href="#cb271-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb271-30"><a href="#cb271-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb271-31"><a href="#cb271-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb271-32"><a href="#cb271-32"></a><span class="st"> </span></span>
<span id="cb271-33"><a href="#cb271-33"></a><span class="st"> #Iteratively fix intercepts of manifest variables across groups</span></span>
<span id="cb271-34"><a href="#cb271-34"></a><span class="st"> x1 ~ c(intx1, intx1)*1</span></span>
<span id="cb271-35"><a href="#cb271-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb271-36"><a href="#cb271-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb271-37"><a href="#cb271-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb271-38"><a href="#cb271-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb271-39"><a href="#cb271-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb271-40"><a href="#cb271-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb271-41"><a href="#cb271-41"></a><span class="st"> x8 ~ c(intx1, intx1)*1</span></span>
<span id="cb271-42"><a href="#cb271-42"></a><span class="st"> x9 ~ NA*1</span></span>
<span id="cb271-43"><a href="#cb271-43"></a><span class="st">'</span></span>
<span id="cb271-44"><a href="#cb271-44"></a></span>
<span id="cb271-45"><a href="#cb271-45"></a>cfaModel_metricInvarianceV8_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb271-46"><a href="#cb271-46"></a>  cfaModel_metricInvarianceV8,</span>
<span id="cb271-47"><a href="#cb271-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb271-48"><a href="#cb271-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb271-49"><a href="#cb271-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb271-50"><a href="#cb271-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb271-51"><a href="#cb271-51"></a></span>
<span id="cb271-52"><a href="#cb271-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_metricInvarianceV8_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"57","2":"7460.012","3":"7649.075","4":"169.7719","5":"64.74584","6":"3","7":"0.00000000000005684922","_rn_":"cfaModel_metricInvarianceV8_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceAddConstraintsVariable9" class="level5" data-number="16.10.9.1.9"><h5 data-number="16.10.9.1.9" class="anchored" data-anchor-id="sec-measurementInvarianceAddConstraintsVariable9">
<span class="header-section-number">16.10.9.1.9</span> Variable 9</h5>
<p>Variable 9 has non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb272"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1"></a>cfaModel_metricInvarianceV9 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb272-2"><a href="#cb272-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb272-3"><a href="#cb272-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb272-4"><a href="#cb272-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb272-5"><a href="#cb272-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb272-6"><a href="#cb272-6"></a><span class="st"> </span></span>
<span id="cb272-7"><a href="#cb272-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb272-8"><a href="#cb272-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb272-9"><a href="#cb272-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb272-10"><a href="#cb272-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb272-11"><a href="#cb272-11"></a><span class="st"> </span></span>
<span id="cb272-12"><a href="#cb272-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb272-13"><a href="#cb272-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb272-14"><a href="#cb272-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb272-15"><a href="#cb272-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb272-16"><a href="#cb272-16"></a><span class="st"> </span></span>
<span id="cb272-17"><a href="#cb272-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb272-18"><a href="#cb272-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb272-19"><a href="#cb272-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb272-20"><a href="#cb272-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb272-21"><a href="#cb272-21"></a><span class="st"> </span></span>
<span id="cb272-22"><a href="#cb272-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb272-23"><a href="#cb272-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb272-24"><a href="#cb272-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb272-25"><a href="#cb272-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb272-26"><a href="#cb272-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb272-27"><a href="#cb272-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb272-28"><a href="#cb272-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb272-29"><a href="#cb272-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb272-30"><a href="#cb272-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb272-31"><a href="#cb272-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb272-32"><a href="#cb272-32"></a><span class="st"> </span></span>
<span id="cb272-33"><a href="#cb272-33"></a><span class="st"> #Iteratively fix intercepts of manifest variables across groups</span></span>
<span id="cb272-34"><a href="#cb272-34"></a><span class="st"> x1 ~ c(intx1, intx1)*1</span></span>
<span id="cb272-35"><a href="#cb272-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb272-36"><a href="#cb272-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb272-37"><a href="#cb272-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb272-38"><a href="#cb272-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb272-39"><a href="#cb272-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb272-40"><a href="#cb272-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb272-41"><a href="#cb272-41"></a><span class="st"> x8 ~ NA*1</span></span>
<span id="cb272-42"><a href="#cb272-42"></a><span class="st"> x9 ~ c(intx1, intx1)*1</span></span>
<span id="cb272-43"><a href="#cb272-43"></a><span class="st">'</span></span>
<span id="cb272-44"><a href="#cb272-44"></a></span>
<span id="cb272-45"><a href="#cb272-45"></a>cfaModel_metricInvarianceV9_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb272-46"><a href="#cb272-46"></a>  cfaModel_metricInvarianceV9,</span>
<span id="cb272-47"><a href="#cb272-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb272-48"><a href="#cb272-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb272-49"><a href="#cb272-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb272-50"><a href="#cb272-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb272-51"><a href="#cb272-51"></a></span>
<span id="cb272-52"><a href="#cb272-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_metricInvarianceV9_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"57","2":"7437.043","3":"7626.106","4":"146.8029","5":"33.95633","6":"3","7":"0.0000002023695","_rn_":"cfaModel_metricInvarianceV9_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceAddConstraintsSummary" class="level5" data-number="16.10.9.1.10"><h5 data-number="16.10.9.1.10" class="anchored" data-anchor-id="sec-measurementInvarianceAddConstraintsSummary">
<span class="header-section-number">16.10.9.1.10</span> Summary</h5>
<p>When iteratively adding constraints, item 1 showed measurement invariance of intercepts, but all other items showed measurement non-invariance of intercepts. This could be due to the selection of starting with item 1 as the first constraint. We could try applying constraints in a different order to see the extent to which the order influences which items are identified as showing measurement non-invariance.</p>
</section></section><section id="sec-measurementInvarianceDropConstraints" class="level4" data-number="16.10.9.2"><h4 data-number="16.10.9.2" class="anchored" data-anchor-id="sec-measurementInvarianceDropConstraints">
<span class="header-section-number">16.10.9.2</span> Iteratively drop constraints to identify measurement non-invariance</h4>
<p>Another approach to identify measurement non-invariance is to iteratively drop constraints to a model that constrains the given parameter (intercepts) to be the same across groups. So, we will use the scalar invariance model as the baseline model (in which item intercepts are constrained to be the same across groups), and we will iteratively drop constraints to identify the items for which measurement invariance becomes established (relative to the metric invariance model which allows item intercepts to differ across groups), and therefore, identifies which item(s) show non-invariant intercepts across groups.</p>
<section id="sec-measurementInvarianceDropConstraintsVariable1" class="level5" data-number="16.10.9.2.1"><h5 data-number="16.10.9.2.1" class="anchored" data-anchor-id="sec-measurementInvarianceDropConstraintsVariable1">
<span class="header-section-number">16.10.9.2.1</span> Variable 1</h5>
<p>Measurement invariance does not yet become established when freeing intercepts of variable 1 across groups. This suggests that, whether or not variable 1 shows non-invariant intercepts, there are other items that show non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb273"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1"></a>cfaModel_scalarInvarianceV1 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb273-2"><a href="#cb273-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb273-3"><a href="#cb273-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb273-4"><a href="#cb273-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb273-5"><a href="#cb273-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb273-6"><a href="#cb273-6"></a><span class="st"> </span></span>
<span id="cb273-7"><a href="#cb273-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb273-8"><a href="#cb273-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb273-9"><a href="#cb273-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb273-10"><a href="#cb273-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb273-11"><a href="#cb273-11"></a><span class="st"> </span></span>
<span id="cb273-12"><a href="#cb273-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb273-13"><a href="#cb273-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb273-14"><a href="#cb273-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb273-15"><a href="#cb273-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb273-16"><a href="#cb273-16"></a><span class="st"> </span></span>
<span id="cb273-17"><a href="#cb273-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb273-18"><a href="#cb273-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb273-19"><a href="#cb273-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb273-20"><a href="#cb273-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb273-21"><a href="#cb273-21"></a><span class="st"> </span></span>
<span id="cb273-22"><a href="#cb273-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb273-23"><a href="#cb273-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb273-24"><a href="#cb273-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb273-25"><a href="#cb273-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb273-26"><a href="#cb273-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb273-27"><a href="#cb273-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb273-28"><a href="#cb273-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb273-29"><a href="#cb273-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb273-30"><a href="#cb273-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb273-31"><a href="#cb273-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb273-32"><a href="#cb273-32"></a><span class="st"> </span></span>
<span id="cb273-33"><a href="#cb273-33"></a><span class="st"> #Iteratively free intercepts across groups</span></span>
<span id="cb273-34"><a href="#cb273-34"></a><span class="st"> x1 ~ NA*1</span></span>
<span id="cb273-35"><a href="#cb273-35"></a><span class="st"> x2 ~ c(intx2, intx2)*1</span></span>
<span id="cb273-36"><a href="#cb273-36"></a><span class="st"> x3 ~ c(intx3, intx3)*1</span></span>
<span id="cb273-37"><a href="#cb273-37"></a><span class="st"> x4 ~ c(intx4, intx4)*1</span></span>
<span id="cb273-38"><a href="#cb273-38"></a><span class="st"> x5 ~ c(intx5, intx5)*1</span></span>
<span id="cb273-39"><a href="#cb273-39"></a><span class="st"> x6 ~ c(intx6, intx6)*1</span></span>
<span id="cb273-40"><a href="#cb273-40"></a><span class="st"> x7 ~ c(intx7, intx7)*1</span></span>
<span id="cb273-41"><a href="#cb273-41"></a><span class="st"> x8 ~ c(intx8, intx8)*1</span></span>
<span id="cb273-42"><a href="#cb273-42"></a><span class="st"> x9 ~ c(intx9, intx9)*1</span></span>
<span id="cb273-43"><a href="#cb273-43"></a><span class="st">'</span></span>
<span id="cb273-44"><a href="#cb273-44"></a></span>
<span id="cb273-45"><a href="#cb273-45"></a>cfaModel_scalarInvarianceV1_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb273-46"><a href="#cb273-46"></a>  cfaModel_scalarInvarianceV1,</span>
<span id="cb273-47"><a href="#cb273-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb273-48"><a href="#cb273-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb273-49"><a href="#cb273-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb273-50"><a href="#cb273-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb273-51"><a href="#cb273-51"></a></span>
<span id="cb273-52"><a href="#cb273-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_scalarInvarianceV1_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"62","2":"7477.804","3":"7648.331","4":"197.5632","5":"82.97954","6":"8","7":"0.00000000000001226467","_rn_":"cfaModel_scalarInvarianceV1_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceDropConstraintsVariable2" class="level5" data-number="16.10.9.2.2"><h5 data-number="16.10.9.2.2" class="anchored" data-anchor-id="sec-measurementInvarianceDropConstraintsVariable2">
<span class="header-section-number">16.10.9.2.2</span> Variable 2</h5>
<p>Measurement invariance does not yet become established when freeing intercepts of variable 2 across groups. This suggests that, whether or not variables 1 and 2 show non-invariant intercepts, there are other items that show non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb274"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1"></a>cfaModel_scalarInvarianceV2 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb274-2"><a href="#cb274-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb274-3"><a href="#cb274-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb274-4"><a href="#cb274-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb274-5"><a href="#cb274-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb274-6"><a href="#cb274-6"></a><span class="st"> </span></span>
<span id="cb274-7"><a href="#cb274-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb274-8"><a href="#cb274-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb274-9"><a href="#cb274-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb274-10"><a href="#cb274-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb274-11"><a href="#cb274-11"></a><span class="st"> </span></span>
<span id="cb274-12"><a href="#cb274-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb274-13"><a href="#cb274-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb274-14"><a href="#cb274-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb274-15"><a href="#cb274-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb274-16"><a href="#cb274-16"></a><span class="st"> </span></span>
<span id="cb274-17"><a href="#cb274-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb274-18"><a href="#cb274-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb274-19"><a href="#cb274-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb274-20"><a href="#cb274-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb274-21"><a href="#cb274-21"></a><span class="st"> </span></span>
<span id="cb274-22"><a href="#cb274-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb274-23"><a href="#cb274-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb274-24"><a href="#cb274-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb274-25"><a href="#cb274-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb274-26"><a href="#cb274-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb274-27"><a href="#cb274-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb274-28"><a href="#cb274-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb274-29"><a href="#cb274-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb274-30"><a href="#cb274-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb274-31"><a href="#cb274-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb274-32"><a href="#cb274-32"></a><span class="st"> </span></span>
<span id="cb274-33"><a href="#cb274-33"></a><span class="st"> #Iteratively free intercepts across groups</span></span>
<span id="cb274-34"><a href="#cb274-34"></a><span class="st"> x1 ~ NA*1</span></span>
<span id="cb274-35"><a href="#cb274-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb274-36"><a href="#cb274-36"></a><span class="st"> x3 ~ c(intx3, intx3)*1</span></span>
<span id="cb274-37"><a href="#cb274-37"></a><span class="st"> x4 ~ c(intx4, intx4)*1</span></span>
<span id="cb274-38"><a href="#cb274-38"></a><span class="st"> x5 ~ c(intx5, intx5)*1</span></span>
<span id="cb274-39"><a href="#cb274-39"></a><span class="st"> x6 ~ c(intx6, intx6)*1</span></span>
<span id="cb274-40"><a href="#cb274-40"></a><span class="st"> x7 ~ c(intx7, intx7)*1</span></span>
<span id="cb274-41"><a href="#cb274-41"></a><span class="st"> x8 ~ c(intx8, intx8)*1</span></span>
<span id="cb274-42"><a href="#cb274-42"></a><span class="st"> x9 ~ c(intx9, intx9)*1</span></span>
<span id="cb274-43"><a href="#cb274-43"></a><span class="st">'</span></span>
<span id="cb274-44"><a href="#cb274-44"></a></span>
<span id="cb274-45"><a href="#cb274-45"></a>cfaModel_scalarInvarianceV2_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb274-46"><a href="#cb274-46"></a>  cfaModel_scalarInvarianceV2,</span>
<span id="cb274-47"><a href="#cb274-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb274-48"><a href="#cb274-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb274-49"><a href="#cb274-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb274-50"><a href="#cb274-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb274-51"><a href="#cb274-51"></a></span>
<span id="cb274-52"><a href="#cb274-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_scalarInvarianceV2_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"61","2":"7475.037","3":"7649.272","4":"192.7970","5":"80.68887","6":"7","7":"0.000000000000009967365","_rn_":"cfaModel_scalarInvarianceV2_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceDropConstraintsVariable3" class="level5" data-number="16.10.9.2.3"><h5 data-number="16.10.9.2.3" class="anchored" data-anchor-id="sec-measurementInvarianceDropConstraintsVariable3">
<span class="header-section-number">16.10.9.2.3</span> Variable 3</h5>
<p>Measurement invariance does not yet become established when freeing intercepts of variable 3 across groups. This suggests that, whether or not variables 1, 2, and 3 show non-invariant intercepts, there are other items that show non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb275"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1"></a>cfaModel_scalarInvarianceV3 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb275-2"><a href="#cb275-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb275-3"><a href="#cb275-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb275-4"><a href="#cb275-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb275-5"><a href="#cb275-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb275-6"><a href="#cb275-6"></a><span class="st"> </span></span>
<span id="cb275-7"><a href="#cb275-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb275-8"><a href="#cb275-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb275-9"><a href="#cb275-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb275-10"><a href="#cb275-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb275-11"><a href="#cb275-11"></a><span class="st"> </span></span>
<span id="cb275-12"><a href="#cb275-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb275-13"><a href="#cb275-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb275-14"><a href="#cb275-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb275-15"><a href="#cb275-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb275-16"><a href="#cb275-16"></a><span class="st"> </span></span>
<span id="cb275-17"><a href="#cb275-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb275-18"><a href="#cb275-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb275-19"><a href="#cb275-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb275-20"><a href="#cb275-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb275-21"><a href="#cb275-21"></a><span class="st"> </span></span>
<span id="cb275-22"><a href="#cb275-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb275-23"><a href="#cb275-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb275-24"><a href="#cb275-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb275-25"><a href="#cb275-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb275-26"><a href="#cb275-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb275-27"><a href="#cb275-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb275-28"><a href="#cb275-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb275-29"><a href="#cb275-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb275-30"><a href="#cb275-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb275-31"><a href="#cb275-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb275-32"><a href="#cb275-32"></a><span class="st"> </span></span>
<span id="cb275-33"><a href="#cb275-33"></a><span class="st"> #Iteratively free intercepts across groups</span></span>
<span id="cb275-34"><a href="#cb275-34"></a><span class="st"> x1 ~ NA*1</span></span>
<span id="cb275-35"><a href="#cb275-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb275-36"><a href="#cb275-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb275-37"><a href="#cb275-37"></a><span class="st"> x4 ~ c(intx4, intx4)*1</span></span>
<span id="cb275-38"><a href="#cb275-38"></a><span class="st"> x5 ~ c(intx5, intx5)*1</span></span>
<span id="cb275-39"><a href="#cb275-39"></a><span class="st"> x6 ~ c(intx6, intx6)*1</span></span>
<span id="cb275-40"><a href="#cb275-40"></a><span class="st"> x7 ~ c(intx7, intx7)*1</span></span>
<span id="cb275-41"><a href="#cb275-41"></a><span class="st"> x8 ~ c(intx8, intx8)*1</span></span>
<span id="cb275-42"><a href="#cb275-42"></a><span class="st"> x9 ~ c(intx9, intx9)*1</span></span>
<span id="cb275-43"><a href="#cb275-43"></a><span class="st">'</span></span>
<span id="cb275-44"><a href="#cb275-44"></a></span>
<span id="cb275-45"><a href="#cb275-45"></a>cfaModel_scalarInvarianceV3_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb275-46"><a href="#cb275-46"></a>  cfaModel_scalarInvarianceV3,</span>
<span id="cb275-47"><a href="#cb275-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb275-48"><a href="#cb275-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb275-49"><a href="#cb275-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb275-50"><a href="#cb275-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb275-51"><a href="#cb275-51"></a></span>
<span id="cb275-52"><a href="#cb275-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_scalarInvarianceV3_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"60","2":"7451.422","3":"7629.364","4":"167.1822","5":"51.92834","6":"6","7":"0.000000001927729","_rn_":"cfaModel_scalarInvarianceV3_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceDropConstraintsVariable4" class="level5" data-number="16.10.9.2.4"><h5 data-number="16.10.9.2.4" class="anchored" data-anchor-id="sec-measurementInvarianceDropConstraintsVariable4">
<span class="header-section-number">16.10.9.2.4</span> Variable 4</h5>
<p>Measurement invariance does not yet become established when freeing intercepts of variable 4 across groups. This suggests that, whether or not variables 1, 2, 3, and 4 show non-invariant intercepts, there are other items that show non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb276"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1"></a>cfaModel_scalarInvarianceV4 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb276-2"><a href="#cb276-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb276-3"><a href="#cb276-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb276-4"><a href="#cb276-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb276-5"><a href="#cb276-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb276-6"><a href="#cb276-6"></a><span class="st"> </span></span>
<span id="cb276-7"><a href="#cb276-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb276-8"><a href="#cb276-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb276-9"><a href="#cb276-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb276-10"><a href="#cb276-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb276-11"><a href="#cb276-11"></a><span class="st"> </span></span>
<span id="cb276-12"><a href="#cb276-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb276-13"><a href="#cb276-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb276-14"><a href="#cb276-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb276-15"><a href="#cb276-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb276-16"><a href="#cb276-16"></a><span class="st"> </span></span>
<span id="cb276-17"><a href="#cb276-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb276-18"><a href="#cb276-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb276-19"><a href="#cb276-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb276-20"><a href="#cb276-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb276-21"><a href="#cb276-21"></a><span class="st"> </span></span>
<span id="cb276-22"><a href="#cb276-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb276-23"><a href="#cb276-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb276-24"><a href="#cb276-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb276-25"><a href="#cb276-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb276-26"><a href="#cb276-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb276-27"><a href="#cb276-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb276-28"><a href="#cb276-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb276-29"><a href="#cb276-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb276-30"><a href="#cb276-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb276-31"><a href="#cb276-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb276-32"><a href="#cb276-32"></a><span class="st"> </span></span>
<span id="cb276-33"><a href="#cb276-33"></a><span class="st"> #Iteratively free intercepts across groups</span></span>
<span id="cb276-34"><a href="#cb276-34"></a><span class="st"> x1 ~ NA*1</span></span>
<span id="cb276-35"><a href="#cb276-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb276-36"><a href="#cb276-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb276-37"><a href="#cb276-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb276-38"><a href="#cb276-38"></a><span class="st"> x5 ~ c(intx5, intx5)*1</span></span>
<span id="cb276-39"><a href="#cb276-39"></a><span class="st"> x6 ~ c(intx6, intx6)*1</span></span>
<span id="cb276-40"><a href="#cb276-40"></a><span class="st"> x7 ~ c(intx7, intx7)*1</span></span>
<span id="cb276-41"><a href="#cb276-41"></a><span class="st"> x8 ~ c(intx8, intx8)*1</span></span>
<span id="cb276-42"><a href="#cb276-42"></a><span class="st"> x9 ~ c(intx9, intx9)*1</span></span>
<span id="cb276-43"><a href="#cb276-43"></a><span class="st">'</span></span>
<span id="cb276-44"><a href="#cb276-44"></a></span>
<span id="cb276-45"><a href="#cb276-45"></a>cfaModel_scalarInvarianceV4_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb276-46"><a href="#cb276-46"></a>  cfaModel_scalarInvarianceV4,</span>
<span id="cb276-47"><a href="#cb276-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb276-48"><a href="#cb276-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb276-49"><a href="#cb276-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb276-50"><a href="#cb276-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb276-51"><a href="#cb276-51"></a></span>
<span id="cb276-52"><a href="#cb276-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_scalarInvarianceV4_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"59","2":"7453.394","3":"7635.042","4":"167.1532","5":"52.06933","6":"5","7":"0.0000000005221006","_rn_":"cfaModel_scalarInvarianceV4_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceDropConstraintsVariable5" class="level5" data-number="16.10.9.2.5"><h5 data-number="16.10.9.2.5" class="anchored" data-anchor-id="sec-measurementInvarianceDropConstraintsVariable5">
<span class="header-section-number">16.10.9.2.5</span> Variable 5</h5>
<p>Measurement invariance does not yet become established when freeing intercepts of variable 5 across groups. This suggests that, whether or not variables 1, 2, 3, 4, and 5 show non-invariant intercepts, there are other items that show non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb277"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1"></a>cfaModel_scalarInvarianceV5 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb277-2"><a href="#cb277-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb277-3"><a href="#cb277-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb277-4"><a href="#cb277-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb277-5"><a href="#cb277-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb277-6"><a href="#cb277-6"></a><span class="st"> </span></span>
<span id="cb277-7"><a href="#cb277-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb277-8"><a href="#cb277-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb277-9"><a href="#cb277-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb277-10"><a href="#cb277-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb277-11"><a href="#cb277-11"></a><span class="st"> </span></span>
<span id="cb277-12"><a href="#cb277-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb277-13"><a href="#cb277-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb277-14"><a href="#cb277-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb277-15"><a href="#cb277-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb277-16"><a href="#cb277-16"></a><span class="st"> </span></span>
<span id="cb277-17"><a href="#cb277-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb277-18"><a href="#cb277-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb277-19"><a href="#cb277-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb277-20"><a href="#cb277-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb277-21"><a href="#cb277-21"></a><span class="st"> </span></span>
<span id="cb277-22"><a href="#cb277-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb277-23"><a href="#cb277-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb277-24"><a href="#cb277-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb277-25"><a href="#cb277-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb277-26"><a href="#cb277-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb277-27"><a href="#cb277-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb277-28"><a href="#cb277-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb277-29"><a href="#cb277-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb277-30"><a href="#cb277-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb277-31"><a href="#cb277-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb277-32"><a href="#cb277-32"></a><span class="st"> </span></span>
<span id="cb277-33"><a href="#cb277-33"></a><span class="st"> #Iteratively free intercepts across groups</span></span>
<span id="cb277-34"><a href="#cb277-34"></a><span class="st"> x1 ~ NA*1</span></span>
<span id="cb277-35"><a href="#cb277-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb277-36"><a href="#cb277-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb277-37"><a href="#cb277-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb277-38"><a href="#cb277-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb277-39"><a href="#cb277-39"></a><span class="st"> x6 ~ c(intx6, intx6)*1</span></span>
<span id="cb277-40"><a href="#cb277-40"></a><span class="st"> x7 ~ c(intx7, intx7)*1</span></span>
<span id="cb277-41"><a href="#cb277-41"></a><span class="st"> x8 ~ c(intx8, intx8)*1</span></span>
<span id="cb277-42"><a href="#cb277-42"></a><span class="st"> x9 ~ c(intx9, intx9)*1</span></span>
<span id="cb277-43"><a href="#cb277-43"></a><span class="st">'</span></span>
<span id="cb277-44"><a href="#cb277-44"></a></span>
<span id="cb277-45"><a href="#cb277-45"></a>cfaModel_scalarInvarianceV5_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb277-46"><a href="#cb277-46"></a>  cfaModel_scalarInvarianceV5,</span>
<span id="cb277-47"><a href="#cb277-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb277-48"><a href="#cb277-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb277-49"><a href="#cb277-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb277-50"><a href="#cb277-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb277-51"><a href="#cb277-51"></a></span>
<span id="cb277-52"><a href="#cb277-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_scalarInvarianceV5_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"58","2":"7447.221","3":"7632.576","4":"158.9803","5":"43.71191","6":"4","7":"0.000000007363407","_rn_":"cfaModel_scalarInvarianceV5_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceDropConstraintsVariable6" class="level5" data-number="16.10.9.2.6"><h5 data-number="16.10.9.2.6" class="anchored" data-anchor-id="sec-measurementInvarianceDropConstraintsVariable6">
<span class="header-section-number">16.10.9.2.6</span> Variable 6</h5>
<p>Measurement invariance does not yet become established when freeing intercepts of variable 6 across groups. This suggests that, whether or not variables 1, 2, 3, 4, 5, and 6 show non-invariant intercepts, there are other items that show non-invariant intercepts.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb278"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1"></a>cfaModel_scalarInvarianceV6 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb278-2"><a href="#cb278-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb278-3"><a href="#cb278-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb278-4"><a href="#cb278-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb278-5"><a href="#cb278-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb278-6"><a href="#cb278-6"></a><span class="st"> </span></span>
<span id="cb278-7"><a href="#cb278-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb278-8"><a href="#cb278-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb278-9"><a href="#cb278-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb278-10"><a href="#cb278-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb278-11"><a href="#cb278-11"></a><span class="st"> </span></span>
<span id="cb278-12"><a href="#cb278-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb278-13"><a href="#cb278-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb278-14"><a href="#cb278-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb278-15"><a href="#cb278-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb278-16"><a href="#cb278-16"></a><span class="st"> </span></span>
<span id="cb278-17"><a href="#cb278-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb278-18"><a href="#cb278-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb278-19"><a href="#cb278-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb278-20"><a href="#cb278-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb278-21"><a href="#cb278-21"></a><span class="st"> </span></span>
<span id="cb278-22"><a href="#cb278-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb278-23"><a href="#cb278-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb278-24"><a href="#cb278-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb278-25"><a href="#cb278-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb278-26"><a href="#cb278-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb278-27"><a href="#cb278-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb278-28"><a href="#cb278-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb278-29"><a href="#cb278-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb278-30"><a href="#cb278-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb278-31"><a href="#cb278-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb278-32"><a href="#cb278-32"></a><span class="st"> </span></span>
<span id="cb278-33"><a href="#cb278-33"></a><span class="st"> #Iteratively free intercepts across groups</span></span>
<span id="cb278-34"><a href="#cb278-34"></a><span class="st"> x1 ~ NA*1</span></span>
<span id="cb278-35"><a href="#cb278-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb278-36"><a href="#cb278-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb278-37"><a href="#cb278-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb278-38"><a href="#cb278-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb278-39"><a href="#cb278-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb278-40"><a href="#cb278-40"></a><span class="st"> x7 ~ c(intx7, intx7)*1</span></span>
<span id="cb278-41"><a href="#cb278-41"></a><span class="st"> x8 ~ c(intx8, intx8)*1</span></span>
<span id="cb278-42"><a href="#cb278-42"></a><span class="st"> x9 ~ c(intx9, intx9)*1</span></span>
<span id="cb278-43"><a href="#cb278-43"></a><span class="st">'</span></span>
<span id="cb278-44"><a href="#cb278-44"></a></span>
<span id="cb278-45"><a href="#cb278-45"></a>cfaModel_scalarInvarianceV6_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb278-46"><a href="#cb278-46"></a>  cfaModel_scalarInvarianceV6,</span>
<span id="cb278-47"><a href="#cb278-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb278-48"><a href="#cb278-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb278-49"><a href="#cb278-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb278-50"><a href="#cb278-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb278-51"><a href="#cb278-51"></a></span>
<span id="cb278-52"><a href="#cb278-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_scalarInvarianceV6_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"57","2":"7425.539","3":"7614.601","4":"135.2983","5":"20.5684","6":"3","7":"0.0001293964","_rn_":"cfaModel_scalarInvarianceV6_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceDropConstraintsVariable7" class="level5" data-number="16.10.9.2.7"><h5 data-number="16.10.9.2.7" class="anchored" data-anchor-id="sec-measurementInvarianceDropConstraintsVariable7">
<span class="header-section-number">16.10.9.2.7</span> Variable 7</h5>
<p>Measurement invariance becomes established when freeing intercepts of variable 7 across groups. This suggests that item 7 shows non-invariant intercepts across groups, and that measurement invariance holds when constraining items 8 and 9 to be invariant across groups. There may also be other items, especially among the preceding items (variables 1–6), that show non-invariant intercepts across groups.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb279"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1"></a>cfaModel_scalarInvarianceV7 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb279-2"><a href="#cb279-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb279-3"><a href="#cb279-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb279-4"><a href="#cb279-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb279-5"><a href="#cb279-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb279-6"><a href="#cb279-6"></a><span class="st"> </span></span>
<span id="cb279-7"><a href="#cb279-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb279-8"><a href="#cb279-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb279-9"><a href="#cb279-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb279-10"><a href="#cb279-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb279-11"><a href="#cb279-11"></a><span class="st"> </span></span>
<span id="cb279-12"><a href="#cb279-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb279-13"><a href="#cb279-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb279-14"><a href="#cb279-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb279-15"><a href="#cb279-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb279-16"><a href="#cb279-16"></a><span class="st"> </span></span>
<span id="cb279-17"><a href="#cb279-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb279-18"><a href="#cb279-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb279-19"><a href="#cb279-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb279-20"><a href="#cb279-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb279-21"><a href="#cb279-21"></a><span class="st"> </span></span>
<span id="cb279-22"><a href="#cb279-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb279-23"><a href="#cb279-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb279-24"><a href="#cb279-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb279-25"><a href="#cb279-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb279-26"><a href="#cb279-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb279-27"><a href="#cb279-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb279-28"><a href="#cb279-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb279-29"><a href="#cb279-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb279-30"><a href="#cb279-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb279-31"><a href="#cb279-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb279-32"><a href="#cb279-32"></a><span class="st"> </span></span>
<span id="cb279-33"><a href="#cb279-33"></a><span class="st"> #Iteratively free intercepts across groups</span></span>
<span id="cb279-34"><a href="#cb279-34"></a><span class="st"> x1 ~ NA*1</span></span>
<span id="cb279-35"><a href="#cb279-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb279-36"><a href="#cb279-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb279-37"><a href="#cb279-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb279-38"><a href="#cb279-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb279-39"><a href="#cb279-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb279-40"><a href="#cb279-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb279-41"><a href="#cb279-41"></a><span class="st"> x8 ~ c(intx8, intx8)*1</span></span>
<span id="cb279-42"><a href="#cb279-42"></a><span class="st"> x9 ~ c(intx9, intx9)*1</span></span>
<span id="cb279-43"><a href="#cb279-43"></a><span class="st">'</span></span>
<span id="cb279-44"><a href="#cb279-44"></a></span>
<span id="cb279-45"><a href="#cb279-45"></a>cfaModel_scalarInvarianceV7_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb279-46"><a href="#cb279-46"></a>  cfaModel_scalarInvarianceV7,</span>
<span id="cb279-47"><a href="#cb279-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb279-48"><a href="#cb279-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb279-49"><a href="#cb279-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb279-50"><a href="#cb279-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb279-51"><a href="#cb279-51"></a></span>
<span id="cb279-52"><a href="#cb279-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_scalarInvarianceV7_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"56","2":"7409.214","3":"7601.984","4":"116.9740","5":"0.6448224","6":"2","7":"0.7244003","_rn_":"cfaModel_scalarInvarianceV7_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceDropConstraintsVariable8" class="level5" data-number="16.10.9.2.8"><h5 data-number="16.10.9.2.8" class="anchored" data-anchor-id="sec-measurementInvarianceDropConstraintsVariable8">
<span class="header-section-number">16.10.9.2.8</span> Variable 8</h5>
<p>Measurement invariance continues to hold when freeing intercepts of variable 8 across groups. This suggests that variable 8 does not show non-invariant intercepts across groups, at least when the other intercepts have been freed.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb280"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1"></a>cfaModel_scalarInvarianceV8 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb280-2"><a href="#cb280-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb280-3"><a href="#cb280-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb280-4"><a href="#cb280-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb280-5"><a href="#cb280-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb280-6"><a href="#cb280-6"></a><span class="st"> </span></span>
<span id="cb280-7"><a href="#cb280-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb280-8"><a href="#cb280-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb280-9"><a href="#cb280-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb280-10"><a href="#cb280-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb280-11"><a href="#cb280-11"></a><span class="st"> </span></span>
<span id="cb280-12"><a href="#cb280-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb280-13"><a href="#cb280-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb280-14"><a href="#cb280-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb280-15"><a href="#cb280-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb280-16"><a href="#cb280-16"></a><span class="st"> </span></span>
<span id="cb280-17"><a href="#cb280-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb280-18"><a href="#cb280-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb280-19"><a href="#cb280-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb280-20"><a href="#cb280-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb280-21"><a href="#cb280-21"></a><span class="st"> </span></span>
<span id="cb280-22"><a href="#cb280-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb280-23"><a href="#cb280-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb280-24"><a href="#cb280-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb280-25"><a href="#cb280-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb280-26"><a href="#cb280-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb280-27"><a href="#cb280-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb280-28"><a href="#cb280-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb280-29"><a href="#cb280-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb280-30"><a href="#cb280-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb280-31"><a href="#cb280-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb280-32"><a href="#cb280-32"></a><span class="st"> </span></span>
<span id="cb280-33"><a href="#cb280-33"></a><span class="st"> #Iteratively free intercepts across groups</span></span>
<span id="cb280-34"><a href="#cb280-34"></a><span class="st"> x1 ~ NA*1</span></span>
<span id="cb280-35"><a href="#cb280-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb280-36"><a href="#cb280-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb280-37"><a href="#cb280-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb280-38"><a href="#cb280-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb280-39"><a href="#cb280-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb280-40"><a href="#cb280-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb280-41"><a href="#cb280-41"></a><span class="st"> x8 ~ NA*1</span></span>
<span id="cb280-42"><a href="#cb280-42"></a><span class="st"> x9 ~ c(intx9, intx9)*1</span></span>
<span id="cb280-43"><a href="#cb280-43"></a><span class="st">'</span></span>
<span id="cb280-44"><a href="#cb280-44"></a></span>
<span id="cb280-45"><a href="#cb280-45"></a>cfaModel_scalarInvarianceV8_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb280-46"><a href="#cb280-46"></a>  cfaModel_scalarInvarianceV8,</span>
<span id="cb280-47"><a href="#cb280-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb280-48"><a href="#cb280-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb280-49"><a href="#cb280-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb280-50"><a href="#cb280-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb280-51"><a href="#cb280-51"></a></span>
<span id="cb280-52"><a href="#cb280-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_scalarInvarianceV8_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"55","2":"7411.119","3":"7607.596","4":"116.8785","5":"0.5640824","6":"1","7":"0.45262","_rn_":"cfaModel_scalarInvarianceV8_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceDropConstraintsVariable9" class="level5" data-number="16.10.9.2.9"><h5 data-number="16.10.9.2.9" class="anchored" data-anchor-id="sec-measurementInvarianceDropConstraintsVariable9">
<span class="header-section-number">16.10.9.2.9</span> Variable 9</h5>
<p>Measurement invariance continues to hold when freeing intercepts of variable 9 across groups (even after constraining intercepts of variable 8 across groups). This suggests that variable 9 does not show non-invariant intercepts across groups, at least when the other intercepts have been freed.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb281"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1"></a>cfaModel_scalarInvarianceV9 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb281-2"><a href="#cb281-2"></a><span class="st"> #Fix factor loadings to be the same across groups</span></span>
<span id="cb281-3"><a href="#cb281-3"></a><span class="st"> visual  =~ c(lambdax1,lambdax1)*x1 + c(lambdax2,lambdax2)*x2 + c(lambdax3,lambdax3)*x3</span></span>
<span id="cb281-4"><a href="#cb281-4"></a><span class="st"> textual =~ c(lambdax4,lambdax4)*x4 + c(lambdax5,lambdax5)*x5 + c(lambdax6,lambdax6)*x6</span></span>
<span id="cb281-5"><a href="#cb281-5"></a><span class="st"> speed   =~ c(lambdax7,lambdax7)*x7 + c(lambdax8,lambdax8)*x8 + c(lambdax9,lambdax9)*x9</span></span>
<span id="cb281-6"><a href="#cb281-6"></a><span class="st"> </span></span>
<span id="cb281-7"><a href="#cb281-7"></a><span class="st"> #Fix latent means to zero</span></span>
<span id="cb281-8"><a href="#cb281-8"></a><span class="st"> visual ~ 0</span></span>
<span id="cb281-9"><a href="#cb281-9"></a><span class="st"> textual ~ 0</span></span>
<span id="cb281-10"><a href="#cb281-10"></a><span class="st"> speed ~ 0</span></span>
<span id="cb281-11"><a href="#cb281-11"></a><span class="st"> </span></span>
<span id="cb281-12"><a href="#cb281-12"></a><span class="st"> #Fix latent variances to one in group 1; free latent variances in group 2</span></span>
<span id="cb281-13"><a href="#cb281-13"></a><span class="st"> visual ~~ c(1, NA)*visual</span></span>
<span id="cb281-14"><a href="#cb281-14"></a><span class="st"> textual ~~ c(1, NA)*textual</span></span>
<span id="cb281-15"><a href="#cb281-15"></a><span class="st"> speed ~~ c(1, NA)*speed</span></span>
<span id="cb281-16"><a href="#cb281-16"></a><span class="st"> </span></span>
<span id="cb281-17"><a href="#cb281-17"></a><span class="st"> #Estimate covariances among latent variables</span></span>
<span id="cb281-18"><a href="#cb281-18"></a><span class="st"> visual ~~ textual</span></span>
<span id="cb281-19"><a href="#cb281-19"></a><span class="st"> visual ~~ speed</span></span>
<span id="cb281-20"><a href="#cb281-20"></a><span class="st"> textual ~~ speed</span></span>
<span id="cb281-21"><a href="#cb281-21"></a><span class="st"> </span></span>
<span id="cb281-22"><a href="#cb281-22"></a><span class="st"> #Estimate residual variances of manifest variables</span></span>
<span id="cb281-23"><a href="#cb281-23"></a><span class="st"> x1 ~~ x1</span></span>
<span id="cb281-24"><a href="#cb281-24"></a><span class="st"> x2 ~~ x2</span></span>
<span id="cb281-25"><a href="#cb281-25"></a><span class="st"> x3 ~~ x3</span></span>
<span id="cb281-26"><a href="#cb281-26"></a><span class="st"> x4 ~~ x4</span></span>
<span id="cb281-27"><a href="#cb281-27"></a><span class="st"> x5 ~~ x5</span></span>
<span id="cb281-28"><a href="#cb281-28"></a><span class="st"> x6 ~~ x6</span></span>
<span id="cb281-29"><a href="#cb281-29"></a><span class="st"> x7 ~~ x7</span></span>
<span id="cb281-30"><a href="#cb281-30"></a><span class="st"> x8 ~~ x8</span></span>
<span id="cb281-31"><a href="#cb281-31"></a><span class="st"> x9 ~~ x9</span></span>
<span id="cb281-32"><a href="#cb281-32"></a><span class="st"> </span></span>
<span id="cb281-33"><a href="#cb281-33"></a><span class="st"> #Iteratively free intercepts across groups</span></span>
<span id="cb281-34"><a href="#cb281-34"></a><span class="st"> x1 ~ NA*1</span></span>
<span id="cb281-35"><a href="#cb281-35"></a><span class="st"> x2 ~ NA*1</span></span>
<span id="cb281-36"><a href="#cb281-36"></a><span class="st"> x3 ~ NA*1</span></span>
<span id="cb281-37"><a href="#cb281-37"></a><span class="st"> x4 ~ NA*1</span></span>
<span id="cb281-38"><a href="#cb281-38"></a><span class="st"> x5 ~ NA*1</span></span>
<span id="cb281-39"><a href="#cb281-39"></a><span class="st"> x6 ~ NA*1</span></span>
<span id="cb281-40"><a href="#cb281-40"></a><span class="st"> x7 ~ NA*1</span></span>
<span id="cb281-41"><a href="#cb281-41"></a><span class="st"> x8 ~ c(intx8, intx8)*1</span></span>
<span id="cb281-42"><a href="#cb281-42"></a><span class="st"> x9 ~ NA*1</span></span>
<span id="cb281-43"><a href="#cb281-43"></a><span class="st">'</span></span>
<span id="cb281-44"><a href="#cb281-44"></a></span>
<span id="cb281-45"><a href="#cb281-45"></a>cfaModel_scalarInvarianceV9_fit <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(</span>
<span id="cb281-46"><a href="#cb281-46"></a>  cfaModel_scalarInvarianceV9,</span>
<span id="cb281-47"><a href="#cb281-47"></a>  <span class="at">data =</span> HolzingerSwineford1939,</span>
<span id="cb281-48"><a href="#cb281-48"></a>  <span class="at">group =</span> <span class="st">"school"</span>,</span>
<span id="cb281-49"><a href="#cb281-49"></a>  <span class="at">missing =</span> <span class="st">"ML"</span>,</span>
<span id="cb281-50"><a href="#cb281-50"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb281-51"><a href="#cb281-51"></a></span>
<span id="cb281-52"><a href="#cb281-52"></a><span class="fu">anova</span>(metricInvarianceModel_fit, cfaModel_scalarInvarianceV9_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chisq diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Df diff"],"name":[6],"type":["int"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"54","2":"7412.554","3":"7612.738","4":"116.3133","5":"NA","6":"NA","7":"NA","_rn_":"metricInvarianceModel_fit"},{"1":"55","2":"7410.964","3":"7607.441","4":"116.7236","5":"0.4023897","6":"1","7":"0.5258577","_rn_":"cfaModel_scalarInvarianceV9_fit"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="sec-measurementInvarianceDropConstraintsSummary" class="level5" data-number="16.10.9.2.10"><h5 data-number="16.10.9.2.10" class="anchored" data-anchor-id="sec-measurementInvarianceDropConstraintsSummary">
<span class="header-section-number">16.10.9.2.10</span> Summary</h5>
<p>When iteratively dropping constraints, measurement invariance became established when freeing the intercepts for items 1–7 across groups. This suggests that items 7, 8, and 9 show measurement invariance of intercepts across groups. This could be due to the selection of starting with item 1 as the first constraint to be freed. We could try freeing constraints in a different order to see the extent to which the order influences which items are identified as showing measurement non-invariance.</p>
</section></section><section id="sec-measurementInvarianceNextSteps" class="level4" data-number="16.10.9.3"><h4 data-number="16.10.9.3" class="anchored" data-anchor-id="sec-measurementInvarianceNextSteps">
<span class="header-section-number">16.10.9.3</span> Next Steps</h4>
<p>After identifying which item(s) show measurement non-invariance, we would evaluate the measurement non-invariance according to theory and effect sizes. We might start with the item with the largest measurement non-invariance. If we deem the measurement non-invariance for this item is non-negligible, we have three primary options: (1) drop the item for both groups, (2) drop the item for one group but keep it for the other group, or (3) freely estimate parameters for the item across groups. We would do this iteratively for the remaining items, by magnitude, that show non-negligible measurement non-invariance. Thus, our model might show partial scalar invariance—some items might have intercepts that are constrained to be the same across groups, whereas other items might have intercepts that are allowed to differ across groups. Then, we would test subsequent measurement invariance models (e.g., residual invariance) while keeping the partially freed constaints from the partial scalar invariance model. Once we establish the best fitting model that makes as many constraints that are theoretically and empirically justified for the purposes of the study, we would use that model in subsequent tests. As a reminder, full or partial metric invariance is helpful for comparing associations across groups, whereas full or partial scalar invariance is helpful for comparing mean levels across groups.</p>
</section></section></section><section id="sec-conclusion-bias" class="level2" data-number="16.11"><h2 data-number="16.11" class="anchored" data-anchor-id="sec-conclusion-bias">
<span class="header-section-number">16.11</span> Conclusion</h2>
<p>Bias is a <a href="reliability.html#sec-systematicError">systematic error</a>. Test bias refers to a <a href="reliability.html#sec-systematicError">systematic error</a> (in measurement, prediction, etc.) as a function of group membership. The two broad categories of test bias include <a href="#sec-predictiveBias">predictive bias</a> and <a href="#sec-testStructureBias">test structure bias</a>. <a href="#sec-predictiveBias">Predictive bias</a> refers to differences between groups in the relation between the test and criterion—i.e., different intercepts and/or slopes of the regression line between the test and the criterion. <a href="#sec-testStructureBias">Test structure bias</a> refers to differences in the internal test characteristics across groups, and can be evaluated with approaches such as <a href="#sec-measurementInvariance">measurement invariance</a> and <a href="#sec-dif">differential item function</a>. When detecting test bias, it is important to address it, and there are a number of ways of <a href="#sec-correctForBias">correcting for bias</a>, including <a href="#sec-scoreAdjustment">score adjustment</a> and <a href="#sec-otherBiasCorrections">other approaches</a> that do not involve score adjustment. However, even if a test does not show bias, it does not mean that the test is <a href="#sec-fairness">fair</a>. <a href="#sec-fairness">Fairness</a> is not a scientific question but rather a moral, societal, and <a href="ethics.html">ethical</a> question; there are many different ways of <a href="#sec-operationalizingFairness">operationalizing fairness</a>. <a href="#sec-fairness">Fairness</a> is a complex question, so do the best you can and try to minimize any negative impact of the assessment procedures.</p>
</section><section id="sec-readings-bias" class="level2" data-number="16.12"><h2 data-number="16.12" class="anchored" data-anchor-id="sec-readings-bias">
<span class="header-section-number">16.12</span> Suggested Readings</h2>
<p><span class="citation" data-cites="Putnick2016">Putnick &amp; Bornstein (<a href="references.html#ref-Putnick2016" role="doc-biblioref">2016</a>)</span>; <span class="citation" data-cites="Cole1981">N. S. Cole (<a href="references.html#ref-Cole1981" role="doc-biblioref">1981</a>)</span>; <span class="citation" data-cites="Fernandez2018">Fernández &amp; Abe (<a href="references.html#ref-Fernandez2018" role="doc-biblioref">2018</a>)</span>; <span class="citation" data-cites="Reynolds2012">Reynolds &amp; Suzuki (<a href="references.html#ref-Reynolds2012" role="doc-biblioref">2012</a>)</span>; <span class="citation" data-cites="Sackett1994">Sackett &amp; Wilk (<a href="references.html#ref-Sackett1994" role="doc-biblioref">1994</a>)</span>; <span class="citation" data-cites="Jonson2022">Jonson &amp; Geisinger (<a href="references.html#ref-Jonson2022" role="doc-biblioref">2022</a>)</span></p>
</section><section id="sec-exercises-bias" class="level2" data-number="16.13"><h2 data-number="16.13" class="anchored" data-anchor-id="sec-exercises-bias">
<span class="header-section-number">16.13</span> Exercises</h2>
<section id="sec-exercisesQuestions-bias" class="level3" data-number="16.13.1"><h3 data-number="16.13.1" class="anchored" data-anchor-id="sec-exercisesQuestions-bias">
<span class="header-section-number">16.13.1</span> Questions</h3>
<p>Note: Several of the following questions use data from the Children of the National Longitudinal Survey of Youth Survey (CNLSY). The CNLSY is a publicly available longitudinal data set provided by the Bureau of Labor Statistics (<a href="https://www.bls.gov/nls/nlsy79-children.htm#topical-guide" class="uri">https://www.bls.gov/nls/nlsy79-children.htm#topical-guide</a>; archived at <a href="https://perma.cc/EH38-HDRN" class="uri">https://perma.cc/EH38-HDRN</a>). The CNLSY data file for these exercises is located on the book’s page of the Open Science Framework (<a href="https://osf.io/3pwza" class="uri">https://osf.io/3pwza</a>). Children’s behavior problems were rated in 1988 (time 1: T1) and then again in 1990 (time 2: T2) on the Behavior Problems Index (BPI). Below are the items corresponding to the Antisocial subscale of the BPI:</p>
<ol type="1">
<li>cheats or tells lies</li>
<li>bullies or is cruel/mean to others</li>
<li>does not seem to feel sorry after misbehaving</li>
<li>breaks things deliberately</li>
<li>is disobedient at school</li>
<li>has trouble getting along with teachers</li>
<li>has sudden changes in mood or feeling</li>
</ol>
<ol type="1">
<li><ol type="a">
<li>Determine whether there is predictive bias, as a function of sex, in predicting antisocial behavior at T2 using antisocial behavior at T2. Describe any predictive bias observed.</li>
<li>How could you address this predictive bias?</li>
</ol></li>
<li>Assume that children are selected to receive preventative services if their score on the Antisocial scale at T1 is &gt; 6. Assume that children at T2 have an antisocial disorder if their score at T2 is &gt; 6. Does the Antisocial scale show fairness in terms of equal outcomes between boys and girls?</li>
<li>A lawyer argues in court that a test that is used to select students for college admissions should be able to be used because it has been demonstrated to show no evidence of bias against particular groups. However, you know that just because a measure may be unbiased does not mean that using the measure’s scores for that purpose is fair. How could such a measure be unbiased yet unfair?</li>
<li>Fit a multi-group <a href="item-response-theory.html">item response theory</a> model to the Antisocial subscale at time 2, with the participant’s sex as a grouping factor.
<ol type="a">
<li>Does a model with item parameters constrained across sexes fit significantly worse than a model with item parameters that are allowed to vary across sexes?</li>
<li>Starting with an unconstrained model that allows item parameters to vary across sexes, sequentially add constraints to item parameters across groups. Which items differed in discrimination across groups? Which items differed in severity across groups? Describe any differences.</li>
<li>How could any differential item functioning be addressed?</li>
</ol>
</li>
<li>Examine the longitudinal measurement invariance of the Antisocial scale across T1 and T2. Use full information maximum likelihood (FIML) to account for missing data. Use robust standard errors to account for non-normally distributed data. Which type(s) of longitudinal measurement invariance failed? Which items and parameters appeared to differ across ages?</li>
</ol></section><section id="sec-exercisesAnswers-bias" class="level3" data-number="16.13.2"><h3 data-number="16.13.2" class="anchored" data-anchor-id="sec-exercisesAnswers-bias">
<span class="header-section-number">16.13.2</span> Answers</h3>
<ol type="1">
<li><ol type="a">
<li>There is predictive bias in terms of different slopes across sexes. The slope is steeper for boys than girls, indicating that the measure is not as predictively accurate for girls as it is for boys.</li>
<li>You could address this predictive bias by using a different predictive measure for girls than boys, changing the criterion, or by using within-group norming.</li>
</ol></li>
<li>No, the Antisocial scale does not show equal outcomes in terms of <a href="prediction.html#sec-selectionRatio">selection rate</a>. The selection ratio is much lower in girls <span class="math inline">\((0.10)\)</span> compared to boys <span class="math inline">\((0.05)\)</span>.</li>
<li>The measure could be unbiased if it shows the same intercepts and slopes across groups in predicting college performance. However, a measure can still be unfair even it is unbiased. If there are different types of errors in different groups, the measure may not be fair. For instance, if there are more false negative errors in Black applicants compared to White applicants and more false positive errors in White applicants than Black applicants, the measure would be unfair against Black applicants. Even if the percent accuracy of prediction is the same for Black and White applicants, the errors have different implications for each group—White applicants who would have failed in college are more likely to be accepted whereas strong Black applicants who would have succeeded are less likely to be accepted. To address the unfairness of the test, it will be important to use one of the various operationalizations of fairness: equal outcomes, equal opportunity, or equal odds.</li>
<li><ol type="a">
<li>The model with item parameters constrained across sexes fit significantly worse than a model with item parameters that were allowed to vary across sexes, <span class="math inline">\(\chi^2[-19] = -119.12, p &lt; .001\)</span>. This suggests that the item parameters show differential item functioning across boys and girls.</li>
<li>No items showed significant differences in discrimination across sexes, suggesting that items did not differ in their relation to the latent factor across boys and girls. Items 1, 2, 3, 4, 5, and 6 differed in severity across sexes. Items showed greater severity for girls than boys. It took a higher level of antisocial behavior for a girl to be endorsed as engaging in one of the following behaviors: cheats or tells lies, bullies or is cruel/mean to others, does not seem to feel sorry after misbehaving, breaks things deliberately, is disobedient at school, and has trouble getting along with teachers.</li>
<li>The differences in item severity across boys and girls could be addressed by resolving DIF. That is, the items that show severity DIF (items 1–6) would be allowed to differ in their severity parameter across boys and girls, but these items would be constrained to have the same discrimination across groups; non-DIF items would have severity and discrimination parameters constrained to be the same across groups.</li>
</ol></li>
<li>The configural invariance model fit well according to RMSEA <span class="math inline">\((0.09)\)</span> and SRMR <span class="math inline">\((0.06)\)</span>, but fit less well according to CFI <span class="math inline">\((0.77)\)</span>. The metric invariance model did not fit significantly worse than the configural invariance model <span class="math inline">\((\Delta\chi^2[6] = 8.77, p = 0.187)\)</span>. However, the scalar invariance model fit significantly worse than the metric invariance model <span class="math inline">\((\Delta\chi^2[6] = 21.28, p = 0.002)\)</span>, and the residual invariance model fit significantly worse than the scalar invariance model <span class="math inline">\((\Delta\chi^2[7] = 42.80, p &lt; .001)\)</span>. Therefore, scalar and residual invariance failed. The following items showed larger intercepts at T1 compared to T2: items 1, 2, 3, 4, 5, and 7. Only item 6 showed larger intercepts at T2 than T1. The following items showed a larger residual at T1 compared to T2: items 2–7. Only item 1 showed a larger residual at T2 compared to T1.</li>
</ol></section></section><section id="sec-sessionInfo-bias" class="level2" data-number="16.14"><h2 data-number="16.14" class="anchored" data-anchor-id="sec-sessionInfo-bias">
<span class="header-section-number">16.14</span> Session Info</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb282"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats4    stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] knitr_1.51        tinytex_0.58      here_1.0.2        lubridate_1.9.5  
 [5] forcats_1.0.1     stringr_1.6.0     dplyr_1.2.0       purrr_1.2.1      
 [9] readr_2.2.0       tidyr_1.3.2       tibble_3.3.1      ggplot2_4.0.2    
[13] tidyverse_2.0.0   MOTE_1.2.2        strucchange_1.5-4 sandwich_3.1-1   
[17] zoo_1.8-15        dmacs_0.1.0.9002  mirt_1.45.1       lattice_0.22-7   
[21] semPlot_1.1.8     semTools_0.5-8    lavaan_0.6-21     petersenlab_1.2.3

loaded via a namespace (and not attached):
  [1] RColorBrewer_1.1-3    rstudioapi_0.18.0     audio_0.1-12         
  [4] jsonlite_2.0.0        magrittr_2.0.4        farver_2.1.2         
  [7] nloptr_2.2.1          rmarkdown_2.30        vctrs_0.7.1          
 [10] minqa_1.2.8           base64enc_0.1-6       htmltools_0.5.9      
 [13] Formula_1.2-5         dcurver_0.9.3         parallelly_1.46.1    
 [16] htmlwidgets_1.6.4     testthat_3.3.2        plyr_1.8.9           
 [19] igraph_2.2.2          lifecycle_1.0.5       pkgconfig_2.0.3      
 [22] Matrix_1.7-4          R6_2.6.1              fastmap_1.2.0        
 [25] rbibutils_2.4.1       future_1.69.0         digest_0.6.39        
 [28] OpenMx_2.22.10        fdrtool_1.2.18        colorspace_2.1-2     
 [31] rprojroot_2.1.1       Hmisc_5.2-5           vegan_2.7-2          
 [34] progressr_0.18.0      timechange_0.4.0      abind_1.4-8          
 [37] mgcv_1.9-3            compiler_4.5.2        proxy_0.4-29         
 [40] bit64_4.6.0-1         withr_3.0.2           glasso_1.11          
 [43] htmlTable_2.4.3       S7_0.2.1              backports_1.5.0      
 [46] carData_3.0-6         DBI_1.2.3             psych_2.6.1          
 [49] R.utils_2.13.0        MASS_7.3-65           sessioninfo_1.2.3    
 [52] GPArotation_2025.3-1  corpcor_1.6.10        gtools_3.9.5         
 [55] permute_0.9-10        tools_4.5.2           pbivnorm_0.6.0       
 [58] foreign_0.8-90        otel_0.2.0            zip_2.3.3            
 [61] future.apply_1.20.1   clipr_0.8.0           nnet_7.3-20          
 [64] R.oo_1.27.1           glue_1.8.0            quadprog_1.5-8       
 [67] nlme_3.1-168          lisrelToR_0.3         grid_4.5.2           
 [70] checkmate_2.3.4       cluster_2.1.8.1       reshape2_1.4.5       
 [73] generics_0.1.4        gtable_0.3.6          tzdb_0.5.0           
 [76] R.methodsS3_1.8.2     class_7.3-23          hms_1.1.4            
 [79] data.table_1.18.2.1   Deriv_4.2.0           sem_3.1-16           
 [82] pillar_1.11.1         vroom_1.7.0           rockchalk_1.8.157    
 [85] mitools_2.4           splines_4.5.2         bit_4.6.0            
 [88] kutils_1.73           tidyselect_1.2.1      pbapply_1.7-4        
 [91] mix_1.0-13            reformulas_0.4.4      gridExtra_2.3        
 [94] xfun_0.56             qgraph_1.9.8          brio_1.1.5           
 [97] arm_1.14-4            stringi_1.8.7         yaml_2.3.12          
[100] boot_1.3-32           evaluate_1.0.5        codetools_0.2-20     
[103] beepr_2.0             mi_1.2                cli_3.6.5            
[106] RcppParallel_5.1.11-1 rpart_4.1.24          xtable_1.8-4         
[109] Rdpack_2.6.6          Rcpp_1.1.1            globals_0.19.0       
[112] coda_0.19-4.1         png_0.1-8             XML_3.99-0.22        
[115] parallel_4.5.2        jpeg_0.1-11           lme4_1.1-38          
[118] listenv_0.10.0        viridisLite_0.4.3     mvtnorm_1.3-3        
[121] SimDesign_2.23        scales_1.4.0          e1071_1.7-17         
[124] crayon_1.5.3          openxlsx_4.2.8.1      rlang_1.1.7          
[127] mnormt_2.1.2         </code></pre>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Aguinis2010a" class="csl-entry" role="listitem">
Aguinis, H., Culpepper, S. A., &amp; Pierce, C. A. (2010). Revival of test bias research in preemployment testing. <em>Journal of Applied Psychology</em>, <em>95</em>(4), 648–680. <a href="https://doi.org/10.1037/a0018714">https://doi.org/10.1037/a0018714</a>
</div>
<div id="ref-AERA2014" class="csl-entry" role="listitem">
American Educational Research Association, American Psychological Association, &amp; National Council on Measurement in Education. (2014). <em>Standards for educational and psychological testing</em>. American Educational Research Association.
</div>
<div id="ref-Barrash2010" class="csl-entry" role="listitem">
Barrash, J., Stillman, A., Anderson, S. W., Uc, E. Y., Dawson, J. D., &amp; Rizzo, M. (2010). Prediction of driving ability with neuropsychological tests: Demographic adjustments diminish accuracy. <em>Journal of the International Neuropsychological Society</em>, <em>16</em>(4), 679–686. <a href="https://doi.org/10.1017/S1355617710000470">https://doi.org/10.1017/S1355617710000470</a>
</div>
<div id="ref-Bauer2020" class="csl-entry" role="listitem">
Bauer, D. J., Belzak, W. C. M., &amp; Cole, V. T. (2020). Simplifying the assessment of measurement invariance over multiple background variables: Using regularized moderated nonlinear factor analysis to detect differential item functioning. <em>Structural Equation Modeling: A Multidisciplinary Journal</em>, <em>27</em>(1), 43–55. <a href="https://doi.org/10.1080/10705511.2019.1642754">https://doi.org/10.1080/10705511.2019.1642754</a>
</div>
<div id="ref-Belzak2020" class="csl-entry" role="listitem">
Belzak, W. C. M., &amp; Bauer, D. J. (2020). Improving the assessment of measurement invariance: Using regularization to select anchor items and identify differential item functioning. <em>Psychological Methods</em>, <em>25</em>(6), 673–690. <a href="https://doi.org/10.1037/met0000253">https://doi.org/10.1037/met0000253</a>
</div>
<div id="ref-Brown1999" class="csl-entry" role="listitem">
Brown, R. T., Reynolds, C. R., &amp; Whitaker, J. S. (1999). Bias in mental testing since bias in mental testing. <em>School Psychology Quarterly</em>, <em>14</em>(3), 208–238. <a href="https://doi.org/10.1037/h0089007">https://doi.org/10.1037/h0089007</a>
</div>
<div id="ref-Burlew2019" class="csl-entry" role="listitem">
Burlew, A. K., Peteet, B. J., McCuistian, C., &amp; Miller-Roenigk, B. D. (2019). Best practices for researching diverse groups. <em>American Journal of Orthopsychiatry</em>, <em>89</em>(3), 354–368. <a href="https://doi.org/10.1037/ort0000350">https://doi.org/10.1037/ort0000350</a>
</div>
<div id="ref-Camilli2013" class="csl-entry" role="listitem">
Camilli, G. (2013). Ongoing issues in test fairness. <em>Educational Research and Evaluation</em>, <em>19</em>(2–3), 104–120. <a href="https://doi.org/10.1080/13803611.2013.767602">https://doi.org/10.1080/13803611.2013.767602</a>
</div>
<div id="ref-R-mirt" class="csl-entry" role="listitem">
Chalmers, P. (2020). <em><span class="nocase">mirt</span>: Multidimensional item response theory</em>. <a href="https://CRAN.R-project.org/package=mirt">https://CRAN.R-project.org/package=mirt</a>
</div>
<div id="ref-Chen2007a" class="csl-entry" role="listitem">
Chen, F. F. (2007). Sensitivity of goodness of fit indexes to lack of measurement invariance. <em>Structural Equation Modeling: A Multidisciplinary Journal</em>, <em>14</em>(3), 464–504. <a href="https://doi.org/10.1080/10705510701301834">https://doi.org/10.1080/10705510701301834</a>
</div>
<div id="ref-Cheng2016" class="csl-entry" role="listitem">
Cheng, Y., Shao, C., &amp; Lathrop, Q. N. (2016). The mediated MIMIC model for understanding the underlying mechanism of DIF. <em>Educational and Psychological Measurement</em>, <em>76</em>(1), 43–63. <a href="https://doi.org/10.1177/0013164415576187">https://doi.org/10.1177/0013164415576187</a>
</div>
<div id="ref-Cheung2002" class="csl-entry" role="listitem">
Cheung, G. W., &amp; Rensvold, R. B. (2002). Evaluating goodness-of-fit indexes for testing measurement invariance. <em>Structural Equation Modeling: A Multidisciplinary Journal</em>, <em>9</em>(2), 233–255. <a href="https://doi.org/10.1207/s15328007sem0902_5">https://doi.org/10.1207/s15328007sem0902_5</a>
</div>
<div id="ref-Clark1984" class="csl-entry" role="listitem">
Clark, M. J., &amp; Grandy, J. (1984). <em>Sex differences in the academic performance of <span>S</span>cholastic <span>A</span>ptitude <span>T</span>est takers: College board report no. 84-8</em>. College Board Publications.
</div>
<div id="ref-Cole1981" class="csl-entry" role="listitem">
Cole, N. S. (1981). Bias in testing. <em>American Psychologist</em>, <em>36</em>(10), 1067–1077. <a href="https://doi.org/10.1037/0003-066X.36.10.1067">https://doi.org/10.1037/0003-066X.36.10.1067</a>
</div>
<div id="ref-R-aMNLFA" class="csl-entry" role="listitem">
Cole, V., Gottfredson, N., &amp; Giordano, M. (2018). <em><span class="nocase">aMNLFA</span>: Automated fitting of moderated nonlinear factor analysis through the <span>Mplus</span> program</em>. <a href="https://CRAN.R-project.org/package=aMNLFA">https://CRAN.R-project.org/package=aMNLFA</a>
</div>
<div id="ref-GeneralAptitudeTestBattery1989" class="csl-entry" role="listitem">
Committee on the General Aptitude Test Battery, Commission on Behavioral and Social Sciences and Education, &amp; National Research Council. (1989). <em>Fairness in employment testing: Validity generalization, minority issues, and the general aptitude test battery</em>. National Academies Press.
</div>
<div id="ref-Counsell2020" class="csl-entry" role="listitem">
Counsell, A., Cribbie, R. A., &amp; Flora, D. B. (2020). Evaluating equivalence testing methods for measurement invariance. <em>Multivariate Behavioral Research</em>, <em>55</em>(2), 312–328. <a href="https://doi.org/10.1080/00273171.2019.1633617">https://doi.org/10.1080/00273171.2019.1633617</a>
</div>
<div id="ref-Curran2014" class="csl-entry" role="listitem">
Curran, P. J., Howard, A. L., Bainter, S. A., Lane, S. T., &amp; McGinley, J. S. (2014). The separation of between-person and within-person components of individual change over time: A latent curve model with structured residuals. <em>Journal of Consulting and Clinical Psychology</em>, <em>82</em>, 8–94. <a href="https://doi.org/10.1037/a0035297">https://doi.org/10.1037/a0035297</a>
</div>
<div id="ref-Dorans2017" class="csl-entry" role="listitem">
Dorans, N. J. (2017). Contributions to the quantitative assessment of item, test, and score fairness. In R. E. Bennett &amp; M. von Davier (Eds.), <em>Advancing human assessment</em> (pp. 201–230). Springer, Cham.
</div>
<div id="ref-R-dmacs" class="csl-entry" role="listitem">
Dueber, D. (2019). <em><span class="nocase">dmacs</span>: Measurement nonequivalence effect size calculator</em>. <a href="https://github.com/ddueber/dmacs">https://github.com/ddueber/dmacs</a>
</div>
<div id="ref-R-semPlot" class="csl-entry" role="listitem">
Epskamp, S. (2022). <em><span class="nocase">semPlot</span>: Path diagrams and visual analysis of various <span>SEM</span> packages’ output</em>. <a href="https://github.com/SachaEpskamp/semPlot">https://github.com/SachaEpskamp/semPlot</a>
</div>
<div id="ref-Fernandez2018" class="csl-entry" role="listitem">
Fernández, A. L., &amp; Abe, J. (2018). Bias in cross-cultural neuropsychological testing: Problems and possible solutions. <em>Culture and Brain</em>, <em>6</em>(1), 1–35. <a href="https://doi.org/10.1007/s40167-017-0050-2">https://doi.org/10.1007/s40167-017-0050-2</a>
</div>
<div id="ref-Fletcher2021" class="csl-entry" role="listitem">
Fletcher, R. R., Nakeshimana, A., &amp; Olubeko, O. (2021). Addressing fairness, bias, and appropriate use of artificial intelligence and machine learning in global health. <em>Frontiers in Artificial Intelligence</em>, <em>3</em>(116). <a href="https://doi.org/10.3389/frai.2020.561802">https://doi.org/10.3389/frai.2020.561802</a>
</div>
<div id="ref-Gipps2009" class="csl-entry" role="listitem">
Gipps, C., &amp; Stobart, G. (2009). Fairness in assessment. In C. Wyatt-Smith &amp; J. J. Cumming (Eds.), <em>Educational assessment in the 21st century: Connecting theory and practice</em> (pp. 105–118). Springer Netherlands. <a href="https://doi.org/10.1007/978-1-4020-9964-9_6">https://doi.org/10.1007/978-1-4020-9964-9_6</a>
</div>
<div id="ref-Gonzalez2021" class="csl-entry" role="listitem">
Gonzalez, O., &amp; Pelham, W. E. (2021). When does differential item functioning matter for screening? A method for empirical evaluation. <em>Assessment</em>, <em>28</em>(2), 446–456. <a href="https://doi.org/10.1177/1073191120913618">https://doi.org/10.1177/1073191120913618</a>
</div>
<div id="ref-Gottfredson1994" class="csl-entry" role="listitem">
Gottfredson, L. S. (1994). The science and politics of race-norming. <em>American Psychologist</em>, <em>49</em>(11), 955–963. <a href="https://doi.org/10.1037/0003-066X.49.11.955">https://doi.org/10.1037/0003-066X.49.11.955</a>
</div>
<div id="ref-Gottfredson2019" class="csl-entry" role="listitem">
Gottfredson, N. C., Cole, V. T., Giordano, M. L., Bauer, D. J., Hussong, A. M., &amp; Ennett, S. T. (2019). Simplifying the implementation of modern scale scoring methods with an automated <span>R</span> package: Automated moderated nonlinear factor analysis (<span class="nocase">aMNLFA</span>). <em>Addictive Behaviors</em>, <em>94</em>, 65–73. <a href="https://doi.org/10.1016/j.addbeh.2018.10.031">https://doi.org/10.1016/j.addbeh.2018.10.031</a>
</div>
<div id="ref-Gunn2020" class="csl-entry" role="listitem">
Gunn, H. J., Grimm, K. J., &amp; Edwards, M. C. (2020). Evaluation of six effect size measures of measurement non-invariance for continuous outcomes. <em>Structural Equation Modeling: A Multidisciplinary Journal</em>, <em>27</em>(4), 503–514. <a href="https://doi.org/10.1080/10705511.2019.1689507">https://doi.org/10.1080/10705511.2019.1689507</a>
</div>
<div id="ref-Hagquist2019" class="csl-entry" role="listitem">
Hagquist, C. (2019). Explaining differential item functioning focusing on the crucial role of external information – an example from the measurement of adolescent mental health. <em>BMC Medical Research Methodology</em>, <em>19</em>(1), 185. <a href="https://doi.org/10.1186/s12874-019-0828-3">https://doi.org/10.1186/s12874-019-0828-3</a>
</div>
<div id="ref-Hagquist2017" class="csl-entry" role="listitem">
Hagquist, C., &amp; Andrich, D. (2017). Recent advances in analysis of differential item functioning in health research using the <span>R</span>asch model. <em>Health and Quality of Life Outcomes</em>, <em>15</em>(1), 181. <a href="https://doi.org/10.1186/s12955-017-0755-0">https://doi.org/10.1186/s12955-017-0755-0</a>
</div>
<div id="ref-Hall1999" class="csl-entry" role="listitem">
Hall, G. C. N., Bansal, A., &amp; Lopez, I. R. (1999). Ethnicity and psychopathology: A meta-analytic review of 31 years of comparative MMPI/MMPI-2 research. <em>Psychological Assessment</em>, <em>11</em>(2), 186–197. <a href="https://doi.org/10.1037/1040-3590.11.2.186">https://doi.org/10.1037/1040-3590.11.2.186</a>
</div>
<div id="ref-Han2019" class="csl-entry" role="listitem">
Han, K., Colarelli, S. M., &amp; Weed, N. C. (2019). Methodological and statistical advances in the consideration of cultural diversity in assessment: A critical review of group classification and measurement invariance testing. <em>Psychological Assessment</em>, <em>31</em>(12), 1481–1496. <a href="https://doi.org/10.1037/pas0000731">https://doi.org/10.1037/pas0000731</a>
</div>
<div id="ref-Helms2006" class="csl-entry" role="listitem">
Helms, J. E. (2006). Fairness is not validity or cultural bias in racial-group assessment: A quantitative perspective. <em>American Psychologist</em>, <em>61</em>(8), 845–859. <a href="https://doi.org/10.1037/0003-066X.61.8.845">https://doi.org/10.1037/0003-066X.61.8.845</a>
</div>
<div id="ref-Jensen1980" class="csl-entry" role="listitem">
Jensen, A. R. (1980). Précis of bias in mental testing. <em>Behavioral and Brain Sciences</em>, <em>3</em>(3), 325–333. <a href="https://doi.org/10.1017/S0140525X00005161">https://doi.org/10.1017/S0140525X00005161</a>
</div>
<div id="ref-Jonson2022" class="csl-entry" role="listitem">
Jonson, J. L., &amp; Geisinger, K. F. (2022). <em>Fairness in educational and psychological testing: Examining theoretical, research, practice, and policy implications of the 2014 standards</em>. American Educational Research Association,.
</div>
<div id="ref-Jorgensen2018" class="csl-entry" role="listitem">
Jorgensen, T. D., Kite, B. A., Chen, P.-Y., &amp; Short, S. D. (2018). Permutation randomization methods for testing measurement equivalence and detecting differential item functioning in multiple-group confirmatory factor analysis. <em>Psychological Methods</em>, <em>23</em>(4), 708–728. <a href="https://doi.org/10.1037/met0000152">https://doi.org/10.1037/met0000152</a>
</div>
<div id="ref-R-semTools" class="csl-entry" role="listitem">
Jorgensen, T. D., Pornprasertmanit, S., Schoemann, A. M., &amp; Rosseel, Y. (2021). <em><span class="nocase">semTools</span>: Useful tools for structural equation modeling</em>. <a href="https://github.com/simsem/semTools/wiki">https://github.com/simsem/semTools/wiki</a>
</div>
<div id="ref-Kuncel2010a" class="csl-entry" role="listitem">
Kuncel, N. R., &amp; Hezlett, S. A. (2010). Fact and fiction in cognitive ability testing for admissions and hiring decisions. <em>Current Directions in Psychological Science</em>, <em>19</em>(6), 339–345. <a href="https://doi.org/10.1177/0963721410389459">https://doi.org/10.1177/0963721410389459</a>
</div>
<div id="ref-Lai2021" class="csl-entry" role="listitem">
Lai, M. H. C. (2021). Adjusting for measurement noninvariance with alignment in growth modeling. <em>Multivariate Behavioral Research</em>, 1–18. <a href="https://doi.org/10.1080/00273171.2021.1941730">https://doi.org/10.1080/00273171.2021.1941730</a>
</div>
<div id="ref-Lee2013" class="csl-entry" role="listitem">
Lee, K., Bull, R., &amp; Ho, R. M. H. (2013). Developmental changes in executive functioning. <em>Child Development</em>, <em>84</em>(6), 1933–1953. <a href="https://doi.org/10.1111/cdev.12096">https://doi.org/10.1111/cdev.12096</a>
</div>
<div id="ref-Little2013" class="csl-entry" role="listitem">
Little, T. D. (2013). <em>Longitudinal structural equation modeling</em>. The Guilford Press.
</div>
<div id="ref-Little2007" class="csl-entry" role="listitem">
Little, T. D., Preacher, K. J., Selig, J. P., &amp; Card, N. A. (2007). New developments in latent variable panel analyses of longitudinal data. <em>International Journal of Behavioral Development</em>, <em>31</em>(4), 357–365. <a href="https://doi.org/10.1177/0165025407077757">https://doi.org/10.1177/0165025407077757</a>
</div>
<div id="ref-Little2006a" class="csl-entry" role="listitem">
Little, T. D., Slegers, D. W., &amp; Card, N. A. (2006). A non-arbitrary method of identifying and scaling latent variables in SEM and MACS models. <em>Structural Equation Modeling</em>, <em>13</em>(1), 59–72. <a href="https://doi.org/10.1207/s15328007sem1301_3">https://doi.org/10.1207/s15328007sem1301_3</a>
</div>
<div id="ref-Liu2017a" class="csl-entry" role="listitem">
Liu, Y., Millsap, R. E., West, S. G., Tein, J.-Y., Tanaka, R., &amp; Grimm, K. J. (2017). Testing measurement invariance in longitudinal data with ordered-categorical measures. <em>Psychological Methods</em>, <em>22</em>(3), 486–506. <a href="https://doi.org/10.1037/met0000075">https://doi.org/10.1037/met0000075</a>
</div>
<div id="ref-Manly2005" class="csl-entry" role="listitem">
Manly, J. J. (2005). Advantages and disadvantages of separate norms for <span>A</span>frican <span>A</span>mericans. <em>The Clinical Neuropsychologist</em>, <em>19</em>(2), 270–275. <a href="https://doi.org/10.1080/13854040590945346">https://doi.org/10.1080/13854040590945346</a>
</div>
<div id="ref-Manly2007" class="csl-entry" role="listitem">
Manly, J. J., &amp; Echemendia, R. J. (2007). Race-specific norms: Using the model of hypertension to understand issues of race, culture, and education in neuropsychology. <em>Archives of Clinical Neuropsychology</em>, <em>22</em>(3), 319–325. <a href="https://doi.org/10.1016/j.acn.2007.01.006">https://doi.org/10.1016/j.acn.2007.01.006</a>
</div>
<div id="ref-McClelland1973" class="csl-entry" role="listitem">
McClelland, D. C. (1973). Testing for competence rather than for <span>“intelligence.”</span> <em>American Psychologist</em>, <em>28</em>, 1–14. <a href="https://doi.org/10.1037/h0034092">https://doi.org/10.1037/h0034092</a>
</div>
<div id="ref-Meade2010" class="csl-entry" role="listitem">
Meade, A. W. (2010). A taxonomy of effect size measures for the differential functioning of items and scales. <em>Journal of Applied Psychology</em>, <em>95</em>(4), 728–743. <a href="https://doi.org/10.1037/a0018966">https://doi.org/10.1037/a0018966</a>
</div>
<div id="ref-Melikyan2019" class="csl-entry" role="listitem">
Melikyan, Z. A., Agranovich, A. V., &amp; Puente, A. E. (2019). Fairness in psychological testing. In G. Goldstein, D. N. Allen, &amp; J. DeLuca (Eds.), <em>Handbook of psychological assessment (fourth edition)</em> (pp. 551–572). Academic Press. <a href="https://doi.org/10.1016/B978-0-12-802203-0.00018-3">https://doi.org/10.1016/B978-0-12-802203-0.00018-3</a>
</div>
<div id="ref-Millsap2011" class="csl-entry" role="listitem">
Millsap, R. E. (2011). <em>Statistical approaches to measurement invariance</em>. Taylor &amp; Francis.
</div>
<div id="ref-Muthen2019" class="csl-entry" role="listitem">
Muthén, L. K., &amp; Muthén, B. O. (2019). <em>Mplus version 8.4</em>. Muthén &amp; Muthén.
</div>
<div id="ref-Newsom2015" class="csl-entry" role="listitem">
Newsom, J. T. (2015). <em>Longitudinal structural equation modeling: A comprehensive introduction</em>. Routledge.
</div>
<div id="ref-Nye2019" class="csl-entry" role="listitem">
Nye, C. D., Bradburn, J., Olenick, J., Bialko, C., &amp; Drasgow, F. (2019). How big are my effects? Examining the magnitude of effect sizes in studies of measurement equivalence. <em>Organizational Research Methods</em>, <em>22</em>(3), 678–709. <a href="https://doi.org/10.1177/1094428118761122">https://doi.org/10.1177/1094428118761122</a>
</div>
<div id="ref-Oberski2014" class="csl-entry" role="listitem">
Oberski, D. L. (2014). Evaluating sensitivity of parameters of interest to measurement invariance in latent variable models. <em>Political Analysis</em>, <em>22</em>(1), 45–60. <a href="https://doi.org/10.1093/pan/mpt014">https://doi.org/10.1093/pan/mpt014</a>
</div>
<div id="ref-Oberski2015" class="csl-entry" role="listitem">
Oberski, D. L., Vermunt, J. K., &amp; Moors, G. B. D. (2015). Evaluating measurement invariance in categorical data latent variable models with the EPC-interest. <em>Political Analysis</em>, <em>23</em>(4), 550–563. <a href="https://doi.org/10.1093/pan/mpv020">https://doi.org/10.1093/pan/mpv020</a>
</div>
<div id="ref-Paulus2020" class="csl-entry" role="listitem">
Paulus, J. K., &amp; Kent, D. M. (2020). Predictably unequal: Understanding and addressing concerns that algorithmic clinical prediction may increase health disparities. <em>Npj Digital Medicine</em>, <em>3</em>(1), 99. <a href="https://doi.org/10.1038/s41746-020-0304-9">https://doi.org/10.1038/s41746-020-0304-9</a>
</div>
<div id="ref-R-petersenlab" class="csl-entry" role="listitem">
Petersen, I. T. (2025). <em><span class="nocase">petersenlab</span>: A collection of <span>R</span> functions by the <span>Petersen Lab</span></em>. <a href="https://doi.org/10.32614/CRAN.package.petersenlab">https://doi.org/10.32614/CRAN.package.petersenlab</a>
</div>
<div id="ref-Petersen2020" class="csl-entry" role="listitem">
Petersen, I. T., Choe, D. E., &amp; LeBeau, B. (2020). Studying a moving target in development: The challenge and opportunity of heterotypic continuity. <em>Developmental Review</em>, <em>58</em>, 100935. <a href="https://doi.org/10.1016/j.dr.2020.100935">https://doi.org/10.1016/j.dr.2020.100935</a>
</div>
<div id="ref-Putnick2016" class="csl-entry" role="listitem">
Putnick, D. L., &amp; Bornstein, M. H. (2016). Measurement invariance conventions and reporting: The state of the art and future directions for psychological research. <em>Developmental Review</em>, <em>41</em>, 71–90. <a href="https://doi.org/10.1016/j.dr.2016.06.004">https://doi.org/10.1016/j.dr.2016.06.004</a>
</div>
<div id="ref-Raykovinpress" class="csl-entry" role="listitem">
Raykov, T., Marcoulides, G. A., Harrison, M., &amp; Zhang, M. (2020). On the dependability of a popular procedure for studying measurement invariance: A cause for concern? <em>Structural Equation Modeling: A Multidisciplinary Journal</em>, <em>27</em>(4), 649–656. <a href="https://doi.org/10.1080/10705511.2019.1610409">https://doi.org/10.1080/10705511.2019.1610409</a>
</div>
<div id="ref-Reynolds2021" class="csl-entry" role="listitem">
Reynolds, C. R., Altmann, R. A., &amp; Allen, D. N. (2021). The problem of bias in psychological assessment. In C. R. Reynolds, R. A. Altmann, &amp; D. N. Allen (Eds.), <em>Mastering modern psychological testing: Theory and methods</em> (pp. 573–613). Springer International Publishing. <a href="https://doi.org/10.1007/978-3-030-59455-8_15">https://doi.org/10.1007/978-3-030-59455-8_15</a>
</div>
<div id="ref-Reynolds2012" class="csl-entry" role="listitem">
Reynolds, C. R., &amp; Suzuki, L. A. (2012). Bias in psychological assessment: An empirical review and recommendations. In I. B. Weiner, J. R. Graham, &amp; J. A. Naglieri (Eds.), <em>Handbook of psychology, <span>V</span>ol. 10: <span>A</span>ssessment psychology, <span>P</span>art 1: <span>A</span>ssessment issues</em> (2nd ed., pp. 82–113).
</div>
<div id="ref-R-mnlfa" class="csl-entry" role="listitem">
Robitzsch, A. (2019). <em><span class="nocase">mnlfa</span>: Moderated nonlinear factor analysis</em>. <a href="https://CRAN.R-project.org/package=mnlfa">https://CRAN.R-project.org/package=mnlfa</a>
</div>
<div id="ref-R-lavaan" class="csl-entry" role="listitem">
Rosseel, Y., Jorgensen, T. D., &amp; Rockwood, N. (2022). <em><span class="nocase">lavaan</span>: Latent variable analysis</em>. <a href="https://lavaan.ugent.be">https://lavaan.ugent.be</a>
</div>
<div id="ref-Sackett2008" class="csl-entry" role="listitem">
Sackett, P. R., Borneman, M. J., &amp; Connelly, B. S. (2008). High stakes testing in higher education and employment: Appraising the evidence for validity and fairness. <em>American Psychologist</em>, <em>63</em>, 215–227. <a href="https://doi.org/10.1037/0003-066X.63.4.215">https://doi.org/10.1037/0003-066X.63.4.215</a>
</div>
<div id="ref-Sackett2001" class="csl-entry" role="listitem">
Sackett, P. R., Schmitt, N., Ellingson, J. E., &amp; Kabin, M. B. (2001). High-stakes testing in employment, credentialing, and higher education. <em>American Psychologist</em>, <em>56</em>, 301–318. <a href="https://doi.org/10.1037/0003-066X.56.4.302">https://doi.org/10.1037/0003-066X.56.4.302</a>
</div>
<div id="ref-Sackett1994" class="csl-entry" role="listitem">
Sackett, P. R., &amp; Wilk, S. L. (1994). Within-group norming and other forms of score adjustment in preemployment testing. <em>American Psychologist</em>, <em>49</em>(11), 929–954. <a href="https://doi.org/10.1037/0003-066X.49.11.929">https://doi.org/10.1037/0003-066X.49.11.929</a>
</div>
<div id="ref-Schmidt1981" class="csl-entry" role="listitem">
Schmidt, F. L., &amp; Hunter, J. E. (1981). Employment testing: Old theories and new research findings. <em>American Psychologist</em>, <em>36</em>(10), 1128–1137. <a href="https://doi.org/10.1037/0003-066X.36.10.1128">https://doi.org/10.1037/0003-066X.36.10.1128</a>
</div>
<div id="ref-Silverberg2009" class="csl-entry" role="listitem">
Silverberg, N. D., &amp; Millis, S. R. (2009). Impairment versus deficiency in neuropsychological assessment: Implications for ecological validity. <em>Journal of the International Neuropsychological Society</em>, <em>15</em>(1), 94–102. <a href="https://doi.org/10.1017/S1355617708090139">https://doi.org/10.1017/S1355617708090139</a>
</div>
<div id="ref-Thorndike1971" class="csl-entry" role="listitem">
Thorndike, R. L. (1971). Concepts of culture-fairness. <em>Journal of Educational Measurement</em>, <em>8</em>(2), 63–70. <a href="https://doi.org/10.1111/j.1745-3984.1971.tb00907.x">https://doi.org/10.1111/j.1745-3984.1971.tb00907.x</a>
</div>
<div id="ref-VanDeSchoot2013" class="csl-entry" role="listitem">
Van De Schoot, R., Kluytmans, A., Tummers, L., Lugtig, P., Hox, J., &amp; Muthen, B. (2013). Facing off with scylla and charybdis: A comparison of scalar, partial, and the novel possibility of approximate measurement invariance. <em>Frontiers in Psychology</em>, <em>4</em>(770). <a href="https://doi.org/10.3389/fpsyg.2013.00770">https://doi.org/10.3389/fpsyg.2013.00770</a>
</div>
<div id="ref-VanDeSchoot2015" class="csl-entry" role="listitem">
Van De Schoot, R., Schmidt, P., De Beuckelaer, A., Lek, K., &amp; Zondervan-Zwijnenburg, M. (2015). Editorial: Measurement invariance. <em>Frontiers in Psychology</em>, <em>6</em>(1064). <a href="https://doi.org/10.3389/fpsyg.2015.01064">https://doi.org/10.3389/fpsyg.2015.01064</a>
</div>
<div id="ref-Wang2014a" class="csl-entry" role="listitem">
Wang, T., Merkle, E. C., &amp; Zeileis, A. (2014). Score-based tests of measurement invariance: Use in practice. <em>Frontiers in Psychology</em>, <em>5</em>. <a href="https://doi.org/10.3389/fpsyg.2014.00438">https://doi.org/10.3389/fpsyg.2014.00438</a>
</div>
<div id="ref-Wang2009b" class="csl-entry" role="listitem">
Wang, W.-C., Shih, C.-L., &amp; Yang, C.-C. (2009). The MIMIC method with scale purification for detecting differential item functioning. <em>Educational and Psychological Measurement</em>, <em>69</em>(5), 713–731. <a href="https://doi.org/10.1177/0013164409332228">https://doi.org/10.1177/0013164409332228</a>
</div>
<div id="ref-Youngstrom2016" class="csl-entry" role="listitem">
Youngstrom, E. A., &amp; Van Meter, A. (2016). Empirically supported assessment of children and adolescents. <em>Clinical Psychology: Science and Practice</em>, <em>23</em>(4), 327–347. <a href="https://doi.org/10.1111/cpsp.12172">https://doi.org/10.1111/cpsp.12172</a>
</div>
<div id="ref-Zieky2006" class="csl-entry" role="listitem">
Zieky, M. J. (2006). Fairness review in assessment. In S. M. Downing &amp; T. M. Haladyna (Eds.), <em>Handbook of test development</em> (pp. 359–376). Routledge. <a href="https://doi.org/10.4324/9780203874776.ch16">https://doi.org/10.4324/9780203874776.ch16</a>
</div>
<div id="ref-Zieky2013" class="csl-entry" role="listitem">
Zieky, M. J. (2013). Fairness review in assessment. In K. F. Geisinger, B. A. Bracken, J. F. Carlson, J.-I. C. Hansen, N. R. Kuncel, S. P. Reise, &amp; M. C. Rodriguez (Eds.), <em>APA handbook of testing and assessment in psychology, <span>V</span>ol. 1: <span>T</span>est theory and testing and assessment in industrial and organizational psychology</em> (pp. 293–302). American Psychological Association. <a href="https://doi.org/10.1037/14047-017">https://doi.org/10.1037/14047-017</a>
</div>
</div>
</section></main><!-- /main --><h2>Feedback</h2>

<div class="feedback">
    Please consider providing feedback about this textbook, so that I can make it as helpful as possible. You can provide feedback at the following link:
    
    <a href="https://forms.gle/95iW4p47cuaphTek6">https://forms.gle/95iW4p47cuaphTek6</a>
</div>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/isaactpetersen\.github\.io\/Principles-Psychological-Assessment");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      if (authorPrefersDark) {
          [baseTheme, altTheme] = [altTheme, baseTheme];
      }
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "isaactpetersen/Principles-Psychological-Assessment";
    script.dataset.repoId = "MDEwOlJlcG9zaXRvcnkzNzIwMjExNjg=";
    script.dataset.category = "Chapter Comments";
    script.dataset.categoryId = "DIC_kwDOFiyXsM4CzZAv";
    script.dataset.mapping = "pathname";
    script.dataset.reactionsEnabled = "0";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./intellectual-assessment.html" class="pagination-link" aria-label="Intellectual Assessment">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Intellectual Assessment</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./interview-dsm.html" class="pagination-link" aria-label="The Interview and the DSM">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">The Interview and the DSM</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>“Principles of Psychological Assessment: With Applied Examples in R” was written by <a href="https://psychology.uiowa.edu/people/isaac-petersen">Isaac T. Petersen</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/edit/main/test-bias.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/blob/main/test-bias.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/isaactpetersen/Principles-Psychological-Assessment/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>